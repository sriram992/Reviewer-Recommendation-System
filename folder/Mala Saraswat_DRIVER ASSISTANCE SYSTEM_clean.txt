Advances and Applications in Mathematical Sciences Volume 20, Issue 3, January 2021, Pages 345-353 2021 Mili Publications 2010 Mathematics Subject Classification: 82C70, 90B06. Keywords: Eye Aspect Ratio, Mouth Vertical Distance, Region of Interest. Received April 15, 2020; Accepted July 20, 2020 DRIVER ASSISTANCE SYSTEM SARIKA, VARSHIT BANSAL, VIKAS YADAV and MALA SARASWAT Department of Computer Science and Engineering ABES Engineering College Ghaziabad, India Abstract India is home to one of the most underpaid yet overworking drivers. Transporters expect them to work at least twenty or more hours per day continuously without any consideration to their health. This leads them to have bursts of micro sleep, a temporary episode of sleepiness which may last for a smidgen of a second or up to 30 seconds, where the victim fails to react to some stimulus from the environment and becomes unconscious. As a result of this, road accidents have become a common occurrence in India. One solution to this problem is to enhance the vehicles to an extent, so that it is possible to determine the drowsiness of the driver in real time. In this project, we propose a system to assist a driver through detecting drowsiness, distractions and stop signs. The system is easy to understand and the learning curve is minimal. The system is highly robust and can withstand minimal amount of wear and tear. The products assumes that the driver is not blind or deaf. This assumption does not affect the availability of product to mass customers since there are not many driver with visual impairment or hearing impairment. It also assumes that the driver does not drive with either of their eyes closed since driving is not a fun game, since the lives of other passengers is in the drivers hands. I. Introduction In India, sixteen people die per hour. Global Road Safety Report 2015 states that road accidents have caused a total of 1, 41, 526 deaths and around five lakh injuries to people in India. Moreover, this estimation is not accurate since all accidents are not recorded by the police. Driving is a tedious task which requires driver s attention at all time, but in recent years, driver s live with a lot of stress and have to go through a lot of exhausting situations that may reduce their ability to control the vehicles that they are driving. There are a lot of parameters that could contribute to a driver s drowsiness. Some predominant parameters include mental or physical SARIKA, V. BANSAL, V. YADAV and M. SARASWAT Advances and Applications in Mathematical Sciences, Volume 20, Issue 3, January 2021 346 fatigue, inadequate sleep, and consumption of drugs. The drivers are actually aware that their capabilities have reduced due to them being in a state of drowsiness but think that they can manage it. Our project aims to develop an interface for vehicles consisting of four modules, that are detection of yawning and closing of eyelids for prolonged amount of time, alert generation for stop sign and alert generation if driver is on a phone call. II. Literature Review Many efforts in developing a real time drowsiness detection system has been made. These efforts are primarily dependent on the activeness of the driver driving the vehicle and so as to do that numerous strategies are actualized to recognize the language of the driver by picture handling and Video preparing. K. Srijaythi et al. in their paper which was published in 2019 titled Implementation of drowsiness Detection System has proposed a prototype model for cars safety system which will turn the ignition of the system off if drowsiness is detected during driving [1]. Ersa Vural et al in their paper which was entitled Drowsy Driver Detection Through Facial Movement Analysis has distinguished and processed Blink rate, eye conclusion, yawning and some facial developments which further closed the relationship between head roll and driver tiredness, and at the end the driver yawns less before nodding off [2]. Raoul de Charette in his paper Real time visual traffic lights recognition based on Spot Light Detection and adaptive traffic lights templates has presented an ongoing traffic light acknowledgment framework for on-vehicle camera applications. The aftereffect of this methodology is acceptable when tried in urban situations. The recognized spots together with other shape examination structure solid speculation that feed versatile formats. Despite the fact that it is still in progress, framework was approved in genuine conditions in our model vehicle and furthermore utilizing enlisted video successions [3]. Y. L Kuo, J. S. Lee and S. T Kao in their paper Eye tracking in visible DRIVER ASSISTANCE SYSTEM Advances and Applications in Mathematical Sciences, Volume 20, Issue 3, January 2021 347 environment which was distributed in 2009 has formed an efficient algorithm for iris detection in no poor lighting with a CPU time of 3.22ms [4]. Rani Pet al in February 2016 has published a paper Computer vision based gaze tracking for accident prevention in Futuristic Trends in Research and Innovation for Social Welfare (Startup Conclave), World Conference IEEE in which frequencies of eye flickering and eye conclusion are utilized as the sign of drowsiness and alert sign is then created for suggestion and outside a self image vehicle, street traffic is additionally dissected [5]. L. Constantin et al in their paper Driver Monitoring Using Face Detection and Facial Landmarks which was published In 2018 International Conference and Exposition on Electrical And Power Engineering (EPE) has built up the framework to assess the exhibition of a driver cautiousness technique that utilizes information got by estimation of face and eye locale developments [6]. Cui et. al. in their paper, Efficient Eye States Detection in Real-time for Drowsy Driving Monitoring System which was distributed in International Conference on June 2008 has proposed a solid technique for eye states recognition for lazy driving observation. Given a limited neighborhood square of eye areas, the Local Binary Pattern (LBP) histogram of the square is extricated and each canister of the histogram is treated as a component of the eye [7]. Chin-Teng Lin et. al. in their paper A Real-Time Wireless Brain- Computer Interface System for Drowsiness Detection , Bio-medical Circuits and Systems,which was distributed in IEEE on Aug. 2010 has built up a novel BCI framework to screen the human subjective state and give biofeedback to the driver when lazy state happens [8]. M. J. Flores et. Al. their paper, Real-Time Warning System for Driver Drowsiness Detection Using Visual Information, introduced at Journal of Intelligent and Robotic Systems,2010 has investigated the job of PC vision innovation applied to the improvement of checking frameworks to distinguish distraction. This paper additionally address the security issues and issue identified with camera sensors [9]. SARIKA, V. BANSAL, V. YADAV and M. SARASWAT Advances and Applications in Mathematical Sciences, Volume 20, Issue 3, January 2021 348 S. Barattelli et al in their paper Eye-movements as an input in human computer interaction: exploiting natural behavior , which was distributed in Annual Conference of IEEE Industrial Electronic Society, the creators has attempted to examine and incorporate the data from all correspondence diverts utilized in common correspondence, for example hand and arm signals, normal language and head and eye developments [10]. Laurance R. Young and David Sheena et. al in their paper Survey of eye recording methods referenced kinds of eye developments and their activity alongside their preferences and hindrances. This work of Young and Sheena incorporate types of eye development, attributes of the eye and the ways to deal with the estimation of eye development, handy strategies for estimation with particular thoughtfulness regarding the new systems, general contemplation controlling a determination of strategy, and rundown [11]. III. Proposed Methodology Various algorithms and processes for eye tracking, and monitoring are devised. The most common way is to relate feature of eyes within video. The algorithm is applied on consecutive frames for calculation of time that an eyes takes to close. By general logic the time taken by a drowsy driver to close the eyes will be greater than the time taken by the driver who is generally blinking. If the time is effectively longer it could result in a dangerous crash as a result of fatigue and sleepiness. Figure 1. Correlation Between Fatigue & hours of driving. DRIVER ASSISTANCE SYSTEM Advances and Applications in Mathematical Sciences, Volume 20, Issue 3, January 2021 349 Figure 1 depicts the correlation between fatigue and hours of driving. As shown in the figure the number of crashes increases in polynomial fashion. The system takes input in the form of a video stream from a web cam. The video is captured in real-time. Now, to move forward we have to divide the video into frames for analysis, since the processing of information and extraction of data can be done only on an image. After this the objects in the image are identified using COCO samples. COCO is a huge scale object recognition, division, and subtitling data set. At that point arrangement of the articles is finished. On the off chance that the article arranged is a cell phone, an alarm to the driver is produced to be careful. On the off chance that the article characterizes is a STOP sign, a caution to the driver is created to stop the vehicle. If the object is a person, the face landmarks of the person is determined using Haar cascade samples. Figure 2. Face before alert generation. Figure 2. depicts that object detected through COCO samples is a person and after face recognition the next step of process would be to mark the face landscapes of the person. SARIKA, V. BANSAL, V. YADAV and M. SARASWAT Advances and Applications in Mathematical Sciences, Volume 20, Issue 3, January 2021 350 Figure 3. Live Landmarks of Face. Figure 3 depicts the live landmarks of the face of the person which are generated using Haar cascade samples. Then, eye Region of Interest (ROI) landmarks are used to determine the Eyes aspect ratio (EAR). If the EAR < 0.3 (threshold) for at least 20 frames consecutively, an alert to the driver is generated that driver has drowsy eyes. After that the mouth ROI landmarks are used to calculate mouth vertical distance (MVD). If the MVD > 6 (threshold) for at least 15 frames consecutively, an alert to the driver is generated that driver is yawning. If the eye ROI cannot be determined for at least 15 frames consecutively, an alert to the driver is generated that driver should pay attention on the road. This is the flow of control until the driver clicks on stop detection button. After an image is extracted from the video stream, it is converted into gray scale. Then, object detection is done through COCO samples. Then, classification of objects is done. If the classified objects contains mobile phone as an object, the system generates an alert to the driver to be cautious. Or if the classified objects contains a STOP sign as an object, the system generates an alert to the driver so that the driver can stop the vehicle. The EAR is calculated for the eyes using the 6 landmarks around the eye ROI. A threshold is set for 0.3 and if the EAR becomes less than the threshold for at least 20 frames, an alert is generated to the drivser predicting that they have drowsy eyes. Else it is considered as blinking and no action is reported to the driver. If the landmarks around the eyes ROI and mouth ROI cannot be determined for at least 15 frames, an alert is generated to the driver insisting the driver to pay attention at the road. Else it is considered as a harmless action and nothing is reported to the driver. To DRIVER ASSISTANCE SYSTEM Advances and Applications in Mathematical Sciences, Volume 20, Issue 3, January 2021 351 achieve the outcomes, the framework was tried with numerous individuals and the precision of foreseeing the languid eyes, yawning, and so forth were recorded. In the framework, a 0.5 MP Web cam is utilized that is associated with the workstation. Figure 4. Flowchart of the system IV. Conclusion The framework caution is utilized to alarm the driver. Progressively usage of the framework, an infrared camera will be introduced to catch the video stream so the framework becomes non-intrusive and a modified signal will be introduced to alarm the driver. The system is for a number of people under different lighting conditions, having different distances from the web cam. The systems made for driver assistance is the limelight of the decade with tons of ideas coming together to build the safest product possible. These systems should be able to identify the driver needs some help to concentrate on driving again instead of feeling fatigue, fall victim to drowsiness or loose SARIKA, V. BANSAL, V. YADAV and M. SARASWAT Advances and Applications in Mathematical Sciences, Volume 20, Issue 3, January 2021 352 concentration while operating on cell phones. The objective of this project was to address this issue by generating optimal solutions. The research and effort in building the project led to the following accomplishments: The system detects when the driver is keeping their eyes closed for prolonged time. Figure 5. Alert generation on closed eyes. Figure 5 shows that the EAR is lesser than 0.3 and hence Driver is showing the signs of drowsiness i.e. the driver has closed eyes and to prevent any future accident. The system detects when the driver is attending a phone call or even using a cell phone while driving. The alert message is shown on screen to alert the driver. The framework distinguishes when the driver is yawning which is a parameter of exhaustion or sleepiness. Figure 6. Alert generation while yawning. DRIVER ASSISTANCE SYSTEM Advances and Applications in Mathematical Sciences, Volume 20, Issue 3, January 2021 353 Figure 6. distinguishes when the driver is yawning which is a parameter of exhaustion or sleepiness and generates an alert that Person Is yawning . The system detects when the driver s head drop while driving which is a sign of fatigue or drowsiness. The system detects and initiates the alarm when a stop sign is detected. References [1] K. Srijayathi and M. Vedachary, Implementation of the Driver Drowsiness Detection System, International Journal of Science, Engineering and Technology Research (IJSETR) 2(9) (2013), 1751-4. [2] E. Vural, M. etin, A. Er il, G. Littlewort, M. Bartlett and J. Movellan, Automated drowsiness detection for improved driving safety (2008). [3] R. De Charette and F. Nashashibi, Traffic light recognition using image processing compared to learning processes, In Intelligent Robots and Systems, 2009. IROS 2009. IEEE/RSJ International Conference on (2009, October). [4] Y. Kuo, J. Lee and S. Kao, Eye tracking in visible environment, Proc. 5th Int. Conf. IIH- MSP, pp. 114-117, 2009. [5] P. S. Rani, P. Subhashree and N. S. Devi, Computer vision based gaze tracking for accident prevention, In Futuristic Trends in Research and Innovation for Social Welfare (Startup Conclave), World Conference on (pp. 1-6). IEEE. (2016, February). [6] L. Constantin, C. Fosalau, C. Zet and D. Petrisor, Driver Monitoring Using Face Detection and Facial Landmarks, In 2018 International Conference and Exposition on Electrical And Power Engineering (EPE) (pp. 0385-0390). IEEE. (2018, October). [7] Cui Xu, Ying Zheng and Zengfu Wang, Efficient Eye States Detection in Real-time for Drowsy Driving Monitoring System, Information and Automation, 2008. ICIA 2008. International Conference on, pp. 170-174, 20-23 June 2008. [8] Chin-Teng Lin, Che-Jui Chang, Bor-Shyh Lin, Shao-Hang Hung; Chih-Feng Chao and I- Jan Wang, A Real-Time Wireless Brain-Computer Interface System for Drowsiness Detection, Biomedical Circuits and Systems, IEEE Transactions on 4(4) (2010), 214-222. [9] M. J. Flores, J. M. Armingol and A. D. L. Escalera, Real-Time Warning System for Driver Drowsiness Detection Using Visual Information, presented at Journal of Intelligent and Robotic Systems (2010), 103-125. [10] S. Barattelli, L. Sichelschmidt and G. Rickheit, Eye-movements as an input in human computer interaction: exploiting natural behavior, Annual Conference of IEEE Industrial Electronic Society 4 (1998), 2000-2005. [11] L. R. Young and D. Sheena, Survey of eye movement recording methods, Behavior research methods and instrumentation 7(5) (1975), 397-429.