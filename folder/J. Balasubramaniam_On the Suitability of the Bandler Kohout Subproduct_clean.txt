IEEE TRANSACTIONS ON FUZZY SYSTEMS, VOL. 18, NO. 2, APRIL 2010 285 On the Suitability of the Bandler Kohout Subproduct as an Inference Mechanism Martin St epni cka, Member, IEEE, and Balasubramaniam Jayaram, Member, IEEE Abstract Fuzzy relational inference (FRI) systems form an im- portant part of approximate reasoning schemes using fuzzy sets. The compositional rule of inference (CRI), which was introduced by Zadeh, has attracted the most attention so far. In this paper, we show that the FRI scheme that is based on the Bandler Kohout (BK) subproduct, along with a suitable realization of the fuzzy rules, possesses all the important properties that are cited in favor of using CRI, viz., equivalent and reasonable conditions for their solvability, their interpolative properties, and the preservation of the indistinguishability that may be inherent in the input fuzzy sets. Moreover, we show that under certain conditions, the equivalence of rst-infer-then-aggregate (FITA) and rst-aggregate-then-infer (FATI) inference strategies can be shown for the BK subproduct, much like in the case of CRI. Finally, by addressing the computa- tional complexity that may exist in the BK subproduct, we suggest a hierarchical inferencing scheme. Thus, this paper shows that the BK-subproduct-based FRI is as effective and ef cient as the CRI itself. Index Terms Bandler Kohout (BK) subproduct, compositional rule of inference (CRI), correctness and continuity of inference, fuzzy relational equations, fuzzy relational inference (FRI) systems, hierarchical CRI. I. INTRODUCTION T HE IDEA of linguistic fuzzy models that imitate the human way of thinking was proposed by Zadeh in his pioneering work [1]. Systems that use fuzzy rules and an inference mech- anism have been applied in a wide variety of applications, viz., automatic control, decision making, risk analysis, etc. Let X be a nonempty classical set. Let us recall that a fuzzy set A on X is a mapping from X to the unit interval, i.e., A : X [0, 1]. Let F(X) denote the set of all fuzzy sets on X. Given two nonempty classical sets X, Y , a fuzzy IF THEN rule is usually given as follows: IF x is A THEN y is B (1) where the antecedent fuzzy set A F(X) and the consequent fuzzy set B F(Y ) represent some properties. Given that a fuzzy observation x is A , where A F(X), a corresponding output fuzzy set B F(Y ), which means that y is B , is deduced using an inference mechanism. Thus, an Manuscript received February 24, 2009; revised July 2, 2009 and October 9, 2009; accepted December 17, 2009. First published January 19, 2010; current version published April 2, 2010. This work was supported by Projects 1M0572 of the M SMT CR and by IAA108270902 of the GA AV CR. The work of B. Jayaram was supported in part by Grant APVV-0375-06. M. St epni cka is with the Institute for Research and Applications of Fuzzy Modeling, University of Ostrava, Ostrava 70100, Czech Republic (e-mail: martin.stepnicka@osu.cz). B. Jayaram is with the Department of Mathematics, Indian Institute of Tech- nology Hyderabad, Hyderabad 502205, India (e-mail: jbala@iith.ac.in). Digital Object Identi er 10.1109/TFUZZ.2010.2041007 inference mechanism may, generally, be viewed as an arbitrary mapping from F(X) to F(Y ) [2], [3]. Many types of inference mechanisms that deal with fuzzy- rule-based systems have been proposed in the literature and used in practical applications. Of the many fuzzy inference schemes, fuzzy relational inferences (FRIs) have received con- siderable attention both from theoretical researchers and practi- tioners. Similarity-based reasoning (SBR) [4] and inverse truth- functional modi cation [5] are two of the representative exam- ples of inference mechanisms that do not use fuzzy relations and that are also well established in the literature. However, it should be mentioned that under certain conditions, an equiva- lent fuzzy-relation-based description of some of these inference mechanisms can be given (see [6] and [7]). In this paper, we will focus only on fuzzy-relation-based in- ference mechanism. A. Fuzzy Relational Inferences FRI mechanisms use a fuzzy relation R to model a given fuzzy rule base. Here, a fuzzy IF THEN rule of the form (1) is represented as a fuzzy relation R : X Y [0, 1], i.e., R F(X Y ). Then, given a fact that x is A , the inferred output y is B is obtained as a composition of A and R, i.e., B = A @R (2) where A F(X), B F(Y ), and @ is a fuzzy relational com- position1 that involves fuzzy logic operations. Up to now, we have discussed the case of a single fuzzy rule only. However, rarely, if ever a single fuzzy rule can be expected to capture the entire knowledge in which the scheme is employed, a fuzzy rule base that consists of multiple fuzzy rules is necessary. Let us consider a fuzzy rule base as follows: IF x is Ai THEN y is Bi, for i = 1, . . . , n (3) where the fuzzy sets Ai F(X) and Bi F(Y ) represent some properties. Clearly, for different representations R of the fuzzy IF THEN rules in (1) and different compositions @, we obtain different FRI mechanisms, often with varying properties that are appli- cable in speci c contexts. We now present two of the most 1In the literature, we may, very often, nd a distinction between fuzzy rela- tional composition and image of a fuzzy set under a fuzzy relation. The rst notion denotes a composition of two binary relations, while the second one denotes our situation when we compose a fuzzy set and a binary fuzzy relation. However, a unary fuzzy relation (i.e., a fuzzy set) on a universe U may be viewed as a binary fuzzy relation on a Cartesian product of an empty set and U. Therefore, we may use the notion composition even in our situation and avoid the use of two notions. 1063-6706/$26.00 2010 IEEE Authorized licensed use limited to: Hochschule Ostfalia (FH). Downloaded on May 27,2010 at 07:27:45 UTC from IEEE Xplore. Restrictions apply. 286 IEEE TRANSACTIONS ON FUZZY SYSTEMS, VOL. 18, NO. 2, APRIL 2010 commonly employed fuzzy relations R to model a given fuzzy rule base and two of the established FRI mechanisms based on different fuzzy compositions. B. Distinct Fuzzy Rule Base Models 1) The fuzzy relation R F(X Y ) R(x, y) = n i=1 (Ai(x) Bi(y)), x X, y Y (4) is the most often used model of fuzzy rules (3) in real- world applications. This is mainly due to the success- ful applications of this, say, Cartesian product approach, which was described by Mamdani and Assilian [8], and was followed by a huge number of researchers and prac- titioners (see, e.g., [9] and [10]). 2) Alternatively, to keep the conditional IF THEN form of fuzzy rules (3), fuzzy relation R F(X Y ) R(x, y) = n i=1 (Ai(x) Bi(y)), x X, y Y (5) can be chosen to model the fuzzy rule base. It deals with a mathematically correct extension of a classical implication that is denoted by . To stress the difference between both the approaches, let us recall the work of Dubois et al. [11], where the authors state that In the view given by (5), each piece of information (fuzzy rule) is viewed as a constraint. This view naturally leads to a conjunctive way of merging the individual pieces of information since the more information, the more constraints and the less possible values to satisfy them. They have also described the second approach that was proposed by Mamdani and Assilian as follows: It seems that fuzzy rules modelled by R are not viewed as constraints, but are considered to be pieces of data. Then, the maximum in (4) expresses accumulation of data. It should be stressed that both approaches have sound logical foundations but from different viewpoints (see, e.g., [12] [14]). However, only the approach using R was widely used in appli- cations, although the implicational approach using R is proba- bly as useful as the approach proposed by Mamdani Assilian (see [15]). Nevertheless, as we show in this paper, the im- plicational approach using R does have an important role to play in the case of Bandler Kohout (BK) subproducts (see Theorem 3.22). For an extensive study of different fuzzy rules, see [16] [18]. C. Coherence Consistency (i.e., nonexistence of contradictory rules) is a crucial issue that needs to be checked when dealing with a fuzzy rule base. In case of the implicational approach (5) to modeling a fuzzy rule base, the situation gets signi cantly simpler. It was noted by Dubois et al. [11] that inconsistent rules lower the largest membership degrees in the resulting fuzzy relation. Departing from this fact, they proposed the concept of so-called coherence for which an existence of y Y such that R(x , y) = 1 for arbitrary x X is required. This condition can be easily checked and ensured (see [11] and [19]). An analogous issue in case of the Cartesian product approach R has been suggested [20]. However, the condition has to be rede ned, and instead of nonemptiness of the core of R, its convexity up to some prede ned value is required. This approach is, unquestionably, more complicated and less preferable. Generally, the consistency (coherence) is a property of the given fuzzy rule base (its model) and not of the inference mecha- nism itself. However, as mentioned previously and demonstrated in Section IV, each model of a fuzzy rule base is computation- ally preferable in combination with a different inference, and thus, these notions cannot be studied independently. D. Compositional Rule of Inference and BK-Subproduct Inference Mechanisms As noted previously, depending on the type of composition @, the FRI varies in its properties. Two of the commonly employed fuzzy relational compositions are the sup - and inf -I compo- sitions (see [21]), which, when employed, lead to the following FRIs. 1) The compositional rule of inference (CRI) that was pro- vided by Zadeh [1] is one of the earliest FRIs. Here, a fuzzy IF THEN rule of the form (1) is represented as a fuzzy relation R(x, y) : X Y [0, 1], i.e., R F(X Y ). Then, given a fact that x is A , the inferred output B is obtained as composition of A (x) and R(x, y), i.e., B (y) =  x X (A (x) R(x, y)), y Y (6) where is a fuzzy conjunction, which is typically a t-norm (see [22] for more details). We use the following notation to indicate the CRI scheme: B = A R. (7) 2) Other than the CRI, let us also recall that it was Pedrycz [23] who rst proposed an inference scheme based on the BK subproduct, which was proposed by Bandler and Kohout [24] [26]. For a given fuzzy input A F(X), the fuzzy output B F(Y ) that is obtained by the BK-subproduct infer- ence mechanism is de ned as follows: B (y) =  x X (A (x) R(x, y)), y Y (8) where is a residual implication (see Section II for more details), and R is the fuzzy relation that models fuzzy rule (1). We use the following notation to indicate the BK-subproduct scheme: B = A R. (9) We only remark that yet other types of fuzzy relational com- positions are studied in the literature, for instance, the inf -S composition, where S is a t-conorm (see [21]). Authorized licensed use limited to: Hochschule Ostfalia (FH). Downloaded on May 27,2010 at 07:27:45 UTC from IEEE Xplore. Restrictions apply. ST EPNI CKA AND JAYARAM: ON THE SUITABILITY OF THE BANDLER KOHOUT SUBPRODUCT AS AN INFERENCE MECHANISM 287 E. Mathematical Structure for Fuzzy Relational Inference Mechanisms Based on the previous discussion, fuzzy rules may be viewed as a partial mapping from F(X) to F(Y ) that assigns Bi F(Y ) to Ai F(X) for every i = 1, . . . , n. Then, the in- ference process itself can be viewed as an extension of this partial mapping to a total one [27]. For better understanding, let us adopt the notation from [28] and consider the following structure: S = (X, Y, {Ai, Bi}i=1,...,n, L, @) where X, Y are nonempty classical sets, Ai F(X), Bi F(Y ) for all i = 1, . . . , n are the antecedent and consequent fuzzy sets in the fuzzy rule base, and @ : F(X) F(X Y ) F(Y ) is a fuzzy relational composition. For instance, @ could be either or . Finally, L is an algebra on the unit interval [0, 1] that provides us with the operations to be em- ployed in the inference process, which is typically a complete residuated lattice (see Section II-A for more details). Now, by the choice of the fuzzy relation R that models the fuzzy rule base and by the choice of @, we de ne a fuzzy function f @ R (A) : F(X) F(Y ) such that f @ R (A) = A@R for an arbitrary A F(X). F. Studies on the Advantages of CRI and Organization of the Paper Given a fuzzy rule base, the CRI is the most often and widely used FRI for the following reasons. 1) An important issue in the applicability of an FRI mecha- nism @ in a structure S = (X, Y, {Ai, Bi}i=1,...,n, L, @) is to determine an appropriate fuzzy relation R that mod- els the given fuzzy rules to obtain meaningful conclu- sions. One of the fundamental properties expected of the corresponding fuzzy adjoint mapping is its interpolativ- ity, i.e., f @ R (Ai) = Bi. This pertains to the solvability of fuzzy relation equations. In the case of CRI, necessary and suf cient conditions for the solvability of fuzzy relation equations have been well established for a long time (see, e.g., [29]). The state of the art, as well as analogous results, which concerns the BK subproduct are brie y recalled in Section III-A. 2) Per lieva and Lehmke [28] and Per lieva and Nov ak [30] have dealt with the continuity of a fuzzy function f R that is adjoint to the CRI mechanism in a structure S = (X, Y, {Ai, Bi}i=1,...,n, L, ) and a fuzzy relation R that models fuzzy rules (3). The authors give necessary and suf cient conditions for f R to be continuous. They have also shown that the concept of continuity is equivalent to the interpolativity of the function f R. We follow their ideas in Section III-B. 3) Klawonn and Castro [31] have proven two important and interesting results about the CRI scheme and the indistin- guishability inherent to the fuzzy sets considered. First, the authors show that the indistinguishability induced by the antecedent fuzzy set of the rule cannot be overcome. Second, they have also demonstrated the robustness of fuzzy inference systems that employ the CRI mechanism in scenarios where there can be slight discrepancies be- tween the intended input A and the actual input A , i.e., f R(A ) = f R( A ). However, this study was done in the case of a single fuzzy rule, as in (1). We consider mul- tiple fuzzy rules (3) and prove that, in such a case, this property holds when R = R. Then, we continue with an investigation of this property for the BK subproduct. Section III-C describes this issue. 4) In the case of CRI, if the input is a fuzzy singleton, then the output determined by the fuzzy adjoint function f R depends only on the relation R that models the given fuzzy rule base, i.e., the inference plays a role only in case of a nonsingleton fuzzy input. A detailed exposition of this topic is provided in Section IV-A. 5) While employing FRIs in a system that consists of multiple fuzzy rules, there are two inference strategies that are usually employed, viz., rst aggregate then infer (FATI) and rst infer then aggregate (FITA). In the case of the CRI mechanism, if the fuzzy rules are represented by the fuzzy relation R, then the FATI inference strategy is equivalent to the FITA inference strategy. However, this is not true if we employ R instead of R. More details on the FATI and FITA strategies, as well as their subsequent exploration, are provided in Section IV-B. 6) Finally, it should be noted that FRIs, in general, have their drawbacks due to space and time complexities. Many works have concentrated on increasing the ef ciency of the inference process. However, so far, all these have been done only for the case of CRI mechanism and, especially, when the fuzzy rules are represented by the fuzzy relation R. The aforementioned properties will be dealt with in a more detailed way in Sections IV-C and D. G. Motivation for This Paper: Study of the Bandler Kohout Subproduct and the Relation R From the previous section, it is clear that most works have tended to concentrate predominantly on the CRI mechanism. However, two facts emerge from it. On the one hand, the previous studies on CRI can also be con- ducted for other FRI mechanisms, and in this paper, we intend to perform a similar investigation into the BK subproduct. On the other hand, also note that some of the advantages available with the CRI mechanism depend, to a large extent, on the fuzzy rules being modeled by the fuzzy relation R, which, as already noted, is appropriate only in the context where the fuzzy rules are viewed as positive pieces of information [11], [17]. How- ever, there are situations when the context dictates to view the fuzzy rules in the conditional nature, and the fuzzy relation R has to be used to model them [15]. Then, many of the advantages of the CRI are no longer available, viz., the robustness of the CRI mechanism with respect to the indistinguishability of input fuzzy sets in the case of multiple fuzzy rules, the equivalence of FATI and FATI, the many techniques that deal with enhancing the ef ciency of the inference procedures. Authorized licensed use limited to: Hochschule Ostfalia (FH). Downloaded on May 27,2010 at 07:27:45 UTC from IEEE Xplore. Restrictions apply. 288 IEEE TRANSACTIONS ON FUZZY SYSTEMS, VOL. 18, NO. 2, APRIL 2010 In this paper, we intend to investigate the following. First, this paper shows that all the properties investigated/touted as an advantage of the CRI mechanism are also available for the BK subproduct and, often, under similar conditions or generality as available on CRI. Second, we also highlight that the conditional form of representation of a fuzzy rule base, in conjunction with the BK subproduct, i.e., f R is a strong alternative to f R in the appropriate contexts. II. MATHEMATICAL BACKGROUND OF FUZZY INFERENCE MECHANISMS A. Fuzzy Inference Mechanisms FRI mechanisms are mathematically based on a complete residuated lattice (see, e.g., [12]) that we x for the whole paper as the basic algebraic structure. Let us only brie y recall that an algebra L = (L, , , , , 0, 1) is a residuated lattice if the following hold. 1) (L, , , 0, 1) is a lattice with the least and the greatest element. 2) L = (L, , 0, 1) is a commutative monoid such that is isotone in both arguments. 3) The operation is a residuation with respect to , i.e., a b c, iff a c b. (10) The following properties [12] are immediately available to us for any a, b, c L: a = 1 a (11) a c b c, whenever a b (12) a b a c, whenever b c (13) a (b c) = (a b) c = (b a) c (14) (a b) b a b (15) a  i I bi =  i I (a bi) (16)  i I (ai b)  i I ai b (17)  i I ai b =  i I (ai b) (18) (a b) c a (b c). (19) Let us x the set L = [0, 1] for the whole paper. Then, becomes a left-continuous t-norm, and becomes a residual fuzzy implication that is derived from . For more details on these operations, see [12], [22], and [32]. In L, we can derive yet another operation that is known as the biresiduum and is de ned as follows: a b = (a b) (b a), a, b L. (20) The following properties of the biresiduum will be useful in the sequel (see [12]): (a b) (b c) a c (21) (a b) (c d) (a c) (b d). (22) Finally, by extending an algebraic operation from L to oper- ations between fuzzy sets, we mean the following: (C D)(u, v) = C(u) D(v), u U, v V (23) where { , , , , } and for arbitrary fuzzy sets C, D on arbitrary universes U, V , respectively. B. Inference Strategies Now, there are two inference strategies that are called FITA and FATI (see [33]). In FITA strategy, we rst construct individual fuzzy relations Ri F(X Y ) from each of the n fuzzy rules. Then, the given fuzzy observation A F(X) is composed with each of these relations Ri by a chosen inference @, and the obtained individual output fuzzy sets B i = A @Ri F(Y ) are then aggregated to form the nal output fuzzy set B F(Y ). In FATI strategy, the individual fuzzy relations Ri F(X Y ) from each of the n fuzzy rules is aggregated into a single fuzzy relation R F(X Y ), and this is composed with the given fuzzy observation A F(X) to obtain the fuzzy output B = A @R F(Y ). III. DESIRABLE PROPERTIES OF INFERENCE MECHANISMS A. Interpolativity of Fuzzy Inference Systems Property 1 The interpolativity f @ R (Ai) = Bi is a fundamental property of any inference mechanism. In this case, we say that R is a correct model of given fuzzy rules in the given structure S. This leads us to deal with a system of fuzzy relation equations [34], where Ai@R = Bi, i = 1, . . . , n (24) is solved with respect to the known Ai F(X) and Bi F(Y ) and unknown R F(X Y ). If R is a solution to (24), then the adjoint fuzzy function ful lls f @ R (Ai) = Bi. In the case of CRI, the previous system of equations reduces to the following: Ai R = Bi, i = 1, . . . , n. (25) Let us recall some main results that may be found, e.g., in [29] and [34] [36]. Theorem 3.1: System (25) is solvable if and only if R is a solution of the system, and moreover, R is the greatest solution of (25). On the one hand, Theorem 3.1 states the necessary and suf- cient condition for the solvability of system (25), and it deter- mines the solution. Moreover, it ensures that the given solution is the greatest one. On the other hand, we still do not know when R is the solution, i.e., how the solvability can be ensured. Theorem 3.2 [36]: Let Ai, for i = 1, . . . , n be normal.2 Then, R is a solution of (25) if and only if the following condition holds for arbitrary i, j {1, . . . , n}:  x X (Ai(x) Aj(x))  y Y (Bi(y) Bj(y)). (26) 2Let us recall that a fuzzy set A on a universe U is called normal if there exists an x U such that A(x) = 1. Authorized licensed use limited to: Hochschule Ostfalia (FH). Downloaded on May 27,2010 at 07:27:45 UTC from IEEE Xplore. Restrictions apply. ST EPNI CKA AND JAYARAM: ON THE SUITABILITY OF THE BANDLER KOHOUT SUBPRODUCT AS AN INFERENCE MECHANISM 289 Theorem 3.2 speci es a suf cient condition under which the system is solvable, and moreover, it ensures that not only R but also R is a solution of system (25). It is worth mentioning that condition (26) that appears in The- orem 3.2 is not very convenient in practice. Another suf cient condition for solvability of the systems with a high practical importance was published in [39] and [40]. Theorem 3.3: Let Ai, for i = 1, . . . , n, be normal and ful ll the Ruspini condition n  i=1 Ai(x) = 1, x X. (27) Then, the system (25) is solvable. Remark 3.4: Besides the case when antecedent fuzzy sets form a fuzzy partition that ful lls the Ruspini condition, the so-called -semipartition [37] also plays an important role. Let us recall the state of the art that concerns the BK subproduct and the interpolativity issue. In the case of the BK subproduct, the system of equations (24) reduces to the following: Ai R = Bi, i = 1, . . . , n. (28) Concerning system (28), let us recall the following two basic theorems from Pedrycz [23] and Noskov a [38]. Theorem 3.5 [23]: System (28) is solvable if and only if R is a solution of the system, and moreover, R is the least solution of system (28). Theorem 3.6 [38, Th. 2]: Let Ai, for i = 1, . . . , n, be normal. Then, R is a solution of (28) if and only if condition (26) holds for arbitrary i, j {1, . . . , n}. Again, condition (26) to which Theorem 3.6 refers is, on one hand, very transparent, but not very convenient from a practical point of view. Fortunately, the suf cient condition for solvability of the system, with a high practical importance, which is stated in Theorem 3.3, is valid even for system (28) (see [39] and [40]). Theorem 3.7: Let Ai, for i = 1, . . . , n, be normal and ful ll the Ruspini condition (27). Then, the system (28) is solvable. We may easily observe that each of the important results that is well known for the interpolativity issue in case of CRI has its analogy, even for the BK-subproduct case under exactly the same conditions, and therefore, both inferences are equally appropriate from this point of view. In fact, the availability of such results for the BK subproduct was also one of the motivations to conduct this study of the BK- subproduct inference v s- a-v s the already-known advantageous properties of CRI. B. Continuity of Fuzzy Inference Systems Property 2 Per lieva and Lehmke [28] and Per lieva and Nov ak [30] have dealt with the continuity of a fuzzy function f R that is adjoint to the CRI mechanism and a fuzzy relation that models fuzzy rules (3). They have suitably de ned continuity and have shown that it is equivalent to the correctness of the model that is under consideration. Although the original de nition in [28] of a continuous model was given for the particular inference mechanism CRI, i.e., for @ , the particular composition plays no role in the proof of the result (see Theorem 3.11), thereby explaining the nature of the de nition. Hence, it can be generalized for an arbitrary fuzzy relational composition. De nition 3.8: A fuzzy relation R F(X Y ) is said to be a continuous model of fuzzy rules (3) in a structure S = (X, Y, {Ai, Bi}i=1,...,n, L, @) if, for each i I and for each A F(X), the following inequality holds:  y Y (Bi(y) (A@R)(y))  x X (Ai(x) A(x)). (29) Remark 3.9: Inequality (29) can be rewritten in terms of the adjoint fuzzy function f @ R as follows:  y Y (Bi(y) (f @ R (A))(y))  x X (Ai(x) A(x)). (30) To be precise, the continuity concerns the fuzzy function f @ R , i.e., the model of fuzzy rules R as well as the inference mechanism @. Therefore, we could, more adequately, talk about continuity of the whole fuzzy inference systems rather than just about the continuity of R. Nevertheless, since De nition 3.8 xes a struc- ture in which the continuity is introduced, it is mathematically correct, and we adopt the original terminology from [28]. Remark 3.10: Let us explain why (29) expresses the continu- ity. The closeness between fuzzy sets is measured by the biresid- uation operation , i.e., it is a dual concept to the metric one. Let us consider a continuous Archimedean t-norm with an additive generator g : [0, 1] [0, + ]. Then, the biresiduum may be written in the form a b = g 1(|g(a) g(b)|) (31) where g 1 : [0, ] [0, 1] is the inverse function and where, in the case of g(0) = , we de ne g(0) g(0) = 0. Now, for an arbitrary nonempty universe X, it is possible to de ne a metric Dg on F(X) that is generated by g as follows: Dg(A, B) =  x X |g(A(x)) g(B(x))|. (32) The following theorem justi es the use of the notion of conti- nuity in De nition 3.8. Theorem 3.11: Let S = (X, Y, {Ai, Bi}i=1,...,n, L, @) be a structure for fuzzy rules (3) such that L is a residuated lattice on [0, 1], with a continuous Archimedean t-norm having a continuous additive generator g. A fuzzy relation R F(X Y ) is a continuous model of the fuzzy rules in the given structure S if and only if Dg(Bi, (A@R)) Dg(Ai, A), i = 1, . . . , n (33) for each fuzzy set A F(X). Proof: The proof for @ may be found in [28]. Its gener- alization is straightforward. The main result by Per lieva and Lehmke [28] and Per lieva and Nov ak [30] concerns the relationship of the aforementioned continuity and the interpolativity for the CRI as contained in the following result. Theorem 3.12 [28, Th. 2]: Let S = (X, Y, {Ai, Bi}i=1,...,n, L, ) be a structure for fuzzy rules (3). A fuzzy relation Authorized licensed use limited to: Hochschule Ostfalia (FH). Downloaded on May 27,2010 at 07:27:45 UTC from IEEE Xplore. Restrictions apply. 290 IEEE TRANSACTIONS ON FUZZY SYSTEMS, VOL. 18, NO. 2, APRIL 2010 R F(X Y ) is a correct model of fuzzy rules (3) in the given structure S if and only if it is a continuous model of these rules in S. In the following, we show that an identical result is valid even for the case of the BK subproduct. Let us start by proving the following lemma that is crucial for further results. Lemma 3.13: Let S = (X, Y, {Ai, Bi}i=1,...,n, L, ) be a structure for fuzzy rules (3), and let R F(X Y ). Then, for any A F(X) and all i = 1, . . . , n, as well as y Y , it is true that Bi(y) (A R)(y) R,i(y)  x X (Ai(x) A(x)) (34) where R,i(y) = Bi(y) (Ai R)(y). Proof: By the transitivity property (21) of with respect to , we get Bi(y) (A R)(y) (Bi(y) (Ai R)(y)) ((Ai R)(y) (A R)(y)) where i {1, . . . , n}. The rst multiplicand Bi(y) (Ai R)(y) is equal to R,i(y), while the second multiplicand, for an arbitrary y Y , has the following lower bound: (A R)(y) (Ai R)(y) =  x X (A(x) R(x, y))  x X (Ai(x) R(x, y))  x X ((A(x) R(x, y)) (Ai(x) R(x, y))) By (22) =  x X (([A(x) R(x, y)] [Ai(x) R(x, y)]) ([Ai(x) R(x, y)] [A(x) R(x, y)])) =  x X (([Ai(x) (A(x) R(x, y))] R(x, y)) ([A(x) (Ai(x) R(x, y))] R(x, y))) By (14) =  x X ((Ai(x) [(A(x) R(x, y)) R(x, y)]) (A(x) [(Ai(x) R(x, y)) R(x, y)])) By (14)  x X ([Ai(x) A(x)] [A(x) Ai(x)]) By (15) =  x X (Ai(x) A(x)). Now, (34) follows immediately from the monotonicity of . Due to Lemma 3.13, we may prove the following theorem that is analogous to Theorem 3.12. It, again, shows that the BK subproduct as an inference mechanism has the same property as the CRI. Theorem 3.14: Let S = (X, Y, {Ai, Bi}i=1,...,n, L, ) be a structure for fuzzy rules (3). A fuzzy relation R F(X Y ) is a correct model of fuzzy rules (3) in the given structure S if and only if it is a continuous model of these rules in S. Proof: Suppose R is a correct model of the fuzzy rules (3) in the given structure. Then, R solves the given system of fuzzy relation equations Ai R = Bi for all i = 1, . . . , n, and there- fore, R,i(y) = 1 for all i = 1, . . . , n and for all y Y . By (34), R is a continuous model. Conversely, let R be a continuous model of (3) in the given structure. Then  y Y (Bi(y) (A R)(y))  x X (Ai(x) A(x)) (35) holds for each i = 1, . . . , n and for arbitrary A F(X). Sub- stituting A Ai into (35), we obtain  y Y (Bi(y) (Ai R)(y)) 1 which implies that Ai R Bi. As in the case of interpolativity, the continuity property is present in both the types of inferences under exactly the same conditions. C. Robustness of Fuzzy Inference Systems Property 3 Let X be a classical set, and let be an equivalence relation that is de ned on X, i.e., is re exive, symmetric, and transi- tive. Immediately, partitions X into equivalence classes. It is well known that an M X belongs to this partition if and only if whenever x M and x y for some y X, then y M. In a sense, the elements of M are indistinguishable and can be represented mathematically as follows: x M and x y implies y M. A similar relation between fuzzy equivalence relations and fuzzy sets on X was introduced by Klawonn and Castro [31]. The operation comes from the residuated lattice L. De nition 3.15: A fuzzy subset E of the Cartesian product X2 is called a fuzzy equivalence relation on X if the following properties are satis ed for all x, y, z X: (Re exivity) E(x, x) = 1 (ER) (Symmetry) E(x, y) = E(y, x) (ES) (Transitivity) E(x, z) E(x, y) E(y, z). (ET) De nition 3.16: A fuzzy set F(X) is called extensional with respect to a fuzzy equivalence relation E on X if (x) E(x, y) (y), x, y X. (36) If a fuzzy set is not extensional with respect to the con- sidered fuzzy equivalence relation E, the smallest fuzzy set is instead considered, which is extensional with respect to E and contains . De nition 3.17: Let F(X), and let E be a fuzzy equiva- lence relation on X. The fuzzy set  (x) =  { | and is extensional with respect to E} is called the extensional hull of . Note that by , we mean that for all x X, (x) (x), i.e., we mean ordering Authorized licensed use limited to: Hochschule Ostfalia (FH). Downloaded on May 27,2010 at 07:27:45 UTC from IEEE Xplore. Restrictions apply. ST EPNI CKA AND JAYARAM: ON THE SUITABILITY OF THE BANDLER KOHOUT SUBPRODUCT AS AN INFERENCE MECHANISM 291 in the sense of inclusion and not in the sense of ordering fuzzy quantities. Proposition 3.18 [31, Proposition 2.9]: Let F(X), and let E be a fuzzy equivalence relation on X. Then, the following hold. 1)  (x) = { (y) E(x, y) | y X}. 2)  is extensional with respect to E. 3)  =  . The following two important and interesting results about the CRI scheme and the considered indistinguishability that is inherent to the fuzzy sets are proved in [31]. Theorem 3.19 [31, Th. 4.4]: Let S = (X, Y, {A, B}, L, ) be a structure for a single fuzzy IF THEN rule as given in (1). Let E be a fuzzy equivalence relation on X with respect to which A is extensional. Letting A F(X) be any fuzzy set, then A R = A R A R = A R. The following interpretation of the previous result is given in [31]: The output obtained from CRI for a given fuzzy rule and an input fuzzy set A does not change if we substitute A by its extensional hull A . The indistinguishability inherent in the fuzzy set A cannot be avoided, even if the input fuzzy set A stands for a crisp value. Further, a fuzzi ed input does not change the outcome of a rule as long as the fuzzy set obtained by the fuzzi cation is contained in the extensional hull of the original crisp input value. They nally conclude that it does not make sense to measure more exactly than the indistinguishability admits. In other words, this shows the robustness of the inference in scenarios where there can be slight discrepancies between the intended input and the actual input. As already observed in [31], it immediately follows that the indistinguishability induced by the fuzzy set that represents the linguistic expression in the premise of the rule cannot be overcome. Even though Theorem 3.19 is proven in [31] for a single fuzzy rule, it can be shown that the result is valid even with n fuzzy rules. Theorem 3.20: Let S = (X, Y, {Ai, Bi}i=1,...,n, L, ) be a structure for fuzzy rules (3). Let E be a fuzzy equivalence relation on X with respect to which Ai is extensional for arbi- trary i = 1, . . . , n. Letting A F(X) be any fuzzy set, then A R = A R. Proof: The inequality A R A R holds for arbitrary fuzzy relation R F(X Y ). Thus, it suf ces to prove the other inequality for R, i.e., A R A R. Since Ai is extensional with respect to E for arbitrary i, Ai(x ) Ai(x) E(x, x ) for any x, x X. For any x X, we have A (x) n i=1 (Ai(x) Bi(y)) =  x X (A (x ) E(x, x )) n i=1 (A(x) B(y)) =  x X  [A (x ) E(x, x )] n i=1 (Ai(x) Bi(y))  = n i=1  x X ([A (x ) E(x, x )] (Ai(x) Bi(y))) = n i=1  x X (A (x ) [E(x, x ) Ai(x)] Bi(y)) n i=1  x X (A (x ) (Ai(x ) Bi(y))) which implies ( A R)(y) (A R)(y), y Y. It should be emphasized that only the Mamdani Assilian (i.e., Cartesian product) approach R generally works in combination with the CRI. We now show the robustness of the BK-subproduct inference mechanism along similar lines as by Klawonn and Castro [31]. Once again, the employed operations come from the residuated lattice L. First, note that if a fuzzy set F(X) is extensional with respect to a fuzzy equivalence relation E on X, then E(x, y) (y) (x), x, y X. (37) Proposition 3.21: Let F(X), and let E be a fuzzy equiv- alence relation on X. Then  (x) =  {E(x, y) (y) | y X}. (38) Proof: Let (y) = {E(z, y) (z) | z X}. We only need to show that =  . First, note that for any x X, we have (x) =  {E(z, x) (z) | z X} E(x, x) (x) = 1 (x) = (x)  (x). Let F(X) be extensional with respect to E such that , which implies, by de nition, that  . Then, for any x X, we have (x) E(z, x) (z) and (x) E(z, x) (z) for every z X, and therefore (x)  {E(z, x) (z) | z X} = (x) i.e., (x)  (x), and hence, (x) =  (x). Now, we present a result that is analogous to the one given in Theorem 3.19. Theorem 3.22: Let S = (X, Y, {A, B}, L, ) be a structure for fuzzy rule (1). Let E be a fuzzy equivalence relation on X with respect to which A is extensional. Let A F(X) be any fuzzy set, then A R = A R, A R = A R. Authorized licensed use limited to: Hochschule Ostfalia (FH). Downloaded on May 27,2010 at 07:27:45 UTC from IEEE Xplore. Restrictions apply. 292 IEEE TRANSACTIONS ON FUZZY SYSTEMS, VOL. 18, NO. 2, APRIL 2010 Proof: Let R F(X Y ) be any fuzzy relation. By the de nition of A , we have the following inequalities: A A = A R A R By (12) = A R A R. Thus, it suf ces to prove the other inequality, i.e., A R A R. Let R = R, i.e., R(x, y) = A(x) B(y) for any x X, y Y . Then, by de nition, we have ( A R)(y) =  x X ( A (x) (A(x) B(y))), y Y. Since A is extensional with respect to E, A(x ) A(x) E(x, x ) for any x, x X, and, by (12) A(x ) B(y) (A(x) E(x, x )) B(y), y Y. (39) For any x X, we have A (x) (A(x) B(y)) =  x X (A (x ) E(x, x )) (A(x) B(y)) =  x X ([A (x ) E(x, x )] (A(x) B(y))) By (18) =  x X (A (x ) [E(x, x ) (A(x) B(y))]) By (14) =  x X (A (x ) ((E(x, x ) A(x)) B(y))) By (14)  x X (A (x ) (A(x ) B(y))) By (40) which implies ( A R)(y) =  x X ( A (x) (A(x) B(y)))  x X (A (x ) (A(x ) B(y))) = (A R)(y) for any y Y . Let R = R, i.e., R(x, y) = A(x) B(y) for any x X, y Y . Then, by de nition, we have ( A R)(y) =  x X ( A (x) (A(x) B(y))), y Y. For any x X, we have A (x) (A(x) B(y)) =  x X (A (x ) E(x, x )) (A(x) B(y)) =  x X ((A (x ) E(x, x )) (A(x) B(y))) By (18) =  x X (A (x ) [E(x, x ) (A(x) B(y))]) By (14) which, by (13) and (19), is  x X (A (x ) ((E(x, x ) A(x)) B(y))) and, by (16), =  x X  A (x )  x X ((E(x, x ) A(x)) B(y))  =  x X  A (x )   x X (E(x, x ) A(x)) B(y)  =  x X (A (x ) ( A(x ) B(y))) By (38) =  x X (A (x ) (A(x ) B(y))) .. . A = A which implies that ( A R)(y) = (A R)(y) for any y Y . The previous result, as already noted in the case of CRI, shows the robustness of the BK-subproduct inference in scenar- ios where there can be slight discrepancies between the intended input and the actual input, and this reinforces the fact that even in the case of BK subproduct, the indistinguishability that is in- duced by the fuzzy set that represents the linguistic expression in the premise of the rule cannot be overcome. Once again, as in the case of CRI, we may generalize the result that concerns the indistinguishability of the premises for an arbitrary nite number of rules. Note that in the case of the BK subproduct, the fuzzy relation R plays the main role. Theorem 3.23: Let S = (X, Y, {Ai, Bi}i=1,...,n, L, ) be a structure for fuzzy rules (3). Let E be a fuzzy equivalence relation on X, with respect to which each Ai is extensional, for arbitrary i = 1, . . . , n. Letting A F(X) be any fuzzy set, then A R = A R. Proof: The inequality A R A R holds for arbitrary fuzzy relation R F(X Y ); see the proof of Theorem 3.22. Thus, it suf ces to prove the other inequality for R, i.e., A R A R. Since each Ai is extensional with respect to E for arbitrary i, Ai(x ) Ai(x) E(x, x ) for any x, x X, and, by (12), we have Ai(x ) Bi(y) (Ai(x) E(x, x )) Bi(y), y Y. (40) For any x X, we have A (x) n i=1 (Ai(x) Bi(y)) =  x X (A (x ) E(x, x )) n i=1 (Ai(x) Bi(y)) Authorized licensed use limited to: Hochschule Ostfalia (FH). Downloaded on May 27,2010 at 07:27:45 UTC from IEEE Xplore. Restrictions apply. ST EPNI CKA AND JAYARAM: ON THE SUITABILITY OF THE BANDLER KOHOUT SUBPRODUCT AS AN INFERENCE MECHANISM 293 which, by (18), (16), (14), and (40), is =  x X  [A (x ) E(x, x )] n i=1 (Ai(x) Bi(y))  = n i=1  x X ([A (x ) E(x, x )] (Ai(x) Bi(y))) = n i=1  x X (A (x ) [E(x, x ) (Ai(x) Bi(y))]) = n i=1  x X (A (x ) ((E(x, x ) Ai(x)) Bi(y))) n i=1  x X (A (x ) (Ai(x ) Bi(y))) which implies ( A R)(y) (A R)(y), y Y . IV. COMPUTATIONAL ASPECTS OF FUZZY RELATIONAL INFERENCES In this section, we deal with the computational aspects of CRI and BK-subproduct inferences. First, we show that all the advantages of CRI are also available with the BK subproduct. However, both CRI and BK subproduct these being FRIs possess some drawbacks. Recently, Jayaram [41] proposed a modi ed form of CRI, viz., an hierarchical CRI scheme, to overcome some of these drawbacks. We show that a similar hierarchical inferencing is possible even in the case of BK sub- product and, hence, is a computationally viable alternative for the CRI. A. Inferencing in the Case of Singleton Fuzzy Inputs Property 4 The following de nition will be useful in this section. De nition 4.1: A fuzzy set on a nonempty set X, A : X [0, 1] is said to be a fuzzy singleton if there exists an x0 X such that A has the following representation: A(x) = 1, if x = x0 0, if x = x0. (41) We say that A attains normality at x0 X. It is common in some contexts to deal with fuzzy singleton inputs. For instance, in typical control situations, the input is usually a crisp value that is fuzzi ed before it is presented to a fuzzy system to obtain the output. There are many fuzzi cation methods, i.e., procedures to convert a crisp value into a fuzzy set with different shapes and spread based on this value. Most often, the singleton fuzzi er that converts a crisp input x X into a singleton A F(X), which attains normality at x , is used. Note that this seemingly formal conversion is crucial since it allows any FRI to be applied, which, in principle, deals only with fuzzy inputs. Given a crisp input x X, which is fuzzi ed using a single- ton fuzzi er, from a computational point of view, it is highly de- sirable to deal with such FRI mechanisms whose inferred output is dependent only on the chosen fuzzy relation R that models a given fuzzy rule base, and the inference plays a role only in case of a fuzzy input, i.e., the inferred output f @ R (A ) = B F(Y ) is given by B (y) = R(x , y), for arbitrary y Y . This property, which saves computational costs, holds for CRI. From the following equalities, we see that the discussed property is valid even for the BK subproduct. Let the given singleton fuzzy input A attain normality at some x X. Then, the inferred output using the BK subproduct is given by B (y) =  x X (A (x) R(x, y)) = (A (x ) R(x , y))  x X x = x (A (x) R(x, y)) = (1 R(x , y))  x X x = x (0 R(x, y)) = R(x , y) 1 = R(x , y), y Y. It should be emphasized that this property is generally not valid for any fuzzy relational composition. Neither the BK superprod- uct nor the BK square product [24], [42] nor any of the inf -S fuzzy relational compositions retain this essential property. This is one of the reasons why the BK subproduct is, other than the CRI, a privileged composition and gives a clear motivation to study all the properties that are investigated in Section III. B. Equivalence Between FITA and FATI Property 5 It is a well-known fact that one of the reasons to use the Carte- sian product approach to model a fuzzy rule base is that it, pos- sibly, saves computational efforts. In other words a combination of with R requires fewer computations than the combination with the fuzzy relation R. This is due to the following sequence of equalities: B(y) =  x X  A (x) n i=1 (Ai(x) Bi(y))  =  x X n i=1 (A (x) (Ai(x) Bi(y))) = n i=1  x X ((A (x) Ai(x)) Bi(y)) = n i=1   x X (A (x) Ai(x)) Bi(y)  , y Y. This means that we do not have to compose all rules to a fuzzy relation; we just nd the highest degree of intersection of a given input A and a particular rule antecedent and multiply it by the corresponding consequent. This approach is, then, applied rule per rule, and the results are composed together by the maximum operation. This reduction in the computational costs is the effect of the equivalence of FITA and FATI inference strategies [2]. Authorized licensed use limited to: Hochschule Ostfalia (FH). Downloaded on May 27,2010 at 07:27:45 UTC from IEEE Xplore. Restrictions apply. 294 IEEE TRANSACTIONS ON FUZZY SYSTEMS, VOL. 18, NO. 2, APRIL 2010 Therefore, it may, again, be generally considered even for other inference mechanisms. Due to the following sequence of equalities: B(y) =  x X  A (x) n i=1 (Ai(x) Bi(y))  =  x X n i=1 (A (x) (Ai(x) Bi(y))) = n i=1  x X ((A (x) Ai(x)) Bi(y)) = n i=1   x X (A (x) Ai(x)) Bi(y)  , y Y we may state that even in the case of the BK subproduct and an appropriate model of fuzzy rules (3) that are given by R, the FATI inference strategy is equivalent to the FITA inference strategy. The difference lies in the propriety of the chosen fuzzy rela- tion that models fuzzy rules (3) with respect to a chosen infer- ence mechanism. In the case of CRI, there is no other choice but R if we want to reduce the computational efforts by an equiva- lent FITA strategy. Whereas in case of the BK subproduct, the same holds for R. In other words, there should be other reasons that lead to the use of R than the computational costs because if this is the only reason, we may still reduce the computational efforts by using the BK subproduct as an inference mechanism, while still keeping the conditional nature of rules (3) by the choice of R. Then, the correctness of the model (i.e., fundamen- tal interpolation condition) should be ensured by the conditions that are given in Theorem 3.6. On the other hand, this is also the case when R is employed where the same conditions have to be imposed (see Theorem 3.2). Remark 4.2: Note that the expression  x X (A(x) A (x)), with being a t-norm, is, in fact, one of the earliest measures that was proposed by Zadeh [43] to determine the similarity between two fuzzy sets A, A F(X). Moreover, typically, antecedent fuzzy sets form some partition (e.g., the Ruspini partition [44]), and the input fuzzy set is of a limited support so that there are such i for which the similarity between the input A and the antecedent Ai, given by the earlier measure, is zero, and the computation gets simpli ed further. C. Drawbacks of a Fuzzy Relational Inference So far, we have considered only single-input single-output (SISO) fuzzy rules. However, in practice, often, such situa- tions are encountered that demand that inputs from multiple sources/dimensions be considered, and hence, the need arises to deal with multiple-input single-output (MISO) fuzzy rules of the following type. For the sake of notational simplicity and ease of understanding, we deal only with a two-input one-output MISO fuzzy rules, which can be extended in an obvious way to more than two input dimensions IF x is Ai AND y is Bi THEN z is Ci (42) where Ai F(X), Bi F(Y ), and Ci F(Z), respectively. Note that in the case of both MISO and SISO rules, the input fuzzy set(s) can be seen to be a fuzzy set on either a single domain or a Cartesian product of the domains; hence, all the results presented so far, although discussed in the framework of SISO rules, are valid even when dealing with MISO fuzzy rules. FRI schemes have their drawbacks also because of the com- putational and space complexities that are involved (see, e.g., [45] [47]). These are compounded greatly, especially while dealing with MISO fuzzy rules. Since both CRI and the BK subproduct belong to the class of FRIs, they are not immune to these drawbacks. The complexity of an inference algorithm stems mainly from two factors. 1) The process of inference itself: The fuzzy inferencing schemes are generally resource-consuming (in terms of both memory and time). Many of the inference schemes discretize the underlying domains, and hence, the process becomes computationally intensive. 2) The structure, complexity, and the number of rules: De- pending on the shape of the underlying fuzzy sets, the number of parameters stored and processed varies. Simi- larly, the manner in which multiple antecedents are com- bined affects the processing complexity. Also, an increase in the number of rules only exacerbates the problem. As the number of input variables and/or input fuzzy sets increases, there is a combinatorial explosion of rules in multiple-fuzzy-rule-based systems. We illustrate these factors through the following example. Example 4.3: Let A = [0.9 0.8 0.7 0.7], B = [1 0.6 0.8], and C = [0.1 0.1 0.2] denote fuzzy sets that are de ned, re- spectively, on the following classical sets: X = {x1, x2, x3, x4}, Y = {y1, y2, y3}, and Z = {z1, z2, z3}. Let S = (X, Y, Z, {A, B, C}, L, ) be the structure considered for the single fuzzy rule IF x is A AND y is B THEN z is C. Let L be the ukasiewicz complete residuated lattice, i.e., L = ([0, 1], , , , , 0, 1), where stands for the ukasiewicz t-norm x y = max(0, x + y 1), and stands for the ukasiewicz implication x y = min(1, 1 x + y). Now, taking the Cartesian product of A and B with respect to , we have A B = 0.9 0.5 0.7 0.8 0.4 0.6 0.7 0.3 0.5 0.7 0.3 0.5 . Now, we have R(A, B; C) = [ R(z1) R(z2) R(z3)], where (A B) C = (A B) [0.1 0.1 0.2], and R(zi) = Authorized licensed use limited to: Hochschule Ostfalia (FH). Downloaded on May 27,2010 at 07:27:45 UTC from IEEE Xplore. Restrictions apply. ST EPNI CKA AND JAYARAM: ON THE SUITABILITY OF THE BANDLER KOHOUT SUBPRODUCT AS AN INFERENCE MECHANISM 295 (A B) C(zi). Thus R(z1) = R(z2) = 0.2 0.6 0.4 0.3 0.7 0.5 0.4 0.8 0.6 0.4 0.8 0.6 R(z3) = 0.3 0.7 0.5 0.4 0.8 0.6 0.5 0.9 0.7 0.5 0.9 0.7 . Let A = [0.7 0.6 0.5 0.5], B = [0.8 0.5 0.7] be the given fuzzy (nonsingleton) inputs. Then A B = 0.5 0.1 0.4 0.4 0.1 0.3 0.3 0 0.2 0.3 0 0.2 . The output that is obtained from the BK subproduct is given by C = (A B ) ((A B) C) = [0.7 0.7 0.8]. (43) Remark 4.4: With the help of Example 4.3, the following observations can be made. 1) Computational complexity: Although the computational complexity depends largely on the choice of operators employed, let us consider the following general case of a p-input 1-output system where the ith fuzzy rule is modeled by the fuzzy relation Ri F(X1, . . . , Xp, Y ), where Ri = ((A1 i Ap i ) Bi). Let the universe of discourse Xj be discretized into pj points for each j = 1, . . . , p. Then, the complexity of a single inference is proportional to O(p j=1 pj). If pj = m, then it is O(mp). 2) Space complexity: Again, for a p-input 1-output system, we have a p-dimensional matrix that has p j=1 pj entries. Hence, we need to store p-dimensional matrices for every fuzzy IF THEN rule. 3) Run-time space requirements: For example, consider in- ferencing with the BK-subproduct inference scheme [see (8)] in the case of a two-input fuzzy IF THEN rule. Let the universes of discourse X1, X2, and Y be discretized into m, k, and l points, respectively. Then, the memory re- quirements of the algorithm are as follows (see also [47]): m k l for (A B) C, m k for combining the given facts A B and l for the consequent, where denotes the t-norm used for the Cartesian product. Overall, it is m k l + m k + l. In the case where m = k = l, the memory requirements of the algorithm become m3 + m2 + m. Generalizing this, in the case of p inputs, the memory requirements of the algorithm are O(m(p+1)). There are many works that have proposed modi cations to the classical CRI in an attempt to enhance the ef ciency in its inferencing (see, for example, the works of Full er and coauthors [48] [50] and Moser and Navara [51] [53]). In the case when there are more than two antecedents involved in fuzzy inference, Ruan and Kerre [54] proposed an extension to the classical CRI, wherein starting from a nite number of fuzzy relations of an arbitrary number of variables, but having some variables in common, fuzzy relations can be inferred among the variables of interest. Demirli and T urksen [47] proposed a rule breakup method and showed that rules with two or more independent variables in their premise can be simpli ed to a number of inferences of rule bases with simple rules (only one variable in their premise). For further modi cation of this method, see [55]. However, to the best of the authors knowledge, no such works exist for the BK subproduct. In the following, we propose a modi ed form of BK subproduct that alleviates some of the concerns noted previously, along the lines of the hierarchical CRI that was proposed by Jayaram [41]. D. Hierarchical BK Subproduct Property 6 Jayaram [41] proposed a hierarchical variant of the CRI where observation on particular axes are taken independently and hi- erarchically, and the overall output is deduced after all obser- vations were used in this step-by-step chain procedure. This contradicts the usual case where a Cartesian product of all ob- servations is computed, and such a product serves as the only fuzzy input with a vector variable. We follow this idea with the BK subproduct as well. Procedure for Hierarchical BK Subproduct Step 1 FOR i = 1 TO n DO i) Calculate R i F(Y Z): R i = Bi Ci. ii) Calculate C i F(Z): C i = B R i. iii) Calculate R i F(X Z): R i = Ai C i. iv) Calculate C i F(Z): C i = A R i . Step 2 AGGREGATE ALL C i BY MINIMUM. Although the algorithm for the hierarchical CRI is provided in [41] only for the case of inferencing with a single MISO rule, we remark that it can be extended in a straightforward manner to the case of multiple MISO rules, as is done here. However, for the sake of simplicity, the following example, which demonstrates the reduction in computational efforts and memory savings, is given in the context of a single MISO rule. Example 4.5: Let the fuzzy sets A, B, C, A , B be as in Example 4.3, with the same structure S for the given fuzzy rule. Inferencing with the hierarchical BK subproduct, given the input (A , B ), we have the following: Step 1 (i) B C = 0.1 0.1 0.2 0.5 0.5 0.6 0.3 0.3 0.4 Step 1 (ii) C = B (B C) = [0.8 0.5 0.7] (B C) = [0.3 0.3 0.4] Step 1 (iii) A C = 0.4 0.4 0.5 0.5 0.5 0.6 0.6 0.6 0.7 0.6 0.6 0.7 Step 1 (iv) C = A (A C ) = [0.7 0.6 0.5 0.5] (A C ) = [0.7 0.7 0.8]. (45) Authorized licensed use limited to: Hochschule Ostfalia (FH). Downloaded on May 27,2010 at 07:27:45 UTC from IEEE Xplore. Restrictions apply. 296 IEEE TRANSACTIONS ON FUZZY SYSTEMS, VOL. 18, NO. 2, APRIL 2010 Remark 4.6: From the previous example, it is clear that we can convert a multi-input system to a single-input hierarchical system by employing the BK-subproduct inference.The effect becomes more pronounced when we have more than two input variables. From Example 4.5, it can be noted that the most memory-intensive step in the inference is the calculation of the current output fuzzy set (steps 1 (ii) and 1 (iv)). Once again, considering the case of a p-input fuzzy rule, if the input universe of discourse Xj, j = 1, 2, . . . , p is discretized into pj points, and the output universe of discourse Z is discretized into l points, then the memory requirements of this step and, hence, of the algorithm itself, can be easily deduced to be p l + l + p , where p = maxp j=1pj. In the case m = p = l, we have that the overall memory requirements are 2m + m2. It should also be emphasized that the memory requirements are independent of the number of input variables, as can be expected in any hierarchical setting. Example 4.5 not only illustrates the computational ef ciency of hierarchical BK-subproduct inference, but it also shows that the inference obtained from the original BK subproduct is iden- tical to the one that is obtained from the proposed hierarchical BK subproduct, i.e., (43) = C = C = (45). The following re- sult shows that this equivalence is always guaranteed under the structure S that is considered in this paper. Theorem 4.7: Let S = (X, Y, Z, {Ai, Bi, Ci}i=1,...,n, L, ) be a structure for fuzzy rules as given in (42), and let R F(X Y Z) be given by n i=1 ((Ai(x) Bi(y)) Ci(z)), x X, y Y, z Z. Then, for any A F(X) and B F(Y ), all i = 1, . . . , n, it is true that (A B) R n i=1 (A (Ai (B (Bi Ci)))). Proof: For an arbitrary z Z, we have [(A B) R](z) =  x,y  (A(x) B(y)) n i=1 ((Ai(x) Bi(y)) Ci(z))  = n i=1  x,y ((A(x) B(y)) ((Ai(x) Bi(y)) Ci(z))) and by triple use of (14), we get = n i=1  x,y ((A(x) Ai(x) B(y) Bi(y)) Ci(z)) = n i=1  x  (A(x) Ai(x))  y ((B(y) Bi(y)) Ci(z)))  which equals to n i=1  x  A(x)  Ai(x)  y (B(y) (Bi(y) Ci(z)))  and, therefore [(A B) R](z) = n i=1 (A (Ai (B (Bi Ci)))). Theorem 4.7 proves the equivalence of outputs that are ob- tained from the proposed algorithm of the hierarchical BK in- ference mechanism and the original BK subproduct with 2-D inputs. Indeed, it may be systematically extended into a case of inputs of an arbitrary nite dimension. Now, we may state the following corollary of Theorems 3.6 and 4.7, which claims that if condition (26) certi es the solvabil- ity of (28), then even the proposed hierarchical BK-subproduct inference procedure keeps the fundamental interpolation condi- tion ful lled. Corollary 4.8: Let all the assumptions of Theorem 4.7 be valid. Furthermore, let n i=1 (Ai(x) Aj(x) Bi(y) Bj(y)) n i=1 (Ci(z) Cj(z)) hold for arbitrary x X, y Y, z Z, as well as for arbitrary i, j {1, . . . , n}. Then n i=1 (Ai (Ai (Bi (Bi Ci)))) Ci. V. CONCLUSION In this paper, after recalling some of the properties that are usually cited in favor of using the CRI, which was introduced by Zadeh [1], viz., equivalent and reasonable conditions for their solvability, their interpolative properties, and the preservation of the indistinguishability that may be inherent in the input fuzzy sets, we have shown that the BK subproduct that was introduced in [24] possesses all the aforementioned properties and, hence, is equally suitable to be considered when reasoning with a system of fuzzy rules. Toward this end, some new but equivalent results on indistinguishability operations have also been presented. Moreover, we show that under certain conditions, the equiv- alence of FITA and FATI can be shown for the BK subproduct, much like in the case of CRI. After citing some of the main draw- backs of FRIs, we propose an hierarchical inferencing scheme that alleviates many of these drawbacks in the BK-subproduct inference. This method is amply illustrated with numerical ex- amples. Finally, we have also shown that if the structure for the considered fuzzy rules is chosen appropriately, then the outputs that are obtained from the hierarchical BK subproduct and the original BK subproduct are identical, thus addressing the issues related to computational complexity. Based on this paper, it can be concluded that the BK subprod- uct is as advantageous as the classical CRI that was proposed by Zadeh and, hence, can be employed alternatively in applica- tions. The main difference lies in the fuzzy relation that models a fuzzy rule base, which is combined with a particular inference mechanism. It is shown that some computational advantages of the very popular Mamdani Assilian approach are valid only in Authorized licensed use limited to: Hochschule Ostfalia (FH). Downloaded on May 27,2010 at 07:27:45 UTC from IEEE Xplore. Restrictions apply. ST EPNI CKA AND JAYARAM: ON THE SUITABILITY OF THE BANDLER KOHOUT SUBPRODUCT AS AN INFERENCE MECHANISM 297 the case of the CRI inference mechanism, while if we use the BK subproduct, then many of the advantages of using R are lost, and the implicational approach that employs the fuzzy relation R assumes this privilege. Therefore, we conclude that there is another added value to the existence of two inference schemes with the same appro- priate properties the possibility to freely choose between two approaches of modeling a fuzzy rule base. Up to now, the ap- proach denoted by R that employs genuine implication was considered to be a disadvantage because of its computational complexity, although for some problems, it is much more suit- able [15]. This investigation shows that from the computational point of view, there is neither a preferable model of a fuzzy rule base nor a preferable inference mechanism; there are only preferable combinations of them. REFERENCES [1] L. A. Zadeh, Outline of a new approach to the analysis of complex systems and decision processes, IEEE Trans. Syst., Man, Cybern., vol. SMC-3, no. 1, pp. 28 44, Jan. 1973. [2] S. Gottwald, An abstract approach toward the evaluation of fuzzy rule systems, in Fuzzy Logic. A Spectrum of Theoretical and Practical Issues (Studies in Fuzzines and Soft Computing), P. P. Wang, D. Ruan, and E. E. Kerre, Eds. Berlin, Germany: Springer-Verlag, 2007, pp. 281 297. [3] S. Gottwald, On a generalization of fuzzy relation equations, in Proc. 11th IPMU Conf., Paris, France, 2006, pp. 2572 2577. [4] I. B. Turksen and Z. Zhong, An Approximate reasoning schema based on similarity measures and interval valued fuzzy sets, IEEE Trans. Syst., Man, Cybern., vol. 18, no. 6, pp. 1049 1056, Nov./Dec. 1988. [5] J. F. Baldwin, A new approach to approximate reasoning using fuzzy logic, Fuzzy Sets Syst., vol. 2, pp. 309 325, 1979. [6] V. Cross and T. Sudkamp, Patterns of fuzzy rule-based inference, Int. J. Approx. Reason., vol. 11, pp. 235 255, 1994. [7] B. Bouchon-Meunier, R. Mesiar, C. Marsala, and M. Rifqi, Compo- sitional rule of inference as an analogical scheme, Fuzzy Sets Syst., vol. 138, pp. 53 65, 2003. [8] E. H. Mamdani and S. Assilian, An experiment in linguistic synthesis with a fuzzy logic controller, Int. J. Man Mach. Stud., vol. 7, pp. 1 13, 1975. [9] W.J.M.Kickertand E.H.Mamdani, Analysisof a fuzzy logic controller, Fuzzy Sets Syst., vol. 1, no. 1, pp. 29 44, 1978. [10] P. M. Larsen, Industrial applications of fuzzy logic control, Int. J. Man Mach. Stud., vol. 12, pp. 3 10, 1980. [11] D. Dubois, H. Prade, and L. Ughetto, Checking the coherence and redun- dancy of fuzzy knowledge bases, IEEE Trans. Fuzzy Syst., vol. 5, no. 3, pp. 398 417, Aug. 1997. [12] V. Nov ak, I. Per lieva, and J. Mo cko r, Mathematical Principles of Fuzzy Logic. Boston, MA: Kluwer, 1999. [13] L. Godo and P. H ajek, A note on fuzzy inference as deduction, in Fuzzy Sets, Logics and Reasoning About Knowledge (Applied Logic Se- ries 15), D. Dubois, E. P. Klement, and H. Prade, Eds. Dordrecht, The Netherlands: Kluwer, 1999, pp. 237 241. [14] P. H ajek, Metamathematics of Fuzzy Logic. Dordrecht, The Nether- lands: Kluwer, 1998. [15] U. Bodenhofer, M. Da nkov a, M. St epni cka, and V. Nov ak, A plea for the usefulness of the deductive interpretation of fuzzy rules in engineering applications, in Proc. IEEE Int. Conf. Fuzzy Syst., London, U.K., 2007, pp. 1567 1572. [16] F. Klawonn and V. Nov ak, The relation between inference and interpola- tion in the framework of fuzzy systems, Fuzzy Sets Syst., vol. 81, no. 3, pp. 331 354, 1996. [17] D. Dubois and H. Prade, What are fuzzy rules and how to use them, Fuzzy Sets Syst., vol. 84, pp. 169 185, 1996. [18] V. Nov ak and S. Lehmke, Logical structure of fuzzy IF THEN rules, Fuzzy Sets Syst., vol. 157, no. 15, pp. 2003 2029, 2006. [19] D. Coufal, Coherence of radial implicative fuzzy systems, in Proc. 15th IEEE Int. Conf. Fuzzy Syst., Vancouver, BC, Canada, 2006, pp. 307 314. [20] D. Coufal, Coherence index of radial conjunctive fuzzy systems, in Foundations of Fuzzy Logic and Soft Computing (Lecture Notes in Arti- cial Intelligence), P. Melin, O. Castillo, L. T. Aguilar, J. Kacprzyk, and W. Pedrycz, Eds. Berlin, Germany: Springer-Verlag, 2007, pp. 502 514. [21] G. J. Klir and B. Yaun, Fuzzy Sets and Fuzzy Logic. Englewood Cliffs, NJ: Prentice-Hall, 1995. [22] E. P. Klement, R. Mesiar, and E. Pap, Triangular Norms. Dordrecht, The Netherlands: Kluwer, 2000. [23] W. Pedrycz, Applications of fuzzy relational equations for methods of reasoning in presence of fuzzy data, Fuzzy Sets Syst., vol. 16, pp. 163 175, 1985. [24] W. Bandler and L. J. Kohout, Fuzzy relational products and fuzzy impli- cation operators, presented at the Int. Workshop Fuzzy Reason. Theory Appl., London, U.K., 1978. [25] W. Bandler and L. J. Kohout, Semantics of implication operators and fuzzy relational products, Int. J. Man Mach. Stud., vol. 12, pp. 89 116, 1979. [26] W. Bandler and L. J. Kohout, The use of checklist paradigm in inference systems, in Fuzzy Logic in Knowledge Engineering, C. V. Negoita and H. Prade, Eds. Koln, Germany: Verlag T UV Rheinland, 1986, pp. 95 111. [27] T. Vetterlein and M. St epni cka, Completing fuzzy if then rule bases by means of smoothing splines, Int. J. Uncertainty, Fuzziness Knowl.-Based Syst., vol. 14, pp. 235 244, 2006. [28] I. Per lieva and S. Lehmke, Correct models of fuzzy IF THEN rules are continuous, Fuzzy Sets Syst., vol. 157, pp. 3188 3197, 2006. [29] A. Di Nola, S. Sessa, W. Pedrycz, and E. Sanchez, Fuzzy Relational Equations and Their Applications to Knowledge Engineering. Boston, MA: Kluwer, 1989. [30] I. Per lieva and V. Nov ak, System of fuzzy relation equations as a con- tinuous model of IF THEN rules, Inf. Sci., vol. 177, pp. 3218 3227, 2007. [31] F. Klawonn and J. L. Castro, Similarity in fuzzy reasoning, Mathw. Soft Comput., vol. 2, pp. 197 228, 1995. [32] M. Baczy nski and B. Jayaram, Fuzzy Implication (Studies in Fuzziness and Soft Computing). Heidelberg, Germany:Springer-Verlag, 2008. [33] S. Gottwald, Generalized solvability behaviour for systems of fuzzy equa- tions, in Discovering the World With Fuzzy Logic (Studies in Fuzzines and Soft Computing), V. Nov ak and I. Per lieva, Eds. Heidelberg, Germany: Springer-Verlag/Physica-Verlag, 2000, pp. 401 430. [34] E. Sanchez, Resolution of composite fuzzy relation equations, Inf. Control, vol. 30, pp. 38 48, 1976. [35] B. De Baets, Analytical solution methods for fuzzy relation equations, in The Handbook of Fuzzy Set Series 1, D. Dubois and H. Prade, Eds. Boston, MA: Kluwer, 2000, pp. 291 340. [36] F. Klawonn, Fuzzy points, fuzzy relations and fuzzy functions, in Dis- covering the World With Fuzzy Logic (Studies in Fuzzines and Soft Com- puting), V. Nov ak and I. Per lieva, Eds. Heidelberg, Germany: Springer- Verlag/Physica-Verlag, 2000, pp. 431 453. [37] B. De Baets and R. Mesiar, T-partitions, Fuzzy Sets Syst., vol. 97, pp. 211 223, 1998. [38] L. Noskov a, Systems of fuzzy relation equation with inf composition: Solvability and solutions, J. Electr. Eng., vol. 12(s), pp. 69 72, 2005. [39] M. St epni cka, B. De Baets, and L. Noskov a, Arithmetic fuzzy models, IEEE Trans. Fuzzy Syst., to be published. [40] M. St epni cka, B. De Baets, and L. Noskov a, On additive and multiplica- tive fuzzy models, in Proc. 5th Int. Conf. Eur. Soc. Fuzzy Logic Technol., vol. 2, New Dimensions Fuzzy Logic, Related Technol., Ostrava, Czech Republic, 2007, pp. 95 102. [41] B. Jayaram, On the law of importation (x y) z (x (y z)) in fuzzy logic, IEEE Trans. Fuzzy Syst., vol. 16, no. 1, pp. 130 144, Feb. 2008. [42] W. Bandler and L. J. Kohout, Fuzzy power sets and fuzzy implication operators, Fuzzy Sets Syst., vol. 4, pp. 183 190, 1980. [43] L. A. Zadeh, Similarity relations and fuzzy orderings, Inf. Sci., vol. 3, pp. 177 200, 1971. [44] E. H. Ruspini, A new approach to clustering, Inf. Control, vol. 15, pp. 22 32, 1969. [45] C. Cornelis M. DeCock, and E. E. Kerre, Ef cient approximate reason- ing with positive and negative information, in Knowledge-Based Intel- ligent Information and Engineering Systems (Lecture Notes in Arti cial Intelligence, vol. 3214), M. G. Negoita, R. J. Howlett, and L. C. Jain, Eds. Berlin, Germany: Springer-Verlag, 2004, pp. 779 785. [46] R. Martin-Clouaire, A fast generalized modus ponens, BUSEFAL, vol. 18, pp. 75 82, 1984. Authorized licensed use limited to: Hochschule Ostfalia (FH). Downloaded on May 27,2010 at 07:27:45 UTC from IEEE Xplore. Restrictions apply. 298 IEEE TRANSACTIONS ON FUZZY SYSTEMS, VOL. 18, NO. 2, APRIL 2010 [47] K. Demirli and I. B. T urksen, Rule break up with compositional rule of inference, in Proc. IEEE Int. Conf. Fuzzy Syst., San Diego, CA, 1992, pp. 749 756. [48] R. Full er, Fuzzy Reasoning and Fuzzy Optimization. Turku, Finland: TUCS, 1998. [49] R. Full er and B. Werners, The compositional rule of inference with several relations, in Proc. Int. Conf. Fuzzy Sets, Its Appl., Liptovsk y, Mikul a s, Slovakia, 1992, pp. 39 44. [50] R. Full er and H.-J. Zimmermann, On computation of the compositional rule of inference under triangular norms, Fuzzy Sets Syst., vol. 51, pp. 267 275, 1992. [51] B. Moser and M. Navara, Conditionally ring rules extend the possi- bilities of fuzzy controllers, in Proc. Int. Conf. Comput. Intell. Model., Vienna, Austria, 1999, pp. 242 245. [52] B. Moser and M. Navara, Which triangular norms are convenient for fuzzy controllers? in Proc. 4th Int. Conf. Eur. Soc. Fuzzy Logic Technol., Palma, Spain, 1999, pp. 75 78. [53] B. Moser and M. Navara, Fuzzy controllers with conditionally ring rules, IEEE Trans. Fuzzy Syst., vol. 10, no. 3, pp. 340 348, Jun. 2002. [54] D. Ruan and E. E. Kerre, On the extension of the compositional rule of inference, Int. J. Intell. Syst., vol. 8, pp. 807 817, 1993. [55] M. Golob, Decomposition of a fuzzy controller based on the inference break-up method, Intell. Data Anal., vol. 3, no. 2, pp. 127 137, 1999. Martin St epni cka (S 05 M 10) received the M.Sc. degree in applied mathematics and the Ph.D. degree in fuzzy modeling from the University of Ostrava, Ostrava, Czech Republic, in 2002 and 2008, respec- tively. He is the Vice Director with the Institute for Re- search and Applications of Fuzzy Modeling, Univer- sity of Ostrava. His current research interests mainly include fuzzy modeling, especially fuzzy inference systems. Dr. St epni cka is a member of the Board of the European Society for Fuzzy Logic and Technology (EUSFLAT), the IEEE Computational Intelligence Society, and the International Institute of Forecasters (IIF). Balasubramaniam Jayaram (S 02 A 03 M 04) re- ceived the M.Sc. and Ph.D. degrees in Mathematics from Sri Sathya Sai University (SSSU), India, in 1999 and 2004, respectively. With the help of a scholarship given by Slovak Academic Information Agency (SAIA) , Government of the Slovak Republic, he was a visiting researcher at the Department of Mathematics and Descriptive Ge- ometry, Slovak University of Technology, Bratislava. He was also a Visiting Researcher at the Johannes Kepler University, Linz and at Institute for Research and Applications of Fuzzy Modeling, University of Ostrava, Czech Republic and a Visiting Assistant Professor at the Department of Mathematics, Indian Institute of Technology Madras, India. He is currently an Assistant Professor at the Department of Mathematics, Indian Institute of Technology Hyderabad, India. His current research interests include fuzzy aggregation operations, chie y fuzzy implications and fuzzy conjunctions, approximate reasoning, fuzzy clustering and fuzzy techniques in Image Processing. He has co-authored a re- search monograph on Fuzzy Implications and is the author or co-author of more than 30 published papers in refereed international journals and conferences. He is also a regular reviewer for many respected international journals and a member of various committees in international conferences. Dr. Jayaram is a member of EUSFLAT and IEEE Computationational Intel- ligence Society and a fellow of the Alexander von Humboldt foundation. Authorized licensed use limited to: Hochschule Ostfalia (FH). Downloaded on May 27,2010 at 07:27:45 UTC from IEEE Xplore. Restrictions apply.