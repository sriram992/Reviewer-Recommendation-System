1 Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm Thesis Submitted in partial ful llment of the requirement of Doctor of Philosophy by Chintan Patel Roll No. 17RCP003 Under the guidance of Dr. Nishant Doshi Department of Computer Science and Engineering School of Technology Pandit Deendayal Energy University Gandhinagar 382426. Gujarat - India August, 2021. Approval Sheet This thesis entitled Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm by Chintan Patel is recommended for the degree of Doctor of Philosophy. Examiners Supervisor H.o.D/Chairman Date: Place: Student Declaration I, Chintan Patel, hereby declare that this written submission represents my ideas in my own words and where others idea or words have been included, I have adequately cited and referenced the original sources. I also declare that I have adhered to all principles of academic honesty and integrity and have not misrepresented or fabricated or falsi ed any idea / data / fact / source in my sub- mission. I understand that any violation of the above will be cause for disciplinary action by the Pandit Deendayal Energy University and can also evoke penal action from the sources which have thus not been properly cited or from whom proper permission has not been taken when needed. Chintan Patel Roll No : 17RCP003 Date: Acknowledgment I feel truly privileged to be a doctorate student in the Computer Science and Engi- neering (CSE) department of the School of Technology (SoT) of the Pandit Deen- dayal Energy University (PDEU), Gandhinagar. My doctorate journey in PDEU has taught me certain values such as academic integrity, honesty, patience and hard work above everything else. It has been one of the most challenging as the same time fruitful phase of my life. In this journey, i came across many people who have inspired me and motivated me for my work. I would like to take this opportunity to thank all those who have helped me and encouraged me during the course of working on this thesis. First, I express deep sense of gratitude towards my guide Dr. Nishant Doshi. I am obliged to him for giving me freedom of expression beyond the limits. I feel happy to be his rst doctorate Scholar. I will always cherish and follow his ideals of keeping patience, being humble and doing hard work in a smarter way during any critical situations. Dear Sir. I truly feel honoured to my external examiner Prof. Maniklal Das, Professor of Computer Science at Dhirubhai Ambani In- stitute of Information and Communication Technology (DA-IICT), Gandhinagar, India, for providing his valuable suggestions during every phase of this submis- sion and word might not suf ce to express my deep gratitude and respect towards him. I would like to express my sincere gratitude to Prof. S. Sundar Manoharan (DG, PDEU), Prof. Sunil Khanna, (Director, SoT) and Prof. Rajesh Patel, (Dean, SoT). I would like to express my sincere thanks to Dr. Samir Patel (HoD, CSE). Respected panel members, Your honest support and fruitful suggestions helped me a lot during this journey. I will always remain honoured towards the con dence you have shown in me. You have steered my career to a path which will always inspire me to touch a sky in my work. I would also like to thank Dr. Manish Chaturvedi, IITRAM, Ahmedabad, In- dia for his valuable suggestions, continuous support in this journey. I am so much thankful to other faculties of CSE department, specially Dr. Rudresh Dwivedi, Dr. Payal Chaudhari and faculties from other department specially Dr. Vivek Patel, Mechanical Engineering Department for their support and encouragement. I would like to thank PDEU management for providing facilities and administra- tive support during this research journey. I cannot miss this opportunity to express my heartfelt gratitude to the friends who always inspired and motivated me for this journey. Dear Ms. Hemani Parikh (my positive thinker), Mr. Kanhaiya Sharma (my anytime helpline) , and Mr. Pruthivish Rajput (my research helpline), I can not visualize any moment of this journey without you people and thank you so much from my bottom of the heart for all your support. Thanks are due to my dear friends Pratik Patel, Mumukshu Trivedi, Ankit Oza, Ruchita Shah, Hardik Jani, Ravi Patel & Devanshi Dave. I will cherish the tea & lunch breaks and other fun at Ph.D. workspace. Thank you all for making me realise my strengths and for being there in moments of weakness. Lastly, I would like to thank the actual drivers of this journey. My Parents. Jayprakash Patel (father) and Leelaben Patel (mother), your love, support and sacri ces made me what I am today. You are the forces that kept me going through the program. Dad, you always said that your duty is far better than my duty and i know you will be happy to see me a successful person in the scienti c eld. I am ii also thankful to three other most special entities of my life, My wife Jagruti Patel (engine who always supported my vehicle in any situation by burning herself) and My sister Dr. Hetal Patel (oil of my vehicle) for motivating me to be best version of myself. I am so much thankful to my son Aarush Patel for highest scari es and indirect support in this journey. I am also thankful to my other family mem- bers for their kind support. Chintan Patel iii Dedicated to Grand Father and Grand Mother... You lightened it Papa...You envisioned this. Your determination and belief made this a reality.. Mummy...Your faith and prayers have lead us here.. Your patience & support made this a reality.. Jagruti & Hetal & Aarush.. You made me laugh at the lowest points.. You made me believe that I can.. Abstract Internet of Things (IoT) is a network of interconnected tiny resource constraint devices. These devices can be sensors, actuators, gateways or other microcon- trollers and microprocessors. An intra-device communication (a.c.a. Machine to Machine Communication (M2M)), as well as an inter-device communication in the IoT, must be protected from both, active and passive attackers. Traditional cryptography protocols (i.e. RSA or DES or AES) provides well suited reliable security mechanism in the current internet topology that is built up using highly resource capable devices such as computers and servers. Fundamental different between internet cryptography and IoT cryptography lies in types of devices used to build up the topology. The internet is built up using resource capable devices such as computers and servers while the IoT network is built up using resource constraint devices such as sensors and actuators. Devices in the IoT suffers from copious limitations such as poor battery backup, less processing capabilities and lower storage capabilities. Hence, it is highly erratic and inept at using traditional internet cryptography in IoT communication. Remote Use Authentication (RUA) is a backbone of any trusted and secure communication. The RUA provides mutually trusted session key for further en- crypted communication between communicating parties. In the IoT, user devices (i.e. wearable devices or mobile devices) receives data from the sensing devices through series of gateway devices. In these devices, gateway devices are only de- vices which are resource capable devices and can perform complex cryptography operations while other devices may not be capable of performing those operations. Hence, it is trivial to establish a mutually trusted session key between sensing de- vices and user devices using lightweight cryptography operations such as Elliptic Curve Cryptography (ECC), XOR operations and Lightweight hash functions. The fundamental objective of the proposed work is to propose a highly ef - cient and computationally reliable authentication mechanism for mutually authen- ticated session key generation between either User - GateWay (U-GW) or between User - GateWay - Sensing device (U-GW-S) in the constraint environment. In this thesis, we propose a novel key exchange schemes for U-GW model as well as U-GW-S model using an XOR operation, lightweight hash function and the ECC encryption-decryption as a preliminary cryptography operation. In this work, we also propose a novel authentication mechanism called a Level Dependent Authentication for Generic IoT (LDA-GIoT). In LDA-GIoT, every user and sensing devices get a level number based on their deployment on the ground. The system user with a lower level compared to the sensing level can only establish a session key for the communication with sensor. An implementa- tion and a security analysis of the proposed LDA-GIoT using the classical tools proves that the proposed LDA-GIoT is an ef cient and reliable algorithm for the IoT devices authentication. Further, we provide a security analysis for the proposed work using a widely adopted Dolev-Yao channel and random oracle based Real or Random (ROR) Model. We also prove a mutual authentication for the proposed schemes using a widely adopted Burrows Abadi Needham logic (BAN) Logic. We have used a python language for the implementation and raspberry pi and nodeMCU for the test-beds generation of the proposed work. For the communication purpose, we have used MQTT (Message Queuing Telemetry Transport) protocol. vi Contents Abstract v Contents vii List of Figures xii List of Tables xiv 1 Introduction 1 1.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1 1.2 Layered Architecture . . . . . . . . . . . . . . . . . . . . . . . . 4 A Seven Layered Architecture . . . . . . . . . . . . . . . . 5 B Four Layered Architecture . . . . . . . . . . . . . . . . . 9 1.3 Remote User Authentication . . . . . . . . . . . . . . . . . . . . 13 A Authentication Models in IoT . . . . . . . . . . . . . . . 15 1.4 Security Issues . . . . . . . . . . . . . . . . . . . . . . . . . . . 18 1.5 Applications . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24 A Smart Home . . . . . . . . . . . . . . . . . . . . . . . . 24 B Smart Grid . . . . . . . . . . . . . . . . . . . . . . . . . 25 vii C Smart Industry . . . . . . . . . . . . . . . . . . . . . . . 26 D Smart Healthcare . . . . . . . . . . . . . . . . . . . . . . 26 E Smart Transportation System . . . . . . . . . . . . . . . . 28 1.6 Research gaps and contributions . . . . . . . . . . . . . . . . . . 29 1.7 Thesis Preview . . . . . . . . . . . . . . . . . . . . . . . . . . . 30 2 Fundamental Preliminaries 33 2.1 Elliptic Curve Cryptography . . . . . . . . . . . . . . . . . . . . 33 A ECC Encryption and Decryption . . . . . . . . . . . . . . 35 B ECC Computational Problems . . . . . . . . . . . . . . . 35 2.2 Hash Function . . . . . . . . . . . . . . . . . . . . . . . . . . . . 37 2.3 Fuzzy Extractor . . . . . . . . . . . . . . . . . . . . . . . . . . . 38 2.4 Security Models . . . . . . . . . . . . . . . . . . . . . . . . . . . 40 A ROR Model . . . . . . . . . . . . . . . . . . . . . . . . . 40 B BAN Logic . . . . . . . . . . . . . . . . . . . . . . . . . 44 2.5 Conclusion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 47 3 Secure Lightweight Key Exchange for User - Gateway Paradigm 48 3.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 49 3.2 Literature Review . . . . . . . . . . . . . . . . . . . . . . . . . . 50 3.3 Threat Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . 50 3.4 Proposed Scheme . . . . . . . . . . . . . . . . . . . . . . . . . . 51 A Initialization Phase . . . . . . . . . . . . . . . . . . . . . 51 B Registration Phase . . . . . . . . . . . . . . . . . . . . . 53 C Login and Authentication Phase . . . . . . . . . . . . . . 54 D Password Update Phase . . . . . . . . . . . . . . . . . . 55 viii 3.5 Security Analysis . . . . . . . . . . . . . . . . . . . . . . . . . . 57 A Informal Security Analysis . . . . . . . . . . . . . . . . . 57 B Mutual Authentication Using BAN Logic . . . . . . . . . 63 C Formal security Analysis using ROR Model . . . . . . . . 67 3.6 Implementation and Testbeds . . . . . . . . . . . . . . . . . . . . 76 3.7 Use cases . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 78 3.8 Comparative Analysis . . . . . . . . . . . . . . . . . . . . . . . . 79 A Network Parameter Analysis . . . . . . . . . . . . . . . . 80 B Communication Cost . . . . . . . . . . . . . . . . . . . . 81 C Computation Cost . . . . . . . . . . . . . . . . . . . . . 82 3.9 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 84 4 Secure Lightweight Key Exchange for User - Gateway - Sensor Paradigm 86 4.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 87 4.2 Literature Review . . . . . . . . . . . . . . . . . . . . . . . . . . 88 4.3 Threat Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . 91 4.4 Proposed Scheme . . . . . . . . . . . . . . . . . . . . . . . . . . 92 A Initialization Phase . . . . . . . . . . . . . . . . . . . . . 93 B Registration Phase . . . . . . . . . . . . . . . . . . . . . 93 C Authentication and Key Exchange Phase . . . . . . . . . 94 4.5 Security Analysis . . . . . . . . . . . . . . . . . . . . . . . . . . 97 A Informal Security Analysis . . . . . . . . . . . . . . . . . 97 B Mutual Authentication using BAN Logic . . . . . . . . . 104 C Formal Security Analysis Using ROR . . . . . . . . . . . 109 4.6 Implementation and Testbeds . . . . . . . . . . . . . . . . . . . . 113 ix 4.7 Use cases . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 114 4.8 Comparative Analysis . . . . . . . . . . . . . . . . . . . . . . . . 115 A Network Parameter Analysis . . . . . . . . . . . . . . . . 115 B Communication Cost . . . . . . . . . . . . . . . . . . . . 116 C Computation Cost . . . . . . . . . . . . . . . . . . . . . 117 4.9 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 118 5 Level Dependent Authentication using Two Factor Authentication 120 5.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 121 A Level Dependent Authentication . . . . . . . . . . . . . . 122 5.2 Literature Survey . . . . . . . . . . . . . . . . . . . . . . . . . . 124 5.3 Threat Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . 127 5.4 Proposed Scheme . . . . . . . . . . . . . . . . . . . . . . . . . . 128 A System Initialize Phase . . . . . . . . . . . . . . . . . . . 129 B User Registration Phase . . . . . . . . . . . . . . . . . . 131 C Login and Session Key Agreement Phase . . . . . . . . . 132 5.5 Security Analysis . . . . . . . . . . . . . . . . . . . . . . . . . . 135 A Informal Security Analysis . . . . . . . . . . . . . . . . . 135 B Mutual Authentication Using BAN Logic . . . . . . . . . 141 C Formal Security Analysis using ROR Model . . . . . . . 146 5.6 Implementations and Testbeds . . . . . . . . . . . . . . . . . . . 150 5.7 Use cases . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 152 5.8 Comparative Analysis . . . . . . . . . . . . . . . . . . . . . . . . 153 A Network Parameter Analysis . . . . . . . . . . . . . . . . 153 B Communication Cost . . . . . . . . . . . . . . . . . . . . 154 x C Computation Cost . . . . . . . . . . . . . . . . . . . . . 155 5.9 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 157 6 Level Dependent Authentication using Multi Factor Authentication 159 6.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 160 A Level Dependent Authentication . . . . . . . . . . . . . . 160 6.2 Literature Review . . . . . . . . . . . . . . . . . . . . . . . . . . 163 6.3 Threat Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . 166 6.4 Proposed Scheme . . . . . . . . . . . . . . . . . . . . . . . . . . 167 A Initialization Phase . . . . . . . . . . . . . . . . . . . . . 168 B Registration Phase . . . . . . . . . . . . . . . . . . . . . 169 C Authentication and Key Exchange Phase . . . . . . . . . 170 6.5 Security Analysis . . . . . . . . . . . . . . . . . . . . . . . . . . 173 A Informal Security Analysis . . . . . . . . . . . . . . . . . 173 B Mutual Authentication using BAN Logic . . . . . . . . . 181 C Formal Security Model using ROR . . . . . . . . . . . . 186 6.6 Implementation and Testbeds . . . . . . . . . . . . . . . . . . . . 197 6.7 Use cases . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 199 6.8 Comparative Analysis . . . . . . . . . . . . . . . . . . . . . . . . 200 A Network Parameter Analysis . . . . . . . . . . . . . . . . 200 B Communication Cost . . . . . . . . . . . . . . . . . . . . 202 C Computation Cost . . . . . . . . . . . . . . . . . . . . . 203 6.9 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 205 7 Conclusions and Future Scope 207 7.1 Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 207 xi 7.2 Future Work . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 211 A Deployment of LDA approach in other realtime IoT ap- plications . . . . . . . . . . . . . . . . . . . . . . . . . . 211 B M2M or D2D Authentication . . . . . . . . . . . . . . . . 212 C Authentication in the Multi gateway Environment . . . . . 212 D Authentication thorough Physical Unclonable Functions or Secure Elements . . . . . . . . . . . . . . . . . . . . . 213 E Learning Approach for Authentication . . . . . . . . . . . 213 List of Publications 214 Bibliography 217 xii List of Figures 1.1 Seven Layered Architecture by CISCO [Cisco (2014)] . . . . . . 6 1.2 Four Layered Architecture [Patel & Doshi (2018)] . . . . . . . . . 11 1.3 User - Gateway Authentication Model . . . . . . . . . . . . . . . 16 1.4 User - Gateway - Sensor Authentication Model . . . . . . . . . . 17 1.5 Security Heptagon [Patel & Doshi (2019)] . . . . . . . . . . . . . 19 1.6 IoT Applications . . . . . . . . . . . . . . . . . . . . . . . . . . 27 3.1 Computed Session Key . . . . . . . . . . . . . . . . . . . . . . . 78 3.2 Performance Comparison Chart . . . . . . . . . . . . . . . . . . 84 4.1 Session Key . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 114 4.2 Performance Comparison Chart . . . . . . . . . . . . . . . . . . 118 5.1 Network Model and Level Dependent Authentication . . . . . . . 123 5.2 LDA-GIoT Session Key . . . . . . . . . . . . . . . . . . . . . . . 151 5.3 Performance Comparison Chart . . . . . . . . . . . . . . . . . . 157 6.1 Level Dependent Authentication . . . . . . . . . . . . . . . . . . 161 6.2 IoT Implementation Model . . . . . . . . . . . . . . . . . . . . . 199 6.3 Computed Session Key . . . . . . . . . . . . . . . . . . . . . . . 199 xiii 6.4 Performance Comparison Chart . . . . . . . . . . . . . . . . . . 204 xiv List of Tables 1.1 IoT Security Related Surveys . . . . . . . . . . . . . . . . . . . . 23 2.1 RSA vs ECC . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34 3.1 Notation and Abbreviations . . . . . . . . . . . . . . . . . . . . . 52 3.2 Authentication and Key Exchange Phase . . . . . . . . . . . . . . 56 3.3 Security Comparison . . . . . . . . . . . . . . . . . . . . . . . . 62 3.4 Goals . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 64 3.5 Implementation Environment . . . . . . . . . . . . . . . . . . . . 77 3.6 Comparison of the Communication Cost . . . . . . . . . . . . . . 82 3.7 Comparison of the Computation Cost . . . . . . . . . . . . . . . 83 4.1 Notation and Abbreviations . . . . . . . . . . . . . . . . . . . . . 93 4.2 Authentication and Key Exchange . . . . . . . . . . . . . . . . . 98 4.3 Security Comparison . . . . . . . . . . . . . . . . . . . . . . . . 100 4.4 Comparison of Communication Cost . . . . . . . . . . . . . . . . 116 4.5 Comparison of the Computation Cost . . . . . . . . . . . . . . . 117 5.1 Notation and Abbreviations . . . . . . . . . . . . . . . . . . . . . 129 5.2 Authentication and Key Exchange . . . . . . . . . . . . . . . . . 134 xv 5.3 Security Comparison . . . . . . . . . . . . . . . . . . . . . . . . 140 5.4 Implementation Environment . . . . . . . . . . . . . . . . . . . . 151 5.5 Comparison of Communication Costs . . . . . . . . . . . . . . . 155 5.6 Comparison of Computation Cost . . . . . . . . . . . . . . . . . 156 6.1 Notation and Abbreviations . . . . . . . . . . . . . . . . . . . . . 168 6.2 Authentication and Key Exchange . . . . . . . . . . . . . . . . . 174 6.3 Security Comparison . . . . . . . . . . . . . . . . . . . . . . . . 179 6.4 Implementation Environment . . . . . . . . . . . . . . . . . . . . 198 6.5 Communication Costs Comparison . . . . . . . . . . . . . . . . . 203 6.6 Computation Cost Comparison . . . . . . . . . . . . . . . . . . . 204 xvi Abbreviations IoT . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Internet of Things M2M . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Machine to Machine D2D . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .Device to Device RUA . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Remote User Authentication RFID . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Radio Frequency IDenti cation ECC . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Elliptic Curve Cryptography SC . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .Smart Card SCR . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Smart Card Reader SK . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .Session Key NFC . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .Near Field Communication DES . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Data Encryption Standard ECDLP . . . . . . . . . . . . . . . . . . . . . . . . . . Elliptic Curve Discrete Logarithm Problem SG . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .Smart Grid SH . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Smart Home SHe . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Smart Healthcare DOS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Denial of Services DDOS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Distributed Denial of Service MITM . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Man-In-the-Middle Attack SI . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Smart Industry HTTP . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Hyper Text Transfer Protocol ECDHE . . . . . . . . . . . . . . . . . . . . . . . . . . . Elliptic Curve Dif e-Hellman Encryption STS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Smart Transportation System RoR Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .Real or Random Model xvii BAN Logic . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Burrows Abadi Needham Logic LDA . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .Level Dependent Authentication BLE . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Bluetooth Low Energy MQTT . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Message Queuing Telemetry Transport CoAP . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Constraint Application Protocol XMPP . . . . . . . . . . . . . . . . . . . . . . . . . . Extensible Messaging and Presence Protocol SM . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Smart Meter AVISPA . .Automated Validation of Internet Security Protocols and Applications Nomenclature H(.) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Hash Function xviii Chapter 1 Introduction of IoT Paradigm This chapter provides an introduction for IoT paradigm and RUA. Section 1.1 pro- vides introduction to IoT. Section 1.2 provides an overview on layered architec- tures adopted by different entities working on IoT expansion. Section 1.3 presents overview on RUA and different authentication models adopted in IoT paradigm. Section 1.4 presents security issues faced by IoT eco-system and it s applications. Section 1.5 provides introductory discussion about IoT applications that makes complete IoT eco-system as an interconnected eco-system. Section 1.6 highlights existing research gaps and major contributions of this thesis. Section 1.7 provides detailed thesis preview in terms of chapter wise overview. 1.1 Introduction An IoT network build-ups using a highly homogeneous, globally dynamic, deeply deployed, and the comparatively resource-constrained devices to provide Any type service at Any location to Anyone on Any time . The scale of IoT data 1 Chapter 1. Introduction generation is directly proportional to the growing quantity of Internet connected devices. As per the recent predictions by the global giant of telecommunications and market intelligence agency International Data Cooperation (IDC), there will be approx 42 billion deployed devices that will generate approx 80 ZettaByte data by 2025 [Atzori et al. (2010)]. The journey of IoT was started with the RFID technology in which RFID tag transmit the identi cation data to the RFID reader. This approach is broadly expanded and now a days IoT can be de ned as an interconnected network of uniquely identi able tiny resource constraint device those communicate with each other in the environment of mesh topology . Most of the devices deployed in the IoT networks are tiny resource constraint sensing devices and actuators which are having capability of tracing the surrounding biological environment as well as the nonbiological environment. These devices use technologies such as Bluetooth, RFID, Zigbee, and WiFi to transmit the sensed data to the cloud server via nearest gateway devices. The major IoT devices are resource constraint devices in terms of storage cost, computation capabilities, communication capabilities and power utilization. The traditional Internet uses complex cryptography mathematical operations for to protect the data over communication channel. These operations require am- ple storage space and high computation memory with huge power consumption. Thus, due to the highly constraint availability of numerous IoT devices, it is indis- pensable to prototype a lightweight security mechanism for the end-to-end data communication in IoT Model. For IoT network, there is a strong need to design a lightweight security mechanism that must be ef cient in terms of the computa- tion capabilities, optimized in terms of memory and time utilization, and robust PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 2 Chapter 1. Introduction against the traditional and non-traditional security attacks. A recent prediction by IoT business news shows that IoT devices will grow from 7.6 billion to 24.1 billion between 2019 and 2030, with estimated revenue will reach to USD 1.5 trillion [Hatton (2020)]. Fuqaha et al. highlighted that by 2022, more than 45% Internet connected devices will be IoT devices that may lead to economical valuation upto $6.2 trillion by 2025 [Al-Fuqaha et al. (2015)]. Hence, there is a need of strong and justi able standardization and architecture that provide a clear direction to the IoT learners, developers, researchers, indus- tries, and all other entities involved with IoT in either ways. Rapid growth in connected devices also invites exponential growth to zero day vulnerabilities in IoT eco-system. Major challenges in IoT eco-system includes (1) heterogeneity of IoT devices in terms of manufacturers and technology used by them. (2) providing unique identity to billions of Internet connected devices. (3) establishing reliable communication among these devices. (4) managing re- sources based on energy consumption, storage requirement, computation cost and communication cost for complete eco-system (5) providing better services to all the types of users through improved data analytic and intelligent decision mak- ing system. (6) providing strong security and privacy system for the complete eco-system. In general, IoT eco-system is build up using three types of devices. i.e. (1) Sensing devices those sense the data and pass those data to the intermediary de- vices. (2) The intermediary devices, those may be gateway devices, cluster heads or other devices whose work is to forward the received data to either user for real time monitoring or to the cloud for further processing and storage. (3) The user devices that receive data from the intermediary devices and take decisions accord- PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 3 Chapter 1. Introduction ingly. Among the numerous security parameters, authentication provides mutual trust among these devices in terms of identity and assures each other that they are communicating with the valid devices. The vast applicability of IoT eco-system attracted government agencies, re- searchers and other entities and inspired to gear up development towards making non-smarter applications to the smarter applications. We can list out some of the IoT based applications such as smart healthcare, smart manufacturing, smart transportation, smart retails and logistics, smart agriculture, smart home and so on. Every IoT applications developed in a layered manner from device deploy- ment to user applications. Next section 1.2 presents different layered architectures adopted by different entities. 1.2 Layered Architecture The layered architecture of any technology helps researchers and learners to un- derstand the development hierarchy of full system. Till today many different or- ganization such as ITU, IETF, IEEE have proposed tentative reference models for IoT eco-system, but still, none of the architecture got a world wide acceptance to become reference model for IOT. In 2014, CISCO, IBM and Intel jointly pre- sented a seven layer architecture at world forum [Cisco (2014)]. Researchers in [Atzori et al. (2010)] presented three layered architectures that consists of per- ception layer, transport layer and application layer. Authors in [L. D. Xu et al. (2014)] presented four layered architecture that adds one extra layer called as a middle ware in the three layered architectures. Some other authors in [Al-Fuqaha et al. (2015)] presented ve layered architecture that consists of perception layer, PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 4 Chapter 1. Introduction network layer, support layer, application layer. Over all, an IoT eco-system con- sists of things which sense the data, network that transmit the data, middle ware that process the data and application layer that uses the data. In this section, First, seven layered architecture proposed by CISCO is over viewed [Cisco (2014)] and then four layered architecture presented in [Patel & Doshi (2018)] is discussed with security vulnerabilities at each layer. A Seven Layered Architecture Following Fig. 1.1 presents seven layer architecture of IoT presented by CISCO. Layer 1: Physical Devices and Controllers The Layer-1 of the CISCO model deals with the IoT devices those collects the data from the environment. This layer basically discusses about things in the IoT. Things can be de- vices such as sensors and actuators or controllers such as arduino and rasp- berry pi. These devices collect the data from the surroundings and forward it to near by controllers. The nearby controllers forward those data to the valid destination at edge level. Examples of these devices and controllers are: sensors, microcontrollers, micro processors, cameras, RFID Tags, RFID readers, bluetooth devices, cars, wearable devices, intelligent machines and so on. Major Security concerns in this layer are con dentiality and integrity of data, physical device security, authentication between devices, accountability and non repudiation of the data transmitting devices. Layer 2: Connectivity PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 5 Chapter 1. Introduction 7. USER AND BUSINESS 6. APPLICATIONS 5. DATA ABSTRACTION 4. DATA ACCUMULATION 3. EDGE COMPUTING 2. CONNECTIVITY 1. PHYSICAL DEVICE AND CONTROLLERS STORED DATA MOVING DATA USER SIDE CLOUD SIDE EDGE SIDE Figure 1.1. Seven Layered Architecture by CISCO [Cisco (2014)] The Layer-2 of the CISCO model provides connectivity between physical devices and edge devices. This layer deals with communication among: Computing devices. Computing devices and controllers. Controllers and gateway device/edge device as well as Gateway and cloud. Users/application and cloud. Major Security concerns in this layer are side channel attacks, con dentiality and integrity of data, physical device security, authentication between devices, ac- countability and non repudiation of data transmitting devices. Layer 3: Edge Computing PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 6 Chapter 1. Introduction The Layer-3 of the CISCO architecture deals with the edge computing or fog com- puting where the data will be processed locally. We can summarize the operations of this layer as follows: Basic motive of this layer is to process the data at local layer with the ob- jective of reduction in the computation overhead over the cloud. This layer helps in traf c reduction at above layers and also improve the accuracy in decision making. Major security challenge in this layer is to protect the data from the internal ad- versaries who have access of edge devices as well as from the external adversaries who try to access edge device with a bad motive. Hence, some security vulnera- bilities such as physical security, Denial of Service and Man in the middle attacks need to take care. Layer 4: Data Accumulation The layer-4 of the CISCO architecture deals with data storage and local ltering. We can conclude functionalities of this layer as follow: To store the data that is not going to use in instant processing but may be later on required. To forward stored data as per requirements and queries from the above lay- ers. To convert the data from packets to tables and schemas. To provide conversion from the event-based data generation to query-based data consumption. It also reduces the data through ltering and selective storing. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 7 Chapter 1. Introduction The major security issue in this layer is to protect the stored data from the attack- ers. Layer 5: Data Abstraction The Layer-5 of the CISCO architecture supports in the development of simple and easy to use IoT applications by better rendering and the storage of the data. We can summarize functionalities of this layer as follows: Gathers data from the multiples sources and try to convert it into easy to use format for application developer and user. Performs ltering, selecting, projecting, and reformatting the data to serve the client applications . Provides security to data through appropriate authentication and authoriza- tion Performs normalization and denormalization operations over indexed data in such way that application user can access it in minimal time. Major security requirement of this layer is to provide better authentication, autho- rization and access control. Layer 6: Application The Layer-6 of the CISCO architecture deals with basically two types of appli- cations that are either controlling applications or monitoring applications. Major works carried out by this layer can be summarised as follows: Mobile applications through which user can control the devices or can mon- itor the data. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 8 Chapter 1. Introduction Communicates with the data accumulation and data abstraction layer for receiving the data. Applications that performs critical analytic or received data for processing. The major security challenge in this layer is to deal with identity and authentica- tion of the application users. Layer 7: Collaboration & Processes This layer supports access of huge IoT among many people through better collab- oration and simple business processes. The CISCO presented seven layer architecture based on business processing and applicability of IoT in industry. With this many other organizations and au- thors presented other layered architecture based on different perspective. In 2018, Patel et al. [Patel & Doshi (2018)] presented four layer architecture with the per- spective of device deployment, applications and security issues. Next subsection discusses this architecture and presents security issues at every layer. B Four Layered Architecture Patel et al. [Patel & Doshi (2018)] presented four layered architecture (Fig. 1.2) for the IoT eco-system based on functionalities. 1. Physical Layer / Perception Layer / Object Layer Basic Functionalities of this layer includes, To deploy the sensors, actuators, RFID readers and sensor gateway on the eld. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 9 Chapter 1. Introduction To focus on sensing environment data such as location, temperature, pressure, humidity, motion, air pressure, pollution level and also col- lecting data from humans and machines for certain application. Assigning universally accepted unique identi cation number to each devices. To focus on capability enhancement of various IoT sensors in terms of cost,size,energy consumption,resource,communication and security. To handle scalability and heterogeneity of devices and data, Reliability of communication. Security challenges : Physical security of the deployed devices. Con dentiality and integrity of the data during transmission to above layer. Authentication and access control of the devices. 2. Network Layer / Communication Layer Basic Functionalities of this layer includes, Data collection from the physical or perception layer. Local data processing at fog devices and forwarding data for further processing such as decision making and high level services. Forwarding control signals to the ground level sensors. Performs long distance communication with functionality such as con- necting smart things, network devices, and cloud servers. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 10 Chapter 1. Introduction Taking care of the routing, discovering and mapping dynamically hap- pening changes inside the network and devices topology. Security challenges : Access control and authentication among the networking devices such as fog devices and routers, accountability and non-repudiation of the received and transmitted data, authentication between sen- sor devices and routers. Denial of Service is the major challenge for this layer. if attack- ers successfully deploy ooding attack and results in to denial of service then it can cause complete damage for the sub-system as well as IoT eco-system. PERCEPTION LAYER PHYSICAL LAYER OBJECT LAYER USER LAYER APPLICATION LAYER DATA PROCESSING SERVICE LAYER NETWORK LAYER COMMUNICATION LAYER S E C U R I T Y Figure 1.2. Four Layered Architecture [Patel & Doshi (2018)] 3. Data processing Layer / Service Layer Basic Functionalities of this layer PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 11 Chapter 1. Introduction includes, Data mining and the data processing of the collected data over the cloud are a key functionalities of this layer. This layer works as a key enabler for the IoT applications and services in eco-system. Perform the data analytic, graph generation, solution generation, rec- ommendation generation as per application requirement. Generating control signal, alerts, messages for the application layer users. Performing other service oriented functionalities for application. Availing on demand services on any time required by any one from the any place after performing successful authentication. Security challenges : Data anonymity and data Privacy of the users and devices should be taken care. Auditability of the sensed data. Trust management and con dentiality of the stored data. 4. User Layer / Application Layer Basic Functionalities of this layer includes, To create an ease of use for the users among IoT eco-system. Preparing Many user oriented applications which receives data from the below layers. Taking care of the heterogeneous private and public applications. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 12 Chapter 1. Introduction Domain oriented application designing. Ex, Smart patient tracking system in Health care domains. Security challenges : Con dentiality & Integrity of the data. Signal transmission, authentication & access control between user applications and cloud storage. Privacy of user and device data. In IoT layered architecture, device at every layer need to authenticate it self with the other communicating devices. In, next section, we discusses basics about authentication and different authentication model followed in IoT. 1.3 Remote User Authentication The Remote User Authentication (RUA) is a security technique that creates trust among two communicating parties over an insecure channel through secure and mutually authenticated session key generation. A reliable and ef cient RUA scheme provides a secure session key to both the entities through which they can communicate over an insecure channel in the trusted environment. In 1981, Lamport introduced the rst RUA scheme based on the hash chain and with the password table at the server-side [Lamport (1994)]. An authentication scheme lightened by Lamport provided use registration through identity (ID) and pass- word (PW). Due to certain limitations of password-based schemes such as storing a password table leads to an insider attack and using a password as a uni-factor may lead to of ine and online password guessing attack. Thus, in 1993, Chang et PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 13 Chapter 1. Introduction al. [Chang & Hwang (1993)] introduced a rst SC based authentication scheme. In the SC based authentication schemes, the user keeps a SC generated by the service provider as another security feature. The SC is a microprocessor device or chip that has secure memory and public memory, and it stores user data and secret parameters [Chang & Hwang (1993)]. In 1976, Dif e et al. introduced the discrete logarithm based information- sharing mechanism [Dif e & Hellman (1976)]. Rivest et al. [Rivest et al. (1978)] and Elgamal et al. [Elgamal (1985)] proposed a secured encryption mechanism in 1978 and 1985, respectively. Till today, many researchers have worked on that and proposed RUA schemes. But the critical challenge is designing an authentication scheme without any vulnerabilities. In 2004, Das et al. [Das et al. (2004)] pro- posed rst dynamic identity based authentication scheme for the sensor network and generated path for other dimension of authentications. Due to several attacks such as SC stolen and power analysis, researchers introduced biometric-based authentication schemes. They created a path for the multi factor authentication, which was followed by OTP based authentication, token-based authentication, and so on. Cryptography mathematics is the complex mathematics for computations, as well as implementations. With the run-up towards smart technology, the need for lightweight cryptography came in the picture. The reason behind this need is the use of numerous resource constraint devices in the deployment of sensor-based IoT application deployments. These resource constraint devices are short of com- putation memory and storage capability. For these devices, it is nearly impossible for them to perform sixteen rounds of DES and exponential computations of RSA promptly and without energy utilization. Thus, in 2006, Hankerson et al. [Hanker- PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 14 Chapter 1. Introduction son et al. (2006)] highlighted ECC, which is much lighter than traditional crypto methods in computations and storage requirements [Hankerson et al. (2006)]. The ECC became a well-known cryptographic technique due to its attractive features like smaller key size, lower time-requirements, and fewer resource utilization. The ECDHE provides a lighter version of Dif e-Hellman with ECDLP. A Authentication Models in IoT The Authentication model in IoT can be divided in to two parts. User - Gateway based Model The User - Gateway based authentication model (Fig. 1.3) involves authentication between IoT application user and near by IoT device that receives data from the various sensors. We can consider following use-cases for this model. Authentica- tion between: Smart home owner and home gateway Smart grid user and smart meter Doctor and healthcare gateway Industry owner and factory gateway so on .. This model basically considers sensing devices as a very lightweight and resource constraint devices those are not capable to perform any crypto operation and have ability to just sense the data and transmit the data. In this model, the application PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 15 Chapter 1. Introduction Figure 1.3. User - Gateway Authentication Model user receives real-time live data after the successful authentication between it and the near by gateway device. The gateway device in this model is a resource ca- pable device and can perform complex cryptography operations. The chapter 3 of this thesis, proposes lightweight and resource ef cient authentication scheme compare to existing schemes based on this model. User - Gateway - Sensor based Model This model is highly used and adopted in IoT authentication in which all the three entities : the system user, intermediary gateway device and the sensors are in- volved in authentication. In this model, after the successful authentication and session key generation, the system user can directly receive a data from the sensor device using key. This authentication model further involves a cluster head device that is either raspberry pi or other little resource capable device compare to sens- PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 16 Chapter 1. Introduction ing devices. The authentication between these entities can be designed based on CH GWN USER CH GWN USER CH GWN USER CH GWN USER CH GWN USER CH GWN USER CH FGWN USER CH USER A B E F C D G H 1 1 1 1 1 1 1 4 2 3 2 3 2 3 6 4 5 3 5 4 6 2 7 1 2 3 4 2 3 HGWN 2 3 4 5 6 7 8 HGWN FGWN 2 3 4 5 Figure 1.4. User - Gateway - Sensor Authentication Model system requirements and design using one of the eight approaches shown in Fig. 1.4. There can be multiple gateway also possible in that scenario authentication steps involves home gateway as well as foreign gateway. This model considers only a gateway device as a resource capable device and fully trusted device while other two devices are considered as a lightweight devices and need resource opti- mization in terms of crypto operations. Chapters 4, 5 and 6 presents authentication scheme based on this network model. IoT suffers from many other security issues parallel to authentication. In next section, we discuss other security issues available in IoT communication. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 17 Chapter 1. Introduction 1.4 Security Issues In this section, we discuss eight security parameters that must be satisfy during designing of any secured eco-system [Patel & Doshi (2019)]. The security oc- tagon shown in Fig. 1.5 presents these eight parameters 1. Con dentiality: Con dentiality can be de ned as a hiding of information from the person or device who is not authorized to read it . In the IoT, devices collect the various sensitive information from the users. In the smart health care, medical devices collect the personal information such as heart bit-rate, pulse information, body tempera- ture. In the smart home, person location, identity and other details such as availability can be tracked. Thus, all this information must be con dentially transmit from the sensing devices to the cloud storage / application. Con dentiality can be achieved using various symmetric and asym- metric encryption algorithms such as RSA and DES. In the resource constraint environment, some lightweight algorithms such as ECC can be useful for authentication and encryption. 2. Integrity: Integrity can be de ned as a preventing unauthorized user/device from modifying single bit of the data during transmission . PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 18 Chapter 1. Introduction IOT SECURITY Octagon NON REPUDIATION CONFIDENTIALITY INTEGRITY AVAILABILITY TRUST & PRIVACY ACCESS CONTROL & AUTHENTICATION ACCOUNTABILITY AUDITABILITY Figure 1.5. Security Heptagon [Patel & Doshi (2019)] In the IoT, integrity concerns becomes critical when it comes to mod- i cation of the information. For example, modi cation in SPO2 level can damage functionalities of automated oxygen supply system. Thus, change in single bit can change the outcome of complete system who are working based on True or False and Yes or No . Better integrity management can also support in smooth functioning of the nancial transactions as well as industrial functioning. Integrity in the security can be assured using numerous veri cation methods such as checksum or one way hash function algorithms like SHA-1, SHA-256. 3. Availability: PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 19 Chapter 1. Introduction Availability can be de ned as a all the services running in the com- plete system must be available at any time to any authenticated enti- ties . In the IoT, availability plays an important role in terms of resources availability or data availability when ever it is requires. The smart grid should control the power system in such a way that whenever user requires high power voltage, he/she gets it. Smart home user must get on time camera videos to verify the on gate guest. In the auto- mated payment system, smart retails system must ensures the working of payment gateway when ever required. The biggest threat to availability is Denial of Service attack or Dis- tributed Denial of Service attack. Availability in the security can be assured using parallel resource avail- ability through the development of distributed system and authenti- cated accesses. 4. Trust and Privacy: Trust management in the IoT can be de ned as a trust in the IoT en- sures that peoples and devices involved in IoT system accepts the ser- vices and information with the full faith. In the IoT, Trust management involves reliable data collection, reliable data fusion and mining with enhanced user privacy. Successful trust creation in the IoT ensures identity of the users/devices and quality of the IoT Services. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 20 Chapter 1. Introduction Trust management involves behavior based trust control, reputation based trust control, and fuzzy approach for trust based access control. Some of the parameters that are used for the calculation of trust are fre- quency of answers, consistency of answer, physical proximity, com- mon goals, common eco-system, history of interaction, availability, and common communities. Privacy in the IoT can be de ned as a not a single bit of informa- tion collected from the person/device get relive with any one without the knowledge of the person/device . Privacy preserving can be as- sured using various attribute based and anonymity based encryption algorithms. In the IoT, Most of the sensors those are part of public services gathers huge personal information. Hence, to whom this personal information should be shared, must be decided/known by the person himself. 5. Authentication and Access control: Authentication can be de ned as a both the communicating parties are sure that they are communicating with the authenticated valid counter part . Successful authentication mechanism supports many other prop- erties such as con dentiality, integrity and the availability. Ensuring authentication in the IoT becomes critical due to heterogene- ity in the number of devices and types of devices involved in the IoT. Each device transmitting data or want access of the data from other device must pass through authentication. Each user who want an ac- PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 21 Chapter 1. Introduction cess of data from the sensing devices via gateway need to authenticate him self with the sensing device. Authentication in the IoT requires lightweight algorithms due to re- source constraint environment of eco-system. Lightweight cryptogra- phy based on ECC and other methods provides solution for this chal- lenge. Access control means only authenticated users/devices have access of other device or personal data and control . In the IoT eco-system, access control schemes can be divided based on arbitrary access control, mandatory access control, and role based access control. 6. Accountability: Accountability in the IoT means Who has generated data and who have processed those data must be clearly de ned and are account- able for those data. Accountability assures that which device has generated which data and which device processed which data in the IoT eco-system. It is an ability to hold users or devices responsible for their actions. Accountability can be assured using proper identi cation mechanism for devices. Most of the devices in the ground level communicate using RFID technology or NFC technology, while edge level devices get IPv6 based IP Address as an identity for tracing. 7. Auditability: PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 22 Chapter 1. Introduction Paper Security challenges Atzori et al. (2010) Authentication, Data integrity, MITM attack, Sensor data protection, Key agreement, Secure cloud computing, Privacy and protection Miorandi et al. (2012) Data con dentiality, Device identity management, User identity man- agement, Integrity of data, Accountability, Authentication, Access control Borgia (2014) Secure boot strapping of object, Secure transmissions, IoT data secu- rity, Authentication and authorization, Auditability, Access control Jing et al. (2014) RFID protocol security, RFID authentication, Key management, De- signing lightweight solutions, handling massive heterogeneity, Access control, Node trust management Granjal et al. (2015) Con dentiality, Integrity, Trust, Authentication, Access control Gil et al. (2016) Privacy, Integrity, Access control, Trust, Identi cation, Authentication Maple (2017) Con dentiality, Integrity, Availability, Authentication, Non-reputation TABLE 1.1 IoT Security Related Surveys Auditability can be de ned as a we must be able to perform consistent monitoring for the occurrence of each event in the system . In the IoT, for the ground level device actions can be monitored by keeping various snif ng tools such as wireshark at fog devices or data collecting devices. 8. Non repudiation: Non repudiation in authentication can be de ned as a any participat- ing entity can not deny that the message sent by it is not generated by it . Non repudiation assures integrity and origin of message. In this section, we have gone through various security challenges faced by IoT PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 23 Chapter 1. Introduction eco-systems. The Table 1.1 presents survey papers related to IoT security and challenges discussed in those papers. The Table 1.1 presents that authentication is a key security challenge in IoT eco-system. The IoT eco-system consists of numerous applications and every applications faces different security challenges based on its functionalities. The next section provides overview on different IoT applications and related challenges face by them. 1.5 Applications There are numerous applications of an IoT eco-system. Fig. 1.6 presents major IoT applications. A Smart Home The SH connects various home appliances and objects with the central cloud server through the Smart Home Gateway. The home appliances such as refrigera- tor, air-conditioning, television, door-security system, washing machine, environ- ment controller, music system, CCTV camera, computer systems, Mobile devices, tablet devices, smart meters can be considered as an data generator in smart home. The short range communication protocols such as radio waves, power lines, wi , zigbee, bluetooth, RFID and NFC are the basic communication protocols used in home automation. The smart home gateway receives data from the appliances and forward those data for further processing and monitoring. The smart home net- work can be integrated with other IoT applications such as smart grid, intelligent water and gas supply and so on. The smart home system suffers from numer- ous security challenges. The location information or light usage data reveal can PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 24 Chapter 1. Introduction leak the information about home owner presence inside or not. Thus, privacy and authentication between devices and user must be taken care appropriate access control mechanism. Chapter 4 presents an authentication scheme between user and smart meter through smart home gateway for smart home energy monitoring. B Smart Grid The SG is a network of devices those interconnects energy producer and energy consumer. The fundamental objective of the smart grid network is ef cient en- ergy generation, reliable energy and data transmission and sustainable energy con- sumption. The smart grid must provide smooth operational control, ef cient fault tolerant and reliable load balancing based on two way energy generation. The smart meter is a device that collects the data related to energy consumption at every unit time and transmits these data to the billing and monitoring server for the further processing. The smart grid user (or energy consumer) can also con- trol the load and do the real time monitoring for its energy consumption data. The smart grid system with its sustainable objectives tries to integrate traditional energy sources with the renewable energy sources to touch a united nation s sus- tainable development goals xed to be achieve by 2030. The con dentiality and integrity of the consumption data, availability of the uninterrupted service are the major challenges in terms of security in the smart grid. If the polynomial time adversary can change the consumption data or the required energy data then it can damage the complete grid system. Hence, the authentication and the identi - cation of devices and users becomes key security requirement for the smart grid network. Chapter 3 presents an authentication scheme between user and smart PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 25 Chapter 1. Introduction gateway that can be used for secure communication between user and the smart meter or between smart meter and the near by gateway users. C Smart Industry The SI or Industrial Internet of Things (IIoT) or industry 4.0 are the common names those aims to revolutionize the industrial production system with the ob- jective of reducing human intervention. The industry 4.0 aims to connect all the industrial aspects from row material mining to nal product distribution and that requires reliable and sustainable automation, communication and monitoring. The industry 4.0 aims to connect all the industries such as agriculture, manufacturing, aviation, chemical, steel, cement and so many more. The industry 4.0 system suf- fers from many social, economical, political and organizational challenges. The major security challenges in industry 4.0 to secure the data sensed by numerous sensors from the unauthorised entities and maintaining integrity of the data with the taking care privacy of customers. Chapter 5 and 6 presents an authentication scheme between user, gateway and sensing devices which is applicable to most of the smart industry in which industry owner or employee want to receive live data from the sensing devices based on allowed accesses. D Smart Healthcare The SHe connects healthcare entities such as doctors, patients, nurses, remote doctors, ambulances, local hospitals, remote hospitals, mobile hospitals, medical suppliers, health insurance companies and health care researchers. The recent re- port published by a global rm Research and Market predicts that the healthcare PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 26 Chapter 1. Introduction Smart Vehicular System Industry 4.0 Smart Healthcare Smart Grid IoT Applications Smart Home Smart Agriculture Figure 1.6. IoT Applications market based on IT services and ICT infrastructure may reach from USD 187.6bil- lion in 2019 to USD 390.7 billion by 2024. In 2021, still, there are many remote places in the world where achieving a good healthcare is a dream. In the smart healthcare system, doctors can do the realtime health monitoring of the patient and medicine intake through the wearable devices. The doctors can also get the information about past medical and medicine history of the patient through med- ical data processing. The major security challenge in the smart healthcare is to protect the health history of the data from the intruders. The data generated by the patient must be accessed by only authenticated doctors and hospitals. Hence, pri- vacy and security are the key challenges those are required to handle in the smart healthcare. Chapter 5 and 6 presents an authentication scheme between user, gate- way and sensing devices which is also applicable to healthcare industry in which doctor want to do realtime health monitoring of their patients. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 27 Chapter 1. Introduction E Smart Transportation System The STS or Intelligent Transport System (ITS) is a set of road infrastructure, on road vehicles, air network, rail-way network, water transportation, planes, trains, and cruises. The basic objective of the smart transportation is to provide ef cient, reliable and secure transport system with the dynamic navigation system to the people. The smart transportation includes GPS tracking, nding shortest route, identifying cheaper public transport, electric vehicles, accident monitoring and infrastructure for electric vehicles as a back-end tools. The smart transportation system handles vehicle to vehicle communication, vehicle to on road unit commu- nication, vehicle to user communication, vehicle to road infrastructure communi- cation and vehicle to cloud communication system. These all the communication need to be secured through better authentication between devices/units/users to achieve secure smart transportation system. Chapter 3 presents an authentication scheme between user and gateway devices that is applicable to smart transporta- tion also where car owner sends data to near by STS gateway after successful authentication between them. The fully secured authentication between devices and users in IoT eco- system can solve many related security challenges. This thesis focuses on design- ing authentication protocols between user device - gateway device and user device - gateway device - sensor device. The next section discusses major research gaps, objectives and contributions followed by thesis preview. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 28 Chapter 1. Introduction 1.6 Research gaps and contributions Research gaps presents the existing problems available in the related eld. Fol- lowing research gaps were identi ed. Existing authentication schemes between user and gateway devices were not suitable for IoT environment because of high computation and commu- nication costs. Exiting authentication schemes for IoT devices are not fully secured against well known security attacks and there is a need to protect an applications such as smart home and energy monitoring. In all, exiting authentication schemes, user need to register for each sensing devices that is ideally not applicable in realtime environment where thou- sands of devices are deployed. There is a need to design an authentication scheme that reduces registrations also. Existing authentication schemes are mostly based on simulation rather than realtime deployment of devices and run time authentication based imple- mentations. Next, we discuss major contributions of this thesis. Provide detailed literature review for existing authentication schemes for IoT communication and show the existing challenges. Propose novel and ef cient authentication schemes for the U-GW (Chapter 3) and U-GW-S (Chapter 4) network model using ECC. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 29 Chapter 1. Introduction Propose novel concept of level dependent authentication scheme (Chapter 5 and 6) using an ECC for the hierarchy oriented IoT communication. Provide security analysis for the proposed scheme using Dolev-Yao chan- nel, ROR Model and BAN Logic (Chapter 3, 4, 5, 6). Provide comparative analysis for the proposed scheme with existing schemes based on communication cost and computation cost. Provide implementation using a realtime IoT test-beds. 1.7 Thesis Preview In Chapter 2, we provide a conceptual understanding of the basic preliminaries used for designing and analysis of the proposed schemes. In this chapter, we provide a mathematical knowledge for ECC and Hash function. We also offer three security models that are used for security analysis of the proposed schemes. We discuss the Dolev-Yao model used for informal security analysis, and random oracle based ROR model for formal oracle security analysis and BAN logic for mutual authentication veri cation. In chapter 3, we discuss the authentication scheme proposed for user-gateway based network model. This chapter provides a threat model, proposed scheme, se- curity analysis using the Dolev-Yao model, ROR model and mutual authentication using BAN Logic. In this chapter, we also provide a comparative analysis of the proposed scheme with existing schemes based on communication cost, compu- tation cost and networking parameters. The comparative analysis is followed by testbed design and implementation of the proposed scheme that is followed by a PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 30 Chapter 1. Introduction conclusion and future work. In this chapter, we also provide applicability of the proposed scheme for the different IoT applications. In chapter 4, we discuss the authentication scheme proposed for user-gateway- sensor based network model. This chapter provides a threat model, proposed scheme, security analysis using the Dolev-Yao model, ROR model and mutual authentication using BAN Logic. In this chapter, we also provide a comparative analysis of the proposed scheme with existing schemes based on communication cost, computation cost and networking parameters. The comparative analysis is followed by testbed design and implementation of the proposed scheme that is followed by a conclusion and future work. In this chapter, we also provide appli- cability of the proposed scheme for the different IoT applications with an example of smart home energy monitoring. In chapter 5, we propose a novel concept of LDA. We start this chapter with an introduction to LDA and its conceptual discussion. We offer an LDA authen- tication scheme using ECC, password, and SC. We provide a security analysis using the Dolev-Yao model, ROR model and mutual authentication using BAN Logic. In this chapter, we also provide a comparative analysis of the proposed LDA scheme with existing schemes based on communication cost, computation cost and networking parameters. The comparative analysis is followed by testbed design and implementation of the proposed scheme that is followed by a summary of the chapter. In chapter 6, we propose a novel concept of LDA using three factor based key exchange. We start this chapter with an introduction to LDA and its conceptual discussion. We offer an LDA authentication scheme using ECC, password, SC, and biometric. We provide a security analysis using the Dolev-Yao model, ROR PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 31 Chapter 1. Introduction model and mutual authentication using BAN Logic. In this chapter, we also pro- vide a comparative analysis of the proposed LDA scheme with existing schemes based on communication cost, computation cost and networking parameters. The comparative analysis is followed by testbed design and implementation of the pro- posed scheme that is followed by a summary of this chapter. In chapter 7, we provide comprehensive conclusion for complete thesis and provide a future scope related to this thesis. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 32 Chapter 2 Fundamental Preliminaries This chapter discusses fundamental preliminaries used in this thesis. Section 2.1 of this chapter provides basics about ECC. Next section 2.2 provides overview on hash function and its properties. Furthermore, section 2.3 presents fuzzy ex- tractor that is used in designing of biometric based authentication schemes. Next Section 2.4 provides discussion about security models which are used for security analysis of the proposed schemes in this thesis. Section 2.4 provides introductory discussion about ROR model (subsection A) and BAN Logic (subsection B). At last, section 2.5 summarise this chapter. 2.1 Elliptic Curve Cryptography An ECC was proposed by Miller [Miller (1986)] and Koblitz [Koblitz (1987)] in 1986 and 1987 respectively. An ECC provides equal security to other public key crypto systems such as RSA with smaller key sizes. Following Table 2.1 shows that 160 bit key of an ECC can provide equal security to 1024 bit key of RSA 33 Chapter 2. Fundamental Preliminaries ECC Key Size (bits) Equivalent RSA Key Size (bits) 160 1024 224 2048 256 3072 384 7680 521 15360 TABLE 2.1 RSA vs ECC algorithm. The properties such as lower key size and low computational require- ments made an ECC as a key player in designing of lightweight cryptography. We de ne an elliptic curve as an algebraic equation with non-repeatable roots: Y 2 = (X3 +aX +b) mod n (2.1) A curve can be de ned over a nite eld or binary eld F of order n in the form E(F). In the above equation, two curve points are X and Y, which can be repre- sented as P(X, Y). a,b Fn are two constants their value must achieve, 4a3 +27b2 = 0 (2.2) The elliptic curve performs two signi cant operations, point addition, and scalar point doubling. During implementation, we use the ECC s double and add method to perform a scalar multiplication between the sizeable random number and the curve point. We use a scalar point multiplication operation for the public key gen- eration, that is computed as n P = P +...+ P for n times. An Elliptic curve point multiplication provides very high secrecy, and even if an adversary has n P and P, he can not extract the value of n in polynomial time. In ECC based authentica- PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 34 Chapter 2. Fundamental Preliminaries tion, devices generate the random number to use it as a secret key or private key that belongs to Z p, where Z p ranges between {1,2,3....,p-1}. We considered that selected value of random number is neither 1 nor p-1 but ranges between these two to avoid known value type attack from adversary. A ECC Encryption and Decryption ECC Encryption: The ECC encryption invokes an encoding for the message m in to the curve point Pm. For any random private key Kx generated by the user Ux, the relative public key KPx = Kx * Gp, where Gp is any group point on the elliptic curve. To encrypt the Pm, user Ux selects the random number k and computes Cm = (k*Gp, Pm + k * KPy) where KPy is a public key of the receiver Uy. User Ux sends Cm to Uy over a public channel. ECC Decryption: The ECC decryption invokes a computation for the Pm = Pm + k * (Ky * Gp) - (Ky*(k*Gp)) where Ky is Y s private key. The advantage of adversary A in computing k from the k*Gp can be de ned as, AdvDec A (et) = Pr[Rand(k, Gp), A: x] where AdvDec A (et) , for any > 0 and randomly generated pair (k, Gp) with execution time et in such a way that x = k*Gp. B ECC Computational Problems Elliptic Curve based Discrete Logarithm Problem (ECDLP) can be de ned as: For given large prime number p and curve parameters a and b (De ned above), the generator point Gp(Xp,Yp) Ep(a,b) where Ep(a,b) denotes the valid group of points on curve. For any generated random number Ri and computed Ni = Ri * Gp mod p, an adversary advantage probability for A related to the ECDLP in nding PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 35 Chapter 2. Fundamental Preliminaries Ri based on given Ni and Gp de ned by AdvECDLPA(et1) = Pr[Rand(Ri)A : Ni = Ri * Gp] where AdvECDLPA(et1) for any > 0 and Rand (Ri) implies that Ri is randomly generated by the adversary A within execution time et1. The ( ,et1) gives that an adversary A breaking the ECDLP such that AdvECDLPA(et1) with the maximum execution time et1. Elliptic Curve based Dif e Hellman Problem (ECDHP) can be de ned as : An ECDHP uses pair of public key and private key to generate a shared session key. Given a large prime number p and curve parameters a and b (De ned above), the generator point Gp(Xp,Yp) Ep(a,b) where Ep(a,b) denotes the valid group of points on curve. For any generated random numbers Ri and Rj, compute Ni = Ri * Gp mod p and Nj = R j * Gp. For given value of Ni and Nj, it is computa- tionally infeasible to compute Ri*Rj*Gp. An adversary s advantage probability for A related to the ECDHP in computing Ri*Rj*Gp for given Ni and Nj de ned by AdvECDHPA(et1) = Pr[A : = Ri*R j*Gp] where AdvECDHPA(et1) for any > 0 and Rand (Ri) and (R j) implies that they are randomly generated by the adversary A within the execution time et1. The ( ,et1) gives that an adver- sary A breaking the ECDHP such that AdvECDHPA(et1) with the maximum execution time et1. Authors in [Patel & Doshi (2019)] have given detailed expla- nation about ECC including point multiplication, point addition, point doubling and so on. For implementation of our proposed schemes, we have used NIST recommended p-256 curve. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 36 Chapter 2. Fundamental Preliminaries 2.2 Hash Function A cryptographic hash function H can be de ned as H : {0,1} {0,1}n. A func- tion H takes and random length binary string s {0,1} as input and generates a speci c size binary string B {0,1}n as a product. H is a subordinate function used for the various cryptographic purposes like a key exchange, digital signa- ture, authentication, random number generation, and many other cryptographic protocol developments. Every cryptographic hash function must satisfy proper- ties such as pre-image resistant or one-way property, second pre-image resistant or weak collision property, xed-size output, variable size input, ef ciency, and randomness, collision-resistant or strong collision property [Stallings (2010)]: 1 Variable Size Input: Accepts variable size input. 2 Ef ciency and randomness: It is near to impossible to generate same hash value or hash value in sequence.It will be completely random. 3 Pre-image Resistant or one-way property: If M is the input and hash value h = H(M), then it is infeasible to nd h = h where h = H(N). 4 Fixed Size Output: Out put size will be x for same hash function and can be very for different hash functions. 5 Second Pre-image Resistant or Weak Collision Property: For any give M if h = H(M) then it is computationally infeasible for third party attacker to nd N = M where H(N) = H(M). This property protects against an attacker who knows input and its hash output, and wants to substitute other value as legitimate value in lieu of original. Hence, it achieves one degree of freedom. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 37 Chapter 2. Fundamental Preliminaries 6 Collision Resistant or Strong Collision Property: It is computationally in- feasible for user itself to nd pair of two values by M = M such that it returns H(M) = H(M ). This property ensures that it is very dif cult for user to nd two input values with the same hash hence it achieves two degree of freedom. If hash is collision resistant then it is also second pre-image resistant. For given n-bit hash value, it needs 2n operations to get a weak collision and n 80 is suf cient size for weak collision. For strong collision, it requires 2n/2 opera- tions to get a strong collision using the third birthday attack (birthday paradox) and it needs n 160 for to achieve strong collision resistance. There exists many cryp- tography hash functions. We can divide those functions based on either they are keyed hash function or unkeyed hash function. i.e. BLAKE2, BLAKE3, HMAC are examples of keyed hash functions while MD series, SHA series hash functions are examples of unkeyed hash function. In this thesis, SHA1 and SHA256 hash functions are used to compute hash values. 2.3 Fuzzy Extractor A biometric-based security mechanism was adopted since long back due to the proven weak security mechanism of identity and password-based authentication. In biometric-based authentication, the user uses a nger-print or retina as a unique biometric input for veri cation. The security of stored biometric templates is a critical challenge in biometric-based security. A noisy nature of biometric does not suit the hash-based processing. Thus, in 2004, Dodis et al. Dodis et al. (2004) proposed a fuzzy extractor, which becomes a widely accepted biometric template protection mechanism. We consider following notations, PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 38 Chapter 2. Fundamental Preliminaries M is a metric space with the distance function Dis: M * M R+ = [0, ]. The measurement of an error is occurred through hamming dis- tance. L denotes length of biometric secret key. T denotes threshold value for error tolerance. Tuple (Bi,Ri,Pi) where Bi is a biometric for the ith user, Ri is extracted ran- dom string de ned as a Ri 0,1L, Pi is a public auxiliary string for the Bi. Fuzzy Extractor is equipped with two algorithms called a a Gen() and Rep(). It can extract any random string from the given biometric template of a user i as input and produce the same random string even for the different biometric template from the same user i from the same trait. Gen() : Generation function is a uni-input and bio-output function that uses probabilistic generation procedure. It is de ned as, Gen(Bi) = (Ri,Pi). Over here Ri is a secret string while Pi is a public string. Rep() : Reproduction function is a bio-input and uni-output function that uses deterministic reproduction procedure. It is de ned as, Rep(B i, Pi) = (Ri). Over here, B i is a biometric template for same user i but obvious it will not be the same as Bi, thus it satis es hamming distance Hd(Bi,B i) T . if (Bi,B i) belongs to the same user then the distance between Bi and B i will be low with high probability, Pr[Hd(Bi,B i) < T ] 1 - fn where fn is false negative . PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 39 Chapter 2. Fundamental Preliminaries if (Bi,B i) belongs to different user then the distance between Bi and B i will be high with low probability, Pr[Hd(Bi,B i) > T ] 1 - f p where fp is false positive and T > T . 2.4 Security Models A ROR Model In 2005, Abdalla et al. [Abdalla & Pointcheval (2005)] proposed the RealOr Ran- dom (ROR) model, which helps security designers to prove that the proposed password based scheme achieves polynomial-time security against an adversary A s advantage of breaking the security. a. Random Oracle: The random oracle de ned as a H(.) also called as a hash function which takes message mi as a input and computes the one-way irre- versible output ri. Whenever an adversary A generates a challenge with mi, random oracle challenger C computes ri = H(mi) and stores it in the list L initialized with NULL value as a pair of (mi, ri). b. Oracle Participants: There are three participants in the proposed LDA-GIoT scheme, The user Ui, the gateway device GW, and the sensing device S j. c. Oracles: p Ui, q GW, and r S j are oracles with the instances p, q and r for the Ui, GW and Sj respectively, which are also called as a participants for the protocol LDA P. d. Oracle Freshness If using the reveal query R( x), an adversary A does not get success in receiving original session key SK then the oracles, p Ui, q GW, PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 40 Chapter 2. Fundamental Preliminaries and r Sj are considered as a fresh oracles. e. Oracles Partnering: Oracle instances x and y are called partner oracles if and only if they ful ll the following criteria simultaneously: Both instances x and y are in the acceptance state. Both x and y share the common session id sid and achieve the mu- tual authentication. sid is transcript of all the communicated messages between oracles. Both x and y satisfy the partner identi cation and vice-versa. No instance other than x and y accept with the partner identi cation equal to x and y. f. Adversary: Let us assume that an adversary A is an eavesdropper who con- trols the complete communication channel de ned over the Dolev-Yao model Dolev & Yao (1981). An adversary A can read, modify, inject, or fabricate the messages on the communication channel for the proposed network model. An adversary A has access for the following random oracle queries, which gives numerous capabilities to A for capturing and modifying the communicated messages and data. 1. R ( x) The Reveal query R provides current session key SK to the adver- sary A which is created by oracle instance x and it s partnering instance. 2. E ( x, y) The Execute query is formed as a passive attack on the commu- nication between oracle participants x and y. This query provides all communicated messages to the adversary A. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 41 Chapter 2. Fundamental Preliminaries 3. S ( x,mi) The Send query is formed as an active attack performed by A on instance x where x can receive the message mi as well as send the reply as a message mi to A. 4. CorruptUserDevice( x) The CorruptUserDevice query models that the user Ui s device is available with A and A can capture all the data stored in it. 5. CorruptSensingDevice ( y) The CorruptSensingDevice query models that the sensing device S j is available with A and A can capture all the data stored in it using power analysis or reverse engineering attack Messerges et al. (1999); Kocher et al. (1999). 6. CorruptUserLevel ( x) The CorruptUserLevel query models that the level of user Ui is available with an adversary A. 7. CorruptSensingLevel ( y) The CorruptSensingLevel query models that the level of sensing device S j is available with an adversary A. 8. T ( x) Before starting of this oracle game, an unbiased coin b get tossed. The output of this toss decides the return value for the Test query T . If the recently generated session key between the user Ui and the sensing device S j is SK and an adversary A performs the test query on an instance p which is the instance of Ui or its partner instance r which is an instance of S j then if the toss output is b = 1 then the participant instance x returns an original session key. In contrast, if the output is b = 0, then the x returns a random value of the session key SK s size to an adversary A. If none of the condition matches, then an instance x returns NULL. The semantic security of the session key is designed based on the Test query. g. Session key symmetric security: The semantic security of the session key SK PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 42 Chapter 2. Fundamental Preliminaries generated between the user Ui and the sensing device Sj depends on an adver- sary A s capability of indistinguishability between the actual session key and the random number. The output of a test query T depends on the value of b guessed by an adversary A. If the value of b is similar to the value of b which is a hidden bit set by an oracle instance x and used by T ( x) to retrieve the original session key. Overall, the game depends on the correct guess by A for the bit b. If an adversary guesses the correct value of b, then it gets the correct session key. Let SC de ne the position in which an adversary gets the success in this game. The advantage of an adversary A in capturing the correct session key SK for the proposed protocol LDAP is de ned as a AdvLDA p . AdvLDA p represents the success of an adversary, and if the AdvLDA p is negligible, then we can say that the proposed scheme is secured under the ROR model. Thus, we can de- ne AdvLDA p as AdvLDA p (A) = 2*Pr[SC] - 1 which is similar to AdvLDA p (A) = 2*Pr[b = b] - 1. Where Pr[SC] represents the probability for the success of an adversary A. If we can prove that the AdvLDA p is negligible under the proposed scheme LDAP, then we can say that the proposed scheme is secure. Semantic Security for the Password based protocol: The semantic security for the password based protocol LDA Ppw de nes an adversary A s capability of guessing the correct password. A password based protocol LDA Ppw is semantically secure if the advantage function AdvLDA Ppw is negligible under the condition: AdvLDA Ppw,|D|(A) max(qs, ( 1 |DS|, f p)). In this equation, qs represents the number of send queries(S), |DS| shows the nite size of the password dictionary, f p shows probability of the false positive occurrence by PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 43 Chapter 2. Fundamental Preliminaries an adversary A. B BAN Logic The BAN Logic is a tool that operates based on the proportional logic and is a widely accepted tool to prove the mutual authentication property of the authenti- cation scheme [Burrows et al. (1989)]. Notations In this subsection, we de nes basic notations used during proof of authentication. A | X : Principal A believes that the statement X is true. A X : Principal A receives Message X. A can see this message and can operate on it. A can also send it to other principals. A | X : Principal A once said message X, either now or sometime in the past, but it is true that A believes message X. A X : Principal A has jurisdiction over statement X and all principals can trust A for the statement X. #(X) : Message X is a recent message and the same message not sent in the past at any time of communication. X Y : The statement X is combined with the Y; thus, any principal say Y, then it will provide the identity of whoever says X Y. Therefore, Y can be used as proof of the origin of X. {X}k : Statement X is encrypted using key k. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 44 Chapter 2. Fundamental Preliminaries A k B : Key k is shared between principals A and B. K7 A : key K is public key of principal A. A ks B : Ks is secret, which is only known by principals A and B. Either any one principal use this secret ks to prove their identity to each other. Inference Rules In this subsection, we provide basic inference rules; using those rules, we derive certain properties like freshness and belief for authentication proof. R1. Message Meaning Rule, that says that if A receives message X that is en- crypted by key K and the key is shared only with B then a message sent by B. A| A K B,A {X}K A| B| X R2. Nonce veri cation rule is used to prove that the message X is recent message and sender still believes on it. A| #(X),A| B| X A| B| X R3. Jurisdiction rule says that if A believes that B has jurisdiction over X then A trusts B on the correctness of message X. A| Q X,A| B| X A| X R4. Seeing rule says that if message X is encrypted by shared key K then both, A and B can see X. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 45 Chapter 2. Fundamental Preliminaries A| B K A,A {X}K A X R5. Seeing rule say that if A believes that K is a public key of B and X is en- crypted by relative private key then A can see the message X. A| K7 B,A {X}K 1 A X R6. Seeing rule say that if A see (X,Y) then A sees X or A sees Y. A (X,Y) A X R7. Fresh rule says that if one part of formula (say X) is fresh, it means that entire formula is fresh. A| #(X) A| #(X,Y) R8. Sensor belief rule says that sensor believes on messages send by the user via gateway. GWN| User| X,Sensor| GWN| X Sensor| User| X R9. User belief rule says that user believes on messages send by the sensor via a gateway device. GWN| Sensor| X,User| GWN| X User| Sensor| X PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 46 Chapter 2. Fundamental Preliminaries 2.5 Conclusion In this chapter, basic preliminaries used for designing and analysis of the authen- tication schemes are discussed. This chapter discusses basics cryptography func- tions such as ECC, hash function, and fuzzy extractors as well as provides an overview on security analysis tools such as ROR model and BAN Logic. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 47 Chapter 3 Secure Lightweight Key Exchange for User - Gateway Paradigm This chapter proposes an authentication scheme between user device and the gateway device. Section 3.1 presents introduction for the user-gateway model and proposed work. Section 3.2 provides literature review related to proposed scheme. Section 3.3 highlights threat model considered for designing authenti- cation scheme. Section 3.4 presents proposed authentication scheme with all the phases. Section 3.5 put forward security analysis for the proposed scheme. sec- tion 3.6 provides implementation aspects and use cases related to proposed work. section 3.7 presents performance comparison of the proposed work with other ex- isting schemes based on communication cost and computation cost. Section 3.8 summarise this chapter with the limitations those are resolved in next chapter. 1C. Patel and N. Doshi, Secure Lightweight Key Exchange Using ECC for User-Gateway Paradigm , in IEEE Transactions on Computers, doi: 10.1109/TC.2020.3026027. 48 Chapter 3. Secure Lightweight Key Exchange for User - Gateway Paradigm 3.1 Introduction IoT communication includes three tier horizontal message transmission. The Tier one consists network of deployed tiny sensing devices, tier two consists interme- diary devices like gateways, intelligent switches, servers, and so on. Tier three consists users of an IoT application. The sensor network provides a live data col- lection with the intelligent forwarding through edge devices to the cloud or to the server for storage and further processing. IoT also plays a signi cant role in in- dustrial applications such as industrial monitoring, industrial data collection and analysis, product modeling, disaster prediction, medical applications, smart city design, and modeling. In the user-gateway model (discussed in subsection A of section 1.3), the gateway device is lightweight (compared with the server) like raspberry pi and nodemcu. Thus, it is not elementary to get a quick response from the gateway device if we use conventional cryptographic approaches. In the proposed work, we consider generalized sensor-based IoT networks where sensors are tiny de- vices. The sensing devices in the proposed model collect data and publish those data to the nearest gateway device on the particular channel. The application user connects with the gateway device and subscribes to the channel on which the sens- ing device transmits data. We have implemented the proposed approach for the generalized IoT network using the MQTT protocol on the university campus. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 49 Chapter 3. Secure Lightweight Key Exchange for User - Gateway Paradigm 3.2 Literature Review ECC provides lightweight and secure computation with an equal level of security to the RSA and the other algorithms. In the recent past, authors in [X. Xu et al. (2013)], [Qiu et al. (2018)], [Chaudhry et al. (2015)] proposed the ECC based authentication schemes and proved that the proposed scheme provides security against most of the famous cryptographic attacks such as replay attack and MITM attack. In 2013, Xu et al. proposed an authentication scheme using ECC to secure key establishment between patient and health server. In this scheme, the authors shared user identity over an open channel, which makes it vulnerable to user im- personation attack and identity theft attack. In 2015, Chaudhry et al. [Chaudhry et al. (2015)] proposed an authentication scheme using ECC and temporary id and claimed that their scheme is secure against password guessing attack and user im- personation attack. But, in 2017, Qiu et al. [Qiu et al. (2018)] break the scheme proposed by Chaudhry et al. and proved that their scheme is vulnerable against both the attack. Furthermore, Qiu et al. also put forward a new authentication scheme. In 2015, Zhang et al. [Zhang & Zhu (2015)] and Qiu et al. [Qiu et al. (2018)] also proposed an authentication scheme using ECC and claimed novelty with security for their schemes. 3.3 Threat Model The threat model considered for designing of the proposed scheme is referred from the model highlighted by Dolev and Yao in 1981 [Dolev & Yao (1981)], where abilities of an adversary A are discussed: PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 50 Chapter 3. Secure Lightweight Key Exchange for User - Gateway Paradigm 1 A can curb the communication channel and delete, modify, and study the data from the communication channel. 2 A can be either from the same network or from the different networks. 3 A can be an insider or can be an outsider of the system. 4 A can get the smart card as well as can read data from the smart card. 5 A can not extract a private key of the user or gateway. 6 A can generate pair of id and password using DICID and DICPW. 7 A can either get the user s password through malicious card readers, or (ii) can read secret data of the smart card by side-channel attacks, but cannot get both simultaneously. Otherwise, it becomes a inconsequential case [Wang & Wang (2018)], [Dhillon & Kalra (2019)], [Sudhakar et al. (2020)]. 3.4 Proposed Scheme Following, Table 3.1 shows notations and abbreviations used in the proposed scheme: A Initialization Phase Step 1: The gateway device Sj generates the random number ks Z p. The gate- way Sj computes public key parameter PKs = ks G and stores private key ks and public key PKs. The gateway device Sj generates the random num- ber PRSC. Here, PRSC is the private key for the user device. Over here, PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 51 Chapter 3. Secure Lightweight Key Exchange for User - Gateway Paradigm Symbols Description U User S Gateway ri & np user random numbers h(.) One way Hash function TS Time stamp ks Gateway secret key ID user Identity SK Session key PW user Password PKS Gateway Public key Enc() ECC Encryption operation secure channel rs & ns Gateway random numbers Dec() ECC Decryption operation PUsc User public key PRsc User private key || String concatenation A Adversary Insecure channel SC Smart Card TABLE 3.1 Notation and Abbreviations we assume that selected value of PRSC is neither 1 nor p-1 but ranges be- tween these two. The gateway Sj computes public key parameter PUBSC = PRSC G and stores private key PRSC and public key PUBSC in a se- cret memory of the user. The gateway S j also makes PKs as a publicly available parameter. Step 2: Both the gateway S j and the user Ui agrees on nite eld p, elliptic curve Ep(), and generator point G. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 52 Chapter 3. Secure Lightweight Key Exchange for User - Gateway Paradigm B Registration Phase USER PART 1 : Step 1: Ui decides ID and PWi. It also generates a random ri such that ri Z p. Step 2: Ui computes B = ri G, li = H(PWi||B) and forwards {li,ID} to S j via a secure channel. GATEWAY PART 1 : Step 1: Sj checks an identity ID and veri es its similarity in its record. If an identity ID is already registered then the gateway Sj asks for the different ID. Else, gateway device Sj continues computation. Step 2: Sj computes Ai = H(H(ID) li) Step 3: Sj chooses random number rs in such a way so that rs Z p and computes T = H((ks +1)||Si), Si = rs * G, MID = EncPKs(ID||rs), Oi = T li. Step 4: Sj makes SC and keeps (Si, MID ,Ai, Oi, H()) in it. Step 5: Sj forwards generated SC to Ui through the protected channel. USER PART 2 : Step 1: Ui stores EncPUBSC(B) in the SC. Step 2: Ui stores SC = (Oi, Si, MID ,Ai, H(), EncPUBSC(B)). PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 53 Chapter 3. Secure Lightweight Key Exchange for User - Gateway Paradigm C Login and Authentication Phase This section presents login and authentication phase of the proposed scheme. Summary of authentication phase is given in Table 3.2. USER PART 1 : Step 1: Ui enter SC in SCR and also provides ID and PWi. SCR computes li = H(PWi||DecPRSC(B)), A i = H(H(ID) li). SCR veri es A i ?= Ai, If, Ai is veri ed then SCR continues for further computations else SCR terminates computations. Step 2: SCR generates random number np such that, np Z p. SCR also computes Np = np G. Step 3: SCR computes T = Oi li, Li = H(Np||ID), PID = T H(ID||Li||TS). Here, TS is the current time stamp of the user Ui. Step 4: Ui sends {PID, Np, TS, MID} to the gateway S j over an insecure channel. GATEWAY PART 1 : Step 1: S j gets current time-stamp TS and veri es T ? TS - TS. If this condi- tion is satis ed then S j continues computation else terminates system. Step 2: S j extracts an identity ID and the random number rs by Decks(MID). Sj computes Ni = H(Np||ID), T = H(rs||ks+1) and PID = T H(ID||Ni||TS). Step 3: S j veri es PID ?= PID. If this condition matches, then Sj continues with its computations else; if Sj gets the fake login requests for more than three times, then it concludes that this is modi ed replay attack and im- mediately blocks the SC for a day. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 54 Chapter 3. Secure Lightweight Key Exchange for User - Gateway Paradigm Step 4: Now, S j erects new random ns and enumerates NS = ns G. S j computes a nal session key, SK = H(T||ns Np||Ns||ID||Np). It also computes SKVi = H(SK||Ns||T||Np||TSnew) as a mutual authentication parameter. Step 5: S j sends Ns, SKVi , TSnew to the user Ui over an open channel. USER PART 2 : Step 1: Ui gets current time-stamp TS new, and veri es Tnew ? TS new TSnew. After the successful time-stamp veri cation, the user Ui computes the session key SK = H(ID||T||np Ns||Ns||Np). Step 2: Ui veri es the session key SK and veri es the gateway S j Step 3: Ui computes Q i = H(Ns||T||Np||TSnew||SK ) and checks Q i . Step 4: Ui veri es, Q i ?= SKVi. Successful veri cation of Qi authenticates the gateway device S j and validates the computed session key SK D Password Update Phase This section presents a password update phase for the proposed scheme. USER PART 1: Step 1: The Ui provides the Smart Card to the SCR and obtain password update step. Step 2: The user provides ID, PWi, PW new i to the SCR. SCR PART 1: PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 55 Chapter 3. Secure Lightweight Key Exchange for User - Gateway Paradigm User/SCR SCR Enter SC, ID and PWi. SCR computes li = H(PWi||DecPRSC(B)), A i = H(H(ID) li). SCR veri- es A i ?= Ai Generate np,computes Np = np G, T = Oi li, Li = H(Np||ID), PID = T H(ID||Li||TS), Sends {PID, Np, TS, MID} to GW. Computes T ? TS - TS, Decks(MID), Ni = H(Np||ID), T = H(rs||ks + 1) and PID = T H(ID||Ni||TS), veri es PID ?= PID, Enumerates NS = ns G. Sj, SK = H(T||ns Np||Ns||ID||Np). It also com- putes SKVi = H(SK||Ns||T||Np||TSnew). sends Ns, SKVi , TSnew to Ui veri es Tnew ? TS new TSnew, computes SK = H(ID||T||np Ns||Ns||Np) and veri es. Q i = H(Ns||T||Np||TSnew||SK ) and checks Q i , Q i ?= SKVi. TABLE 3.2 Authentication and Key Exchange Phase Step 1: The SCR gets B by the computation of DecPRSC(B) and computes li = H(PWi||B), Step 2: The SCR performs A i = H(li H(ID)) and verify A i ?= Ai. If Ai is satis ed then the SCR continues, Step 3: The SCR generates the random number rinew Z p, Step 4: Computes Bnew = rinew * G, li = H(PWnew||Bnew), Step 5: Computes Oinew = li linew Oi, Step 6: Computes Ainew = H(H(ID) linew), Step 7: Now SCR updates Ai, Oi and generates updated SC = (Oinew, Si, MID ,Ainew, H(), EncPUBSC(Bnew)). PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 56 Chapter 3. Secure Lightweight Key Exchange for User - Gateway Paradigm 3.5 Security Analysis A Informal Security Analysis This section discusses informal security analysis for the proposed scheme. It high- light that the proposed scheme is secure against all well known attacks. USER ANONYMITY The proposed scheme do not communicate user identity over the public channel in the plain text format. Ui transmits the Ui s identity with the message PID. It generates PID using the hash function and the xor operation. Thus, it is infeasible for an intruder to retrieve an identity of the Ui. The proposed scheme achieves user anonymity from the adversary A as follow: 1. If an adversary A sniffs entire communication traf c then also A can not com- pute the ID because adversary A is utterly unaware about the parameter T. To computer the parameter T, an adversary A needs the secret key of S j which is nearly impossible for the A to get it. 2. A needs correct random number np to compute parameter PID. It is almost impossible for the A to generate a same random number np in a polynomial time. 3. Even if an adversary A gets the value of Ai and Oi from a smart card, A can not compute the correct value of PID due to unawareness about a random parameter T and an encrypted parameter B. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 57 Chapter 3. Secure Lightweight Key Exchange for User - Gateway Paradigm Hence, the proposed scheme achieves user anonymity. REPLAY ATTACKS In the replay attack, an adversary A captures previous messages and replays those messages after some time. Thus, in this attack, an adversary A tries to pretend itself as a trusted registered entity. The proposed scheme achieves security from the replay attack by two means: 1. In the rst, by using a random number np and ns, which are non-repeated pa- rameters. 2. In the second, it uses time-stamp TS for each message communication. The receiver of these messages veri es time-stamp using the pre-de ned threshold. OFF LINE PASSWORD GUESSING ATTACKS The proposed scheme computes a smart card, SC = (Oi, Si, MID ,Ai, H(), EncPUBSC(B)). Overhear, B = ri * G, that is encrypted using a public key of the user device. Thus, an adversary A can not get the value of B. Though, an adversary A presumes the correct identity ID and a password PWi, A can not compute li = H(PWi||DecPRSC(B)). Therefore, it is infeasible for the A to carry further session key computation. Similarly, if an adversary tries to go through the online pass- word guessing attempts, then three consecutive wrong attempts will block the SC for a day. Therefore, the probability of winning the password guessing game by an adversary A becomes NULL. Thus, the proposed scheme is secured from the password guessing attack. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 58 Chapter 3. Secure Lightweight Key Exchange for User - Gateway Paradigm MUTUAL AUTHENTICATION AND MITM ATTACKS The proposed scheme achieves mutual authentication through the gateway Sj s computation. The gateway S j computes PID and compares PID with the re- ceived parameter PID during a login request from the user. The Sj veri es the identity and a password of the Ui. The Ui veri es the gateway by computing Q i ?= Qi, where Qi, is computed using the session key, which is transmitted by the gateway Sj. Hence, the proposed scheme achieves mutual authentication. In the MITM attack, A tries to compute a session key using public parameters, pub- lic messages, and the stolen smart card. The proposed authentication scheme is secure against the MITM attack because A can not perform successful authenti- cation with the correct session key generation due to ECC encryption and random numbers. Suppose an adversary A wants to authenticate itself with the user Ui, then A must require a secret key of the gateway as well as the generated ran- dom numbers. Similarly, when A tries to authenticate with the gateway, then A requires a user id, password le, and the value of B, which is impossible for an adversary A to get. Thus, it is quixotic for an adversary A to launch the MITM attack; hence, the proposed scheme is immune enough against the MITM attack. PRIVILEGED INSIDER ATTACKS Let us assume that the malicious system insider traces registration phase informa- tion and saves that data. Let us also presume that the inside attacker accesses all secret parameters such as ID, PWi, and ri. Then also, the insider can not compute the session key due to the run-time use of a random numbers such as np and ns by both the communicating parties. The proposed scheme secures authentication PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 59 Chapter 3. Secure Lightweight Key Exchange for User - Gateway Paradigm phase by using the hash function, ECC operations, and random numbers. There- fore, the proposed scheme achieves security from the privileged malicious insider attack. PERFECT FORWARD SECRECY In Perfect forward secrecy (PFS), even though the A receives all secrets and iden- tities of the user, then also A can not compute the previous session key SK [Garg et al. (2020)]. The proposed model achieves PFS through the use of random num- bers np and ns. Even though an adversary A captures the gateway s secret key ks and other public or private parameters, it is infeasible for an adversary A to guess the exact value of np, and ns which were generated in the previous session and this proves inexpert for A to compute last session key. Therefore, the proposed scheme achieves perfect forward secrecy. DENIAL OF SERVICE ATTACKS By using DOS attack, the adversary A tries to block Ui and Sj from session key generation. The DoS attacker A may generate unnecessary traf c for any of the devices and create an undue delay in the authentication and key generation. In the realtime scenario, it is dishonesty to say that our scheme achieves complete security from the DoS attack, but the proposed scheme tries to protect it from the DoS attack through the blockage of SC and by using the time-stamp. Therefore, it somehow limits an adversary A to get control of the full system. The pro- posed scheme consider simulating it for the DDoS type attacks (like ooding) as a prospective aspect. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 60 Chapter 3. Secure Lightweight Key Exchange for User - Gateway Paradigm USER IMPERSONATION ATTACKS In this attack, the adversary A tries to impersonate as a valid user and tries to generate a valid login request for the gateway device. To regenerate valid login request, A needs to generate a valid message {PID, Np, TS, MID}. Over here, A can generate Np (if aware of parameter G) and time-stamp TS. However, without knowledge of other secrets such as ID, PWi and private key of the user device, an A can not generate parameter PID (where PID = T H(ID||Li||TS)). To obtain the parameter MID, an A requires a physical smart card of the valid user Ui. It is a dif cult task for an A to obtain all secrets of the user (like secretly shared private key of the user device and information stored in the smart card) at the same time. Thus, it is clear that the proposed scheme is secure enough against the user impersonation attack. GATEWAY IMPERSONATION ATTACKS In this attack, the adversary A tries to impersonate as a valid gateway device and tries to generate a valid reply on behalf of the authenticated gateway device. In the rst reply, the gateway device sends { Ns, SKVi , TSnew} to the user Ui. To regenerate the valid reply, an A generates time-stamp TS and parameter Ns (if aware about parameter G). However, an A also needs to compute valid SKVi = H(SK||Ns||T||Np||TSnew). For this, an A requires knowledge about secret cre- dentials such as user ID, server master secret ks, and server random number rs. It is highly infeasible for the A to capture all these parameters at the same time in the polynomial time. Therefore, it is clear that the proposed scheme is resis- tant enough against the gateway impersonation attack. Security comparison is PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 61 Chapter 3. Secure Lightweight Key Exchange for User - Gateway Paradigm Scheme F1 F2 F3 F4 F5 F6 F7 F8 F9 F10 [X. Xu et al. (2013)]           [Zhang & Zhu (2015)]           [Chaudhry et al. (2015)]           [Odelu et al. (2015)]           [Qiu et al. (2018)]           Proposed           TABLE 3.3 Security Comparison shown in Table 3.3. Security attacks in Table 3.3 are noti ed as : F1 = User anonymity, F2= Replay attack, F3= Of ine Password guessing attack, F4 = Mu- tual authentication and MITM attack,F5 = Privilege insider attack,F6 = Perfect forward secrecy,F7 = Denial of Service attack, F8 = User impersonation attack, F9 = gateway impersonation attack, F10 = Stolen smart card attack. From the Table 3.3, it found that the schemes proposed by the Xu et al. s [X. Xu et al. (2013)], Zhang et al. s [Zhang & Zhu (2015)], Chaudhary et al. s [Chaudhry et al. (2015)], Odelu et al. s [Odelu et al. (2015)], and QIU et al. s [Qiu et al. (2018)] suffer from the numerous attacks and vulnerabilities. An el- liptic curve based on the scalar multiplication provides high security against the perfect forward secrecy and the related attacks due to its discrete logarithm prop- erties. Thus, the proposed scheme provides a secure and computationally feasible scheme for the proposed network compares to other existing schemes. STOLEN SMART CARD ATTACKS In this attack, the adversary A captures the smart card of a valid user and tries to generate session key using smart card parameters and other public param- PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 62 Chapter 3. Secure Lightweight Key Exchange for User - Gateway Paradigm eters. In the proposed scheme, the nal SC available with the user is SC = (Oi, Si, MID ,Ai, H(), EncPUBSC(B)). To compute the nal session key SK = H(T||ns Np||Ns||ID||Np), an adversary A also requires secret credentials such as user ID, PWi, server master secret ks, server random number rs, valid random numbers generated by user and gateway (np and ns) and a private key of the user device. Thus, with the help of limited knowledge about the smart card and pub- lic parameter, an adversary A can not compute the nal session key. Therefore, the proposed authentication scheme provides enough security against stolen smart card attacks. B Mutual Authentication Using BAN Logic The proposed scheme uses BAN logic for to prove that the proposed scheme achieves mutual authenticity property. It uses BAN Logic to verify the trust be- tween principles involved in a communication. The BAN Logic focuses on the soundness and viability of the authentication process. The BAN Logic works based on several postulates, inference rules, and assumptions. The basic postu- lates and inference rules are de ned in subsection B of section 2.4. Assumptions BAN Logic works based on a following assumptions: Secrets initially shared between each principal. Principals raise fresh nonces. Principals are faithful in speci c ways. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 63 Chapter 3. Secure Lightweight Key Exchange for User - Gateway Paradigm Principals can recognize their messages. If principal A assures that K is a public key, then A must be aware of the corresponding private key K 1. Goals For any client-gateway architecture, followings are the fundamental goals those are necessary to achieve during the authentication process. Thus, with the help of individual assumptions, postulates, and inference rules, both client (C) and the gateway (S) try to attain speci c goals, as shown in Table 3.4: Goal No. Goal 1 Client C | C SessionKey S 2 gateway S | S SessionKey C TABLE 3.4 Goals Theorem 1. The proposed model achieves secure mutual authentication between the user Ui and the gateway Sj. Proof. The login and Authentication phase of a proposed scheme includes ex- change of the messages those are rewritten in generic form as follow: Message 1: Ui Sj: (H(rd G||(Ks + 1)) H( PWi||Dec(ri G) ) H( PWi||Dec(ri G) ) H( ID||H(np G||ID)||TSi ),np G, TSi,Enc( ID||rs )) Message 2: Sj Ui: (ns G, H(H(ID||H(rs||Ks +1) ||ns Np||ns G||np G) ||ns G|| H(rs||Ks +1) ||np G||TSnew), TSnew) Idealized form: Above messages can be rewritten in idealized form as follow: PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 64 Chapter 3. Secure Lightweight Key Exchange for User - Gateway Paradigm Message 1: Ui S j: < (( rs G||(Ks+1) ), (PWi||Dec(ri G)) ( PWi||Dec(ri G) ), ( ID||(np G||ID)||TSi ), np G, TSi, Enc( ID||rs )) > Ui PKs Sj Message 2: S j Ui: < (ns G, ((ID||(rs||Ks + 1) ||ns Np||ns G||np G) ||ns G|| (rs||Ks +1) ||np G||TSnew), TSnew) > Ui PKs Sj Goal: The Goals of a proposed scheme can be written as follow: G1: Sj | Ui SK S j G2: Ui | Ui SK Sj Following assumptions are considered to prove the mutual authentication: A1. Ui | #(TSi) A2. S j | #(TSi) A3. Ui | #(TSnew) A4. S j | #(TSnew) A5. Ui | (Ui PKs S j) A6. S j | (Ui PKs,D S j) A7. Ui | S j | (Ui SK S j) A8. S j | #(rs,np,ns) A9. Ui | #(rs,np,ns) A10. Ui | PKS 7 S j Mutual authentication between user Ui and gateway GWj is achieved as follows: S1: from the message 1, it obtains, S j < (( rd G||(Ks+1) ), ( PWi||Dec(ri G) ) ( PWi||Dec(ri G) ), (ID||(np G||ID)||TSi ), np G, TSi, Enc( ID||rs )) > Ui PKs Sj S2: Using S1, R1 and A6, it procures, S j | Ui | < ((rs G||(Ks+1)), (PWi||Dec(ri G)) (PWi||Dec(ri G)), (ID||(np G||ID)||TSi), np G, TSi, Enc(ID||rs)) > PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 65 Chapter 3. Secure Lightweight Key Exchange for User - Gateway Paradigm S3: Using S2, A2, R2, it comes by, S j | Ui | < ((rd G||(Ks+1)), (PWi||Dec(ri G)) (PWi||Dec(ri G)), (ID||(np G||ID)||TSi), np*G, TSi, Enc(ID||rs)) > S4: Using R7,R3 it obtains, GWj | Ui (rd G||(Ks+1)), (PWi||Dec(ri G)) (PWi||Dec(ri G)), (ID||(np G||ID)||TSi) S5: Using S3,S4, R8, it procures, GWj | ( rd G||(Ks + 1) ) , ( PWi||Dec(ri G) ) ( PWi||Dec(ri G) ), ( ID||(np G||ID)||TSi ) S6: Using S1, S4, R2, A8, it comes by, S j | Ui SK Sj [Goal 1] S7: using message 2, it obtains, Ui < (ns G, ((ID||(rs||Ks +1) ||ns Np||ns G||np G) ||ns G|| (rs||Ks +1) ||np G||TSnew), TSnew) > Ui PKs Sj S8: Using S7, R1 and A6, it gets, Ui | S j | < (ns G, ((ID||(rs||Ks + 1) ||ns Np||ns G||np G) ||ns G|| (rs||Ks +1) ||np G||TSnew), TSnew) > Ui PKs Sj S9: Using S8, A2, R2, it gains, Ui | Sj < (ns G, ((ID||(rs||Ks + 1) ||ns Np||ns G||np G) ||ns G|| (rs||Ks +1) ||np G||TSnew), TSnew) > Ui PKs Sj S10: Using S9, R7, R3, it gets, Ui | S j ((ID||(rs||Ks + 1) ||ns Np||ns G||np G) ||ns G|| (rs||Ks + 1) ||np G||TSnew) Ui | ((ID||(rs||Ks + 1) ||ns Np||ns G||np G) ||ns G|| (rs||Ks + 1) ||np G||TSnew) PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 66 Chapter 3. Secure Lightweight Key Exchange for User - Gateway Paradigm S11: Using S10, S9, R8, it acquires, Ui | Sj | Ui SK Sj S12: Using S8, S9, R2, A8, it earns, Ui | Ui SK Sj [Goal 2] Thus, the auspicious derivation of both the goals (goal one and goal two) proves that the proposed authentication scheme delivers mutual authentication property. C Formal security Analysis using ROR Model The ROR model is one of the key formal and standard security models used to prove that an adversary A can not get con dence for the retrieved key using ran- dom oracle queries. An ultimate goal of the ROR model is to show that an ad- versary A can not distinguish between retrieved random value and the original session key. Random oracle based ROR model Random oracles and ROR model can be de ned as follows: Random Oracle: The proposed protocol P uses cryptographic public hash function that is formalized as a random oracle H(m). Thus, whenever any proba- bilistic polynomial adversary A communicates message mi, then the oracle H(mi) computes x sized irreversible random value ri. The oracle maintains a list L that is initialized with a NULL value. The oracle stores pair of (mi,ri) in L, for each i where i = 0 to n and returns value ri to A. ROR Model: In the proposed RUA scheme, there are two participants Ui and PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 67 Chapter 3. Secure Lightweight Key Exchange for User - Gateway Paradigm S j. Thus, the ROR modeling for these participants and adversary A is as follow: Oracles: Om Ui and On Sj are oracles with instances m and n for Ui and Sj respectively. These oracles are also called participants for the proposed protocol P. Oracles Freshness: Om Ui and On Sj are called fresh oracles if the reveal ora- cle query R does not provided correct session key SK. Oracles Partnering: The oracle instances Om Ui and On Sj are called partners if they satisfy following conditions: 1. Both instances Om Ui and On Sj are in the same acceptance state. 2. Both Om Ui and On S j share the common session id sid. 3. Both Om Ui and On Sj satisfy the partner identi cation and viceversa. 4. No other instance other than Om Ui and On Sj is accepted with the same partner identi cation equal to Om Ui and On Sj. Over here, sid is a transcript of all communicated messages between participants before achieving an acceptance state. Oracle Accepted state: An instance Ox reaches to acceptance state after communicating the last message with the partner instance Oy. The concatenation of all messages transmitted before reaching to acceptance state generates sid for a particular session. Adversary Model: An adversary A can be derived using the famous Dolev- Yao model de ned based on send (snd) and receive (rcv) channel. The adversary A can perform passive attacks as well as active attacks. The A can receive, read, update, delete, and add messages over an open communication channel. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 68 Chapter 3. Secure Lightweight Key Exchange for User - Gateway Paradigm Following random oracle queries are de ned to provide access capabilities to a polynomial time adversary A: R(Om) : The reveal query R provides session key SK to the adversary A generated by an instance Om and it s partner for the same sid. S (Om Ui) : The send query S can be formalized as an active attack by adver- sary A. By using this query, an adversary A communicates with the user instance Om. The A sends messages to the user instance Om as well as gets responce from it. S (On S j) : The send query S can be formalized as an active attack by the adversary A. By using this query, an adversary A communicates with the gateway instance On. A sends messages to the gateway instance On as well as gets responce from it. E(Om,On) : The execute query E can be formalized as a passive attack. By this query, an adversary A gets capacity to monitor the communication chan- nel between two instances Om and the On. Thus, the execute query grants read permission to an adversary A. T (Om) : As a respond to this query, an Om tosses unbiased coin and get value of bit b. The output of this toss decides return value of the test query T . Let us consider SK as a newly generated session key between the user Ui and the gateway S j. The adversary A performs the test query over either instance Om or its partner instance On. Then, if the output of toss is b = 1, then Om returns the original session key else if b = 0, then the Om returns a random value of the size equal to session key. If none of the condition matches then the instance Om returns NULL. RSC(Om Ui) : The query Read Smart Card (RSC) enables an adversary A PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 69 Chapter 3. Secure Lightweight Key Exchange for User - Gateway Paradigm to extract records stored in the smart card SC. This query is formalized as an active attack. The Power analysis attack is the most famous attack using that an adversary A performs the RSC query. Therefore, this query returns all the parameters stored in the user Ui s smart card. This attack is considered as a stolen smart card attack. Semantic Security in ROR Model: The ROR Model puts restrictions on the adversary A by limiting the attempts for performing the reveal query R, RSC. The semantic security also gives unlimited access for queries such as T . The semantic security of the session key SK depends on an adversary A s capability of indistinguishability between the random number and the actual session key. The output of test query T depends on the value of b guessed by an adversary A. The bit b is hidden bit set by an oracle instance Om. The T (Om) uses it to retrieve the original session key. Overall game depends on the correct guess by an adversary A for the bit b . The correct guess of b (similar to b) provides the original session key to an adversary A. Let, the parameter SUCC de nes the success position for an adversary A. The advantage function for an adversary A can be de ned as AdvP. The AdvP represents the success of an adversary A in the identi cation of the original ses- sion key. If it is proved that the parameter AdvP is negligible under the proposed scheme, then it is considered that the proposed scheme is secured under the ROR model. The AdvP is de ned as follows: AdvP(A) = 2 Pr[SUCC] 1 (3.1) PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 70 Chapter 3. Secure Lightweight Key Exchange for User - Gateway Paradigm The above equation can be rewritten as follow: AdvP(A) = 2 Pr[b = b] 1 (3.2) Here, Pr[SUCC] represents the the success probability of an adversary A. Semantic Security for the Password based protocol The semantic security of the password based protocol Ppw de nes an adversary A s capability of guess- ing the correct password. The password based protocol Ppw is semantically secure if the advantage function AdvPpw is negligible under the following condition: AdvPpw,|D|(A) max(qs,( 1 |D|, f p)) (3.3) In equation 6.3, qs represents the number of send queries (Ss), |D| shows nite size of the password dictionary, f p shows probability of the false positive occur- rence by an adversary A. Formal security proof The formal security proof for the proposed protocol P can be proved by the fol- lowing theorem: Theorem 2. Let the adversary A runs against the proposed protocol P for a limited time period tA. Let an adversary A tries to attack the proposed protocol P using oracle queries. Here, qh de nes the number of hash (H) queries, qs de nes the number of send (S) queries, and qe de nes the number of execute (E). The PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 71 Chapter 3. Secure Lightweight Key Exchange for User - Gateway Paradigm proposed protocol is secured against oracle queries of A if, AdvP(A) q2 h 2lh +max(qs,( 1 |D|, f p))+(qs +qe 2lr ) (3.4) In Equation 6.4, lh is the size of the return value of hash (H) query generated by A in bits, lr is the size of the random nonce generated by the protocol P. |D| shows the nite size of a password dictionary and f p shows the probability of a false positive occurrence by A. Proof. For to prove that the proposed protocol P is secure against an adversary A and AdvP(A) is negligible under the ROR model, four security games are de ned which are called as a Gm0, Gm1, Gm2, Gm3. The oracle game start with the game Gm0 and terminates with the game Gm3. Now, let de ne an event SUCCi that represents the correct guess of bit b for each game Gmi via the test query T by an adversary A. Game Gm0: Gm0 is the initial game in which a real protocol P is equal to an initial game : AdvP(A) = 2 Pr[SUCC0] 1 (3.5) Game Gm1: De nition: This game executes following query, The execute query E(Om,On) eavesdrops communication between the user Ui and the gateway S j. After receiving all the messages, adversary A performs test query T to acquire the session key. If the information retrieved using the above query provides suf cient PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 72 Chapter 3. Secure Lightweight Key Exchange for User - Gateway Paradigm erudition to the A for computing SK, then it can be said that the adversary A wins the game Gm1. Else: Pr[SUCC1] = Pr[SUCC0] (3.6) Simulation of Gm1: Gm1 de nes passive attack. Let us assume that the ad- versary A gets messages : Message 1: Ui S j: (H( ri G||(Ks + 1) ) H( PWi||Dec(ri G) ) H( PWi||Dec(ri G) ) H( ID||H(np G||IDi)||TSi ), np G, TSi, Enc( ID||rs )) Message 2: S j Ui: (ns*G, H(H(ID||H(rs||Ks + 1) ||ns Np||ns G||np G) ||ns G|| H(rs||Ks +1) ||np G||TSnew), TSnew) The user computes nal session key as SKu = H( ID||T||np Ns||Ns||Np ) and the gateway computes nal session key as SKs = H( ID||T||ns Np||Ns||Np ). The computation of SK depends on a randomly generated unknown size numbers. The session key computation depends on parameters such as ID, ns, np, and T. There- fore, eavesdropping of the rst message and the second message does not improve the winning probability of an adversary A for game Gm1. Thus, it is said that the equation 6.6 holds true. Game Gm2: De nition: The game Gm2 executes following queries, Hash query H(Om,mi) to retrieve the hash output of message mi. Send query SS(On Sj) to get messages from the gateway device. Send query SC(Om Ui) to get messages from the User device. In this game, the adversary A performs hash query H, send query SS, and the send query SC with the motive of creating a collision and creating a fake trust. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 73 Chapter 3. Secure Lightweight Key Exchange for User - Gateway Paradigm The birthday paradox de nes a probability of collision for the hash query H as at most q2 h 2lh . As shown in the rst message and the second message, each message in the communication uses either the random numbers, time-stamps, or long-term secrets. None of the messages is similar to another one. Therefore, the adversary A can not create a collision between messages. The rst message contains a random number of ri, while the second message contains a random number of rs. The maximum collision probability between messages with the random numbers is at most qs+qe 2lr . Consequently, after this game, following result is achieved: Pr[SUCC2] Pr[SUCC1] q2 h 2lh + qs +qe 2lr (3.7) Game Gm3: De nition: This game executes the following query, Query RSC (Om Ui) performs Read Smart Card operation. Using this an adversary A gets data from the smart card. In game Gm3, the adversary A reads data from the Ui s SC. The user Ui s SC stores (Oi, Si,MID, Ai, H(.), Enc(B)). By using RSC query, an adversary A reads all these parameters and tries to compute the password PWi. But the password PWi is protected through a random number, and the probability of guessing a correct random number is almost NULL. Now an adversary tries to perform the online password guessing attack, but for a particular session, the number of attempts allowed to execute is restricted. Thus, it is said that: Pr[SUCC3] Pr[SUCC2] max(qs,( 1 |D|, f p)) (3.8) PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 74 Chapter 3. Secure Lightweight Key Exchange for User - Gateway Paradigm The adversary tries all possible attack to break the proposed protocol P before nishing all the games. But, the equations 6.5, 6.6, 6.7, and 6.8 shows that the adversary does not achieve any success till the last game. Now, the only option left with the adversary A is to guess the correct value of b and to perform the test (T ) query on either the user Ui or the gateway Sj. The success probability for this guess is de ned as follow: Pr[SUCC3] = 1 2 (3.9) From Equations 6.5 and 6.6, AdvP(A) = 2 Pr[SUCC1] 1 (3.10) Using Equations 6.6, 6.7, 6.8, 6.9, Pr[SUCC3] Pr[SUCC1] [Pr[SUCC2] Pr[SUCC1]] +[Pr[SUCC3] Pr[SUCC2]] (3.11) this is followed by, AdvP(A) 2 q2 h 2lh +max(qs,( 1 |D|, f p))+(qs+qe 2lr ) 2 (3.12) Thus, AdvP(A) q2 h 2lh +max(qs,( 1 |D|, f p))+(qs +qe 2lr ) (3.13) The equation 6.12 shows that the proposed protocol P is secure against all the oracles of an adversary A as well as secure under the ROR model. The game Gm1 proves that even though an adversary A tracks all the publicly communicated PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 75 Chapter 3. Secure Lightweight Key Exchange for User - Gateway Paradigm messages, he can not compute the original session key. The Gm2 focuses on the hash collision and the security against the fake messages. The adversary A does not achieve success in the game Gm2 due to frequent use of the random numbers, timestamps, and long term secrets in each message. The Gm3 enables an adversary A to perform the active attack over the user s SC and allow him/her to retrieve the correct password PWi using those data. The proposed protocol protects the password using the hash function and the random numbers. Thus, the adversary A does not get any success after Gm3 also. Therefore,it is said that the proposed protocol is secured under the ROR formal security model. 3.6 Implementation and Testbeds This section discusses the aspects related to the realtime implementation of the proposed scheme. The similar assumptions and the scenario discussed by authors in [Chaturvedi et al. (2017)], and [Radhakrishnan & Karuppiah (2018)] is consid- ered. The system computes throughput, round trip delay, and the other results for the proposed scheme using an MQTT protocol. It uses the following parameters and scenarios for the implementation of a proposed scheme. The raspberry-pi as a gateway device and nodemcu as a sensing device are used to create a testbeds. To implement the MQTT protocol, the mosquitto broker was installed in the Linux and raspbian OS. A secure pipeline was designed using a Transport Layer Security (TLS) over MQTT protocol for secure communications. In the proposed scheme, the JavaScript le is used as a SC for the authenti- cation purpose. In the registration phase, the system user publishes his/her secret credential to the gateway device over an MQTT secure channel. The gateway de- PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 76 Chapter 3. Secure Lightweight Key Exchange for User - Gateway Paradigm vice performs registration steps and creates a JavaScript (UID sc.js) le for the user device. The gateway device publishes this le to the user device over an MQTT secure channel. The user device receives le and stores it into the device s secret memory (like secret memory of secure element). In the login and authenti- cation phase, the user device reads stored JavaScript le whenever it needs to use SC. Network Model User - gateway Protocol Using MQTT Broker Mosquitto Secure channel By Enabling TLS communication in Mosquitto ECC Curve NIST P-256 Curve ECC Multiplication Using double and Add method Message format JSON Type Language Python System Architecture = x86-64, Processor: Intel (R) Core (TM) i5-7500 CPU with 3.40 GHz. TABLE 3.5 Implementation Environment The NodeMCU is used to connect with sensors as a publisher who publishes data to the directly connected gateway device. Users of the smart university ap- plication subscribe with the gateway device and try to receive the data from a gateway device. For better implementation, a laptop with the Linux OS is used as a user and raspberry-pi as a gateway device. The mobility of the three meters per second to 20 meters per second is considered for the users. The message size is computed in bits. For communication size computation, The MQTT packet header size is not considered. The size of the data part is only considered for the computation. The Table 3.5 provides con guration for the setup that is used for implementation of the proposed scheme. The MySQL server was setup to store PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 77 Chapter 3. Secure Lightweight Key Exchange for User - Gateway Paradigm parameters and data. The Raspberry Pi 3 Model B+ was used as an intermedi- ary gateway device as well as some user devices with the laptop. The wireshark tool was installed for the data collection of the MQTT packets. The Wireshark tool was used to trace the MQTT protocol in the .pcap extension le. The python program was used to perform the analysis and ltering of these messages. The Fig.3.1. shows derived session key between the user device (laptop) and a gate- way device (raspberry pi) using the proposed protocol. For implementations we have used SHA-256 as a hash function and NIST recommended P-256 Curve. The security level achieved through implementation of proposed scheme is 128 bit. Figure 3.1. Computed Session Key 3.7 Use cases This chapter proposes RUA scheme for the user-gateway model. The proposed scheme aims to provide a lightweight communication between the user device and the gateway device. The following are some of the signi cant use-cases of the proposed work. The proposed scheme can be used for secure and authenticated data ex- change in the smart home area network. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 78 Chapter 3. Secure Lightweight Key Exchange for User - Gateway Paradigm it can be also useful in smart factory, smart mall, smart agriculture and many more applications where it needs ef cient and lightweight authentication mechanism between user (mobile/laptop) and the IoT device. If a case scenario of the smart family health monitoring application is con- sidered in which the user (a doctor) wants to monitor the data published by a family member over the home gateway device. Then using the proposed RUA scheme, the registered doctor can login with the home gateway device and can monitor the realtime patient data. The proposed RUA scheme can be also useful for automated payment sys- tem in the shopping mall. The novelty of the proposed work lies in its adaptive environment, lightweight computations and realtime implementations. The realtime implementation of the proposed ECC based scheme using MQTT protocol (that itself is a lightweight communication protocol used by the IoT industry) makes it novel. The realtime implementation using MQTT protocol has advantages like the lightweight header and reliable communication over other conventional protocols. 3.8 Comparative Analysis In this section, the performance analysis for the proposed scheme is given by comparing it with the other existing schemes of Qiu et al s [Qiu et al. (2018)], Xu et al. s [X. Xu et al. (2013)], Zhang et al. s [Zhang & Zhu (2015)], Chaudhary et al. s [Chaudhry et al. (2015)], and Odelu et al. s [Odelu et al. (2015)]. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 79 Chapter 3. Secure Lightweight Key Exchange for User - Gateway Paradigm A Network Parameter Analysis As per shown in the Table 3.5, the widely adopted IoT protocol MQTT is used for our implementation. The MQTT protocol uses the publish-subscribe model for its communication in which the publisher publishes a sensing data to the broker, and the subscriber receives those data from the broker. For the computation of net- working parameters, experiments were performed where the user device publishes an authentication request to the gateway device over an insecure channel. 1. Average round-trip delay: The round trip delay computed with the help of four major delays. These delays include queuing delay, processing delay, transmission delay, and the propagation delay. Thus, the overall round trip delay is the average time required by the user and the gateway to commu- nicate the single message. Therefore, for one packet, it is (Trec - Tsend), and subsequently, for n packet, it is the sum of all. For the proposed setup, ini- tially fty requests were communicated from the ten users for the login and authentication using the MQTT protocol. As an outcome of this setup, it founds 0.2232s as an average RTT for the proposed scheme. If the commu- nication cost is considered then the RTT for Xu et al. [X. Xu et al. (2013)], Zhang et al. [Zhang & Zhu (2015)], Chaudhary et al. [Chaudhry et al. (2015)], Odelu et al. [Odelu et al. (2015)] and Qiu et al. [Qiu et al. (2018)] will be approx 0.35s, 0.4s, 0.32s, 0.32s, 0.5s respectively. Thus, the aver- age RTT for the proposed scheme is minimum compared to other existing schemes. 2. Average throughput: Throughput in the networking indicates an average PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 80 Chapter 3. Secure Lightweight Key Exchange for User - Gateway Paradigm number of bits communicated per unit time. Thus, it is (number of trans- mitted packets * size of each delivered packet)/total delay. The computed throughput value for the proposed scheme, Xu et al., Zhang et al., Chaud- hary et al., Odelu et al. and, Qiu et al. is 103 bits per second (bps), 123 bps, 123 bps, 133 bps, 143 bps, 126 bps respectively. Thus, the throughput of the proposed scheme is minimum compare to other existing schemes due to the more modest communication cost of the MQTT packets. 3. Average packet loss: The packet loss is computed based on the number of lost packets during the communication for a speci c time. The mosquitto broker was used to set up an MQTT communication. Thus, it founds that the packet loss is rare. But if the global brokers such as Amazon AWS or hivemq are used, then the average packet loss of around 0.019 in total 1800 seconds for the proposed scenario. It is also computed for the other existing schemes. Then, it founds that there were 0.022, 0.022, 0.032, and 0.041, and 0.036 for Xu et al., Zhang et al., Chaudhary et al., Odelu et al., and Qiu et al. respectively. Sometimes, the inef cient implementation of the cryptographic algorithms increases packet loss, but more or less, the packet loss highly depends on the communication protocol and network infrastructure. B Communication Cost The communication cost in a security mechanism represents the number of bits communicated prior to the session key establishment. To perform the commu- nication cost analysis, rst, individual parameter size is considered in bits. The PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 81 Chapter 3. Secure Lightweight Key Exchange for User - Gateway Paradigm Scheme cost [X. Xu et al. (2013)] 1184 bits [Zhang & Zhu (2015)] 1184 bits [Chaudhry et al. (2015)] 1344 bits [Odelu et al. (2015)] 1600 bits [Qiu et al. (2018)] 1280 bits Ours 800 bits TABLE 3.6 Comparison of the Communication Cost computed size of identity and password is 160 bits; the hash output is 256 bits for SHA-256. The size of the randomly generated nonce is 128 bits, and the times- tamp size is 32 bits. The ECC based implementations is used for the computation of the key parameters. Each point in the ECC has two coordinates, and each co- ordinate size is 160 bits. Thus, the size of one curve point P(Xp, Yp) is 160 bits + 160 = 320 bits. Therefore, the public key size (PKs) is 320 bits, while the private key(Ks) size is 160 bits. Table 3.6 shows comparative communication cost. C Computation Cost The computation cost comparison is performed based on the time consumed by various operations during the implementation of the proposed scheme. For the comparison, some operations such as xor and string concatenation operations are neglected due to the lower computation time. Major operations used for the com- parison are as follows: Th : Time required for the hash operation. TPa : Time required for the elliptic curve point addition. TPm : Time required for the elliptic curve point multiplication. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 82 Chapter 3. Secure Lightweight Key Exchange for User - Gateway Paradigm Scheme User computation Gateway computa- tions Total [X. Xu et al. (2013)] 6TH + 3TPm 6.6918 ms 5TH + 3TPm 6.6895 ms 11TH + 6TPm 13.3813 ms [Zhang & Zhu (2015)] 7TH + 3TPm + 1TSym 6.6987 ms 7TH + 3TPm + 1TSym 6.6987 ms 14TH + 6TPm + 2TSym 13.3974 ms [Chaudhry et al. (2015)] 5TH + 4TPm 8.9155 ms 4TH + 3TPm 6.6872 ms 9TH + 7TPm 15.6083 ms [Odelu et al. (2015)] 7TH + 3TPm + 1TSym 6.6987 ms 6TH + 2TPm + 2TSym 4.475 ms 13TH + 5TPm + 3TSym 11.1737 ms [Qiu et al. (2018)] 8Th + 2TPm 4.4704 ms 5Th + 2TPm 4.4635 ms 13Th + 4TPm 8.9339 ms Proposed 6TH + 2TPm + 1TSym 4.4704 ms 5TH + 2TPm + 1TSym 4.4681 ms 11TH + 4TPm + 2TSym 8.9385 ms TABLE 3.7 Comparison of the Computation Cost TSym : Time required for the symmetric encryption / decryption operation. For the scenario of Table 3.5, the time required for the above four operations is 0.0023 ms, 0.028 ms, 2.226 ms, 0.0046 ms, respectively. The Table 3.7 highlights computation cost comparison for the proposed scheme with the other existing scheme. As per shown in the Table 3.7, the total time required by the Xu et al. s [X. Xu et al. (2013)], Zhang et al s [Zhang & Zhu (2015)], Chaudhary et al. s [Chaudhry et al. (2015)], Odelu et al. s [Odelu et al. (2015)], QIU et al. s [Qiu et al. (2018)] and the proposed scheme is 13.3813 ms, 13.3974 ms, 15.6083 ms, 11.1737 ms, 8.9393 ms, 8.9385 ms respectively. It shows that the computation time required by the proposed scheme is minimum compared to other existing schemes. Following PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 83 Chapter 3. Secure Lightweight Key Exchange for User - Gateway Paradigm Fig.3.2. gives performance comparison of communication cost and computation cost of the proposed scheme with the existing schemes. 0 200 400 600 800 1000 1200 1400 1600 1800 [X. Xu et al. (2013)] [Zhang & Zhu (2015)] [Chaudhry et al. (2015)] [Odelu et al. (2015)] [Qiu et al. (2018)] Ours Communication Costs in bits 0 2 4 6 8 10 12 14 16 18 [X. Xu et al. (2013)] [Zhang & Zhu (2015)] [Chaudhry et al. (2015)] [Odelu et al. (2015)] [Qiu et al. (2018)] Ours Computation Costs in ms Figure 3.2. Performance Comparison Chart 3.9 Summary Authentication is one of the critical challenges in the IoT environment. To address these challenges, many authors proposed authentication schemes. This chapter proposes a novel authentication scheme for the User-Gateway based communi- cation model. This model is widely used in the IoT and the sensor networks. The proposed authentication scheme uses identity, password, and the smart card as a factors. The ECC is used for the key generation. After successful registra- tion, the application user performs login and authentication to establish a secure session key. After the successful mutual authentication, the application user de- termines a secure session key with the cluster gateway device. The security is proved for the proposed key exchange scheme using the formal security analy- sis as well as informal security analysis. A random oracle based ROR model PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 84 Chapter 3. Secure Lightweight Key Exchange for User - Gateway Paradigm and the BAN Logic are used for the formal analysis and the Dolev-Yao channel for informal analysis of the proposed scheme. The proposed scheme was imple- mented for a realtime scenario generated on the university campus. The session key between the users (laptop and raspberry pi devices) and the gateway device (raspberry-pi) was generated for the further communication. In this chapter, the comparison of the proposed scheme with the other existing schemes is also pro- vided in terms of the communication cost, computation cost, throughput, RTT, and the packet loss. Overall, this chapter proposes reliable and lightweight RUA scheme for user-gateway communication. The proposed scheme in this chapter considers sensing devices as a tiny devices which are not capable to do cryptog- raphy operations but now a days we nd many sensing devices those are capable to perform cryptography operations and can play an important role in session key derivation. Hence, next chapter 4 proposes an authentication scheme between the user device, gateway device and the sensing device. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 85 Chapter 4 Secure Lightweight Key Exchange for User - Gateway - Sensor Paradigm This chapter proposes an authentication scheme between user device, gateway device and the sensing device. Section 4.1 presents introduction for the user- gateway model and proposed work. Section 4.2 provides literature review related to proposed scheme. Section 4.3 highlights threat model considered for designing authentication scheme. Section 4.4 presents proposed authentication scheme with all the phases. Section 4.5 put forward security analysis for the proposed scheme. Section 4.6 provides implementation aspects and use cases related to proposed work. Section 4.7 presents performance comparison of the proposed work with other existing schemes based on communication cost and computation cost. Section 4.8 sum- 1Patel C., Doshi N. (2020) A Novel Lightweight Authentication for Intelligent Energy Monitoring in Smart Home. Advances in Intelligent Systems and Computing, vol 1148. Springer, Singapore. https://doi.org/10.1007/978-981-15-3914-517 86 Chapter 4. Secure Lightweight Key Exchange for User - Gateway - Sensor Paradigm marise this chapter with the limitations those are resolved in next chapter. 4.1 Introduction The Sensing devices are very tiny devices that are not capable of storing a large amount of data, not competent to perform a higher level of computations, and not capable of transmitting the data for a longer distance. The major wireless communication protocols which are used by the sensing devices are BLE, Z-Wave, Zigbee (make use of IEEE 802.15.4), NFC, RFID and so on. These protocols can transmit the data for a short-range (100 meter), so the sensing devices are connected with micro-controllers or micro-processors (like Arduino, Intel Galileo, Raspberry-Pi, NodeMCU) through either a wireless channel or a wired channel. These micro-controllers and micro-processors communicate through the Internet using a WiFi or a Wired LAN. The Internet Protocol (IP) or 6LoWPAN which is adaption of IPv6 for low power networks is the primary communication protocols that are used by these controllers and processors. The application users can use the protocols like a HTTP, MQTT, CoAP and XMPP for receiving the data from a cloud or directly from the sensing devices. The meaningful communication in IoT based application occurs through insecure channels or open channels (like normal MQTT or CoAP) that connect sensing devices with the users via a gateway and the cloud servers [Patel & Doshi (2019)]. This chapter considers network model discussed in subsection A of section 1.3 . For designing of the authentication scheme, this chapter considers use case of smart home energy monitoring. The Smart Home is an intelligent staying location that is built up through an interconnection of appliances like a Smart light, Smart PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 87 Chapter 4. Secure Lightweight Key Exchange for User - Gateway - Sensor Paradigm Fridge, Smart TV, Smart Door and Window system, Smart locking system, and so on. These devices are called smart sensing devices. These sensing devices perform their tasks by consuming electricity. These all Internet enabled devices share their electricity consumption with the SM (Ex. Smart bulb with motion sensor which get on only when motion is there else go to sleep mode and reduce power consumption). The SM collects data related to electricity consumption from each sensing device at a particular time interval and forwards those data through the Internet to smart home users via a gateway device. Let us denote the smart home user devices as a SHUi in which i represents the ith user, the sensing devices as SDj in which j represents the jth sensing device, the smart meter as a SM and the gateway device as GW. The communication between SDj to SM is considered as a secure communication because many times, this communication also occurred in a wired environment. The remaining communication of SM to GW and GW to SHUi is considered as an insecure communication. This chapter presents a lightweight and secure authenticated key exchange mechanism between the User SHUi, the gateway GW, and the smart meter SM by considering SM as a resource constraint device like sensing devices. 4.2 Literature Review Sensing devices (SHDj where j ranges between 1 to number of smart devices in home), communicates data with the near by gateway (SHgwk where k ranges be- tween 1 to number of smart home gateway). Ex. Smart home gateway SHgwk some time works as a fog device which processes a messed up data received from SHgwk PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 88 Chapter 4. Secure Lightweight Key Exchange for User - Gateway - Sensor Paradigm or some time works as just a forwarder of data. The SHgwk transmits this data to central service provider which is also called as cloud service provider (SHcsp). User SHUi (Where i ranges between 1 to number of home users) communicates via GSM (4G/5G) with SHcsp for receiving data from the SHD j. Secure as well as privacy preserving authentication and key-exchange is necessary between all these entity to achieve the basic security goals. An authentication protocol de- signer need to keep in mind that here, SHDj is a resource constraint device and is not capable to perform complected cryptography operations that much. Most of the authentication protocol designed for models such as smart home aims to generate secure SK through SHUi registration phase, SHDj registration phase, SHgwk initialize as well as registration phase. secure SHUi login and authentica- tion phase. Kumar et al. [Kumar et al. (2015)] proposed lightweight authentication scheme for smart home model. Authors in [Kumar et al. (2015)] designed a authentication scheme between smart device and gateway using service provider server. Service provider server generates symmetric key parameters for further computations. Au- thors provided simulation of proposed protocol using TinyOS and formal security analysis using AVISPA tool. Kang et al. in [Kang et al. (2016)] proposed zero-knowledge based authen- tication scheme. Kang et al. also followed similar network model to kumar et al. [Kang et al. (2016)] in which smart home gateway initiates communication with service provider server followed by user request to service provider. Author in [Kang et al. (2016)] claims that their proposed scheme is secured against SA1, SA11 and satisfy the SG1,SG2, SG3 and SG4. During study of this literature, it is observed that author had not discussed any simulation, implementation and formal PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 89 Chapter 4. Secure Lightweight Key Exchange for User - Gateway - Sensor Paradigm security analysis for proposed scheme. Authors in [Wazid et al. (2017)] proposed authentication scheme between user, gateway and smart device using registration authority. During proposed scheme designing Wazid et al. assumed that gateway node and registration authority are the secured and trusted device. Authors used AVISPA for security, ROR for formal security model and NS2 for simulation. Farash et al. in [Farash et al. (2016)] proposed an authentication scheme for the IoT network using only XOR and Hash functions. Proposed scheme in this pa- per is having four phases: i.e. pre-deployment phase, registration phase, login and authentication phase and password deployment phase. Through informal security analysis, authors in this paper proved that their scheme is secured against attacks such as MITM, replay, stolen veri er, and impersonation attack. Authors also proved mutual authentication using BAN logic and AVISPA tool. The proposed scheme in this chapter is compared with this paper and proved that is more secure and cost-ef cient compare to scheme proposed by Farash et al.in [Farash et al. (2016)]. Wu et al. in [Wu et al. (2017)], presented authentication scheme for the WSN based IoT deployment and provided NS2 based simulation for the proposed work. Authors of this paper proved formal security analysis using ProVerif tool. Through informal security analysis, author proved that their scheme is secured against forgery attacks, tracing attacks and guessing attacks. Amin et al. in [Amin et al. (2018)], proposed an authentication scheme for the U-GW-sensor based network model used in healthcare system. The proposed scheme consists of setup phase, registration phase, login and authentication phase and password change phase. Author provided simulation for the proposed scheme using AVISPA and proved mutual authentication using BAN Logic. Through in- PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 90 Chapter 4. Secure Lightweight Key Exchange for User - Gateway - Sensor Paradigm formal security analysis, author proved security of the proposed scheme against anonymity, stolen attack, untraceability, and guessing attacks. Authors in [Amin et al. (2018)] proved ef ciency of the proposed scheme by comparing it with other existing schemes based on computation cost and communication cost. Through comparison, it is proved that the proposed scheme of this chapter is more compu- tationally feasible compare to [Amin et al. (2018)]. In 2019, Zhou et al. [Zhou et al. (2019)] proposed a key agreement scheme for the IoT environment that also supported privacy preservation and proved for- mal security analysis using random oracle and mutual authentication using BAN Logic. Through the comparative analysis based on communication cost and com- putation cost, it is proved that proposed scheme of this chapter is more computa- tionally feasible compare to the scheme proposed in [Zhou et al. (2019)]. In 2019, Poh et al. [Poh et al. (2019)] proposed an authentication scheme for the smart home environment that is based on U-GW-Sensor model. Authors in this paper done an assumption that the gateway device is a semi-trusted device with that they also considered that the secret key of a gateway device is stored securely. In this paper, setup phase and authentication phases are discussed for key setup. Authors in this paper proved con dentiality, authentication and privacy preserva- tion of their scheme and provided comparative analysis with existing schemes to prove computational ef ciency. 4.3 Threat Model The adversary model describes the capability of an adversary A. The adversary A makes use of these capabilities to break the security of the proposed scheme. The PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 91 Chapter 4. Secure Lightweight Key Exchange for User - Gateway - Sensor Paradigm design of a strong adversary model helps a security researcher to focus on design- ing of foolproof security mechanism. For the proposed authentication scheme, following adversary model is considered. 1 An adversary A has full access on the communication channel between User - Gateway and Gateway - Smart Meter. 2 An adversary A can compute a valid pair of identity password of ine in poly- nomial time. 3 An adversary A may get a previously calculated session key. 4 An adversary A can get either information from the smart card or can get a password of the user. He can t get both info at the same time. 5 An adversary A can compromise a sensor node physically and can get a piece of stored information. 4.4 Proposed Scheme This section discusses the proposed scheme which includes the system initializa- tion phase by gateway GW, the registration phase by the user SHUi and the smart meter SM, and at last the authentication and key establishment phase by an user SHUi and an intelligent meter SM through a gateway GW. The proposed scheme makes use of the symbols and notations highlighted in Table 4.1. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 92 Chapter 4. Secure Lightweight Key Exchange for User - Gateway - Sensor Paradigm Symbol Description Symbol Description UID User ID GWID Gateway ID SMID Smart Meter ID ri Random number Ti Time stamp P Curve Point L XOR SKusm Session key TABLE 4.1 Notation and Abbreviations A Initialization Phase The system initialization phase is performed of ine by the gateway GW. The gate- way device GW generates a random master key Mk of 160 bit size. The gateway GW computes public key Pk = Mk*P where P is a generator point of elliptic curve. The gateway computes i = H(GWID||UIDi||Mk) and j = H(GWID||SMID||Mk) where GWID is the gateway identity, UIDi is the identity of the ith user and SMID is the identity of the smart meter. These identities are generated randomly by the gateway GW. The GW stores the UIDi, GWID and i in SHUis temper proof memory and SMID, GWID and j in the SMs temper proof memory. The GW stores (UIDi, i) and (SMID, j) in its own secret memory. B Registration Phase In the registration phase, the user SHUi and the smart meter SM register with the gateway GW through their identities. User Registration The user device sends the UIDi and Temp = H(UIDi|| i) to the gateway through the secure channel. The gateway device veri es the Temp = H(UIDi||H(GWID|| PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 93 Chapter 4. Secure Lightweight Key Exchange for User - Gateway - Sensor Paradigm UIDi||Mk)) ?= Temp. Now the gateway computes Uipub = ( i + Mk)*P and UiPri = 1 i+Mk as a public parameter and private parameter for the ith user respectively. Af- ter the successful computation, the gateway GW provides (Fp, P, E, n, H(.),Uipub,UiPri, UIDi, SMID, GWID) to the user. The User SHUi stores these parameters with i in its temper proof memory. Smart Meter Registration The smart meter sends the SMID and Temp1 = H(SMID|| j) to the gateway through the secure channel. The gateway device veri es the Temp 1 = H(SMID|| H(GWID||SMID||Mk)) ?= Temp1. Now the smart meter computes SMpub = ( + Mk)*P and SMPri = 1 i+Mk as a public parameter and a private parameter for the smart meter SM respectively. After the successful computation, the gateway GW provides (Fp, P, E, n, SMIDt, IDSMt H(.),SMpub,SMPri, UIDi, SMID, GWID) to the smart meter. The smart meter SM stores these parameters with j in its temper proof memory. Here the SMIDt is the secret token for the smart meter and the IDSMt is the token identi er for SM. C Authentication and Key Exchange Phase In the authentication and key establishment phase, the user SHUi establishes a shared session key SKusm to receive the data from the smart meter SM. The au- thentication and key-establishment phase is performed through an uncon dent channel, and the whole communication of this phase is available to an intruder A. Summary of authentication phase is given in Table 4.2. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 94 Chapter 4. Secure Lightweight Key Exchange for User - Gateway - Sensor Paradigm User SHUi Message1 Gateway GW: The user SHUi selects the random number r1 and computes the X1 = r1*P and X2 = X1 *UiPri. The SHUi computes the parameter M1 = H(UIDi||SMID||GWID||X1||X2|| i||T1), M2 = UIDi L i, M3 = SMIDL i. The user SHUi creates a rst request as a mes- sage 1 = (X1, M1,M2,M3,T1) and sends the message 1 to the gateway GW. Here T1 is the current time stamp. It is assumed that the clock between SHUi, GW and SM is synchronized. Gateway GW message2 Smart Meter SM: The gateway GW veri es the time-stamp T1 by verifying T T 1 -T1 where T is the pre-de ned timing threshold and T 1 is the current time-stamp at gateway. The gateway GW retrieves UIDi till it successfully performs UID i ?= M2 L i where UID i and i is the stored pair. The gateway retrieves SMID in similar way by computation of SMID ?= M3 L i where SMID is the retrieved identity of the Smart Meter. Gateway GW nds the suitable j for the SMID from its secret memory. The gateway veri es M 1 = H(X1||X2||UID i ||SMID ||GWID|| i ||T1) ?= M1 by computing X 2 = 1 Mk+ i . After the successful veri cation of the user, the gateway GW computes the parameters for the smart meter SM. The gateway GW selects the random number r2 and computes Z1 = r2*P and Z2 = 1 Mk+ j . The gate- way computes M4 = H(UID i ||SMID||GWID||Z1||Z2|| j||T2), M5 = H(SMID||GWID||Mk) L GWID and M6= H(SMID||GWID||Mk) L UID i , M7 = X 2 L j where T2 is the current time-stamp. The gateway GW creates the second message as a mes- sage 2 = (Z1, M4, M5, M6, T2, M7) and sends the message 2 to the smart meter SM with an identity as a SMID. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 95 Chapter 4. Secure Lightweight Key Exchange for User - Gateway - Sensor Paradigm Smart Meter SM message3 Gateway GW: The smart meter SM veri es the time-stamp T2 by verifying T T 2 -T2 where T is the pre-de ned timing threshold and T 2 is the current time-stamp at smart meter. The Smart meter computes GWID = j L M5, UID i = j L M6, Z 2 = Z1 * SMPri and performs the veri cation, M 4 = H(UID i ||GWID ||Z1||Z 2||T2|| j) ?= M4. After the successful veri cation of M4, the smart meter performs the further computation. The smart meter SM generates the random number r3, computes Y1 = r3*P,Y2=H(Y1||UID i ), X 2 = M7 Lrho j, Y3 = r3 * Pk, M7 = H(UID i ||GWID ||Y2 ||SMID||Y3|| j||T3) and M8 = H(Z 2||X1||Pk). Here T3 is the current time-stamp at smart meter. The smart meter creates a third message as a message 3 = (Y1,Y2,M7,M8,T3,T2) and sends message 3 to the gateway GW. The smart meter SM computes the ses- sion key, SKusm = H(UID i ||SMID||GWID ||T2||T3||X 2 ||Y 3 ). Gateway GW message4 User SHUi: The gateway GW veri es the time-stamp T3 by verifying T T 3 -T3 where T is the pre-de ned timing threshold and T 3 is the current time-stamp at gateway. The gateway performs Y 2 = H(Y1||UID i ) ?= Y2, Y 3 =Y1 * Mk, M7 = H(UID i ||GWID|| SMID||Y 2 ||Y 3 ||T3|| j) ?= M7, M 8 = H(Z2||X1||Pk) ?= M8. After the successful veri- cation of all the messages, the gateway computes Y4 = i LY 3 , K1 = H(Y 3 ||UIDi ||SMID||X 2 ||GWID||T4), K2 = H(K1||T4||GWID||T3||T2||T1), K3 = H(GWID|| i ||T4||UIDi||SMID). The gateway creates a fourth message as, message 4 = (K2, K3, Y4, T4) and sends message 4 to the user SHUi with identity as UIDi. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 96 Chapter 4. Secure Lightweight Key Exchange for User - Gateway - Sensor Paradigm User SHUi: The user veri es the time-stamp T4 by verifying T T 4 -T4 where T is the pre-de ned timing threshold and T 4 is the current time-stamp at SHUi. The user veri es K3 = H(UIDi||GWID||T4||SMID|| i) ?= K3 and computes Y 3 = Y4 L i, K 1 = H(Y 3 ||UIDi||SMID||GWID||T4||X2), K 2 = H(K 1||T1||T2||T3||T4) ?= K2, and computes the session key, SKusm = H(UIDi||SMID||GWID||T2||T3||X2||Y 3 ). 4.5 Security Analysis A Informal Security Analysis This subsection discusses the informal security analysis for the proposed scheme. It discusses how the proposed protocol is secured against various attacks for the Dolev-Yao channel. The Dolev-Yao channel is a send and receive insecure chan- nel which is widely accepted in security protocols [Dolev & Yao (1981)]. MUTUAL AUTHENTICATION The mutual authentication property in security protocol assures that both the com- municating entities have trust on each other and both are assured about the iden- tity of each other. In the proposed protocol, the user SHUi communicates with the smart meter SM via the trusted entity gateway GW. So whenever the user SHUi and the smart meter SM establish the session key SKusm, they both verify the iden- tity of each other. In the message 1, SHUi sends M2 = UIDi L i in which UIDi is PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 97 Chapter 4. Secure Lightweight Key Exchange for User - Gateway - Sensor Paradigm User Gateway Smart Meter Selects r1, computes X1 = r1*P and X2 = X1 * UiPri. , M1 = H(UIDi||SMID||GWID||X1||X2|| i||T1), M2 = UIDi L i, M3 = SMIDL i. Sends message 1 = (X1, M1,M2,M3,T1) to GW Verify T T 1 -T1, retrieves UIDi by UID i ?= M2 L i , retrieve SMID by SMID ?= M3 L i . veri es M 1 = H(X1||X2||UID i ||SMID ||GWID || i ||T1) ?= M1 by com- puting X 2 = 1 Mk+ i . se- lects r2 and computes Z1 = r2*P and Z2 = 1 Mk+ j , M4 = H(UID i ||SMID||GWID||Z1||Z2 || j||T2), M5 = H(SMID||GWID||Mk) L GWID and M6= H(SMID||GWID||Mk) L UID i , M7 = X 2 L j. Send message 2 = (Z1, M4, M5, M6, T2, M7) to SM Verify T T 2 -T2, Com- putes GWID = j L M5, UID i = j L M6, Z 2 = Z1 * SMPri and performs M 4 = H(UID i ||GWID ||Z1||Z 2 ||T2|| j) ?= M4. Generates r3, computes Y1 = r3*P, Y2=H(Y1||UID i ), X 2 = M7 Lrhoj, Y3 = r3 * Pk, M7 = H(UID i ||GWID ||Y2||SMID ||Y3|| j||T3) and M8 = H(Z 2||X1||Pk). Sends mes- sage 3 = (Y1,Y2,M7,M8,T3,T2) to GW Veri es T T 4 - T4, veri es K3 = H(UIDi||GWID||T4||SMID|| i) ?= K3 and computes Y 3 = Y4 L i, K 1 = H(Y 3 ||UIDi||SMID||GWID||T4 ||X2), K 2 = H(K 1||T1||T2||T3||T4) ?= K2. Verify T T 3 -T3. per- forms Y 2 = H(Y1||UID i ) ?= Y2, Y 3 =Y1 * Mk, M7 = H(UID i ||GWID||SMID|| Y 2 ||Y 3 ||T3|| j) ?= M7, M 8 = H(Z2||X1||Pk) ?= M8. Com- putes Y4 = i LY 3 , K1 = H(Y 3 ||UIDi||SMID||X 2 ||GWID||T4), K2 = H(K1||T4||GWID||T3 ||T2||T1), K3 = H(GWID|| i ||T4||UIDi||SMID). Send message 4 = (K2, K3, Y4, T4) to user SKusm = H(UIDi|| SMID|| GWID|| T2|| T3|| X2||Y 3) SKusm = H(UID i || SMID|| GWID || T2||T3|| X 2 ||Y 3 ). TABLE 4.2 Authentication and Key Exchange PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 98 Chapter 4. Secure Lightweight Key Exchange for User - Gateway - Sensor Paradigm an identity of the user and i is a secret parameter which is computed using the se- cret master of the gateway device. The gateway device can achieve the authentica- tion of the user device by performing M 1 = H(X1||X2||UID i ||SMID ||GWID|| i ||T1) ?= M1. Similarly the smart meter con rms the authenticity of user and gateway device by performing M 4 = H(UID i ||GWID ||Z1||Z 2||T2|| j) ?= M4 and the user performs authenticity veri cation of gateway and sensing device by computing K3 = H(UIDi||GWID||T4||SMID|| i) ?= K3. The whole authenticity veri cation is secured against the one-way hash function so the integrity veri cation is also achieved over here. USER NON-TRACEABILITY The non-traceability property in the IoT based applications assures that even though the adversary A captures the identity of user SHUi, A must not be able to trace the other communication of user SHUi. Now let us assume that an adversary A capture UIDi as an identity for ith user. Now SHUi communicates the message 1 = (X1, M1,M2,M3,T1) in which M1 and M2 includes an identity of user SHUi but an adversary does not know the other parameter i which is required to generate M1. Similarly A doesn t know the parameters like X2 and GWID so for an adversary A can t compute M2 also by achieving UIDi. Similarly all the messages which includes an identity of user are either secured through hash function or XOR op- eration with the secure parameter. So the proposed protocol achieves the user non-traceability property. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 99 Chapter 4. Secure Lightweight Key Exchange for User - Gateway - Sensor Paradigm ANONYMITY AND UNSINKABLE Let us assume that an adversary A captures all the communicated messages through an insecure channel. The user communicated message 1 with the gateway GW in which the user sends computed parameters to the gateway but doesn t send its identity in plain text. The gateway device communicates the message 2 with the smart meter and the message 4 with the user. In none of the message, gateway device doesn t communicate it s identity GWID through a public channel. Sim- ilarly, the smart meter communicates the message 3 with the gateway device but the SM doesn t send SMID in plain text. So all the three identities UIDi, GWID and SMID are secured through a hash function and the XOR with secret parame- ters. So the anonymity property is achieved in the proposed protocol. All the three entities SHUi, GW and SM generates r1, r2 and r3, the random numbers before the computation of other parameters. The random number assures that the message 1 and message 1* by user SHUi will not be similar. Similarly message 2, message 4 by gateway GW will not be similar to other messages message 2*,message 4* by same gateway GW due to the random numbers . So an adversary A can t link the two messages of the same entity. Thus the proposed protocol also achieves unlinkability property. Scheme F1 F2 F3 F4 F5 F6 F7 F8 F9 F10 [Farash et al. (2016)]           [Amin et al. (2018)]           [Zhou et al. (2019)]           [Poh et al. (2019)]           Proposed           TABLE 4.3 Security Comparison PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 100 Chapter 4. Secure Lightweight Key Exchange for User - Gateway - Sensor Paradigm Security attacks in Table 4.3 are noti ed as : F1 = User anonymity, F2= Re- play attack, F3= Of ine Password guessing attack, F4 = Mutual authentication and MITM attack,F5 = Privilege insider attack,F6 = Perfect forward secrecy,F7 = Denial of Service attack, F8 = User impersonation attack, F9 = gateway imper- sonation attack, F10 = Stolen smart card attack. SECURE AGAINST REPLAY ATTACK In the replay attack, an adversary A try to create the trust by re-communicating the previously communicated messages by valid entities. Let us assume that an adversary A eavesdrops the message 1 = (X1, M1,M2,M3,T1), message 2 = (Z1, M4, M5, M6, T2, M7), message 3 = (Y1,Y2,M7,M8,T3,T2), message 4 = (K2, K3, Y4, T4). Now let us assume that an adversary A replays message 1 after sometime to gateway GW. The gateway veri es T T 1 -T1 where T is the pre-de ned timing threshold and T 1 is the current time-stamp at gateway. The veri cation will fail because the value of T will exceed the prede ned threshold. Similarly whenever the adversary A try to re-communicate the other messages message 2,message 3,message 4, the gateway GW, the user SHUi and the smart meter SM verify the time-stamp threshold T. None of the replayed message will satisfy this threshold, thus the proposed protocol is secured against the replay-attack. SECURE AGAINST MITM ATTACK In the MITM attack, an adversary capture the message, modify the message and send the message to destination. The adversary A modi es the message in such a way that destination accept the modi ed message. Now let us assume that an adversary A captures message 1 = (X1, M1,M2,M3,T1) and try to modify any of the PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 101 Chapter 4. Secure Lightweight Key Exchange for User - Gateway - Sensor Paradigm value. Let us assume that A modi es X1 then at the gateway M 1 = H(X1||X2||UID i ||SMID ||GWID|| i ||T1) ?= M1 veri cation will fail. The adversary A can t gen- erate X2 and i from the public parameters. Similarly any modi cation to other messages will fail the UID i ?= M2 L i and SMID ?= M3 L i veri cation. Sim- ilarly when ever an adversary A modi es the message 2, the veri cation M 4 = H(UID i ||GWID ||Z1||Z 2||T2|| j) ?= M4 will not be get success. The modi cation in message 3 and message 4 will fail the M7 = H(UID i ||GWID||SMID||Y 2 ||Y 3 ||T3|| j) ?= M7 and K3 = H(UIDi||GWID||T4||SMID|| i) ?= K3 veri cation respectively. So any modi cation or new message in the proposed protocol doesn t give success to an adversary A and thus the proposed protocol is secured against the Man-In- The-Middle attack. RESISTANT TO SMART METER COMPROMISED ATTACK The physical attack on smart devices is one of the most challenging attack in the IoT network. In the smart home environment, the smart devices are physically secured and it is dif cult for an adversary to capture the smart meter SM in phys- ical. Let us assume that an adversary A performs the physical attack on smart meter SM and try to perform the power analysis attack [Kocher et al. (1999)] to get the secret parameters stored in side the smart meters. Now let us assume that an adversary A captures (Fp, P, E, n, SMIDt, IDSMt H(.),SMpub,SMPri, j ,UIDi, SMID, GWID) from the smart meter s memory. Now the session key computation, SKusm = H(UIDi||SMID||GWID||T2||T3||X2||Y 3 ) which includes X2 and Y3 which are computed based on randomly generated parameters r1 and r3 respectively. The messages X2 and Y3 are never communicated through public channel. The Y3 is secured through the private master of the gateway GW. Thus PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 102 Chapter 4. Secure Lightweight Key Exchange for User - Gateway - Sensor Paradigm even through the adversary physically captures (which is very dif cult in smart home environment) the smart meter, the adversary A can t compute the session key SKusm. RESISTANT TO IMPERSONATION ATTACK The adversary A willing to impersonate the user SHUi, may try to capture the message 1 = (X1, M1,M2,M3,T1) in the rst communication.However the adversary A can not know the real identity of the user SHUi which is UIDi. The identity of SHUi is con dential through the secret i and the hash function H(.). Since the secret key SKusm = H(UIDi||SMID||GWID||T2||T3||X2||Y 3 ) is computed using the identity of all the 3 entity and none of the identity is communicated in the plain text. Similarly let us assume that an adversary A try to impersonate smart meter SM and capture the message 3 = (Y1,Y2,M7,M8,T3,T2). The identity of smart meter is secured through the secret j and smart gateway master Mk. The secrets i and j is secured through the master secret of the gateway GW. Thus, the proposed protocol is secured against the impersonation attack. SECURED AGAINST GATEWAY NODE BYPASSING ATTACK In the gateway node by passing attack, an adversary A try to replace the gateway node and works as a trusted entity between the user SHUi and the smart meter SM. Let us assume adversary A receives the message 1 = (X1, M1,M2,M3,T1) and com- pute the parameters for the smart meter SM. Let us assume that an adversary A creates message2 = (Z 1, M 4, M 5, M 6, T 2 , M 7) and sends it to the smart meter SM. Now when the smart meter performs M 4 = H(UID i ||GWID ||Z1||Z 2||T2|| j) ?= M4, this veri cation doesn t get success because the adversary doesn t know the PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 103 Chapter 4. Secure Lightweight Key Exchange for User - Gateway - Sensor Paradigm correct value of j which is computed by the real gateway device for the smart meter SM by using it s own master secret Mk. Similarly at user side, the veri - cation K3 = H(UIDi||GWID||T4||SMID|| i) ?= K3 doesn t get success due to the secret parameter i computed by the real gateway GW. Thus for any adversary A, it s impossible to bypass the gateway device GW and so that the proposed scheme is secured against the gateway node by passing attack. B Mutual Authentication using BAN Logic This section discusses the mutual authentication veri cation between the user SHUi and the lightweight device SM using the BAN Logic. This proof mainly consists of the following steps: (I) Initial assumption, (II) Goal declaration, (III) Message formation, and (IV) Formal veri cation. 1. Initial assumptions: J1. SHUi | #(Ti), SMj | #(Ti),GW | #(Ti); J2. SHUi | #(r1), GW | #(r2), SMj | #(r2), SHUi | #(r3); J3. GW | SHUi X, GW | SMj X, SMj | GW X. J4. SHUi | ( GWID 7 GW), SMj | ( RIDUi 7 Ui), GW | ( SID j 7 SMj) J5. SHUi | SMj (SHUi SK SMj) 2. Goal Declaration: The expected goals in the proposed LDA scheme in- cludes trust in shared key and freshness of communicated messages. In LDA scheme, expected goals are as follow: G1. SHUi | SHUi SK SMj PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 104 Chapter 4. Secure Lightweight Key Exchange for User - Gateway - Sensor Paradigm G2. SMj | SHUi SK SMj G3. SHUi | SMj | SHUi SK SMj G4. SMj | SHUi | SHUi SK SMj G5. SHUi | GW | #(X) G6. GW | SMj | #(X) G7. SMj | GW | #(X) 3. Message Formation: The login and Authentication phase of the proposed LDA scheme includes exchanges of the following messages which can be written in the generic form as follow: Message 1: SHUi GW: (X1, M1,M2,M3,T1) Message 2: GW SMj: (Z1, M4, M5, M6, T2, M7) Message 3: SMj GW: (Y1,Y2,M7,M8,T3,T2) Message 4: GW SHUi: (K2, K3, Y4, T4) Idealized form: The ideal forms for the above messages can be written as follows: Message 1: SHUi GW: GW < ((r1*P), (H(UIDi||SMID||GWID||X1||X2|| i||T1)), (UIDi L i), (SMIDL i), T1 > GW| ( SID j 7 SMj) Message 2: GW SMj: SMj < ((r2*P), (H(UID i ||SMID||GWID||Z1||Z2|| j||T2)), (H(SMID||GWID||Mk) L GWID), (H(SMID||GWID||Mk) L UID i ), (X 2 L j), T2) > SMj| ( GWID 7 GW) PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 105 Chapter 4. Secure Lightweight Key Exchange for User - Gateway - Sensor Paradigm Message 3: SMj GW: GW < ((r3*P), (H(Y1||UID i )), (H(UID i ||GWID ||Y2||SMID||Y3|| j| (H(Z 2||X1||Pk)), T3, T2) > GW| ( SID j 7 SMj) Message 4: GW SHUi: SHUi < ((H(K1||T4||GWID||T3||T2||T1)), (H(GWID|| i ||T4||UIDi||SMID)), ( i LY 3 ), T4) > 4. Formal Veri cation Theorem 1. The proposed scheme achieves the secure mutual authentica- tion between the user SHUi and the sensing device SMj, and it achieves expected goals. Proof. Expected goals are [G1 - G7] achieved as follow: S1: from the message 1, GW < ((r1*P), (H(UIDi||SMID||GWID||X1||X2|| i||T1)), (UIDi L i), (SMIDL i), T1 > GW| ( SID j 7 SMj) S2: Using S1, R1 and J1, GW | SHUi | < ((UIDi||SMID||GWID||X1||X2|| i||T1)), (UIDi L i), T1) > S3: Using S2, J2, R2, GW | SHUi | < ((UIDi||SMID||GWID||X1||X2|| i||T1), (SMIDL i), T1) > S4: from the message 2, SMj < ((r2*P), (H(UID i ||SMID||GWID||Z1||Z2|| j||T2)), (H(SMID||GWID||Mk) L GWID), (H(SMID||GWID||Mk) LUID i ), (X 2 L j), T2) > SMj| ( GWID 7 GW) S5: Using S4, R2, R5 and J2, PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 106 Chapter 4. Secure Lightweight Key Exchange for User - Gateway - Sensor Paradigm SMj | GW | < ((r2*P), (UID i ||SMID||GWID||Z1||Z2|| j||T2), ((SMID||GWID||Mk) L GWID), T2) > S6: Using S4, R4, R6 and J3, SMj | GW | < ((r2*P), (UID i ||SMID||GWID||Z1||Z2|| j||T2), ((SMID||GWID||Mk) L UID i ), (X 2 L j), T2), T2) > S7: Using S4, S5, R1, R7 and J1, SMj | (SMID||GWID||Mk) LUID i ), SMj | (UID i ||SMID||GWID||Z1||Z2|| j||T2), S8: from the message 3, GW < ((r3*P), (H(Y1||UID i )), (H(UID i ||GWID ||Y2||SMID||Y3|| j||T3)), (H(Z 2||X1||Pk)), T3, T2) > GW| ( SID j 7 SMj) S9: Using S8, R3, R4 and J4, GW | SMj | < ((r3*P), (Y1||UID i ), (UID i ||GWID ||Y2||SMID||Y3|| j||T3), T2, T3) > S10: Using S8, S9, R8, GW | SMj | < ((r3*P), (UID i ||GWID ||Y2||SMID||Y3|| j||T3), (Z 2||X1||Pk), T3, T2) > S11: Using S8, S9, R10, R8 and J1, GW | (Y1||UID i ), SMj | (UID i ||GWID ||Y2||SMID||Y3|| j||T3, S12: from the message 4, SHUi < (((K1||T4||GWID||T3||T2||T1)), ((GWID|| i ||T4||UIDi||SMID)), ( i LY 3 ), T4) > S13: Using S12, R3, R8 and J1,, PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 107 Chapter 4. Secure Lightweight Key Exchange for User - Gateway - Sensor Paradigm SHUi | GW | < ((K1||T4||GWID||T3||T2||T1), (GWID|| i ||T4||UIDi||SMID) T4) > S14: Using S12, S13, R3, R8 and J1, SHUi | GW | < ( i LY 3 ), T4) > S15: Using S13, S14, R3, R8 and J1,, SHUi | (GWID|| i ||T4||UIDi||SMID), S16: Using S1, S7, S8, R3, R8 and J1,, SMj | Ui SK SMj [G2] S17: Using S4, S10, S12, R3, R8 and J1,, SHUi | SHUi SK SMj [G1] S18: Using S7, S11, S13, S14, S16 J4, R4, and R7, SHUi | SMj | SHUi SK SMj [G3] S19: Using S9, S12, S14, J4, R1, R6 and R7, SMj | SHUi | SHUi SK SMj [G4] S20: Using S3, S7, S9, R4, R6, R7, J2 and J4, SMj | GW | #(Message1) S21: Using S8, S12, S14, S18, R6, R9, J3 and J5, SMj | GW | #(Message1,Message3) [G7] S22: Using S9, S11, S15, R4, R7, J3 and J5, GW | SMj | #(Message2) [G6] S23: Using S19, S20, S21, R3, R5, J2, J4, PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 108 Chapter 4. Secure Lightweight Key Exchange for User - Gateway - Sensor Paradigm SHUi | GW | #(Message4) [G5] Thus, the above veri cation clearly shows that the proposed authentication scheme achieves all de ned goals (G1 - G7). C Formal Security Analysis Using ROR The ROR model [Abdalla & Pointcheval (2005)] is widely accepted security model to preform the formal security analysis. The ROR model is based on random ora- cles, which are oracle queries performed by an adversary A to perform the various attacks on the proposed scheme. The basic objective of an adversary A is to dis- tinguish the real session key and retrieved random values successfully. A similar approach to formal security analysis is also applied in [Roy et al. (2018)]. Random Oracles: The random oracles are hash function H(.) which outputs non-reversible random value ri for any message mi. Participants and oracle instances: In the proposed scheme, there are three participants, the user SHUi, the gateway GW, and the smart meter SM. Let us assume that x Ui, y GW, and z SM are oracles with the instances x, y and z for the SHUi, GW and Sj respectively. Partnering: The two oracle instances t1, t2 are the partnering instances if both share the same sid (transcript of all messages) and both are in the acceptance state. Freshness: The oracle t1 is fresh if no reveal query is performed by an ad- versary A on the instance t1. Adversary: The adversary A is an intruder who controls the complete Dolev- Yao channel and performs the oracle queries. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 109 Chapter 4. Secure Lightweight Key Exchange for User - Gateway - Sensor Paradigm R( t1) : The reveal query provides a session key computed by an instance t1 with its partnering instances t2. T ( t1) :. The test query provides a random key size value to an adversary based on the value of bit b decided by adversary A using an unbiased coin. This query is performed for a limited number of times for one session. S( t1,mi) The send query enables an adversary A to perform the communi- cation using message mi with an instance t1. E( t1, t2) The execute query enables an adversary A to perform the passive monitoring of communicated messages between legal instances t1 and t2. CorruptSmartMeter The query CorruptSmartMeter enables an adversary A to capture the stored information inside the secret memory of the smart meter. This query is performed for limited number of times for one session. CorruptUserDevice The query CorruptSmartMeter enables an adversary A to capture the stored information inside the secret memory of the user device. This query is performed for a limited number of times for one session. If the SUCC de nes the success of an adversary A then the advantage func- tion AdvP de nes the success of an adversary A in capturing SKusm. And if AdvP is negligible, then the proposed scheme is secured. Thus AdvP can be de ned as follows: AdvP(A) = 2 Pr[SUCC] 1 (4.1) The Formal Security Proof: The formal security proof for the proposed protocol can be given as follows: Theorem 2. The security of the proposed protocol from the polynomial time ad- PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 110 Chapter 4. Secure Lightweight Key Exchange for User - Gateway - Sensor Paradigm versary A is de ned as, AdvP(A) q2 h 2lh+1 + (qs +qe)2 2lr+1 + 1 2lr+1 (4.2) The lh, lr are the size of hash output and random number in bits respectively. Here the qh , qs and qe de ne the number of times in which hash query, send query and execute query are performed by an Adversary A. Proof. To prove the security of the proposed protocol P, Four security games (G0, G1, G2 and G3) are de ned. In the security games Pr[SUCC] de ne the suc- cess probability for an adversary to successfully distinguish computed or retrieved value and real session key SKusm. Game G0: The game G0 is an identical game to real protocol P. So the game G0 can be de ned as per shown in Equation. 5.2, AdvP(A) = 2 Pr[SUCC0] 1 (4.3) Game G1: The game G1 enables an adversary to perform a passive attack through the execute E query. Let us assume that an adversary A performs E( x, y, z) query to track the communicated messages between all the three participants. The Pr[SUCC] in this game for A depends on the computation of the session key SKusm from the tracked messages. There are four messages communicated by the three participants. Let us assume that through the E query, an adversary receives message 1 = (X1, M1,M2,M3,T1), message 2 = (Z1, M4, M5, M6, T2, M7), message 3 = (Y1,Y2,M7,M8,T3,T2), message 4 = (K2, K3, Y4, T4). Now the computation of SKusm = H(UIDi||SMID||GWID||T2||T3||X2||Y 3 ) which includes secured identi- PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 111 Chapter 4. Secure Lightweight Key Exchange for User - Gateway - Sensor Paradigm ties of all the three participants, also includes the parameters like X2 and Y3 which are secured through the master secret of trusted entity gateway device GW. None of the parameters required for the session key is received by A in the plain text. So after the game G1, Pr[SUCC1] = Pr[SUCC0] (4.4) The equation 5.3 shows that Pr[SUCC] for A is negligible under G1. Game G2: The game G2 enables an adversary A to perform the active at- tack through the simulation of Hash query and send query. The basic objective of an adversary A is to modify the messages and convince the communicated parties to accept the modi ed messages. Now let us assume that A receives mes- sage 1 = (X1, M1,M2,M3,T1) from SHUi and try to modify message 1 in such a way that gateway accept the modi ed message but the computation of M1 = H(UIDi||SMID||GWID||X1||X2|| i||T1), M2 = UIDi L i, M3 = SMIDL i in- cludes identities, random number based X1 and X2 and time stamp so there is no probability of occurrence of the collision. The collision probability of hash query is at most q2 h 2lh+1 [Chatterjee et al. (2018)] and collision probability for the random numbers is (qs+qe)2 2lr+1 [Chatterjee et al. (2018)]. So, through the birthday paradox: Pr[SUCC2] Pr[SUCC1] q2 h 2lh+1 + (qs +qe)2 2lr+1 (4.5) Game G3: The game G3 considers the other attacks performed by an adver- sary A using oracle queries. The A makes use of CorruptSmartMeter and Cor- ruptUserDevice and retrieves (Fp, P, E, n, SMIDt, IDSMt H(.),SMpub,SMPri, UIDi, SMID, GWID) and (Fp, P, E, n, H(.),Uipub,UiPri, UIDi, SMID, i , GWID) respec- tively. Now an adversary tries to compute the session key SKusm = H(UIDi||SMID PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 112 Chapter 4. Secure Lightweight Key Exchange for User - Gateway - Sensor Paradigm ||GWID||T2||T3||X2||Y 3 ) from the received values. Through these queries, A can get UIDi, SMID, GWID but can t compute the value X2 and Y3 because both the values depend on random numbers r1 and r3. The guessing probability of a ran- dom number for an A is 1 2lr+1. Hence, Pr[SUCC3] Pr[SUCC2] 1 2lr+1 (4.6) So now, after the completion of all the games, an option left with an adversary A is to toss the unbiased coin to guess the correct value of bit b whose probability is almost 1 2. So, from the Equation 5.2, 5.3, 6.3, 1 2AdvP(A) = Pr[SUCC1] Pr[SUCC3] (4.7) With the help of Equation 6.3,6.4,6.5, AdvP(A) q2 h 2lh+1 + (qs +qe)2 2lr+1 + 1 2lr+1 4.6 Implementation and Testbeds The proposed protocol is implemented using MQTT as an application layer pro- tocol and IP as a network layer protocol. An MQTT broker was installed in the gateway device. The user device make use of a 1GB RAM Mobile device. A laptop with Intel (R) Core(TM) i5-7500CPU with 3.40 GHz with 8GB RAM was used as a gateway device. As a smart meter, a raspberry pi 3.0 with 1 GB RAM PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 113 Chapter 4. Secure Lightweight Key Exchange for User - Gateway - Sensor Paradigm Figure 4.1. Session Key was used. The following Fig. 4.1 shows the computed session key between User SHUi and Smart Meter SM using the proposed protocol. For implementations we have used SHA256 as a hash function and NIST recommended P-256 Curve. The security level achieved through implementation of proposed scheme is 128 bit. 4.7 Use cases This chapter proposes RUA scheme for the user-gateway-sensor model. The pro- posed scheme aims to provide a lightweight communication between the user de- vice and the lightweight sensing device. The following are some of the signi cant use-cases of the proposed work. The proposed scheme can be used for secure and authenticated data ex- change in IoT applications such as smart home where home owner want to get realtime data from the sensing devices. it can be also useful in ST, SI, SH and many more applications where it needs ef cient and lightweight authentication mechanism between user (mobile/laptop) and the sensing devices. The proposed RUA scheme can be also useful for all the environment where user want to receive live data from the sensing devices. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 114 Chapter 4. Secure Lightweight Key Exchange for User - Gateway - Sensor Paradigm The novelty of the proposed work lies in its adaptive environment, lightweight computations and real-time implementations. Real-time implementation of the proposed ECC based scheme using MQTT protocol (that itself is a lightweight communication protocol used by the IoT industry) makes it novel. The real-time implementation using MQTT protocol has advantages like the lightweight header and reliable communication over other conventional protocols. 4.8 Comparative Analysis In this section, the performance analysis for the proposed scheme is given by comparing it with the other existing schemes of Farash et al. [Farash et al. (2016)], Amin et al. [Amin et al. (2018)], Zhou et al. [Zhou et al. (2019)] and Poh et al. [Poh et al. (2019)]. A Network Parameter Analysis In 2016, Farash et al. [Farash et al. (2016)] proposed an authentication scheme for the IoT environment in which the user device sends the request to the sens- ing device, and they both mutually authenticate with the gateway device. The communication cost in Farash et al. scheme was more than 3200 bits, and the computation cost was 0.6s.In 2018, Amin et al. [Amin et al. (2018)] proposed a scheme for patient monitoring by the doctor in which the doctor receives live patient data through the gateway device. The communication cost incurred by the scheme of Amin et al. was 3500 bits and 1.1s. Recently, In 2019, Zhou et al. [Zhou et al. (2019)] and Poh et al. [Poh et al. (2019)] proposed a scheme for a smart home where user device establishes a session key with a smart device PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 115 Chapter 4. Secure Lightweight Key Exchange for User - Gateway - Sensor Paradigm Scheme User Gateway Sensor Total Cost [Farash et al. (2016)] 632 792 2048 3472 [Amin et al. (2018)] 832 1120 320 3072 [Zhou et al. (2019)] 832 2048 672 3552 [Poh et al. (2019)] 640 2240 800 3680 Proposed 832 1248 864 2944 TABLE 4.4 Comparison of Communication Cost through a gateway device. The overall communication cost and computation cost up to session key establishment by Zhou et al. s scheme and Poh et al. s scheme were 3600bits, 3000bits, and 0.65s and 0.7s. The overall communication cost and computation cost in the proposed scheme are 2800 bits and 0.6s, which is lesser compared to the many recent schemes. The computation of key indexed is done through the various cryptanalysis performed on the [Farash et al. (2016)], [Amin et al. (2018)], [Zhou et al. (2019)] and [Poh et al. (2019)] or their discussion re- garding the security of proposed scheme in manuscript. B Communication Cost The communication represents the number of bits communicated over insecure channels. To compute the communication cost, 160 bits output size of the hash function and 160 bits identity size of each entity is considered. The size of a random number is 128 bits, and one of the timestamps is 28 bits. The size of the elliptic curve point is 320 bit, with each point size being 160 bits. Following Table 4.4 presents comparison of communication cost between proposed scheme and existing schemes. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 116 Chapter 4. Secure Lightweight Key Exchange for User - Gateway - Sensor Paradigm Scheme User Gateway Lightweight Device Total [Farash et al. (2016)] 11*Th 14*Th 7*Th 0.6934 [Amin et al. (2018)] 12*Th 16*Th 6*Th 0.9576 [Zhou et al. (2019)] 4*Tecm+5*Th 3*Tecm+7*Th 4*Tecm+6*Th 1.19933 [Poh et al. (2019)] 6*Th 2*Th+2*Te 6*Th 0.803 Proposed 4*Th 8*Th 4*Th 0.689 TABLE 4.5 Comparison of the Computation Cost C Computation Cost The computation cost gives information about the number of operations used in the proposed protocol. Let Th represent the hash operation; Tecm represents the elliptic curve multiplication and division operation. The computation cost of the XOR operation is not considered due to very little time required by it. The av- erage value of Th at the user device, gateway, and the smart meter is 0.00041 ms, 0.00034 ms, 0.0607 ms. The average value of Tecm at the user device, gate- way, and the smart meter is 0.0607 ms, 0.0589 ms, 0.0703 ms. Above Table 4.5 presents comparison of computation cost between proposed scheme and existing schemes. Following Fig.4.2. gives performance comparison of communication cost and computation cost of the proposed scheme with the existing schemes. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 117 Chapter 4. Secure Lightweight Key Exchange for User - Gateway - Sensor Paradigm Communication Costs in bits Computation Costs in s 0 500 1000 1500 2000 2500 3000 3500 4000 [Farash et al. (2016)] [Amin et al. (2018)] [Zhou et al. (2019)] [Poh et al. (2019)] Proposed 0 0.2 0.4 0.6 0.8 1 1.2 1.4 [Farash et al. (2016)] [Amin et al. (2018)] [Zhou et al. (2019)] [Poh et al. (2019)] Proposed Figure 4.2. Performance Comparison Chart 4.9 Summary The smart home and the smart grid are two widely accepted IoT Applications. This chapter proposes a secure authentication scheme for the user - gateway - sensor model with an example of smart home energy monitoring. This chapter presents an authentication scheme between the smart home user, the gateway, and the smart meter using elliptic curve cryptography. In the proposed authentication scheme, the gateway device works as an intermediary between the user and the smart meter. The formal security analysis of the proposed protocol is given using a random oracle based ROR Model and BAN Logic.The implementation of the proposed protocol is presented using an MQTT protocol. At last, performance comparison of the proposed protocol with the recently proposed other existing schemes for the same environment is given. The IoT based Smart grid is the future of the electricity transmission system, which will not only enhance the electricity distribution, but it will also reduce energy consumption. Similarly, the smart home PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 118 Chapter 4. Secure Lightweight Key Exchange for User - Gateway - Sensor Paradigm system also improves the living standard of the people. The primary concern is the security and privacy of their data. In proposed scheme, every user have to register for each sensing device. Now let us take scenario where user needs to receive data from hundreds of sensing device and it becomes dif cult to register each user for each sensor. Hence, to solve this problem, next chapter 5 proposes a level dependent authentication scheme using two factor based approach. It provides a novel approach though which number of registration in the IoT authentication can be reduced signi cantly. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 119 Chapter 5 Level Dependent Authentication us- ing Two Factor This chapter proposes a level dependent key exchange scheme between the user device, gateway device and the sensing device using two factor authentication. Section 3.1 presents introduction for the user-gateway model and proposed work. Section 5.2 provides literature review related to proposed scheme. Section 5.3 highlights threat model considered for designing authentication scheme. Section 5.4 presents proposed authentication scheme with all the phases. Section 5.5 put forward security analysis for the proposed scheme. section 5.6 provides imple- mentation aspects and use cases related to proposed work. section 5.7 presents performance comparison of the proposed work with other existing schemes based on communication cost and computation cost. section 5.8 summarise this chapter 1C. Patel, N. Doshi, Cryptanalysis and Improvement of Barman et al.s Secure Remote User Authentication Scheme , international journal of circuits, systems and signal process- ing, pp.604-610, Sept 2019 120 Chapter 5. Level Dependent Authentication using Two Factor Authentication with the limitations those are resolved in next chapter. 5.1 Introduction The sensing devices deployed on ground collect data from the environment and transmit those data to the nearby home agent (gateway). The neighboring home agents can be a micro-controller, micro-processor, mobile towers, routers, or any data receiver device which integrates data from the sensing devices and forwards those data to the users via other Internet devices. The recent study shows that the latest home agents also work like fog devices or edge computing devices ca- pable of performing the local data processing and converting those unorganized data into organized raw data. In traditional IoT network, deployed sensing de- vices create a local cluster and communicate pieces of information with the clus- ter heads (CHs) thorough the short-range protocols like Zigbee, Z-Wave, Beacon or Bluetooth Low Energy (BLE). In some of the IoT model, the sensing devices communicate with the cluster head through a wired medium. The CH connects the gateway devices (GW) with the sensing devices. The gateway devices are resource capable devices that can perform complex security operations and can forward the received data to the IoT application users through a long-range Inter- net protocol like IP or 6LoWPAN. In IoT, users can access stored data as well as realtime live data. Thus, the gateway devices transmit data to the cloud server for storage and processing or to the user for realtime monitoring. Secure storage and processing of the data in the cloud lead toward intelligent decision making through machine learning. In numerous recently proposed key agreement schemes, the ap- plication users register with the gateway devices for each sensing device [Zhou et PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 121 Chapter 5. Level Dependent Authentication using Two Factor Authentication al. (2019)], but let us take the realtime scenario in which there are thousands of sensing devices deployed on the ground. Users like the company owner or the cluster manager want to receive the data from each sensing device in realtime. Then, they need to register for each sensing device individually, which is not a practical and feasible solution. During deployment of the realtime scenario, it is observed that in the recently proposed schemes, the gateway needs to create a sep- arate smart card for each of the sensing devices for each of the application users who require Nu Nsd registrations and Nu Nsd time gateway initial computations. Here Nu shows the number of users, and Nsd indicates the number of sensing de- vices. Thus, this chapter presents a novel solution for the problems mentioned earlier, using a bizarre concept of the LDA. A Level Dependent Authentication To achieve successful access control in the IoT scenario is also one of the prin- cipal challenges. Essential factors that affect the liberty of access control is the availability of the tonnes of sensing devices and heterogeneity of their technical capabilities. Thus, for every user, if separate access control list is maintained or perform the registration, then it will be an unvaried task. As per the current liter- ature, the user registers for individual sensors. If the user is eligible for hundreds of sensing devices, then he/she needs to maintain hundreds of smart cards. This is a signi cant challenge to reduce the space requirement with less complexity and wipe out the user s multiple registrations. Rather than the traditional approach, a novel concept of the LDA is presented to tackle the above said challenges using a less computation cost, low energy PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 122 Chapter 5. Level Dependent Authentication using Two Factor Authentication consumption, fewer operations, and little memory requirement. The working of the LDA concept is highlighted in Fig. 5.1. The following algorithm provides a working mechanism of the LDA concept. INTERNET Level - I Level - I Level - I Level - I Level I+2 Level I+2 Level I+1 Level I+1 Level I+3 Level J User Level J+1 User Level J+2 User Level J+3 User Level Dependent Authentication [LDA] : If Level of User is j and want access sensor at level I <= j, than user will get successful authentication, else if level of user j > level of sensor I requested, than authentication will get failure. Figure 5.1. Network Model and Level Dependent Authentication Result: Access of Sensing Device to User User-level = i; Sensor-level = j; while Gateway received request from user do if j i then Access-Allowed; else Access-Not-Allowed; end end Algorithm 1: Level Dependent Authentication Therefore, the major advantages of using LDA can be listed as follows: Reduction in the access control complexity. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 123 Chapter 5. Level Dependent Authentication using Two Factor Authentication Number of registration phases and initialize phases will be reduced to the number of users rather than the number of sensing devices. Smooth replacement of the user device, sensing device, and gateway device compare to the existing traditional approach. Reduction of the computation cost, energy consumption, and memory uti- lization at user devices, gateway devices, and sensing devices. The major challenges and future research directions related to LDA concept can be listed as follows: Little increase in the computation cost at the gateway device. In the proposed scheme, the decision for users and sensors level will be taken by gateway. The proposed scheme can get further extension where separate authority like registration authority can be created for the purpose of initial parameter computation as well as level decision. 5.2 Literature Survey Recently, Shuai et al. published an authentication scheme for the smart home using an ECC [Shuai et al. (2019)]. In this chapter, the Registration Authority (RA) is a trusted entity that performs an initialization step and generates secret credentials for the sensing device SD j and the gateway node GW. The scheme proposed in [Shuai et al. (2019)] is a two-factor authentication scheme in which the user makes use of the password and smart card to perform the login and au- thentication. The other authentication scheme was recently proposed by Lyu et PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 124 Chapter 5. Level Dependent Authentication using Two Factor Authentication al. [Lyu et al. (2019)] for the intelligent home using ECC. Authors in [Lyu et al. (2019)] put forward an authentication scheme which provides security against the traceability and useful for the uncertain Internet services and environment like If This Then That (IFTTT) . In the same paper, authors give a formal se- curity analysis using a practical scyther tool. In 2018, Chifor et al. [Chifor et al. (2018)] proposed a unique authentication scheme for the Fast IDntity Online (FIDO) model. In the FIDO model, the user does not use any authentication fac- tors like a password. Still, it uses ECC generated parameters as keys stored by the trusted party and biometric-based access for those keys. The other authentication protocol for the smart home using a password was proposed by Naoui et al. in [Naoui et al. (2019)]. Authors in [Naoui et al. (2019)] proposed a lightweight and secure password-based authentication scheme called LSP-SHAP for the smart home monitoring and management. In 2016, Jo et al. proposed an authentication mechanism for the smart grid using ECC. Jo et al. [Jo et al. (2016)] proposed an authentication scheme between a smart meter (SM), Data Collection Unit (DCU), Advanced Metering Infrastructure (AMI) using ECC based key pair generation. In 2017, Vahedi et al. proposed an ECC based authentication scheme for the grid in [Vahedi et al. (2017)]. Authors in [Vahedi et al. (2017)] proposed an authentication mechanism be- tween a smart meter (which collects an energy consumption from smart appli- ances), a gateway (which aggregates the data from all smart meter) and operation center (which works as a bill generating location) using a Trusted Third Party (TTP). In 2018, Wazid et al. [Wazid et al. (2018)] proposed a User Authenticated Key Management Protocol (UAKMP) for the smart home IoT network. Authors in [Wazid et al. (2018)] followed the user-gateway-sensor based network model PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 125 Chapter 5. Level Dependent Authentication using Two Factor Authentication and the random oracle based ROR model for the formal security analysis. In 2019, Das et al. [Das et al. (2019)] proposed a lightweight access control and key agree- ment protocol for the IoT environment (LACKA-IoT) using ECC. Recently, in 2019, Gope et al. [Gope & Sikdar (2019)] proposed a privacy-preserving authen- tication scheme for the IoT devices using a Physical unclonable Function (PUF). The PUF provides a lightweight hardware implementation of the random number generator. In [Das et al. (2019)], the ROR based security model was followed, and the security simulation is produced using the AVISPA tool. They simulated the proposed protocol using a widely used simulator Network Simulator 2 (NS2). A publish-subscribe based MQTT protocol is widely accepted for IoT based applications. The Lohachab et al. [Lohachab & Karambir (2019)], in 2019, pro- posed an ECC based authentication and access control scheme for the MQTT based communications. The Machine to Machine communication through the MQTT protocol plays a signi cant role in automated service developments. The authors in [Esfahani et al. (2019)] proposed an authentication scheme between the sensing device and routing device (device-device) using lightweight operations like hash function and XOR operation. The Internet of Drones (IoD) is a net- work of uncrewed areal vehicles called Drones. In IoD based interface, the secure live streaming and reliable access control of the drone devices are essential secu- rity aspects. The authors in [Wazid et al. (2019)] set forth a crucial lightweight agreement scheme for the drone deployment in which the ground user securely communicates with the Drone Data Transmitter (DDT) through the server as a trusted entity. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 126 Chapter 5. Level Dependent Authentication using Two Factor Authentication 5.3 Threat Model The threat model used in this chapter is contemplated from the homogeneous model discussed in [Dolev & Yao (1981)]. An adversary A is an eavesdropper who controls the complete public communication channel. In the IoT based net- work model, it is possible to de ne an adversary A with the robust capabilities for improvement in the designing of the reliable protocol and also to perform the better security validation for the proposed authentication concept. the following adversarial model is followed in this chapter: G1. An Adversary A can compute valid pair of the identity password of ine in polynomial time using dictionary [Wazid et al. (2017)], [Gope & Sikdar (2019)]. G2. An Adversary A can extract the data from the user s smart card after receiv- ing smart card in either ways [Gope & Sikdar (2019)], [Shuai et al. (2019)]. G3. An Adversary A have full access on the communication channel between a User - Gateway, Sensor node - Gateway, and User - Sensor node [Wazid et al. (2018)], [Gope & Sikdar (2019)], [Shuai et al. (2019)]. G4. An Adversary A can get the previously computed session key between the user and sensor. A can use this key to compute the next session key [Kumar et al. (2015)]. G5. An Adversary A can have the level information of the user device or the sensing device at a time but can t have the level of both at a time [Shuai et al. (2019)]. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 127 Chapter 5. Level Dependent Authentication using Two Factor Authentication G6. An Adversary A can have the secrets of a gateway node during the system failure situations. A can use this old secrets to break the newly established system after failure. G7. An Adversary A can perform the physical attacks on sensor nodes and can retrieve the information stored into it [Kumar et al. (2015)]. G8. An Adversary A can generate bot nodes and can send the simultaneous ping messages to the sensor node with the aim to perform DoS attacks [Kumar et al. (2015)]. 5.4 Proposed Scheme In this section, the proposed Level Dependent Authentication Scheme for Generic IoT (LDA-GIoT) is discussed. An LDA-GIoT is proposed between the user device and the sensing device through the intermediary gateway node. As earlier said, it is assumed the gateway device as a trusted and secure node. The proposed vital agreement scheme consists of three phases: system initialization phase, user reg- istration phase, and login and key-agreement phase. The gateway device is con- sidered as a master device, and the key-agreement is also going to carry through the gateway device. The necessary notations used for designing of the proposed scheme are highlighted in Table 5.1. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 128 Chapter 5. Level Dependent Authentication using Two Factor Authentication Symbols Description Rx Random Number Tx Time-stamp li User Level lj Sensor Level Ui User Device Sj Sensor Device GW Gateway Node SIDj Sensor Identity UIDi User Identity GWID Gateway Identity Gp Elliptic Curve Generator T Time-stamp Threshold Ks Gateway Node Master Secret H(.) One-way Hash Function Enc(.)/Dec(.) ECC Encryption/Decryption L, || XOR and Concatenation Respectively TABLE 5.1 Notation and Abbreviations A System Initialize Phase In this subsection, the system s initialization phase is discussed. All steps in the initialization phase of the system are carried out by the gateway node in an of ine manner. Thus, message generation and message communication in this phase occur in a secure environment. The gateway device computes parameters for the user devices and sensing devices. The gateway device decides level for the user device based on the position of the user in an organizational hierarchy and the level of sensing device based on its location of deployment in the environment. It is necessary to observe that none of the devices store their levels in any format. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 129 Chapter 5. Level Dependent Authentication using Two Factor Authentication Gateway Initialize Phase The gateway initialize phase occurs as follow, Generates random private key RGWNk from the range of 1 to n where n is the large prime order of the elliptic curve. Generates a gateway random master key Ks. Computes gateway node public key as a PUBGWk = RGWNk * P, where P is the curve point. User Device Initialize Phase The user device initialize phase occurs as follow, Generates a random private key for each ith user as RUi from the range of 1 to n where n is a large prime order of the curve, and i ranges from 1 to the number of users in the IoT network. Computes public key for the user Ui as a PUBUi = RUi * P, where P is curve point. Gateway node will compute B1 = H(PUBUi||Ks) and B2 = H(li||Ks||H(PUBUi)) where li is level of ith user based on its role in organization and ks is mas- ter secret of gateway node. GWN will store B1 and B2 also in user device. GWN will it self not store. Sensor Device Initialize Phase The sensor device initialize phase occurs as follow, PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 130 Chapter 5. Level Dependent Authentication using Two Factor Authentication Generates a random number as a private key for each sensor node S j called as a RSNj. Computes public key for the sensing device S j as a PUBSj = RSNj * P, where P is the curve point. Generates random identity for each sensor node S j as a SID j. Gateway node will compute D1 = H(PUBSj||Ks) and D2 = H(l j||Ks||H(PUBSj)) where lj is level of jth sensor based on its role in organization and ks is mas- ter secret of gateway node. GWN will store D1 and D2 in sensor device. GWN will it self not store. Gateway node y parameters PUBGWk, PUBUi, PUBSj as a public parameters. B User Registration Phase In this section, the user registration process is discussed that is carried out in a secured manner between user device and the gateway device. The user registration phase follows following steps: 1. Ui Request GW: The user Ui selects the password UPWi, generates the ran- dom numbers Ra, Rb, computes the TPWi = H(UPWi||Ra) L Rb and sends Request = {UIDi} to the gateway GW. 2. GW SmartCard Ui: The gateway computes, Regi = H(UIDi||Ks), computes Bi = H(li||Ks||UIDi) where li is the level of ith user based on its role in the organization. Generate smart card SC = {Regi, Bi, H(.), Ep(a,b)} and sends to the user Ui. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 131 Chapter 5. Level Dependent Authentication using Two Factor Authentication 3. The user computes L1 = H(UIDi) L Ra, TPW i = TPWi L Rb, L2 = H(UIDi||TPW i ), Regi = Regi L Rb, replaces Regi by Regi in SC and creates nal SC = {Regi , L1, L2 ,Bi, H(.), Ep(a,b)} C Login and Session Key Agreement Phase In this subsection,the login phase and the session key agreement phase is presented in which the user device Ui wants to access the data from the sensing device Sj, and for that, it tries to establish a session key with the S j. In the login phase, the user provides UIDi, UPWi and SC to the Smart Card Reader (SCR), the SCR veri es all the parameter and computes new parameters for the key agreement phase. All the steps of the session key agreement phase perform through the public channel. In this phase, Ui sends a request to the GW. The GW veri es level and other parameters of the Ui and prove it s access capabilities. Later on, through the GW device, Ui and S j generates a mutually authenticated session key SK. Summary of authentication phase is given in Table 5.2. The login phase and the session key agreement consist of the following steps: 1. Ui Request SCR: The user provides UIDi and UPWi and SC to the SCR. The SCR computes Ra = L1 L H(UIDi ), TPWi = H(UPWi||Ra ), L2 = H(UIDi||TPWi ) and veri es L2 = L2. If veri cation gets success, SCR allows Ui for the further key agreement else abort the procedure. 2. Ui Message1 GW: Generate random number r1 Fp. Compute M1 = H(r1||B1), Get current time stamp T1, Compute M2 = H(M1||PUBUi||T1), Compute M3 = M2 PUBUi, Compute M4 = M1 M3, Compute M5 = EncPUBGWk(r1, PUBUi, PUBS j), Send Message 1 = (M3, M4, M5, T1). PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 132 Chapter 5. Level Dependent Authentication using Two Factor Authentication 3. GW Message2 S j: Verify time stamp T = T1 - T1, Compute M 1 = M3 M4, Get r 1, PUBUi, PUBSj = DecRGWNk(M5), Verify M 1 = H(r 1||H(PUBUi||KS)), Compute Tmp1 = H(PUBGWk||H(PUBSj||Ks)||T2), Send Message 2 = (Tmp 1, T2) to S j. 4. S j Message3 GW: Verify time stamp T = T2 - T2, Verify Tmp 1 = H(PUBGWk ||D1||T2) ?= Tmp1, If yes, send Message 3 = (M6 = H(PUBGWk||D1||T3), T3, D2) to GW, 5. GW Message4 Sj: Verify time stamp T = T3 - T3. Verify M 6 = H(PUBGWk ||H(PUBSj||Ks)||T3) ?= M6. Get li and lj from B2 and D2. if li lj, then allow else deny. Compute current time stamp T4. Generate random number k1. Compute M7 = H(k1||PUBGWk||PUBS j||PUBUi||r 1||T4). Compute M8 = PUBGWk PUBUi. Compute M9 = EncPUBSj(k1,r 1). Compute M10 = EncPUBUi(k1). Send Message 4 = (M7,M8,M9,T4) to SNj and Send Message 5 = (M10, T4) to Ui. 6. Ui computes: Veri es T T4 - T4. Get k 1 = DecRUi(M10). Gener- ate r2. M11 = EncPUBSj(r2). Send M11, T5. Compute session key SK = H((r1||PUBUi), H(k 1||PUBGWk||PUBSj||PUBUi||r1), r2, T5). 7. S j computes: Veri es T T4 - T4. Get k 1,r 1 = DeCRSNj(M9). Get PUBUi = M8 PUBGWk. Compute M 7 = H(k 1||PUBGWk||PUBSj||PUBUi||r 1 ||T3) ?= M7. X1 = H(k 1||PUBGWk||PUBSj||PUBUi||r 1 ). X2 = H(r1||RUi) and sleep. Wake up and Verify T T5 - T5. Get r 2 = DecRSNj(M11). Verify X2 = H(r1||RU i ) ?= X2. Verify X2 = H(r1||RU i ) ?= X2. Compute Session key SK = H(X2||X1||r 2||T5). PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 133 Chapter 5. Level Dependent Authentication using Two Factor Authentication User/SCR Gateway Sensor UIDi and UPWi and SC to SCR. Computes Ra = L1 L H(UIDi ), TPWi = H(UPWi||Ra ), L2 = H(UIDi||TPWi ) and veri es L2 = L2. Generate r1 Fp. Compute M1 = H(r1||B1), M2 = H(M1||PUBUi||T1), M3 = M2 PUBUi, M4 = M1 M3, M5 = EncPUBGWk(r1, PUBUi, PUBS j), Send Message 1 = (M3, M4, M5, T1). to GW Verify T = T1 - T1, Compute M 1 = M3 M4, Get r 1, PUBUi, PUBS j = DecRGWNk(M5), M 1 = H(r 1||H(PUBUi||KS)), Tmp1 = H(PUBGWk||H(PUBS j ||Ks)||T2), Send Message 2 = (Tmp 1, T2) to Sj. Verify T = T2 - T2, Verify Tmp 1 = H(PUBGWk||D1||T2) ?= Tmp1, If yes, send Message 3 = (M6 = H(PUBGWk||D1||T3), T3, D2) to GW, Veri es T T4 - T4. Get k 1 = DecRUi(M10). Generate r2. M11 = EncPUBS j(r2). Send M11, T5. Compute ses- sion key SK = H((r1||PUBUi), H(k 1||PUBGWk||PUBS j||PUBUi||r1), r2, T5). Verify T = T3 - T3, M 6 = H(PUBGWk||H(PUBSj||Ks)||T3) ?= M6. Get li and lj from B2 and D2. if li l j, then allow else deny. Compute T4. Generate random k1. Compute M7 = H(k1||PUBGWk||PUBS j||PUBUi ||r 1||T4), M8 = PUBGWk PUBUi, M9 = EncPUBS j(k1,r 1), M10 = EncPUBUi(k1). Send Message 4 = (M7,M8,M9,T4) to SNj and Send Message 5 = (M10, T4) to Ui. Veri es T T4 - T4. Get k 1,r 1 = DeCRSNj(M9). Get PUBUi = M8 PUBGWk. Compute M 7 = H(k 1||PUBGWk||PUBSj||PUBUi ||r 1 ||T3) ?= M7. X1 = H(k 1||PUBGWk||PUBSj||PUBUi ||r 1 ). X2 = H(r1||RUi) and sleep. Wake up and Verify T T5 - T5. Get r 2 = DecRSNj(M11). Verify X2 = H(r1||RU i ) ?= X2. Verify X2 = H(r1||RU i ) ?= X2. Compute Session key SK = H(X2||X1||r 2||T5). TABLE 5.2 Authentication and Key Exchange PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 134 Chapter 5. Level Dependent Authentication using Two Factor Authentication 5.5 Security Analysis A Informal Security Analysis The Dolev-Yao channel [Dolev & Yao (1981)] is a communication model based on snd and rcv operations. In this subsection, the informal security analysis for the proposed protocol based on a Dolev-Yao channel is presented. The polynomial time adversary A can access and control the Dolev-Yao channel. In the proposed scheme, the initialize phase implemented over the secure channel, and the gateway device is a trusted secure device. Table 5.3 presents security comparison between proposed schemes and existing schemes. ANONYMITY AND TRACEBILITY The anonymity for the security algorithm assures that an identity of the user is secured against the adversary s knowledge. In the initialize phase of the proposed scheme, the trusted GW generates an identity of the ith user as UIDi and jth sensing device as SIDj. Later on GW computes B1 = H(PUBUi||Ks) and B2 = H(li||Ks||H(PUBUi)) for each Ui and L2 = H(UIDi||TPW i ) in user registration phase. During the login and key-exchange phase, user communicates message M5 = EncPUBGWk(r1, PUBUi, PUBSj) which is secured through the public-key of gateway. Now, let us assume that an adversary A intercepts other messages. All the intercepted messages are either protected through the one-way hash function H(.) or the encryption. Thus, no vulnerability exists which helps an adversary A to achieve the UIDi. In many realtime application, it is expected that an adversary A must not be able to trace the user and messages communicated by him/her. The PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 135 Chapter 5. Level Dependent Authentication using Two Factor Authentication A can trace Ui if and only if an identity of the Ui is revealed. Thus, the proposed LDA based scheme achieves anonymity and tracebility. ACHIEVES MUTUAL AUTHENTICATION AND SESSION KEY AGREE- MENT The mutual authentication property assures each party that the message is received from the valid source. After receiving of the rst message from GW, the Sj device retrieves it s identity and performs veri cation of Tmp 1 = H(PUBGWk||D1||T2) ?= Tmp1. Any adversary A uses PUBGWk to prove himself/herself as a valid user, A does not get success due to presence of parameters like D1 in the veri cation which are not available with A. Similarly, veri cation M 6 = H(PUBGWk||H(PUBS j ||Ks)||T3) ?= M6 assure about the authenticity of S j to the GW. The veri cation X2 = H(r1||RU i ) ?= X2 helps user device Ui to authenticate the GW and the veri ca- tion M 7 = H(k 1||PUBGWk||PUBSj||PUBUi||r 1 ||T3) ?= M7 helps S j to authenticate the GW. The computed session key SK = H(X2||X1||r 2||T5) also includes identities of each entity in indirect manner and random numbers thus the proposed protocol achieves mutual authentication and session key agreement. SECURE AGAINST REPLAY ATTACK In the replay attack, an adversary A replays previously communicated messages after some time or in the next session. To provide security against the replay attack, the proposed scheme uses random parameters and timestamps. Each com- municated message contains time-stamp Ti which is validated by the receiving entity through T Ti - Ti veri cation where Ti is the current time at receiver side and T prede ned maximum threshold time. Even though A replays any PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 136 Chapter 5. Level Dependent Authentication using Two Factor Authentication message, the LDA receiver will catch that the received message is replayed. Thus, the proposed scheme is secure against the replay attack. SECURE AGAINST USER/SENSOR LEVEL SIDE CHANNEL ATTACK The level li de nes the level of user Ui in the hierarchy and lj de nes the level of sensing device S j in the deployment. If an adversary A gets the level li then he/she can guess the role of Ui in the organization, similarly if lj is available to the A then he/she can guess the sensing device deployment location. Thus, it is important to secure li and lj. In the proposed protocol, none of the entity (not even GW) stores li and lj. The Ui stores li in parameter B2 = H(li||Ks||H(PUBUi)) and the Sj stores l j in parameter D2 = H(lj||Ks||H(PUBS j)) which are protected by one-way hash function and the gateway master Ks. Hence, the proposed LDA-GIOT scheme is secured against a level side channel attack. KEY ESTABLISHMENT WITH PERFECT FORWARD SECRECY In perfect forward secrecy, it is assumed that the adversary A somehow obtains the user secret key RUi and sensing device secret key RSNj, then the adversary A can retrieve the the messages through the knowledge of RSNj. The hash func- tion protects the messages Mi, and ri is an unknown random number that does not provide any useful information. Similarly, through the RUi, an adversary A can obtain the messages. These all the parameters are secured through the one- way hash function and do not provide any useful information. The session key computed using SK = H((r1||PUBUi), H(k 1||PUBGWk||PUBSj||PUBUi||r1), r2, T5). Where parameter r2 is not available to A and A can not get k1 or r2 by just know- ing a RUi and RSNj. It is assumed that the user device s physical capturing and PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 137 Chapter 5. Level Dependent Authentication using Two Factor Authentication the user s secret key relieve will not coincide, and this assumption is valid because one is a physical attack while the other is a guessing attack. Thus the proposed LDA scheme achieves the perfect forward secrecy. GATEWAY DEVICE BYPASS ATTACK In the gateway device bypass attack, an adversary A tries to behave as a GW or any one of the device Ui or Sj try to behave as a GW. In the proposed scheme, dur- ing the initialize phase, the GW computes B1 = H(PUBUi||Ks) and B2 = H(li||Ks||H(PUBUi)) while D1 = H(PUBSj||Ks) and D2 = H(l j||Ks||H(PUBSj)) for Sj. All these com- putation involves gateway master secret Ks. Thus, neither A nor the Ui or Sj can compute the above parameters. Hence, the proposed LDA scheme is secured against gateway device bypass attack. STOLEN USER DEVICE ATTACK In this attack, an adversary A gets physical user device and retrieves stored pa- rameters B1 and B2. Now the session key is computed as SK = H(X2||X1||r 2||T5) where r2 is the random parameters. If an adversary A gets the user secret RUi then also he can not guess random rt. By capturing the user device, an adversary A can not capture the user identity also. Thus, it is computationally non-feasible for an adversary to compute the session key SK in polynomial time. SENSING DEVICE CAPTURE ATTACK In this attack, an adversary A gets the physical user device and gets stored pa- rameters {D1, D2}. Now if an adversary A tries to compute the session key SK = H((r1||PUBUi), H(k 1||PUBGWk||PUBSj||PUBUi||r1), r2, T5) then it requires three PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 138 Chapter 5. Level Dependent Authentication using Two Factor Authentication random numbers r1, r2 and as well as the timestamp T5. Thus, even though an adversary A physically attacks the sensing device as well as track the messages, he can not obtain the r1, r2 and rt from it. The sensing device does not store the sensing device identity; thus, through the sensing device attack, A can not track the sensing device also; thus the proposed scheme is secured against the sensing device capture attack. USER DEVICE IMPERSONATION ATTACK In this attack, an adversary A intercepts all the messages send by user Ui and tries to replace those messages by other manually generated messages. Let A inter- cepts Message 1 = {M3, M4, M5, T1}. The Message 1 is secured through the hash functions, still let us assume that A creates Message 1* = {M3*, M4*, M5*, T1*} and forwards it to gateway. Now the gateway device GW extracts data from the message Message 1* and performs the veri cation M 1 = H(r 1||H(PUBUi||KS)) which contains the fresh random number generated by Ui and the gateway mas- ter secret Ks which is computationally unfeasible to generate same Ks = Ks in a polynomial time for an adversary A. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 139 Chapter 5. Level Dependent Authentication using Two Factor Authentication Scheme S1 S2 S3 S4 S5 S6 S7 S8 S9 S10 S11 [Farash et al. (2016)]            [Wazid et al. (2018)]            [Zhou et al. (2019)]            [Shin & Kwon (2020)]            [Jangirala et al. (2020)]            LDA-GIoT            Legends: S1: Tracebility, S2: Anonymity, S3: Mutual authentication and Integrity, S4: Replay attack , S5: Man-in-The-Middle Attack, S6: Forward secrecy, S7: Gateway by pass attack, S8: Gateway impersonation attack , S9: Sensing device capture attack, S10: Privilege insider attack, S11: Level Dependent Authentication, : the protocol supports this feature, : the protocol doesn t support this feature. TABLE 5.3 Security Comparison Sensing Device Impersonation Attack In this attack, an adversary A intercepts all the messages send by the sensing device Sj to the gateway device GW. Let A intercepts Message 3 = (M6 = H(PUBGWk||D1||T3), T3, D2) and try to replace these messages by Message 3* = {(M6* = H(PUBGWk ||D1 ||T3 ), T3*, D2*)}. The message M6 is encrypted through the public-key of GW. At the other side after receiving this message, GW performs M 6 = H(PUBGWk||H(PUBS j||Ks)||T3) ?= M6 which includes secure mas- ter secret Ks. Thus, it is infeasible to generate a Message 3* which is similar to Message 3. Thus, the proposed LDA scheme is secured against a sensing device impersonation attack. Gateway Device Impersonation Attack In this attack, an adversary A intercepts all the messages send by the gateway device GW and trie to impersonate as a gateway device. Now let an adversary PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 140 Chapter 5. Level Dependent Authentication using Two Factor Authentication A captures Message 4 = (M7,M8,M9,T4) to SN and Send Message 5 = (M10, T4) and generates new messages Message 4* = (M7*,M8*,M9*,T4*) , Message 5* = (M10*, T4*). and forwards Message 4* and Message 5* to sensing device Ui and S j respectively. These messages are either encrypted by the device secrets respectively as well as hash functions. Thus it is infeasible to get these both the secrets in polynomial time for an adversary A. Hence, the proposed LDA scheme is secured against the gateway device impersonation attack. B Mutual Authentication Using BAN Logic In this section,the mutual authentication veri cation phase is discussed between the user Ui and the sensing device SDj using the BAN Logic. This proof mainly consists of the following steps: (I) Initial assumption, (II) Goal declaration, (III) Message formation, and (IV) Formal veri cation. 1. Initial assumptions: J1. Ui | #(Ti), SNj | #(Ti),GW | #(Ti); J2. Ui | #(r1), GW | #(r2), SD j | #(r2), Ui | #(r3); J3. GW | Ui X, GW | SNj X, SNj | GW X. J4. Ui | ( GWID 7 GW), SNj | ( RIDUi 7 Ui), GW | ( RSNj 7 SNj) J5. Ui | SNj (Ui SK SNj) 2. Goal Declaration: The expected goals in the proposed LDA scheme in- cludes trust in shared key and freshness of communicated messages. In LDA scheme, expected goals are as follow: PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 141 Chapter 5. Level Dependent Authentication using Two Factor Authentication G1. Ui | Ui SK SNj G2. SNj | Ui SK SNj G3. Ui | SNj | Ui SK SNj G4. SNj | Ui | Ui SK SNj G5. Ui | GW | #(X) G6. GW | SNj | #(X) G7. SNj | GW | #(X) 3. Message Formation: The login and Authentication phase of the proposed LDA scheme includes exchanges of the following messages which can be written in the generic form as follow: Message 1: Ui GW: ((M2 PUBUi), (M1 M3), (EncPUBGWk(r1, PUBUi, PUBSj), T1) Message 2: GW SNj: (H(PUBGWk||H(PUBS j||Ks)||T2), T2) Message 3: GW Ui: (H(PUBGWk||D1||T3), T3, D2) Message 4: GW SNj: ((H(k1||PUBGWk||PUBSj||PUBUi||r 1||T4)), (PUBGWk PUBUi), (EncPUBS j(k1,r 1)), T4) Message 5: GW Ui: (EncPUBUi(k1), T4) Idealized form: The ideal forms for the above messages can be written as follows: Message 1: Ui GW: GW < ((M2 PUBUi), (M1 M3), (EncPUBGWk(r1, PUBUi, PUBSj), T1) > GW| ( S j 7 Sj) PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 142 Chapter 5. Level Dependent Authentication using Two Factor Authentication Message 2: GW SNj: SNj < ((PUBGWk||H(PUBSj||Ks)||T2), T2) > Sj| ( Ui 7 Ui) Message 3: GW Ui: Ui < ((PUBGWk||D1||T3), T3, D2) > GW| ( Ui 7 Ui) Message 4: GW Sj: S j < (((k1||PUBGWk||PUBSj||PUBUi||r 1||T4)), (PUBGWk PUBUi), (EncPUBSj(k1,r 1)), T4) > Message 5: GW Ui: Ui < (EncPUBUi(k1), T4) > 4. Formal Veri cation Theorem 3. The proposed scheme achieves the secure mutual authentica- tion between the user Ui and the sensing device SD j, and it achieves ex- pected goals. Proof. Expected goals [G1 - G7] are achieved as follow: S1: from the message 1, GW < ((M2 PUBUi), (M1 M3), (EncPUBGWk(r1, PUBUi, PUBSj), T1)) > GW| ( Ui 7 Ui) S2: Using S1, R1, R2 and J2, GW | Ui | < ((EncPUBGWk(r1, PUBUi, PUBSj), T1) > S3: Using S1, S2, J1, R3, GW | Ui | < ((M2 PUBUi), (M1 M3), (EncPUBGWk(r1, PUBUi, PUBSj), T1)) > S4: from the message 2, S j < ((PUBGWk||H(PUBSj||Ks)||T2), T2) > S j| ( GWk 7 GWk) PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 143 Chapter 5. Level Dependent Authentication using Two Factor Authentication S5: Using S4, R1, R2 and J3, S j | GW | < (((PUBGWk||H(PUBSj||Ks)||T2), T2) > S6: Using S4, J2, R2, GW | SD j | < ((r3), (GWID||SID j||r3||T8), (GWID||SID j||r2||T8), T8) > S7: Using J3, J4, J6, R8, R2, S j | (GWID||SIDj||r3||T8), S j | (GWID||SIDj||r2||T8), S8: from the message 3, Ui < ((PUBGWk||D1||T3), T3, D2) > Ui| ( GWk 7 GWk) S9: Using S8, R2, J2, J3, Ui | GW | < (PUBGWk||D1||T3), T3, D2) > S10: Using S9, J3, J4, R4, Ui | GW | < (PUBGWk||D1||T3), T3, D2) > S11: from the message 4, Sj < (((k1||PUBGWk||PUBSj||PUBUi||r 1||T4)), (PUBGWk PUBUi), (EncPUBSj(k1,r 1)), T4) > S12: Using S11, R2, R3 and J1, S j | GW | < (((k1||PUBGWk||PUBSj||PUBUi||r 1||T4)), (PUBGWk PUBUi), (EncPUBSj(k1,r 1)), T4) > S13: Using S13, J2, R2, Sj | GW | < (((k1||PUBGWk||PUBSj||PUBUi||r 1||T4)), (PUBGWk PUBUi), (EncPUBS j(k1,r 1)), T4) > PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 144 Chapter 5. Level Dependent Authentication using Two Factor Authentication S14: Using S13, S14, J3,J4 R7,R3, S j | (PUBGWk PUBUi),(EncPUBSj(k1,r 1)),T4, S15: Using S11, S13, S4, S14, R2, R7, J3, S j | Ui SK Sj [G2] S16: Using S8, S9, S10, R4, R8, J3, Ui | Ui SK Sj [G1] S17: from the message 5, Ui < (EncPUBUi(k1), T4) > S18: Using S17, R8, R9 and J1, Ui | GW | < (EncPUBUi(k1), T4) > S19: Using S17, S18, J1, R8, Ui | GW | < (EncPUBUi(k1), T4) > S20: Using S3,S4, S14, S15, J5, R3, R7 and R8, S j | Ui | Ui SK S j [G3] S21: Using S9,S10, S11, J5, R3, R7 and R9, Uj | Sj | Ui SK S j [G4] S22: Using S20, S21, R5, R8, R6, S j | GW | #(Message1) S23: Using S4, S5, S12, S22, R3, R6, R7, J2 and J3, S j | GW | #(Message1,Message3) [G7] S24: Using S6, S12, S13, R3, R6, R8, J2 and J3, PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 145 Chapter 5. Level Dependent Authentication using Two Factor Authentication GW | Sj | #(Message2) [G6] S25: Using S10, R3, R7, R9, J2 and J4, Ui | GW | #(Message4) [G5] Thus, the above veri cation clearly shows that the proposed authentication scheme achieves all de ned goals (G1 - G7). C Formal Security Analysis using ROR Model In this section, the formal security analysis for the proposed scheme using a widely accepted and proved secure random oracle based model proposed by Ab- dalla et al. [Abdalla & Pointcheval (2005)] is discussed. The authors in [Abdalla & Pointcheval (2005)] proposed the Real-Or-Random (ROR) model, which helps security designers to prove that the proposed scheme achieves polynomial-time security against an adversary A s advantage of breaking the security. Security Proof: The security model discussed in chapter 2 is discussed for to prove formal security of the proposed scheme. Theorem 4. If A is a polynomial time attacker running against the proposed protocol LDA P within a limited time t. Let qh determines the range space of hash (H) queries, qs denotes the number of send (S) queries, qe represents the number of execute (E) query, the uniformly distributed password dictionary is de ned as DC either against the user Ui or the sensing device S j and AdvECDLP de nes the advantage of A of breaking the discrete logarithm problem of A then PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 146 Chapter 5. Level Dependent Authentication using Two Factor Authentication the proposed protocol is considered secured if, AdvLDA p (A) q2 h 2lh +max(qs,( 1 |DC|, f p)) +AdvECDLP +( 1 2lj ) (5.1) In equation 5.1, lh is the size of the return value of a hash (H) query generated by an adversary A in bits, lr is the size of the random nonce generated by the protocol LDA P. |DC| shows the nite size of a password dictionary, and f p shows the probability of a false positive occurrence by A. Proof. The proposed protocol is secured if the AdvLDA p (A) is negligible using the ROR model.To prove the security of the proposed scheme, ve games say Gm0, to Gm4 are de ned. Now, let us de ne an event SCi which represents the correct guess for the bit b in each game Gmi via the test query T by an adversary A. Gm0: The rst game Gm0 is the original security game which is corresponding to an original attack performed by an adversary A on the LDA-P. At the beginning of the game, adversary A chooses bit b. Hence it follows that, AdvLDA p (A) = 2 Pr[SC0] 1. (5.2) Gm1: The Gm1 is modelled as a passive attack in which A performs execute query E( p Ui, q GW, r Sj) and captures all communicated messages (Message 1 to Message 7). Based on all these messages A tries to determine the session key SK and after completion of the game A performs a test query T . The output of T determines weather it is veritable session key or the random number. The session key is computed by the user Ui and the sensing device S j as SK = H((r1||PUBUi), PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 147 Chapter 5. Level Dependent Authentication using Two Factor Authentication H(k 1||PUBGWk||PUBSj||PUBUi||r1), r2, T5) and SK = H(X2||X1||r 2||T5) respec- tively. The session key computation involves random numbers which are secured through the private keys of user and sensing devices. Since, interception of the messages Message 1 to Message 7 does not lead to compromise of the session key SK or any other secret credentials. Thus, the winning probability of the adversary A does not increase in Gm1. Pr[SC0] = Pr[SC1]. (5.3) Gm2: The Gm2 involves two more queries in the Gm1. The Gm2 executes Send query and Hash H(.) through which an adversary A communicates with the user Ui and the sensor S j. Through the several H(.) queries, A veri es hash digest. Thus, Gm2 is an active attack in which A tries to convince the Ui and S j to accept the forged messages. The messages M7 = H(k1||PUBGWk||PUBSj||PUBUi||r 1||T4). , M8 = PUBGWk PUBUi, M9 = EncPUBSj(k1,r 1), M10 = EncPUBUi(k1), M11 = EncPUBSj(r2) involves throughout the use of random numbers, time-stamps, sens- ing device identity, gateway master secret, user identity which will not provide any success to an adversary A in collusion veri cation of the generated message digest. Thus, through the birthday paradox, it follows that, Pr[SC1] Pr[SC2] q2 h 2lh . (5.4) Gm3: The Gm3 translated from Gm2. The Gm3 performs all the Corrupt queries. Through the query CorruptUserDevice, an adversary A receives all the stored parameters like X1, X2, K1, B1 and the other curve parameters. Now, A tries to guess the correct user ID and password PW for the user Ui through the dictionary PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 148 Chapter 5. Level Dependent Authentication using Two Factor Authentication attack. To guess the correct password, A needs UPW and Ra to validate the TPWi = H(UPWi||Ra ), L2 = H(UIDi||TPWi ) and veri es L2 = L2. The value of Ra is a random value and it s correct guess depends on the correct guess for an identity UIDi. Thus, due to these limitations for the Send query access in a polynomial time, it is infeasible to guess the correct pair of (UIDi, UPWi) in a polynomial time. In similar way, Thus, Pr[SC3] Pr[SC2] max(qs,( 1 |DS|, f p)) (5.5) Gm4: The Gm4 is translated from the Gm3. In this game an adversary A per- forms CorruptUserLevel( x), CorruptSensingLevel( y), CorruptSensingDevice. Through these queries, A tries to get the level of the user device or the sensor device. Now, let us assume that the probability of guessing the correct level is 1 2l j where 2l j represents the number of bits used for the level. Thus, after guess- ing the level of user device or sensing device, A tries to validate it s guess. To validate the user level li, an adversary A requires B1 = H(PUBUi||Ks) and B2 = H(li||Ks||H(PUBUi)) and to validate the sensing device level lj, an adversary A needs D1 = H(PUBSj||Ks) and D2 = H(lj||Ks||H(PUBSj)). To get these parame- ters, A must need the secret key of the user device (RUi) or sensing device (RSNj) which is computationally infeasible for an adversary to get in polynomial time. Thus, Pr[SC4] Pr[SC3] 1 2l j +AdvECDLP (5.6) Now, after completion of all the games, A doesn t get success. Now A have only one option left in which A try to guess the correct value of bit b and perform the T query. The success probability of this query is 1 2. So after all the PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 149 Chapter 5. Level Dependent Authentication using Two Factor Authentication games, it is clear that, Pr[SC4] = 1 2 (5.7) Now, from equation 5.2, 1 2*AdvLDA P = [Pr[SC0] - 1 2]. So by using the triangular inequality, [Pr[SC1] - [Pr[SC4] [Pr[SC1] - [Pr[SC2] + [Pr[SC2] - [Pr[SC4] [Pr[SC1] - [Pr[SC2] + [Pr[SC2] - [Pr[SC3] q2 h 2lh + max(qs, ( 1 |DC|, f p)) + (AdvECDLP ) + ( 1 2lj ). Using equations 6.4-6.6, |Pr[SC0] 1 2| q2 h 2lh +max(qs,( 1 |DC|, f p)) +AdvECDLP +( 1 2lj ) (5.8) So nally, from the equation 5.2 and 6.7, AdvLDA P(A) q2 h 2lh +max(qs,( 1 |DC|, f p)) +AdvECDLP +( 1 2l j ) (5.9) 5.6 Implementations and Testbeds An environment for the implementation of the proposed LDA scheme is high- lighted in the following Table 5.4. As a user device, laptop and desktop is used, the raspberry pi as a gateway device and the NodeMCU connected with the sen- sors as a sensing device. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 150 Chapter 5. Level Dependent Authentication using Two Factor Authentication Network Model Generic IoT Model Broker Mosquitto Protocol Using MQTT Language Python ECC Curve NIST P-256 Curve Secure channel By Enabling TLS communication in Mosquitto ECC Multiplication Using double and Add method Message format JSON Type User Device Intel (R) Core (TM) i3-7500 CPU with 2.80 GHz. Gateway System Raspberry Pi 3 Model B, 1 GB RAM. Sensing device NodeMCU + Raspberry Pi TABLE 5.4 Implementation Environment The following Fig. 5.2 shows the computed session key between the user device and the sensing device. Figure 5.2. LDA-GIoT Session Key For implementations we have used SHA256 as a hash function and NIST rec- ommended P-256 Curve. The security level achieved through implementation of proposed scheme is 128 bit. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 151 Chapter 5. Level Dependent Authentication using Two Factor Authentication 5.7 Use cases This chapter proposes two factor based LDA scheme for the user-gateway-sensor model. The proposed scheme aims to provide a lightweight communication be- tween the multiple user devices and the numerous amount of lightweight sensing devices deployed on the ground. The following are some of the signi cant use- cases of the proposed work. The proposed scheme presents signi cantly improved authentication scheme for the IoT application where the quantity of deployed sensing devices is large and have hierarchical user base. The proposed scheme can be highly useful in smart industry, smart educa- tion campus, smart transportation and so on. The signi cant use case of the proposed scheme mostly lies in environment where user doesn t have option to provide biometric trait as an input and still wants to receive a data from the sensing devices. The novelty of the proposed work lies in its dynamic environment, lightweight computations and real-time implementations. Real-time implementation of the proposed ECC based LDA scheme using MQTT protocol (that itself is a lightweight communication protocol used by the IoT industry) makes it novel. The real-time implementation using MQTT protocol has advantages like the lightweight header and reliable communication over other conventional protocols. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 152 Chapter 5. Level Dependent Authentication using Two Factor Authentication 5.8 Comparative Analysis A Network Parameter Analysis Round-trip Delay A Round-Trip Delay (RTD) is computed as an average time required by a com- municated packet to arrive at the destination from the source. The round-trip delay involves queuing delay, processing delay, transmission delay, and the prop- agation delay. The processing delay includes cryptographic operations, while the propagation delay includes travel time required by a packet. For the experimen- tal purpose, through our scenario of numerous users, uni gateway, and multiple sensing devices, simultaneous requests was generated to the gateway device from the user devices for accessing the sensors at different levels. Then, The average RTD at the sensing device, which includes the time between the sensor s reply to the gateway and gateway s response to the sensor, is 0.4825 second. The average RTD at a user device, which includes the time required between sending a request to receiving a reply from the gateway via sensing devices, is 0.5282 seconds. If some requests are sent in which the user is not eligible to access the sensor at a particular level, then the RTD gets a little hike due to the gateway node taking little more veri cation time. If the gateway device does not nd a valid user, sub- sequently, it communicates 0 signal to both the user and sensor to indicate invalid requests received. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 153 Chapter 5. Level Dependent Authentication using Two Factor Authentication Throughput Throughput can be de ned in either way. The rst way is based on the number of bits communicated in unit-time, and the second way is the number of packets transmitted in unit-time. During the implementation of the proposed LDA-GIoT, data for numerous static users was gathered, uni gateway, and numerous static sensors. The throughput is 162 bps, 233 bps, and 91bps at the user, gateway, and sensor. Thus, if computation cost is required for the proposed scheme, then the average transmission time as per the throughput will be 4.28 seconds, 5.16 seconds, and 8.69 seconds needed for the user, gateway, and sensor, respectively. the MOSQUITTO [Light et al. (2017)] broker at the gateway was installed for the implementation, and data from the gateway device was gathered. Now, if the number of packets transmitted per unit time is considered, then the throughput can be computed as totalpacketreceived packetsize totaltime . Thus, by computed using this formula, the average number of MQTT packet received at the user is 7, the sensor is 12 and gateway is 42 where packet size communicated from the user to gateway is 7 byte, gateway to user and sensor is 9 byte and sensor to the gateway is 5 byte through MQTT. Thus, the average throughput for the proposed scheme is 19.48 bps. B Communication Cost The communication cost de nes the total number of bits transmitted on the public channel. During the implementation of the proposed LDA-GIoT, a python-based programming approach was used. Table 5.5 shows the total number of bits com- municated in the cited schemes over the public channel. The computation of the communication cost is done as follows: to compute the communication cost, the PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 154 Chapter 5. Level Dependent Authentication using Two Factor Authentication output size for each parameter was considered in the unit of bits using python. In our implementation, the size of the generated identity and password is 160 bits. A SHA-256 was used as a hash function; thus, the size of the hash output is 256 bits. The timestamp size is 32 bits, and the size of the generated random number is 128 bits. Table 5.5 summarizes communication cost comparison between the proposed scheme and other existing scheme. Scheme User Gateway Sensor Total Cost [Farash et al. (2016)] 632 792 2048 3472 [Wazid et al. (2018)] 736 1344 512 2592 [Zhou et al. (2019)] 832 2048 672 3552 [Shin & Kwon (2020)] 1158 1560 678 3552 [Jangirala et al. (2020)] 1012 1127 517 2656 LDA-GIoT 512 1344 704 2560 TABLE 5.5 Comparison of Communication Costs C Computation Cost The computation cost highlights the number of cryptographic operations used in the proposed scheme during the login and authentication stage. It also gives the total time required by those operations at each participant s devices. Let Th, TE/TD, TP and Tfe represent the computation cost of one-way hash function H(.), ECC encryption/decryption operation, ECC Point multiplication and fuzzy extractor respectively. the computation cost of bitwise XOR operation is not considered because it takes very little time (almost 0 ms) compare to other operations. During our implementation, it is observed that, For user device, TE/TD operation takes 0.07083 seconds, Th operation takes 0.00041 seconds, the TP operation takes 0.0607 seconds and Tfe operation PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 155 Chapter 5. Level Dependent Authentication using Two Factor Authentication takes 0.0503 seconds. For sensing device, TE/TD operation takes 0.08883 seconds, Th operation takes 0.00084 seconds and the TP operation takes 0.0703 seconds. For gateway device, TE/TD operation takes 0.06783 seconds, Th operation takes 0.00034 seconds and the TP operation takes 0.0589 seconds. Above all the costs are an average of 100 times veri ed outputs. Table 5.6 sum- marizes computation cost comparison between the proposed scheme and other existing scheme. Scheme User Gateway Sensor Time(ms) [Farash et al. (2016)] 11*Th 14*Th 7*Th 10.4341 [Wazid et al. (2018)] Tfe + 13*Th + 2*Te 5*Th + 4*Te 4*Th + 2*Te 8.99 [Zhou et al. (2019)] 4*TP + 5*Th 3*TP + 7*Th 4*TP + 6*Th 10.693 [Shin & Kwon (2020)] 3*TP + 14*Th TP + 12*Th 2*TP + 5*Th 8.66 [Jangirala et al. (2020)] 5*TP + 13*Th 3*TP + 23*Th 2*TP + 9*Th 22.5 LDA-GIoT 6*Th + 2*Te 13*Th + 6*Te 6*Th + 3*Te 7.92 Legends: Th: One-way hash function cost, TE/TD: ECC Encryption/Decryption cost, TP: ECC point multiplication cost TABLE 5.6 Comparison of Computation Cost Following Fig.5.3. gives performance comparison of communication cost and computation cost of the proposed scheme with the existing schemes. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 156 Chapter 5. Level Dependent Authentication using Two Factor Authentication Communication Costs in bits Computation Costs in ms 0 500 1000 1500 2000 2500 3000 3500 4000 [Farash et al. (2016) [Wazid et al. (2018)] [Zhou et al. (2019)] [Shin & Kwon (2020)] [Jangirala et al. (2020)] Proposed 0 5 10 15 20 25 [Farash et al. (2016) [Wazid et al. (2018)] [Zhou et al. (2019)] [Shin & Kwon (2020)] [Jangirala et al. (2020)] Proposed Figure 5.3. Performance Comparison Chart 5.9 Summary In this chapter, a novel IoT authentication approach was proposed using an ECC as a Level Dependent Authentication for Generic IoT (LDA-GIoT). The LDA-GIoT reduces the number of user registrations and smooths the access control mecha- nism of the IoT system. The informal security analysis of the proposed scheme is given through the Dolev-Yao channel. The formal security analysis of the pro- posed scheme is given using a widely accepted AVISPA tool and random oracle based ROR Model. The comparative analysis of the LDA-GIoT with the other existing systems shows a little increase in computation and communication costs in the authentication phase. Still, it drastically decreases the efforts in multiple user registration and maintenance of the access control list. The implementation of a proposed LDA-GIoT is done through the MQTT protocol as an application layer protocol and raspberry-pi as a sensing device. Overall the proposed LDA- GIoT opens the new door for the researchers to study access control free, only PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 157 Chapter 5. Level Dependent Authentication using Two Factor Authentication authentication dependent security systems. This chapter presents an authentica- tion scheme using two factor authentication and does not use any biometric trait for authentication. Even, two factor authentication provides secure key generation environment, it has certain limitations in terms of security and it requires to design an authentication scheme that use biometric trait as a third factor. Next chapter 6 proposes three factor based LDA scheme to improve the security of the proposed scheme in this chapter. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 158 Chapter 6 Level Dependent Authentication us- ing Multi Factor This chapter proposes a level dependent key exchange scheme between the user device, gateway device and the sensing device using three factor authentication. Section 6.1 presents introduction for the user-gateway model and proposed work. Section 6.2 provides literature review related to proposed scheme. Furthermore, Section 6.3 highlights threat model considered for designing authentication scheme. Section 6.4 presents proposed authentication scheme with all the phases. Sec- tion 6.5 put forward security analysis for the proposed scheme. Section 6.6 pro- vides implementation aspects and use cases related to proposed work. Section 6.7 presents performance comparison of the proposed work with other existing schemes based on communication cost and computation cost. Section 6.8 sum- 1 Chintan Patel Nishant Doshi (2021) LDA-IoT : a level dependent authentica- tion for IoT paradigm, Information Security Journal: A Global Perspective, DOI: 10.1080/19393555.2021.1931573 159 Chapter 6. Level Dependent Authentication using Multi Factor Authentication marise this chapter. 6.1 Introduction The Internet of Things (IoT) based services are getting a widespread expansion in all the directions and dimensions of the 21st century. The IoT based deployment involves an Internet connected sensor, mobiles, laptops, and other networking and computing devices. In most IoT based applications, the sensor collects the data and communicates it to the end-user via gateway device or fog device over a pre- carious Internet channel. The attacker can use this open channel to capture the sensing device or the gateway device to collect the IoT data or control the IoT system. For a long time, numerous researchers are working towards designing the authentication mechanism for the sensor network to achieve reliable and compu- tationally feasible security. For the resource constraint environment of the IoT, it is essential to design reliable, ef cient, and secure authentication protocol. In this chapter, a novel approach of authentication in the IoT paradigm called a LDA is proposed. In the LDA protocol, reliable and resource ef cient key sharing mech- anism is proposed in which users at level li can communicate with the sensor at level lj if and only if the level of user in the organizational hierarchy is lower or equal to the level of sensor deployment. Next subsection presents an overview on LDA approach. A Level Dependent Authentication An access control (AC) mechanism assures that only a valid user can access the sensing device based on their level in a hierarchy. Handling an access control for PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 160 Chapter 6. Level Dependent Authentication using Multi Factor Authentication the small number of devices is not a signi cant challenge and can be implemented using the Access Control List (ACL). In the IoT, the scalability and heterogeneity of devices are two signi cant challenges against smooth access control imple- mentation. For performing AC, every intermediary device like gateway needs to maintain a list of valid users for each sensor. The physical attack is also one of the critical challenges, and it is infeasible to keep the static list for this highly dy- namic environment. Rather than this approach, a novel and realtime implemented approach is proposed to tackle these challenges using a single user registration and lightweight authentication mechanism. INTERNET Level - I Level - I Level - I Level - I Level I+2 Level I+2 Level I+1 Level I+1 Level I+3 Level J User Level J+1 User Level J+2 User Level J+3 User Level Dependent Authentication [LDA] : If Level of User is j and want access sensor at level I <= j, than user will get successful authentication, else if level of user j > level of sensor I requested, than authentication will get failure. Figure 6.1. Level Dependent Authentication As shown in Fig.6.1., every user in the IoT application will be assigned a particular level by the gateway device (or by registration authority in the multi- gateway scenario) during the user registration. Assigning this level will be based on the role of the user in the organization or industry. In parallel, during the sensor initialization phase, every sensor also gets a level based on its data genera- tion mechanism. Thus, the overall idea of the LDA approach is articulated in the following algorithm: So the major advantages of using level dependent authenti- PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 161 Chapter 6. Level Dependent Authentication using Multi Factor Authentication Result: Access of Sensing Device to User User-level = i; Sensor-level = j; while Gateway received request from user do if j i then Access-Allowed; else Access-Not-Allowed; end end Algorithm 2: Level Dependent Authentication cation can be listed as follow: No need to maintain ACL in the system. This characteristic differentiates the proposed approach from other access control mechanisms. No chance for any unauthorized user to get access to any sensing device. Lighter implementation of intermediary devices. Very less registration by the user device (near to one only). Reduction of the computational complexity of the gateway device and sens- ing device for unauthorized requests. The LDA approach s noticed challenge is that it increases the short time (in millisecond) for the gateway device for level veri cation. In most of the IoT im- plementations, gateway devices are powerful routing devices or servers which are resource capable of performing this operation. Thus, this is a negligible challenge. The proposed LDA approach does not. require to store any separate access con- trol list or the list of user s roles. Various other Role-based Access Control or PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 162 Chapter 6. Level Dependent Authentication using Multi Factor Authentication Attribute-Based Access Control methods available are used only for access con- trol veri cation; these methods do not provide any mechanism for authentication or the secure key setup. These methods consume space, memory, and list veri - cation time, which increases unnecessary space and time complexity. At the same time, the proposed LDA scheme provides access control with authentication in a resource-constrained environment with highly optimized resource utilization. 6.2 Literature Review In 2014, Turkanovic et al. [Turkanovi c et al. (2014)] proposed RUA scheme using a smart card for IoT notations and pointed out that their scheme provides secure key agreement and lower computation cost compare to existing schemes. In 2016, Farash et al. [Farash et al. (2016)] pointed out certain limitations in Turkanovic et al. s scheme. They highlighted that Turkanovic et al. s scheme is vulnerable against the session key and secret parameter disclosure attack, stolen smart card attack, Man-in-the-Middle (MITM) attack, and user traceability. In the same pa- per, Farash et al. [Farash et al. (2016)] proposed a new authentication scheme for the IoT environment and claimed that their scheme is highly secured and com- putationally feasible compare to analyzed schemes and other existing schemes. Unfortunately, in the same year, Amin et al. [Amin et al. (2018)] highlighted that the scheme proposed by Farash et al. is vulnerable against session-speci c tempo- rary attack, user impersonation, and of ine password guessing attack. In the same paper, Amin et al. proposed a new smart card based three-factor authentication scheme using XOR and hash operations and claimed security and feasibility of the scheme. In 2017, Jiang et al. [Jiang et al. (2017)] pointed out that the scheme PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 163 Chapter 6. Level Dependent Authentication using Multi Factor Authentication proposed by Amin et al. is vulnerable from tracking attack and session-speci c temporary credential attack. Jiang et al. [Jiang et al. (2017)] also proposed a se- cure, lightweight, and ef cient authentication scheme based on bio-hacking and rubin cryptosystem for wearables. The smart Home (SH) is one of the most promising IoT application which consists of heterogeneous intelligent home appliances like smart tv, smart meter, smart refrigerator, smart washing machine, smart door lock, smart window viper and so on. Due to the overloaded adoption of smart homes, it becomes essential for the researcher to focus on security and privacy issues also. In 2017, Wazid et al. [Wazid et al. (2017)] proposed a secure key establishment scheme using a hash function with symmetric encryption and provided the security analysis using random oracle based Real-Or-Random (ROR) model. In the same year, Kumar et al. [Kumar et al. (2015)] also proposed a new authentication scheme for the smart home environment using XOR, hash, and symmetric encryption. By secu- rity analysis using AVISPA and performance comparison based on computation cost and communication cost, Kumar et al. proved the feasibility and security of their scheme in resource constraint environment. By considering privacy as a sig- ni cant challenge, Poh et al. [Poh et al. (2019)]proposed an authentication scheme in two phases. In the rst phase, the author proposed a lightweight key establish- ment protocol, and in the second phase, the author used token-based searchable encryption-based queries to achieve privacy. The smart Grid (SG) is a network of all renewable and non-renewable en- ergy generators, distributors, and consumers. The smart grid s fundamental ob- jective is to reduce non-renewable energy consumption in the world and forecast renewable energy to let consumers also become a generator. The smart meter PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 164 Chapter 6. Level Dependent Authentication using Multi Factor Authentication is an intelligent device that collects the information regarding energy consump- tion and needs from the user and passes that information at a regular interval to the energy control station. Information regarding energy usage must be se- curely communicated with the energy control station and other smart grid enti- ties because leakage of this information can create a loophole in the user s pri- vacy. In 2017, Mahmood et al. [Mahmood et al. (2018)] proposed an ECC based authentication scheme without making use of the third party like a registration server. In 2018, Gope et al. [Gope & Sikdar (2019)] introduced an authentication scheme between the smart meter and energy service provider using a Physically Unclonable Function (PUF). In 2018, Abbasinezhad et al. [Abbasinezhad-Mood & Nikooghadam (2018)] reviewed an authentication scheme proposed in [Mah- mood et al. (2018)] and pointed out that their scheme is vulnerable against perfect forward secrecy, private key leakage, and known session-speci c temporary infor- mation attack. Abbasinezhad et al. proposed a new authentication scheme using ECC and claimed reliable security and computational feasibility by comparing it with the previously proposed scheme. The smart grid will play a signi cant role in the successful deployment of Electric Vehicle (EV) in the market. Communica- tion between EV and SG networks must ensure that an intruder can not trace the location of EV and can not play with the user s privacy. Roman et al. [Roman et al. (2019)], in 2019, proposed a paring based authentication scheme between EV and authentication servers of the smart grid. Industrial Internet of Things (IIoT) is one of the prominent applications of IoT. IIoT makes use of sensing technology for trusted observation of industrial production, reliable data management, intelligent decision making, and ef cient human resource utilization. An authentication between IIoT user and sensing de- PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 165 Chapter 6. Level Dependent Authentication using Multi Factor Authentication vices plays a vital role in managing the security of the complete hierarchy of IIoT. Li et al. [Li et al. (2017)] in 2018 proposed a privacy-preserving authen- tication scheme for the IIoT environment and proved security for the proposed scheme using random oracle based adversary capabilities. Karate et al. [Karati et al. (2018)] proposed a signature-based authentication scheme for a cloud-centric IIoT environment. In 2018, karati et al. [Karati et al. (2018)] proposed an ef cient scheme between the key generator, cloud server, data owner, and data consumer and prove the security using widely accepted game theory-based analysis. An authors in [Wang & Wang (2018)] proposed a secure authentication protocol for industrial IoT. The limitation of these protocols is that they consider all sensors at a similar level, but in the realtime industrial deployment, it is not the real scenario. Overall, the authentication in the IoT environment consists of many indepen- dent entities, complicated technologies, and resource constraint devices. Thus, it is essential to propose an authentication scheme that is reliable, ef cient, and suitable for IoT s resource constraint environment. 6.3 Threat Model An adversary model used in this chapter is considered from a similar model dis- cussed in [Dolev & Yao (1981)]. The adversary is an intruder who tries to capture the communicated messages as well as tries to gain physical access to devices belongs to network topology. In the IoT based network model, it is possible to de- ne an adversary with the robust capabilities for improvement in the designing of reliable protocols and also to perform better security validation for the proposed authentication protocol. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 166 Chapter 6. Level Dependent Authentication using Multi Factor Authentication C1. An Adversary A can compute valid pair of identity password of ine in polynomial time using the available dictionary. C2. An Adversary A can capture a smart card and can retrieve the information from it. C3. An Adversary A have full access on the communication channel between user - gateway, sensor node - gateway, and user - sensor node. C4. An Adversary A may get previously computed session key. C5. An Adversary A may get the secret of the gateway node during failure situa- tions. C6. An Adversary A can compromise sensor node physically and can get stored information. C7. An Adversary A can capture the level of user or sensing device. C8. An Adversary A can generate bot nodes and can send simultaneous ping messages to the user device and sensing device. 6.4 Proposed Scheme In this section, the proposed authentication and key exchange scheme is set forth for the U-GW-Sensor based network model discussed in chapter 1 . The proposed scheme consists of the initialization phase in which the gateway device works as a master device and performs of ine and secure initialization for the user device, sensing device, and gateway itself. The initialization phase is followed by the registration phase and the login and authentication phase. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 167 Chapter 6. Level Dependent Authentication using Multi Factor Authentication A Initialization Phase This phase call on of ine by the gateway device with trusted platform module: Table 6.1 presents notations and symbols used in the articulation of the pro- posed scheme. We use the random number and timestamp to protect the proposed scheme from the replay attack. We assume that all the entities have a synchronized clock. Symbols Description Rx Random Number generated during initialize phase rx Random Number generated during authentication phase Tx Time-stamp li User Level l j Sensor Level SID j Sensor identity UIDi User identity GWID Gateway identity Gp Elliptic curve generator T Time-stamp threshold Ks Gateway node master secret Bioi User biometric template Mx Message Number TID Temporary Identity Gen(.) Generation procedure in fuzzy extractor Rep(.) Reproduction procedure in fuzzy extractor H(.) One-way Hash function Enc(.)/Dec(.) ECC encryption/decryption L, || XOR and Concatenation respectively B,Z Computed Parameters TABLE 6.1 Notation and Abbreviations PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 168 Chapter 6. Level Dependent Authentication using Multi Factor Authentication User Initialization Let Ri be a secret random number generated by the gateway GW for the user device Ui as a password. The GW computes UIDi = Ri*P where P is a point on elliptic curve. The GW generates random master secret Ks and computes X1 = H(UIDi||Ks), Z1 = H(li||Ks||H(UIDi)). Here li is the level for the user Ui. GW stores Ri, UIDi, X1 and Z1 in the hidden memory of Ui. Sensing Device initialization Let R j be a secret random number generated by the gateway GW for a sensing device SD j. The GW computes SID j = R j*P where P is a point on elliptic curve. The GW computes X2 = H(SIDj||Ks), Z2 = H(l j||Ks||H(SIDj)). Here l j is the level for the sensor SD j. GW stores Rj, SIDj, X2 and Z2 in hidden memory of SD j. Gateway Node Initialization The gateway GW generates random number Rk as a secret parameter and compute GWID = Rk*P as a public identity. B Registration Phase User Registration User registration is a phase which is carried out through secure channel. 1. Ui GW : User Ui sends X1, UIDi to GW. 2. GW Ui : Gateway node veri es X1 = H(UIDi||Ks) ?= X1. The GW de- vice generates r1 and computes TIDi = H(r1||X1), M1 = H(TIDi||GWID||Ri), PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 169 Chapter 6. Level Dependent Authentication using Multi Factor Authentication B1 = X1 r1 and sends smart sard (SC) = (TIDi, M1, B1). 3. User Ui generates biometric parameters using fuzzy extractor as BiO = Gen(Bi) = ( i, i) in which i is a secret key parameter which is used for veri cation and i is a public parameter which is also an input during repro- duction stage. Ui computes M2 = H( TIDi|| i||Ri), user stores SC = (TIDi, M1, B1, M2). C Authentication and Key Exchange Phase The authentication and key establishment between User Ui and SDj involves au- thentication of Ui with GW and SD j with GW. After an authentication, Ui and SD j computes session key. An ECC based encryption/decryption was used during key establishment phase. Summary of authentication phase is given in Table 6.2. 1. Ui GW : User provides Ri,UIDi, X1, Z1 and Bio to Smart card reader (SCR) with SC. SCR computes i = Rep(Bio , i) and veri es following: TIDi = H(r1||X1) ?= TIDi, r1 = X1 B1, M1 = H(TIDi ||GWID||Ri) ?= M1, M2 = H(TIDi || i ||Ri) ?= M2, If all conditions successfully veri ed, then SCR generates random number r2, and computes following: B2 = TIDi UIDi, PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 170 Chapter 6. Level Dependent Authentication using Multi Factor Authentication M4 = EncGWID(r2, UIDi,SIDj), M5 = H(TIDi ||SID j||GWID||T1), TIDi = H(TIDi ||r2), sends authentication Message 1 = (TIDi , M4, M5, T1, Z1 ,B2) to GW. 2. GW SD j : Gateway Node GW computes current time T2 and veri es T T2 - T1, if yes then performs following: (r2, SIDj, UIDi) = DecRk(M4), TIDi = H(r1||H(UIDi||Ks)) TIDi = H(TIDi||r2) ?= TIDi , if yes M6 = H(H(SIDj||Ks)||T3)), sends message 2 = (M6, T3) to SD j. 3. SD j GW : SDj takes current time T4 and veri es T T4 - T3, if veri ed then computes following: M 6 = H(H(X2)||T1) ?= M6, M7 = H(X2||GWNIDk||T5), sends message 3 = (M7, Z2, T5) to GW. 4. GW SDj : Gateway Node GW takes current time T6 and veri es T T6 - T5, if yes then performs following: PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 171 Chapter 6. Level Dependent Authentication using Multi Factor Authentication M 7 = H(H(SNIDj||Ks)||GWNIDk||T5) ?= M7, Gets li and lj from Z1 and Z2 respectively by computing: Z1 =H(li||Ks||H(UIDi)) till Z1 ?= Z1 satis es for valid li, Z2 =H(l j||Ks||H(SID j)) till Z2 ?= Z2 satis es for valid lj, Veri es if li lj, then continue else transmits 0 signal to Ui and sensing device SDj, Veri es M 5 = H(TIDi ||SIDj||GWID||T1) ?= M5, M8 = H(UIDi||r2||SID j||GWID||T7), M9 = EncSID j(UIDi, r2), sends message 4 = (M8, M9, T7) to sensing device SD j. 5. SD j GW : SD j takes current time T8 and veri es T T8 - T7,if veri ed then computes following: DecRj(M9) = (UIDi, r2)), M 8 = H(UIDi||r2||SIDj||GWID||T7) ?= M8), generates random number r3, M10 = EncRIDUi(r3), M11 = H(GWID||SIDj||r3||T8), M12 = H(GWID||SIDj||r2||T8), send message 5 = (M10,M11,M12,T8) to GW. 6. GW Ui : Gateway node GW takes current time T9 and veri es T T9 - T8, if yes then performs following: PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 172 Chapter 6. Level Dependent Authentication using Multi Factor Authentication M12 = H(GWIDk||SIDj||r2||T8) ?= M12, gets current time stamp, T9, Mk = H(Z1||Z2||Ks||T9) sends message 6 = (M10,M11,Mk,T8,T9) to Ui and message 7 = (Mk, T9) to SD j 7. User Ui: takes current time T10 and veri es T T10 - T9, if yes then performs following: DecRi(M10) = (r3), M 11 = H(GWIDk||SID j||r3||T8) ?= M11, if yes. SK = H(r2||r3||UIDi||SIDj||GWIDk||T8||Mk||T9) 8. Sensor SD j: takes current timestamp T11 and veri es T T11 - T9, if yes then performs following: SK = H(r2||r3||UIDi||SIDj||GWIDk||T8||Mk||T9) 6.5 Security Analysis A Informal Security Analysis In this subsection, an informal security analysis for the proposed LDA Protocol was discussed.Table 6.3 presents summary of comparison of the proposed scheme with the other existing schemes based on secure against attacks. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 173 Chapter 6. Level Dependent Authentication using Multi Factor Authentication User/SCR Gateway Sensor SCR computes : i = Rep(Bio , i), TIDi = H(r1||X1) ?= TIDi, r1 = X1 B1, M1 = H(TIDi ||GWID||Ri) ?= M1, M2 = H(TIDi || i ||Ri) ?= M2 Generate r2, B2 = TIDi UIDi, M4 = EncGWID(r2, UIDi,SIDj), M5 = H(TIDi ||SIDj||GWID||T1), TIDi = H(TIDi ||r2) veri es T T2 - T1, (r2, SID j, UIDi) = DecRk(M4), TIDi = H(r1||H(UIDi||Ks)), TIDi = H(TIDi||r2) ?= TIDi , if yes M6 = H(H(SIDj||Ks)||T3)) veri es T T4 - T3, M 6 = H(H(X2)||T1) ?= M6, M7 = H(X2||GWNIDk||T5) Message 1 = (TIDi , M4, M5, T1, Z1 ,B2) to GW sends message 2 = (M6, T3) to SD j sends message 3 = (M7, Z2, T5) to GW. veri es T T6 - T5, M 7 = H(H(SNIDj||Ks)||GWNIDk||T5) ?= M7, Z1 =H(li||Ks||H(UIDi)) till Z1 ?= Z1, Z2 =H(lj||Ks||H(SID j)) till Z2 ?= Z2, M 5 = H(TIDi ||SID j||GWID||T1) ?= M5, M8 = H(UIDi||r2||SIDj||GWID||T7), M9 = EncSIDj(UIDi, r2), sends message 4 = (M8, M9, T7) veri es T T8 - T7, DecRj(M9) = (UIDi, r2)), M 8 = H(UIDi||r2||SIDj||GWID||T7) ?= M8), generates r3, M10 = EncRIDUi(r3), M11 = H(GWID||SIDj||r3||T8), M12 = H(GWID||SIDj||r2||T8), send message 5 = (M10,M11,M12,T8) to GW veri es T T10 - T9, DecRi(M10) = (r3), M 11 = H(GWIDk||SIDj||r3||T8) ?= M11, if yes. SK = H(r2||r3||UIDi||SID j||GWIDk ||T8||Mk||T9) veri es T T9 - T8, M12 = H(GWIDk||SIDj||r2||T8) ?= M12, Mk = H(Z1||Z2||Ks||T9), sends message 6 = (M10, M11, Mk, T8, T9) to Ui and message 7 = (Mk, T9) to SD j veri es T T11 - T9, if yes, SK = H(r2 || r3|| UIDi|| SID j|| GWIDk|| T8|| Mk|| T9) TABLE 6.2 Authentication and Key Exchange PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 174 Chapter 6. Level Dependent Authentication using Multi Factor Authentication SECURED AGAINST TRACEABILITY In most of the IoT application, it is expected that an original identity of the user or device must not relieve. If an adversary A can capture the identity of the user then it creates a problem for user s privacy preservation. The adversary A can easily trace the user and it s functionalities. In the proposed LDA scheme, the rst public authentication request message 1 by user Ui to GW is TIDi ,M4,M5,T1,Z1,B2 . The message 1 is distinct for each new request due to following reason. The author computes M4 = EncGWID(r2, TIDi ,SIDj), M5 = H(TIDi ||SID j||GWID||T1), in which r2 is a random number and T1 is a latest timestamp, Thus, the inclusion of r2 and T1 ensures that M4 and M5 are different for each session. Similarly other communicated messages (message 2, message 3, message 4, message 5, message 6, message 7) by user Ui and sensing device SDj are also distinct for each session. ANONYMITY An anonymity preservation can be achieved by securing an identity of the user Ui and the sensor SD j from adversary A. Identity of user Ui is UIDi which is secured by one-way hash function in computations of X1 = H(UIDi||Ks) and Z1 = H(li||Ks||H(UIDi)). During authentication messages, user uses temporary id TIDi = H(r1||X1) which is protected using one-way hash function and ECC based en- cryption. Identity of the sensing device (SIDj) is also protected by computed pa- rameters X2 = H(SIDj||Ks), Z2 = H(l j||Ks||H(SID j)) which are protected by one- way hash function. Gateway node communicates following messages with the user and the sensor device, M6,T3 , M8,M9,T7 , and M10,M11,T8,T9 . Each message communicated by the gateway device uses timestamp and is protected PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 175 Chapter 6. Level Dependent Authentication using Multi Factor Authentication by one-way hash function and encryption. Therefore, anonymity of the sensing device and the user device is achieved in the proposed LDA scheme. MUTUAL AUTHENTICATION AND INTEGRITY The mutual authentication is an important property that assures security from unauthorized access to any unknown adversary A. The proposed LDA scheme achieves mutual authentication for the participating entities. The gateway device GW authenticates user Ui by performing the following operations. The GW com- putes TIDi = H(TIDi||r2) ?= TIDi to ensure the temporary id, which is received from the user Ui. Computation of TIDi = H(r1||H(UIDi||Ks)) includes secret pa- rameter Ks which an adversary can never get. The gateway GW authenticates sensing device by computing M 7 = H(H(SNIDj||Ks)||GWID||T5) ?= M7, which in- cludes master secret Ks and gateway node identity GWID. Similarly, the user au- thenticates gateway and sensing device during veri cation of the parameter M11, and the sensing device validates user and gateway during veri cation of the pa- rameter M8. In the proposed scheme, all the communicated messages are veri ed by a one-way hash function, which ensures integrity for the proposed scheme. PROTECTED AGAINST REPLAY ATTACK In the replay attacks, an adversary A replays old messages which are captured by A by tracking of communications between Ui, GW and SDj. Let us assume, an adversary A captures message 1 = TIDi ,M4,M5,T1,Z1,B2 and communicate message 1 to start a new session with the GW device. After receiving a message from A, gateway GW performs validation of time interval between current time and message generation time by performing T T2 - T1. Here T2 is current PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 176 Chapter 6. Level Dependent Authentication using Multi Factor Authentication time or receiving time at gateway GW. This validation will fail because interval will not be lesser then the previously decided T. Similarly, every communication between user Ui, gateway GW and sensor SD j is protected by threshold T. Thus, the proposed LDA scheme is secured against a replay attack. SECURED AGAINST MAN-IN-THE-MIDDLE ATTACK (MITM) In this attack, an adversary A captures the messages communicated by valid par- ticipants of the system and modi es messages. it is assumed that A captures the message 1 = TIDi ,M4,M5,T1,Z1,B2 communicated by user Ui to GW. Let A updates the message 1 by message 1 = TIDi ,M 4,M 5,T 1,Z 1,B 2 and send to GW. Now the gateway veri es TIDi with TIDi by capturing r2 from the decryption of M4. Thus, the modi ed TIDi does not match with the TIDi. Therefore, the gateway devices stops further communication. Similarly, all the communications in the proposed protocol is secured using encryptions and one- way hash functions. Hence, the proposed scheme is immune enough against the MITM attack. KEY ESTABLISHMENT WITH PERFECT FORWARD SECRECY The protection against perfect forward secrecy assures that even through an ad- versary A captures all messages of the previous session and nal session key, then also A must not get the ability to compute key for the ongoing session. the session key in the proposed scheme is computed as follows. The session key SK = H(r2||r3||UIDi||SID j||GWIDk||T8), that includes two random numbers and one timestamp. It is nearly impossible for an adversary A to generate the random numbers, which will match with the same r2 and r3. Now let us assume that an PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 177 Chapter 6. Level Dependent Authentication using Multi Factor Authentication adversary gets the long term secret Ks from the gateway. Then also, the adver- sary could not break the previous session messages due to hash protected random numbers. Therefore, the proposed LDA scheme achieves perfect forward secrecy, and it is nearly impossible for an adversary to link the current session with the previous session. RESISTANCE AGAINST GATEWAY NODE BYPASS ATTACK In the proposed authentication scheme, it is impossible for any valid user Ui and sensing device SDj to bypass the gateway device GW because the proposed scheme does not provide any direct communication between the user device and sensing device. In our MQTT implementation, Ui and SDj can publish data with the gateway GW device s topic only and can not publish on each other s topic. In the proposed LDA scheme, when gateway node receives rst authentication request from the user Ui, it computes M6 = H(H(SIDj||Ks)||T3)) which is not pos- sible for the user Ui to compute because Ui is not aware of Ks. Similarly when gateway node receives message from user, it computes Mk = H(Z1||Z2||Ks) before key generation which is not possible for SDj to compute because SD j is also not aware of Ks and Z1. As a result, due to master key Ks and time stamp validation and random numbers, it is impossible for Ui, SDj or A to bypass the gateway GW. RESISTANCE AGAINST GATEWAY NODE IMPERSONATION ATTACK Let us assume that an adversary A intercepts message 1, message 2, message 3, message 4, message 5, message 6, message 7 and try to create other valid messages message 1 , message 2 , message 3 , message 4 , message 5 , message 6 , message 7 on behalf of the gateway GW where message 1 = TIDi ,M4,M5,T1,Z1,B2 , PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 178 Chapter 6. Level Dependent Authentication using Multi Factor Authentication message 2 = M6,T3 , message 3 = M7,Z2,T5 , message 4 = M8,M9,T7 ,message 5 = M10,M11,M12,T8 ,message 6 = M10,M11,Mk,T8,T9 and message 7 = Mk . Now let us assume that an adversary A generates random number {r 2, r 3} and time-stamps {T 1, T 2, T 3, T 4, T 5, T 6, T 7}. Still to compute the message M6 and Mk, adversary requires KS. To calculate M8, M11 and M12, the adversary A needs {UIDi, SIDj}. These are secured identities. Thus, an adversary A can not com- pute valid messages message 1 , message 2 , message 3 , message 4 , message 5 , message 6 , message 7 on behalf of the gateway GW. Therefore, the proposed LDA scheme is protected against the gateway node impersonation attack. Scheme S1 S2 S3 S4 S5 S6 S7 S8 S9 S10 S11 [Challa et al. (2017)]            [Shin & Kwon (2020)]            [Zhou et al. (2019)]            [Wu et al. (2020)]            [Shuai et al. (2020)]            Proposed            Note: S1: Tracebility, S2: Anonymity, S3: Mutual authentication and Integrity, S4: Re- play attack , S5: Man-in-The-Middle Attack, S6: Forward secrecy, S7: Gateway by pass attack, S8: Gateway impersonation attack , S9: Sensing device capture attack, S10: Priv- ilege insider attack, S11: Level Dependent Authentication, : the protocol supports this feature, : the protocol doesn t support this feature. TABLE 6.3 Security Comparison SECURED AGAINST SENSING DEVICE CAPTURE ATTACK Now, let us assume that an adversary A physically captures sensing device SDj and uses a power analysis attack [Messerges et al. (1999); Kocher et al. (1999)] retrieves a piece of information stored in sensing device SD j. Thus, let us assume that A successfully retrieves R j,SIDj,Z2,X2 from sensor memory. For com- PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 179 Chapter 6. Level Dependent Authentication using Multi Factor Authentication puting SIDj, the gateway node GW uses a Random Number Generator (RNG). For the computation of Z2 and X2, the gateway GW uses master secret Ks. Thus, RNG helps gateway GW in unique identity generation for each sensor. Thus, the compromise of session key between Ui and SD j does not compromise the other session keys. Now let us assume that A tries to compute session key by using extracted data. Still, A could not get success due to non-availability of the master key KS and other parameters like r2, Z1 and X1. Thus, the proposed LDA scheme achieves safety against the sensing device capture attack. SECURED AGAINST SMART-CARD AND PASSWORD CAPTURE AT- TACK Now, let us assume that an adversary A gets the user s smart card and try to generate the password from the password list. Thus, A has {TIDi, M1, B1, M2} as a smart card parameters and R i as a guessed password. If A tries to log in, then he must provide the Bio with the SC and other parameters. It is nearly impossible for A to come up with the same biometric parameter Bio based on which SCR performs further computation. Thus, adversary A could not satisfy the condition M2 = H(TIDi || i ||Ri) ?= M2. Hence, even though an adversary A captures the smart card and generates a valid password, he/she could not access the proposed system. SECURED AGAINST PRIVILEGE INSIDER ATTACK Let us assume that A is a malicious insider of the gateway node GW. He/she is aware of {UIDi, SID j, GWID} and the gateway master secret Ks. Let us as- sume that A also tracks messages received by the gateway node GW, and thus, PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 180 Chapter 6. Level Dependent Authentication using Multi Factor Authentication he/she receives Z1 and Z2 from the valid user Ui and the sensor device SD j re- spectively. Let us assume that A also gets ECC parameters, biometric gen- erator function, and stored data in the user smart card. In the proposed LDA scheme, the session key computation occurs as follows. The session key SK = H(r2||r3||UIDi||SID j||GWIDk||T8||Mk). After tracking all the above-said infor- mation on the gateway node, malicious insider A obtains T8 from the message 5. Still, A needs random number r3 to compute the session key, which is generated by the sensing device SD j for the valid Ui. The r3 is encrypted with parameter M10 and is not possible to decrypt for A or even valid gateway GW to get it. Thus, it is nonproductive efforts for any malicious insider A to compute the nal session key or next session key. B Mutual Authentication using BAN Logic In this section, mutual authentication, freshness, and key-establishment capacity of the proposed scheme is presented using the BAN Logic. The BAN Logic is a tool that operates based on the proportional logic and is a widely accepted tool to prove the mutual authentication property of the authentication scheme [Burrows et al. (1989)]. Mutual Authentication using BAN Logic This proof mainly consists of the following steps: (I) Initial assumption, (II) Goal declaration, (III) Message formation, and (IV) Formal veri cation. 1. Initial assumptions: This proof mainly consists of the following steps: (I) Initial assumption, (II) Goal declaration, (III) Message formation, and (IV) PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 181 Chapter 6. Level Dependent Authentication using Multi Factor Authentication Formal veri cation. J1. Ui | #(Ti), SD j | #(Ti),GW | #(Ti); J2. Ui | #(r1), GW | #(r2), SD j | #(r2), Ui | #(r3); J3. GW | Ui X, GW | SD j X, SDj | GW X. J4. Ui | ( GWID 7 GW), SDj | ( RIDUi 7 Ui), GW | ( SIDj 7 SD j) J5. Ui | SD j (Ui SK SDj) 2. Goal Declaration: The expected goals in the proposed LDA scheme in- cludes trust in shared key and freshness of communicated messages. In LDA scheme, expected goals are as follow: G1. Ui | Ui SK SDj G2. SD j | Ui SK SDj G3. Ui | SD j | Ui SK SD j G4. SD j | Ui | Ui SK SD j G5. Ui | GW | #(X) G6. GW | SDj | #(X) G7. SD j | GW | #(X) 3. Message Formation: The login and Authentication phase of the proposed LDA scheme includes exchanges of the following messages which can be written in the generic form as follow: Message 1: GW SDj: (H(UIDi||r2||SID j||GWID||T7), Enc(UIDi, r2), T7) PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 182 Chapter 6. Level Dependent Authentication using Multi Factor Authentication Message 2: SDj GW: (Enc(r3), H(GWID||SIDj||r3||T8), H(GWID||SIDj||r2||T8), T8) Message 3: GW Ui: (Enc(r3), H(GWID||SID j||r3||T8), H(Z1||Z2||Ks||T9), T8, T9) Message 4: GW SDj: (H(Z1||Z2||Ks||T9), T9) Idealized form: The ideal forms for the above messages can be written as follows: Message 1: GW SD j: SD j < ((UIDi||r2||SIDj||GWID||T7), (UIDi, r2), T7) > GW| ( SID j 7 SD j) Message 2: SDj GW: GW < ((r3), (GWID||SID j||r3||T8), (GWID||SID j||r2||T8), T8) > SD j| ( RIDUi 7 Ui) Message 3: GW Ui: Ui < ((r3), (GWID||SIDj||r3||T8), (Z1||Z2||Ks||T9), T8, T9) > GW| ( RIDUi 7 Ui) Message 4: GW SDj: SDj < ((Z1||Z2||Ks||T9), T9) > 4. Formal Veri cation Theorem 5. The proposed scheme achieves the secure mutual authentica- tion between the user Ui and the sensing device SD j, and it achieves ex- pected goals. Proof. Expected goals [G1 - G7] are achieved as follow: S1: from the message 1, PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 183 Chapter 6. Level Dependent Authentication using Multi Factor Authentication SD j < ((UIDi||r2||SID j||GWID||T7), (UIDi, r2), T7) > GW| ( SID j 7 SDj) S2: Using S1, R1 and J1, SD j | GW | < ((UIDi||r2||SIDj||GWID||T7), (UIDi, r2), T7) > S3: Using S2, J2, R2, SD j | GW | < ((UIDi||r2||SIDj||GWID||T7), (UIDi, r2), T7) > S4: from the message 2, GW < ((r3), (GWID||SIDj||r3||T8), (GWID||SIDj||r2||T8), T8) > SD j| ( RIDUi 7 Ui) S5: Using S4, R1 and J1, GW | SD j | < ((r3), (GWID||SIDj||r3||T8), (GWID||SIDj||r2||T8), T8) > S6: Using S4, J2, R2, GW | SD j | < ((r3), (GWID||SIDj||r3||T8), (GWID||SIDj||r2||T8), T8) > S7: Using J3,J4 R7,R3, SD j | (GWID||SIDj||r3||T8), SDj | (GWID||SID j||r2||T8), S8: from the message 3, Ui < ((r3), (GWID||SIDj||r3||T8), (Z1||Z2||Ks||T9), T8, T9) > GW| ( RIDUi 7 Ui) S9: Using S8, R1 and J3,J4, Ui | GW | < ((r3), (GWID||SID j||r3||T8), (Z1||Z2||Ks||T9), T8, T9) > S10: Using S9, J3, R2, Ui | GW | < ((r3), (GWID||SIDj||r3||T8), (Z1||Z2||Ks||T9), T8, T9) > PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 184 Chapter 6. Level Dependent Authentication using Multi Factor Authentication S11: Using J4, R7,R3, Ui | (GWID||SIDj||r3||T8), Ui | (Z1||Z2||Ks||T9), S12: from the message 4, SD j < ((Z1||Z2||Ks||T9), T9) > S13: Using S1, R1 and J1, SD j | GW | < ((Z1||Z2||Ks||T9), T9) > S14: Using S4, J2, R2, SD j | GW | < ((Z1||Z2||Ks||T9), T9) > S15: Using J3,J4 R7,R3, SD j | (Z1||Z2||Ks||T9), S16: Using S3,S4, S14, S15, R3, R8,J5, SD j | Ui SK SD j [G2] S17: Using S9,S10, S11, R3, R9, J5, Ui | Ui SK SD j [G1] S18: Using S3,S4, S14, S15, J5, R3, R7 and R8, SD j | Ui | Ui SK SD j [G3] S19: Using S9,S10, S11, J5, R3, R7 and R9, Uj | SD j | Ui SK SDj [G4] S20: Using S1, R2, R5, R7, J1 and J2, SD j | GW | #(Message1) S21: Using S4, S12, R2, R5, R7, J1 and J2, PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 185 Chapter 6. Level Dependent Authentication using Multi Factor Authentication SD j | GW | #(Message1,Message3) [G7] S22: Using S4, R2, R5, R7, J1 and J2, GW | SD j | #(Message2) [G6] S23: Using S8, R2, R5, R7, J1 and J2, Ui | GW | #(Message4) [G5] Thus, the above veri cation clearly shows that the proposed authentication scheme achieves all de ned goals (G1 - G7). C Formal Security Model using ROR To perform the formal security analysis of the proposed LDA scheme, a widely accepted random oracle based Real-Or-Random (ROR) model is used. The ROR model [Abdalla & Pointcheval (2005)] is one of the key formal and conventional security models used by security researchers to prove that an adversary A with the random oracle queries can not achieve self-con dence for the retrieved key. The supreme target of the ROR model is that an adversary A must not be able to distinguish the retrieved random value and the real session key. Random Oracle: The proposed LDA protocol LDAP uses cryptographic pub- lic Hash function which is formalized as a random oracle call H(m). Thus, when- ever a probabilistic polynomial adversary A communicates with the message mi then the oracle H(mi) computes x size irreversible random value ri for the mes- sage. The oracle maintains a list L initialized with the NULL value in which it stores pair of (mi,ri) for each i where i = 0 to n and the returns value ri to an adversary A. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 186 Chapter 6. Level Dependent Authentication using Multi Factor Authentication Participants: In the proposed LDA scheme, there are three participants, user Ui, gateway GW, and sensing device SD j. The ROR modeling for these partici- pants and adversary A is as follow: Oracles: m Ui, n GW, and o SD j are oracles with the instances m, n and o for the Ui, GW and SD j respectively. These are also called as a participants for the protocol LDAP. Oracles Freshness: m Ui, n GW and o SD j consider as a fresh oracles if the reveal oracle query R does not provide correct session key SK to A. Oracles Partnering: Oracle instances x and y are partners if following conditions are ful lled simultaneously: Both instances x and y are in the acceptance state. Both x and y share the common session-id sid and achieve the mutual authentication. Both x and y satisfy the partner identi cation and vice-versa. No other instance other than x and y accept with partner identi cation equal to x and y. sid is a session identi cation. It represents the transcript of all the communicated messages between the participants before acceptance state. Oracle Accepted state: An instance x reaches to accept state after com- municating the last message with the partner instance y. The concatenation of all delivered messages by both participants before reaching the acceptance state makes sid for a particular session. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 187 Chapter 6. Level Dependent Authentication using Multi Factor Authentication Adversary: Let us assume that an adversary A controls complete commu- nication channel de ned over Dolev-Yao model. An adversary A can read, mod- ify, inject, or fabricate the messages over this channel. An adversary A accesses random oracle queries that give the capability to A for capturing and modifying the communication. Freshness: The instances m Ui or o SDj are fresh instances if SK computed between m Ui and o SD j is not revealed to an adversary A by using reveal query on any instance x. Adversary Model: The modeling of an adversary A is done using the fa- mous Dolev-Yao model. It de nes send (snd) and receive (rcv) channels. Adver- sary A can perform the passive attack as well as an active attack. The adversary A can receive, read, update, and delete the communicated messages as well as add the new messages on the communication channel. The following random oracle queries give the capabilities to an adversary A: R( x) : The reveal query R provides session key SK to the adversary A generated by x and it s partner for the same sid. S( x,msg) : The adversary A formalizes send query as an active attack. Using the send query, an adversary A communicates with an instance x. An adversary A sends message to x as well as gets response from the participant instance x. Thus, using this query, adversary A communicates with the user participant with instance x. E( x, y) : The execute query E is formalized as a passive attack through which an adversary A gets the capacity to monitor the communication between instances x and y.Thus, an execute query grants the read permission to an ad- versary A. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 188 Chapter 6. Level Dependent Authentication using Multi Factor Authentication CorruptUserDevice( m Ui): The CorruptUserDevice query enables an adver- sary A to capture the stored data inside the user Ui s device. CorruptUserSc( m Ui): The CorruptUserSc query enables an adversary A to capture the data from the user Ui s smart card (SC). CorruptSensingDevice( o SDj): The CorruptSensingDevice query enables an adversary A to capture the stored data inside the sensing device SD j. This query also enables an adversary A to receive the secret credential (Rj) of the sensing device SD j . Above three queries (CorruptUserDevice, CorruptUserSc, CorruptSensingDevice achieve the weak-corruption model in which the partici- pant s internal data and temporary key does not corrupt. CorruptLevelSensingDevice( o SD j): The CorruptLevelSensingDevice en- ables an adversary A to get the deployment level (lj) for the sensing device(SD j) with an objective of the performing an active attack. T ( x) : Before starting of this oracle game, an unbiased coin b get tossed. The output of this toss decides the return value for the test query T . If the recently generated session key between the user Ui and the sensor device SD j is SK, and an adversary A performs the test query on an instance m which is the instance of Ui or its partner instance o which is an instance of SD j then if the toss output is b = 1, participant instance m returns an original session key. In contrast, if b = 0, then m returns a random value of the session key SK s size to an adversary A. If none of the condition matches, then an instance m returns NULL. Accord- ing to an adversarial model discussed earlier in the chapter, the gateway device GW is a trusted device; thus, an adversary A can not apply these oracles on the gateway device. An adversary A has limited access to CorruptUserDevice, Cor- ruptUserSc, CorruptSensingDevice, CorruptLevelSensingDevice queries while A PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 189 Chapter 6. Level Dependent Authentication using Multi Factor Authentication can perform test query (T ( x)) as many time as it wish. Semantic Security of session key in ROR Model: The semantic security of the session key SK depends on an adversary A s capability of indistinguishability between the random number and the actual session key. The output of a test query T depends on the value of b guessed by A. If the value of b is similar to the value of b, which is a hidden bit set by an oracle instance m and used by T ( m) to retrieve the original session key. Thus, the overall game depends on the correct guess by A for bit b. If an adversary guesses the correct value of b, then it gets the correct session key. Let SUCC de ne success position for an adversary, then the advantage of an adversary A in capturing the correct session key SK for the proposed protocol LDAP is AdvLDA P. The AdvLDA P represents the success of an adversary A, and if the AdvLDA P is negligible, then it is said that the proposed scheme achieves security under the ROR model. Thus, AdvLDA P as follow: AdvLDA P(A) = 2 Pr[SUCC] 1 (6.1) Same equation can be written as follow: AdvLDA P(A) = 2 Pr[b = b] 1 (6.2) Where Pr[SUCC] represents the probability for the success of an adversary A, if it is proved that the AdvLDA P is negligible under the proposed protocol LDAP, then the proposed protocol is secure. Semantic Security for the Password based protocol The semantic security PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 190 Chapter 6. Level Dependent Authentication using Multi Factor Authentication of the password base protocol LDA Ppw de nes an adversary A s capability of guessing the correct password. A password based protocol LDA Ppw is se- mantically secure if the advantage function AdvLDA Ppw is negligible under the following condition: AdvLDA Ppw,|D|(A) max(qs,( 1 |DS|, f p)) (6.3) In equation 6.3, qs represents number of send queries (S), |DS| shows the - nite size of the password dictionary, f p shows probability of the false positive occurrence by an adversary A. Formal Security Proof The Security proof for the proposed protocol LDA P is represented in the fol- lowing theorem: Theorem 6. Let A is a polynomial-time attacker running against the proposed protocol LDA P within a limited time tA. Let an adversary A tries to attack the proposed protocol LDA P then it needs to perform the oracle queries. Let qh de nes the number of hash (H) queries, qs de nes the number of send (S) queries, qe establishes the number of execute (E) query, the number of bits for the biometric key is de ned as i, the uniformly distributed password dictionary is de ned as DC either against the user Ui or the sensor device SD j then the proposed protocol is secured if, AdvLDA P(A) q2 h 2lh +max(qs,( 1 |DC| 2l , f p))+(qs +qe 2lr )+( 1 2lj ) (6.4) PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 191 Chapter 6. Level Dependent Authentication using Multi Factor Authentication In Equation 6.4, lh is the size of the return value of Hash(H) query generated by A in bits, lr is the size of the random nonce generated by the protocol LDA P. |DC| shows the nite size of a password dictionary, and f p shows the probability of a false positive occurrence by A. Proof. four security games are de ned : {Gm0, Gm1, Gm2, Gm3, Gm4} for to prove that the proposed protocol P is secured against an adversary A and AdvLDA P(A) under de ned ROR model. The Game starts with the Gm0 and terminates at the Gm4. Now let us de ne an event SUCCi which represents the correct guess for the bit b in each game Gmi via the test query T by an adversary A. Game Gm0: The Gm0 is the initial game in which a real protocol LDA P is equal to an initial game so that: AdvLDA P(A) = 2 Pr[SUCC0] 1 (6.5) Game Gm1: In the Gm1, an Execute query E is performed by single intruder or multiple intruder A. An adversary A performs E( m, n, o) query to spoof communi- cation between valid participants. An Adversary A performs the test query T to achieve the session key. An adversary A must be capable enough to differentiate between a real session key and a random number. If the information retrieved us- ing above queries provide suf cient information to A for the computation of SK, PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 192 Chapter 6. Level Dependent Authentication using Multi Factor Authentication then the Gm1 is won by adversary A else : Pr[SUCC0] = Pr[SUCC1] (6.6) Simulation of Gm1: The game Gm1 de nes passive attack. Let us assume that adversary gets messages : Message 1: GW SDj: (H(UIDi||r2||SID j||GWID||T7), Enc(UIDi, r2), T7) Message 2: SDj GW: (Enc(r3), H(GWID||SIDj||r3||T8), H(GWID||SIDj||r2||T8), T8) Message 3: GW Ui: (Enc(r3), H(GWID||SIDj||r3||T8), H(Z1||Z2||Ks||T9), T8, T9) Message 4: GW SDj: (H(Z1||Z2||Ks||T9), T9) Note that the session key computation at user side Ui and Sensing device side SDj occurs as SK = H(r2||r3||UIDi||SIDj||GWIDk||T8||Mk||T9). where Mk = H(Z1||Z2||Ks||T9). To Compute the session key an adversary A needs {r2, r3, UIDi, SIDj and GWIDk} which involves random number and digested identities which are unknown to him/her. Thus, the winning probability for an adversary A does not increase. And hence, it is obvious that an Equation 6.6 satis es for an adversary A under the game Gm1. Game Gm2: De nition: This game executes following queries, Hash query H( m,mi) to retrieve hash output of message mi. Send query S( n SD j) to get messages from Sensing device. Send query S( m Ui) to get messages from User device. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 193 Chapter 6. Level Dependent Authentication using Multi Factor Authentication In this game an adversary A convinces legal participants for receiving a modi- ed messages. Thus in this game A can also perform hash operation to validate the modi cation. An adversary A validates collision and as per birthday paradox de nes, the probability of a collision for the oracle H is at most q2 h 2lh . In the pro- posed protocol (LDA-P), the rst message communicated between GW and SDj is message 1 = (H(UIDi||r2||SIDj||GWID||T7), Enc(UIDi, r2), T7) which includes secret identity of the user device and sensing device, random number r2 and time stamp T7. Thus, it is not possible to generate collision after performing the send query S. Similarly every other communicated messages (message 2, message 3, message 4) contains random nonces, time-stamps, gateway master secrets and so on. maximum collision possibility for the random numbers is at most qs+qe 2lr . Thus after this game: Pr[SUCC2] Pr[SUCC1] q2 h 2lh + qs +qe 2lr (6.7) Game Gm3: De nition: This game executes after the Gm0, Gm1, Gm2 games. The game Gm3 performs following query, Query CorruptUserSc( m Ui) provides user Ui s smart card data to an adver- sary A. Query CorruptUserDevice( m Ui) provides data stored in user Ui s device to an adversary A. An adversary A tries to guess the password used by the user. In this game Gm3, an adversary tries to read the smart card data for the user Ui. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 194 Chapter 6. Level Dependent Authentication using Multi Factor Authentication The user Ui stores (TIDi, M1, B1, M2) in the smart card where TIDi = H(r1||X1), M1= H(TIDi||GWID||Ri), B1 = X1 r1, M2 = H( TIDi|| i||Ri). Using Corrup- tUserSc query, an adversary A reads these all the parameters and tries to com- pute password PWi. But the password PWi is protected through a random number by gateway and the probability of guessing a correct random number is almost NULL. Now an adversary tries to acquire the biometric i from the user s data by performing the query CorruptUserDevice. In the proposed LDA-P protocol, strong fuzzy extractor is used which retrieves at most l bits and guessing probabil- ity for i o,1l is approximately 1 2l . Now an adversary tries to perform the online password guessing attack but for a particular session, the number of attempts al- lowed to execute is limited Thus, Pr[SUCC3] Pr[SUCC2] max(qs,( 1 |DS| 2l , f p)) (6.8) Game Gm4: De nition: This game executes after the completion of Gm0 to Gm3 games. The game Gm4 performs following query, Query CorruptSensingDevice( o SD j) enables an adversary A to capture stored parameter inside the sensing device SDj. Query CorruptLevelSensingDevice( o SD j) enables an adversary A for capa- bility of guessing the level lj for the sensing device SD j Now let us assume an adversary A performs above query on the proposed proto- col LDA-P then it receives Z2, X2, and sensing device long term secret R j from the memory of sensing device. The session key computed between user Ui and sens- PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 195 Chapter 6. Level Dependent Authentication using Multi Factor Authentication ing device SDj does not use either Z2 or X2. Now let us assume that A uses Rj to encrypt the receiving messages then he/she can get r2 parameter of the session key SK but can not capture the r3 and other parameters due to their ECC based encryption, randomness and hashed outputs. By using CorruptLevelSensingDe- vice query, an adversary A guesses the level l j for the sensing device. During the session key computation, neither the user Ui nor the sensing device SD j uses lj directly for the session key computation. Now let us assume that the probability of guessing the correct level is 1 2lj where 2l j represents the number of bits used for the level. Thus, after this game, Pr[SUCC4] Pr[SUCC3] 1 2l j (6.9) Thus, after completion of all games Gm0 to Gm4, an adversary A tried all the ran- dom oracle queries but he/she does not achieve success in session key generation. Now the only option left with an adversary is to guess the correct bit b for to win this game. Thus, an adversary A performs test query T . Hence overall, Pr[SUCC4] = 1 2 2l j (6.10) Now, from equation 6.6, 1 2*AdvLDA P = [Pr[Succ0] - 1 2]. So by using the trian- gular inequality, / [Pr[SUCC1] - [Pr[SUCC4] [Pr[SUCC1] - [Pr[SUCC2] + [Pr[SUCC2] - [Pr[SUCC4] [Pr[SUCC1] - [Pr[SUCC2] + [Pr[SUCC2] - [Pr[SUCC3] q2 h 2lh + max(qs, ( 1 |DC| 2l , f p)) + (qs+qe 2lr ) + ( 1 2l j ). Using equation PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 196 Chapter 6. Level Dependent Authentication using Multi Factor Authentication 6.6-6.10, |Pr[SUCC0] 1 2| q2 h 2lh +max(qs,( 1 |DC| 2l , f p))+(qs +qe 2lr )+( 1 2l j ) (6.11) So nally, from the equation 6.4 and 6.11, AdvLDA P(A) q2 h 2lh +max(qs,( 1 |DC| 2l , f p))+(qs +qe 2lr )+( 1 2l j ) (6.12) 6.6 Implementation and Testbeds In this section, the implementation approach for the proposed LDA scheme is dis- cussed. The proposed authentication scheme is implemented using the Message Queuing Telemetry Transport (MQTT) protocol is an application layer protocol and IPv6 as a network layer protocol. In this section, a comparison of the pro- posed authentication scheme is also presented with existing schemes in terms of communication cost (in bits), computation cost (based on operations), and net- working parameters like round-trip delay, packet loss, and throughput. Implementation Scenario An environment for the implementation of the pro- posed LDA scheme is highlighted in the following Table 6.4. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 197 Chapter 6. Level Dependent Authentication using Multi Factor Authentication Network Model Generic IoT Model Protocol Using MQTT Broker Mosquitto Secure channel By Enabling TLS communication in Mosquitto ECC Curve NIST P-256 Curve ECC Multiplication Using double and Add method Message format JSON Type Language Python User Device Intel (R) Core (TM) i3-7500 CPU with 2.80 GHz. Sensing device 1 GB RAM, Raspberry PI 3.0 Gateway System Architecture = x86-64, Processor: Intel (R) Core (TM) i5- 7500 CPU with 3.40 GHz. TABLE 6.4 Implementation Environment For the implementation of the proposed LDA Protocol, ten user devices, ten sensing devices, and one intermediate gateway was taken. The con guration for all the devices is highlighted in Table 6.4. A publish-subscribe model was cre- ated for communication using the MQTT protocol in which the user device and the sensing device subscribes to the gateway topics and communicate with each other via the gateway device. For the initialization and registration phase, a secure channel was created using the TLS connection of the MQTT protocol. To achieve higher accuracy in MQTT communication is a big challenge. The lightweight and secure MQTT communication is also a futuristic research area for the IoT security paradigm. For implementations we have used SHA256 as a hash func- tion and NIST recommended P-256 Curve. The security level achieved through implementation of proposed scheme is 128 bit. The above Fig.6.2. shows the implementation model, and the following Fig.6.3 shows the generated session key between the user device and the sensing device. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 198 Chapter 6. Level Dependent Authentication using Multi Factor Authentication User Device - 1 User Device - 10 Gateway Device Sensing Device - 10 Sensing Device - 1 Session Key Figure 6.2. IoT Implementation Model Figure 6.3. Computed Session Key 6.7 Use cases This chapter proposes three factor based LDA scheme for the user-gateway-sensor model. The proposed scheme aims to provide a lightweight communication be- tween the multiple user devices and the numerous amount of lightweight sensing devices deployed on the ground. The following are some of the signi cant use- cases of the proposed work. The proposed scheme presents signi cantly improved authentication scheme for the IoT application where the quantity of deployed sensing devices is large and have hierarchical user base. The proposed scheme can be highly useful where user is having mobile PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 199 Chapter 6. Level Dependent Authentication using Multi Factor Authentication devices capable to sense the biometric traits such as nger print. The signi cant use case of the proposed scheme mostly lies in environment where user have option to provide biometric trait as an input and wants to receive a data from the sensing devices. The novelty of the proposed work lies in its dynamic environment, lightweight computations and real-time implementations. Real-time implementation of the proposed ECC based LDA scheme using MQTT protocol (that itself is a lightweight communication protocol used by the IoT industry) makes it novel. The real-time implementation using MQTT protocol has advantages like the lightweight header and reliable communication over other conventional protocols. 6.8 Comparative Analysis A Network Parameter Analysis In this subsection, networking related parameters like throughput, round trip delay (RTD), and packet loss are discussed. The WIRESHARK tool was setup to monitor MQTT packets and collect the data regarding packet loss, the number of packets transmitted per unit time, and how much time each packet takes to reach the destination. Rather than simulation through any simulator, a raspberry pi, and laptop devices were deployed to implement the proposed scheme and collected real-time data. Thus, the outcome of throughput, RTD, and packet loss for the proposed scheme is as follows. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 200 Chapter 6. Level Dependent Authentication using Multi Factor Authentication Throughput The throughput can be computed in two ways, one based on the number of bits transmitted per unit time and the second based on the number of packets trans- mitted per unit time. Our implementation collected data for ten static users, one gateway, and ten static sensors. The throughput is 167 bps, 237 bps, and 93bps at the user, gateway, and the sensor device, respectively. Thus, the com- putation cost for the proposed scheme is 4.98 seconds, 5.26 seconds, and 9.29 seconds at the user, gateway, and sensor device, Now, if the number of packets transmitted per unit time is considered, then the throughput can be computed as totalpacketreceived packetsize totaltime . Thus, by this formula, the average number of packet received at the user is 9, the sensor is 11 and gateway is 45 where packet size communicated from user to gateway is 7 byte, gateway to user and sensor is 9 byte and sensor to the gateway is 5 byte through MQTT. Therefore, the average throughput for the proposed scheme is 22.58 bps. Round Trip Delay (RTD) The round trip delay is computed as an average time required by a communicated packet to arrive at the destination from the source. For the experimental purpose, through our scenario of ten users, one gateway, and ten sensing device, a simul- taneous requests to gateway device were generated from each user for accessing sensors of different levels. Then the average RTD at the user device, which in- cludes the time required between sending a request to receiving a reply from the gateway via a sensing device, is 0.4836 seconds. The average RTD at the sensing device, which includes the time between the sensor s reply to the gateway and PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 201 Chapter 6. Level Dependent Authentication using Multi Factor Authentication gateway s response to the sensor, is 0.4625 second. If some requests are sent in which the user is not eligible to get access to the sensor of a particular level, then the RTD increases due to gateway node take little more veri cation time. If the gateway device does not found a valid user, subsequently, it communicates zero signal to both the user and sensor device to terminate communication. B Communication Cost The communication cost represents the number of bits communicated before es- tablishing the session key for the proposed protocol. A communication cost in the unit of bits is taken. In the proposed LDA protocol, the size of a randomly generated identity and a password is 160 bits. Due to resource constraints, as a biometric parameter, The 160 bits random binary string was used. The output size of a hash operation is 256 bits due to the use of SHA-256. The size of the randomly generated nonce is 128 bits, and the size of the timestamp is 32 bits. An ECC is used for the key generation. Each point in the ECC has two coordi- nates, and each coordinate size is 160 bits; thus, one point (Xp, Yp) represents a total of 160 + 160 = 320 bits. Therefore, the public key size (PKs) is 320 bits, while the private key (Ks) size is 160 bits as per ECC computation of the pro- posed LDA scheme. Table 6.5 presents communication cost comparison for the proposed scheme and existing schemes. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 202 Chapter 6. Level Dependent Authentication using Multi Factor Authentication Scheme User Gateway Sensor Total Cost [Challa et al. (2017)] 992 1024 512 2528 [Shin & Kwon (2020)] 1158 1560 678 3552 [Zhou et al. (2019)] 832 2048 672 3552 [Wu et al. (2020)] 813 2110 789 3712 [Shuai et al. (2020)] 1260 1696 1344 4256 Proposed 832 1248 864 2944 TABLE 6.5 Communication Costs Comparison C Computation Cost The computation cost represents the number of cryptographic operations used in the proposed scheme during the login and authentication stage. It also gives the total time required by those operations at each participant s devices. Let TE/TD, Th, Tecm, Tfe represent the computation cost of ECC encryption/decryption operation, one-way hash function H(.), ECC Point multiplication and fuzzy extra traction operation respectively. The computation cost of the bitwise XOR operation is not considered because it takes very little time (almost 0 ms) compare to other oper- ations. Following are the realtime observations through deployment of devices in university campus, For the gateway device, TE/TD operation takes 0.06783 seconds, Th opera- tion takes 0.00034 seconds and the Tecm operation takes 0.0589 seconds. For the user device, TE/TD operation takes 0.07083 seconds, Th operation takes 0.00041 seconds, the Tecm operation takes 0.0607 seconds and Tfe operation takes 0.0503 seconds. For the sensing device, TE/TD operation takes 0.08883 seconds, Th operation PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 203 Chapter 6. Level Dependent Authentication using Multi Factor Authentication takes 0.00084 seconds and the Tecm operation takes 0.0703 seconds. Above all the costs are an average of 100 times veri ed outputs. Table 6.6 presents computation cost comparison for the proposed scheme and existing schemes. Scheme User Gateway Sensor Time(S) [Challa et al. (2017)] Tfe+5*Tecm+5*Th 5*Tecm+4*Th 4*Tecm+3*Th 1.11501 [Shin & Kwon (2020)] 3*TP + 14*Th TP + 12*Th 2*TP + 5*Th 0.866 [Zhou et al. (2019)] 4*Tecm+5*Th 3*Tecm+7*Th 4*Tecm+6*Th 1.069 [Wu et al. (2020)] 13*Th + TBKG 15*Th 4*Th 1.503 [Shuai et al. (2020)] 7*Th + Tecm + TQR 7*Th + TQR 5*Th + Tecm 2.150 Proposed 7*Th + 2*Te + Tfe 11*Th+2*Te 5*Th+1*Te 0.72656 TABLE 6.6 Computation Cost Comparison Following Fig.6.4. gives performance comparison of communication cost and computation cost of the proposed scheme with the existing schemes. The compar- Communication Costs in bits Computation Costs in s 0 500 1000 1500 2000 2500 3000 3500 4000 4500 [Challa et al. (2017)] [Shin & Kwon (2020)] [Zhou et al. (2019)] [Wu et al. (2020)] [Shuai et al. (2020)] Proposed 0 0.5 1 1.5 2 2.5 [Challa et al. (2017)] [Shin & Kwon (2020)] [Zhou et al. (2019)] [Wu et al. (2020)] [Shuai et al. (2020)] Proposed Figure 6.4. Performance Comparison Chart PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 204 Chapter 6. Level Dependent Authentication using Multi Factor Authentication ative analysis shows that the proposed scheme has little higher computation and communication costs than other existing schemes. Still, the security index for the proposed scheme is higher compared to other existing schemes. In the proposed scheme, a novel idea of the LDA is presented, which ful lls the requirement of real-time deployment of the IoT application. The proposed LDA scheme is used in IoT applications with a hierarchical access control model. The proposed LDA reduces the number of user registration steps, reduces memory utilization and search operations and discard the need of separate access control mechanism. 6.9 Summary This chapter highlights a novel concept of Level Dependent Authentication (LDA) in which the gateway de nes user and sensor levels during initialization. Later on, only valid users can access the sensors deployed at a particular level. The pro- posed scheme has three important phases. In the initialization phase, the gateway creates a credential for the user and sensor. Later on, the user does the registra- tion, which is followed by login and authentication. The security analysis for the proposed scheme is provided through the random oracles and an AVISPA tool. The BAN Logic is used to prove the mutual authentication property. The imple- mentation of the proposed scheme was performed through the raspberry-pi and laptops as a static device and the MQTT as an application layer protocol. Overall, the proposed scheme successfully achieves a security objective for the real-time deployment of any generic IoT application. This chapter also provides a com- parative analysis of the proposed scheme with the other existing schemes. Even though, this chapter presents strong enough security for the LDA scheme using PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 205 Chapter 6. Level Dependent Authentication using Multi Factor Authentication three factor authentication, there is a scope of further development and have broad application oriented future work. Next chapter 7 provides conclusion and future work related to this thesis. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 206 Chapter 7 Conclusions and Future Scope This chapter presents summary of major contributions of this thesis and also pro- vide light on road-map for future research directions related to the user and device authentication in IoT. Section 7.1 presents conclusion of this thesis. Section 7.2 provides future work related to this thesis 7.1 Conclusions The major contributions of this thesis can be outlined as follows. In this thesis, we have proposed four remote user authentication schemes using ECC for the IoT environment in the following manners. Authentication between user - gateway where sensing devices are not capa- ble to perform computations. Authentication between user - gateway - sensing devices in which user have to register for each sensing device. 207 Level dependent authentication using two factors that tries to reduce number of registrations for users and provide light weight key exchange. Level dependent authentication using three factors that provides better se- curity compare to two factor based authentication with light weight compu- tations. In the rst contribution (Chapter 3), we have proposed a novel authentication scheme between user device and the gateway device. In this contribution, we have considered sensing devices as a very tiny devices which are not capable to perform complex cryptography operations. In this contribution, there are three phases. The rst phase provides initialization step that is performed in secure environment. Next phase is login and authentication phase that is performed over open channel and as an outcome of this phase, a session key will be generated between user and gateway device. We validate the security of this proposed work by formal security models such as BAN Logic and ROR model as well as informal security analysis over dolev-yao channel. The proposed scheme of this contribution was also implemented in realtime environment and was compared with other existing schemes. This contribution was enhanced in next chapter in which we have also used smart lightweight device also for session key generation with other devices. In the second contribution (Chapter 4), we have proposed a novel authentica- tion scheme between user device, gateway device and the smart meter which is considered as a lightweight device capable to perform cryptography operations. In this contribution, we have considered real time IoT environment with the ap- plication of energy monitoring in smart home. In this contribution, there are three phases. The rst phase provides initialization step that is performed in secure en- 208 vironment. Next phase is registration phase, and last phase is authentication and key exchange phase that is performed over open channel and as an outcome of this phase, a session key will be generated between user and the smart meter. We val- idate the security of this proposed work by formal security models such as BAN Logic and ROR model as well as informal security analysis over dolev-yao chan- nel. The proposed scheme of this contribution was also implemented in realtime environment by considering raspberry pi as a smart meter device and was com- pared with other existing schemes. The major drawback of this work we found was that user need to register for each sensing device. Now, in the IoT environ- ment where thousands sensing devices are deployed then it becomes tedious task to do that. Thus, this contribution was enhanced in next chapter in which we have come up with novel ideal of level dependent authentication. In the third contribution (Chapter 5), we have proposed a novel authentication scheme called as a level dependent authentication between user device, gateway device and the sensing device using two factors. In this contribution, we have considered real time IoT environment where thousands of sensors are deployed on ground and there is a need to provide data to system users on time. In this contribution, user registers with some level and he/she will have access of sensing devices which are deployed below that level. In this contribution, there are three phases. The rst phase provides initialization step that is performed in secure en- vironment by the gateway device. Next phase is registration phase and last phase is authentication and key exchange phase that is performed over open channel and as an outcome of this phase, a session key will be generated between user and the sensing devices. User will have access of all those sensors which are below the user level. So onetime registration of the user will enable access to all eligible 209 sensing devices. We validate the security of this proposed work by formal security models such as BAN Logic and ROR model as well as informal security analy- sis over dolev-yao channel. The proposed scheme of this contribution was also implemented in realtime environment by considering raspberry pis as a sensing devices and was compared with the other existing schemes. The major drawback of this work we found was that this in this scheme, user does not use any biometric trait to perform authentication and that sometime leads toward system breakout. Thus, this contribution was enhanced in next chapter in which we have used three factor based authentication with LDA for to improve the security. In the last contribution (Chapter 6), we have proposed a novel authentication scheme called as a level dependent authentication between user device, gateway device and the sensing device using three factors. In this contribution, we have considered real time IoT environment where thousands of sensors are deployed on ground and there is a need to provide data to system users on time. In this contribution, user registers with some level and he/she will have access of sensing devices which are deployed below that level. In this contribution, there are three phases. The rst phase provides initialization step that is performed in secure en- vironment by the gateway device. Next phase is registration phase and last phase is authentication and key exchange phase that is performed over open channel and as an outcome of this phase, a session key will be generated between user and the sensing devices. User will have access of all those sensors which are below the user level. So onetime registration of the user will enable access to all eligible sensing devices. We validate the security of this proposed work by formal security models such as BAN Logic and ROR model as well as informal security analy- sis over dolev-yao channel. The proposed scheme of this contribution was also 210 implemented in realtime environment by considering raspberry pis as a sensing devices and was compared with the other existing schemes. Still, there is a scope of development in the RUA for IoT environment using new lightweight cryptog- raphy operations and lightweight hardware. In next section 7.2, we provide an overview on tentative future work. 7.2 Future Work In this section, we put forward some possible directions for future work. One can investigate following research directions : A Deployment of LDA approach in other realtime IoT appli- cations In this thesis, we proposed LDA approach that we implemented in university cam- pus environment but it still needs to verify in other IoT applications such as SH, SI and so on. Now a days people uses authentication and access control as a sep- arate security mechanism but we believe that LDA can work as a joint approach for both these security parameters. Hence, there is a wide scope of further devel- opment in LDA approach. An IoT authentication can have multiple other phases such as dynamic device addition, run time user registration, user revocation or re- registration phases. This thesis doesn t provide this phases for LDA approach that needs to design to improve the services in IoT eco-system. Hence, in future, we will implement proposed LDA with other realtime IoT applications and improve the security and services by designing new phases. 211 B M2M or D2D Authentication An IoT eco-system is a network of billions of interconnected heterogeneous de- vices. In this network, interconnected devices communicates with each other as well as communicates back-end infrastructures (such as databases, cloud) to transmit the data and store the data. Similarly M2M communication connects nu- merous machine with IoT network. Thus, authentication between (or of ) these devices and machines must be done to secure the whole eco-system. Hence only authorized devices and machines can connect and communicate inside the IoT eco-system. C Authentication in the Multi gateway Environment In this thesis, we considered only single gateway environment where user had only one intermediary option to communicate with the sensing device and this gateway device can be always a targeted point for the attacker to perform DoS and DDoS type attacks. Hence, there can be multiple gateway deployed to provide uninter- rupted services to the IoT eco-system. There can be multi gateway environment to provide faster services to the user (i.e. many road side units to provide faster services to ongoing vehicles) and in that circumstances, authentication must occur faster in very lighter mode without damage to the security. 212 D Authentication thorough Physical Unclonable Functions or Secure Elements The Secure Element (SE) aims to store the secret credential in the tamper-resistant environment. The SE is like micro controller which is having two type of mem- ory. In rst memory, it stores public elements and in second memory it stores secret elements which are accessible by only SE controller. Hence, designing an authentication schemes for IoT devices using SE can improve the IoT eco-system security. The Physical Unclonable Function (PUF) is also another option that is adopted by many researchers who are working on hardware based authentication for IoT devices [Garg et al. (2020)]. Any PUF is unclonable and it s output is non predictable as well as dependent on physical system. E Learning Approach for Authentication Machine Learning (ML) and its other sub parts such as deep learning and feder- ated learning are the growing elds. Authors in presents an authentication scheme based on deep neural network framework that allows real-time authentication of the wireless nodes, using the effects of inherent process variation on Radio Fre- quency (RF) properties of the wireless transmitters (Tx), detected through in-situ machine learning at the receiver (Rx) end. In this paper, author uses DNN tech- niques to authenticate the devices [Chatterjee et al. (2019)]. Similarly other au- thors used random forest classi cation, generative adversarial network and other classi cation based methods to develop authentication approach for IoT devices. Though there are challenges such as proper dataset and run time modeling exists in learning based techniques, there is a wide scope of research in this direction. 213 List of Publications Book 1. Chintan Patel, and Nishant Doshi, Internet of things security: challenges, advances, and analytics. CRC Press (Taylor and Francis Group), Auerbach Publications, ISBN: 9780429454448, 2018. DoI : https://doi.org/10.1201/9780429454448. [Chapter 1-2-3] Book Chapter 1. Chintan Patel, and Nishant Doshi, Patel C.,(2019) Security Challenges in IoT Cyber World. In: Hassanien A., Elhoseny M., Ahmed S., Singh A. (eds) Security in Smart Cities: Models, Applications, and Challenges. Lecture Notes in Intelligent Transportation and Infrastructure. Springer, Cham. DoI : https://doi.org/10.1007/978-3-030-01560-2 8[Chapter 1-2- 3] 214 Journal Publications 1. Chintan Patel, and Nishant Doshi, Secure Lightweight Key Exchange Us- ing ECC for User-Gateway Paradigm Published in IEEE Transactions on Computers (SCI Indexed, H-Index = 118), DoI : 10.1109/TC.2020.3026027 [Chapter 3]. 2. Chintan Patel, and Nishant Doshi, Cryptanalysis and Improvement of Bar- man et al. s Secure Remote User Authentication Scheme published in In- ternational journal of Circuits, Systems And Signal Processing (Scopus), NAUN Publication, Vol 13 No. 1, pp. 604-610, 2019.[Chapter 5] 3. Chintan Patel & Nishant Doshi (2021) LDA-IoT : a level dependent authen- tication for IoT paradigm, Information Security Journal: A Global Perspec- tive, DOI: 10.1080/19393555.2021.1931573. [Chapter 6] Conference Publications 1. Chintan Patel, and Nishant Doshi, Internet of Things: A Review on Ma- jor Challenges and Applications, Proceedings of INCRS 2018, IIITDM Ja- balpur, Gupta V., Varde P., Kankar P., Joshi N. (eds) Reliability and Risk Assessment in Engineering. Lecture Notes in Mechanical Engineering. Springer, Singapore. [Chapter 1-2-3] DoI : https://doi.org/10.1007/978-981-15-3746-2 40 2. Chintan Patel, and Nishant Doshi, Cryptanalysis of ecc-based key agree- ment scheme for generic IoT network model, 215 Proceedings of 10th IEEE International Conference on Computing, Com- munication and Networking Technologies (ICCCNT), IIT Kanpur, India, 2019. [Chapter 1,2,3] DoI : 10.1109/ICCCNT45670.2019.8944674. 3. Chintan Patel, and Nishant Doshi A Novel Lightweight Authentication for Intelligent Energy Monitoring in Smart Home, Proceedings of ISTA 2019, International Conference on Applied Soft computing and Communication Networks (ACN 19), December 18-21, 2019, IIITM, Trivandrum, India. in Thampi S. et al. (eds) Intelligent Systems, Technologies and Applications. Advances in Intelligent Systems and Computing, vol 1148. Springer, Sin- gapore. [Chapter 4] DoI : https://doi.org/10.1007/978-981-15-3914-5 17. 4. Chintan Patel, and Nishant Doshi, A Novel MQTT Security framework In Generic IoT Model, CoCoNet-2019, IIITM Trivandrum, in Procedia Com- puter Science, Elsevier, Vol 171, pp. 1399-1408, 2020. [Chapter 1-2-3] DoI : https://doi.org/10.1016/j.procs.2020.04.150. 216 Bibliography Abbasinezhad-Mood, D., & Nikooghadam, M. (2018). Design and hard- ware implementation of a security-enhanced elliptic curve cryptography based lightweight authentication scheme for smart grid communications. Future Generation Computer Systems, 84, 47 - 57. Retrieved from http://www .sciencedirect.com/science/article/pii/S0167739X17315376 doi: https://doi.org/10.1016/j.future.2018.02.034 Abdalla, M., & Pointcheval, D. (2005). Simple password-based encrypted key exchange protocols. In Cryptographers track at the rsa conference (pp. 191 208). Al-Fuqaha, A., Guizani, M., Mohammadi, M., Aledhari, M., & Ayyash, M. (2015). Internet of things: A survey on enabling technologies, protocols, and applications. IEEE Communications Surveys Tutorials, 17(4), 2347-2376. doi: 10.1109/COMST.2015.2444095 Amin, R., Islam, S. H., Biswas, G., Khan, M. K., & Kumar, N. (2018). A robust and anonymous patient monitoring system using wireless medi- cal sensor networks. Future Generation Computer Systems, 80, 483 - 495. 217 Bibliography Retrieved from http://www.sciencedirect.com/science/article/pii/ S0167739X16301509 doi: https://doi.org/10.1016/j.future.2016.05.032 Atzori, L., Iera, A., & Morabito, G. (2010). The internet of things: A survey. Computer networks, 54(15), 2787 2805. Borgia, E. (2014). The internet of things vision: Key features, applica- tions and open issues. Computer Communications,Elsevier, 54, 1 31. Re- trieved from http://dx.doi.org/10.1016/j.comcom.2014.09.008 doi: 10.1016/j.comcom.2014.09.008 Burrows, M., Abadi, M., & Needham, R. M. (1989). A logic of authentication. Proceedings of the Royal Society of London. A. Mathematical and Physical Sciences, 426(1871), 233 271. Challa, S., Wazid, M., Das, A. K., Kumar, N., Goutham Reddy, A., Yoon, E., & Yoo, K. (2017). Secure signature-based authenticated key establishment scheme for future iot applications. IEEE Access, 5, 3028-3043. doi: 10.1109/ ACCESS.2017.2676119 Chang, C.-C., & Hwang, S.-J. (1993). Using smart cards to authenticate remote passwords. Computers & Mathematics with Applications, 26(7), 19 27. Chatterjee, B., Das, D., Maity, S., & Sen, S. (2019). Rf-puf: Enhancing iot security through authentication of wireless nodes using in-situ machine learning. IEEE Internet of Things Journal, 6(1), 388-398. doi: 10.1109/ JIOT.2018.2849324 PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 218 Bibliography Chatterjee, S., Roy, S., Das, A. K., Chattopadhyay, S., Kumar, N., & Vasi- lakos, A. V. (2018, Sep.). Secure biometric-based authentication scheme using chebyshev chaotic map for multi-server environment. IEEE Transac- tions on Dependable and Secure Computing, 15(5), 824-839. doi: 10.1109/ TDSC.2016.2616876 Chaturvedi, A., Mishra, D., & Mukhopadhyay, S. (2017). An enhanced dynamic id-based authentication scheme for telecare medical information systems. Jour- nal of King Saud University - Computer and Information Sciences, 29(1), 54 - 62. Retrieved from http://www.sciencedirect.com/science/article/ pii/S1319157815000865 doi: https://doi.org/10.1016/j.jksuci.2014.12.007 Chaudhry, S. A., Naqvi, H., Shon, T., Sher, M., & Farash, M. S. (2015, Apr 26). Cryptanalysis and improvement of an improved two factor authentication pro- tocol for telecare medical information systems. Journal of Medical Systems, 39(6), 66. Retrieved from https://doi.org/10.1007/s10916-015-0244-0 doi: 10.1007/s10916-015-0244-0 Chifor, B.-C., Bica, I., Patriciu, V.-V., & Pop, F. (2018). A security authorization scheme for smart home internet of things devices. Future Generation Computer Systems, 86, 740 749. Cisco. (2014). The internet of things reference model. Retrieved from http://cdn.iotwf.com/resources/71/IoT-Reference-Model-White -Paper-June-4-2014.pdf Das, A. K., Wazid, M., Yannam, A. R., Rodrigues, J. J. P. C., & Park, Y. (2019). Provably secure ecc-based device access control and key agreement protocol PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 219 Bibliography for iot environment. IEEE Access, 7, 55382-55397. doi: 10.1109/ACCESS .2019.2912998 Das, M. L., Saxena, A., & Gulati, V. P. (2004). A dynamic id-based remote user authentication scheme. IEEE transactions on Consumer Electronics, 50(2), 629 631. Dhillon, P. K., & Kalra, S. (2019). Secure and ef cient ecc based sip authentica- tion scheme for voip communications in internet of things. Multimedia Tools and Applications, 78(16), 22199 22222. Dif e, W., & Hellman, M. (1976). New directions in cryptography. IEEE trans- actions on Information Theory, 22(6), 644 654. Dodis, Y., Reyzin, L., & Smith, A. (2004). Fuzzy extractors: How to generate strong keys from biometrics and other noisy data. In International conference on the theory and applications of cryptographic techniques (pp. 523 540). Dolev, D., & Yao, A. C. (1981). On the security of public key protocols. In Proceedings of the 22nd annual symposium on foundations of computer science (pp. 350 357). Washington, DC, USA: IEEE Computer Society. Retrieved from https://doi.org/10.1109/SFCS.1981.32 doi: 10.1109/SFCS.1981 .32 Elgamal, T. (1985). A public key cryptosystem and a signature scheme based on discrete logarithms. IEEE Transactions on Information Theory, 31(4), 469-472. doi: 10.1109/TIT.1985.1057074 PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 220 Bibliography Esfahani, A., Mantas, G., Matischek, R., Saghezchi, F. B., Rodriguez, J., Bicaku, A., ... Bastos, J. (2019, Feb). A lightweight authentication mechanism for m2m communications in industrial iot environment. IEEE Internet of Things Journal, 6(1), 288-296. doi: 10.1109/JIOT.2017.2737630 Farash, M. S., Turkanovi c, M., Kumari, S., & H olbl, M. (2016). An ef cient user authentication and key agreement scheme for heterogeneous wireless sensor network tailored for the internet of things environment. Ad Hoc Networks, 36, 152 176. Garg, S., Kaur, K., Kaddoum, G., & Choo, K.-K. R. (2020). Toward secure and provable authentication for internet of things: Realizing industry 4.0. IEEE Internet of Things Journal, 7(5), 4598-4606. doi: 10.1109/JIOT.2019.2942271 Garg, S., Kaur, K., Kaddoum, G., & Choo, K. R. (2020). Toward secure and provable authentication for internet of things: Realizing industry 4.0. IEEE Internet of Things Journal, 7(5), 4598-4606. Gil, D., Ferr andez, A., Mora-Mora, H., & Peral, J. (2016). Internet of things: A review of surveys based on context aware intelligent services. Sensors, 16(7). Retrieved from http://www.mdpi.com/1424-8220/16/7/1069 doi: 10.3390/s16071069 Gope, P., & Sikdar, B. (2019, Feb). Lightweight and privacy-preserving two- factor authentication scheme for iot devices. IEEE Internet of Things Journal, 6(1), 580-589. doi: 10.1109/JIOT.2018.2846299 Granjal, J., Monteiro, E., & Silva, J. S. (2015, thirdquarter). Security for the internet of things: A survey of existing protocols and open research issues. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 221 Bibliography IEEE Communications Surveys Tutorials, 17(3), 1294-1312. doi: 10.1109/ COMST.2015.2388550 Hankerson, D., Menezes, A. J., & Vanstone, S. (2006). Guide to elliptic curve cryptography. Springer Science & Business Media. Hatton, M. (2020). The iot in 2030: 24 billion connected things generating $1.5 trillion. IoT Business news. Jangirala, S., Das, A. K., Wazid, M., & Vasilakos, A. V. (2020). Design- ing secure user authentication protocol for big data collection in iot-based in- telligent transportation system. IEEE Internet of Things Journal, 1-1. doi: 10.1109/JIOT.2020.3040938 Jiang, Q., Zeadally, S., Ma, J., & He, D. (2017). Lightweight three-factor au- thentication and key agreement protocol for internet-integrated wireless sensor networks. IEEE Access, 5, 3376 3392. Jing, Q., Vasilakos, A. V., Wan, J., Lu, J., & Qiu, D. (2014, November). Se- curity of the internet of things: Perspectives and challenges. Wirel. Netw., 20(8), 2481 2501. Retrieved from http://dx.doi.org/10.1007/s11276 -014-0761-7 doi: 10.1007/s11276-014-0761-7 Jo, H. J., Kim, I. S., & Lee, D. H. (2016, May). Ef cient and privacy-preserving metering protocols for smart grid systems. IEEE Transactions on Smart Grid, 7(3), 1732-1742. doi: 10.1109/TSG.2015.2449278 PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 222 Bibliography Kang, J., Park, G., & Park, J. H. (2016). Design of secure authentication scheme between devices based on zero-knowledge proofs in home automation service environments. The Journal of Supercomputing, 72(11), 4319 4336. Karati, A., Islam, S. H., & Karuppiah, M. (2018). Provably secure and lightweight certi cateless signature scheme for iiot environments. IEEE Transactions on Industrial Informatics, 14(8), 3701 3711. Koblitz, N. (1987). Elliptic curve cryptosystems. Mathematics of computation, 48(177), 203 209. Kocher, P. C., Jaffe, J., & Jun, B. (1999). Differential power analysis. In Pro- ceedings of the 19th annual international cryptology conference on advances in cryptology (pp. 388 397). Berlin, Heidelberg: Springer-Verlag. Retrieved from http://dl.acm.org/citation.cfm?id=646764.703989 Kumar, P., Gurtov, A., Iinatti, J., Ylianttila, M., & Sain, M. (2015). Lightweight and secure session-key establishment scheme in smart home environments. IEEE Sensors Journal, 16(1), 254 264. Lamport, L. (1994). Latex: a document preparation system: user s guide and reference manual. Addison-wesley. Li, X., Niu, J., Bhuiyan, M. Z. A., Wu, F., Karuppiah, M., & Kumari, S. (2017). A robust ecc-based provable secure authentication protocol with privacy preserv- ing for industrial internet of things. IEEE Transactions on Industrial Informat- ics, 14(8), 3599 3609. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 223 Bibliography Light, R. A., et al. (2017). Mosquitto: server and client implementation of the mqtt protocol. J. Open Source Software, 2(13), 265. Lohachab, A., & Karambir. (2019). Ecc based inter-device authentication and au- thorization scheme using mqtt for iot networks. Journal of Information Security and Applications, 46, 1 - 12. doi: https://doi.org/10.1016/j.jisa.2019.02.005 Lyu, Q., Zheng, N., Liu, H., Gao, C., Chen, S., & Liu, J. (2019). Remotely access my smart home in private: An anti-tracking authentication and key agreement scheme. IEEE Access, 7, 41835-41851. doi: 10.1109/ACCESS.2019.2907602 Mahmood, K., Chaudhry, S. A., Naqvi, H., Kumari, S., Li, X., & Sangaiah, A. K. (2018). An elliptic curve cryptography based lightweight authentication scheme for smart grid communication. Future Generation Computer Systems, 81, 557 - 565. Retrieved from http://www.sciencedirect.com/science/article/ pii/S0167739X17309263 doi: https://doi.org/10.1016/j.future.2017.05.002 Maple, C. (2017). Security and privacy in the internet of things. Journal of Cy- ber Policy, 2(2), 155 184. Retrieved from https://www.tandfonline.com/ doi/full/10.1080/23738871.2017.1366536 doi: 10.1080/23738871 .2017.1366536 Messerges, T. S., Dabbish, E. A., & Sloan, R. H. (1999). Power analysis attacks of modular exponentiation in smartcards. In C . K. Koc & C. Paar (Eds.), Cryp- tographic hardware and embedded systems (pp. 144 157). Berlin, Heidelberg: Springer Berlin Heidelberg. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 224 Bibliography Miller, V. S. (1986). Use of elliptic curves in cryptography. In H. C. Williams (Ed.), Advances in cryptology crypto 85 proceedings (pp. 417 426). Berlin, Heidelberg: Springer Berlin Heidelberg. Miorandi, D., Sicari, S., De Pellegrini, F., & Chlamtac, I. (2012). Internet of things: Vision, applications and research challenges. Ad hoc networks, 10(7), 1497 1516. Naoui, S., Elhdhili, M. E., & Saidane, L. A. (2019, Mar 09). Lightweight and secure password based smart home authentication protocol: Lsp-shap. Journal of Network and Systems Management. Retrieved from https://doi.org/ 10.1007/s10922-019-09496-x doi: 10.1007/s10922-019-09496-x Odelu, V., Das, A. K., & Goswami, A. (2015, Sept). A secure biometrics-based multi-server authentication protocol using smart cards. IEEE Transactions on Information Forensics and Security, 10(9), 1953-1966. doi: 10.1109/TIFS.2015 .2439964 Patel, C., & Doshi, N. (2018). Internet of things security: challenges, advances, and analytics. CRC Press. Patel, C., & Doshi, N. (2019). Security challenges in iot cyber world. In A. E. Hassanien, M. Elhoseny, S. H. Ahmed, & A. K. Singh (Eds.), Se- curity in smart cities: Models, applications, and challenges (pp. 171 191). Cham: Springer International Publishing. Retrieved from https://doi.org/ 10.1007/978-3-030-01560-2 8 doi: 10.1007/978-3-030-01560-2 8 PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 225 Bibliography Poh, G. S., Gope, P., & Ning, J. (2019). Privhome: Privacy-preserving authenti- cated communication in smart home environment. IEEE Transactions on De- pendable and Secure Computing. Qiu, S., Xu, G., Ahmad, H., & Wang, L. (2018). A robust mutual authentication scheme based on elliptic curve cryptography for telecare medical information systems. IEEE Access, 6, 7452-7463. doi: 10.1109/ACCESS.2017.2780124 Radhakrishnan, N., & Karuppiah, M. (2018). An ef cient and secure remote user mutual authentication scheme using smart cards for telecare medical informa- tion systems. Informatics in Medicine Unlocked. Retrieved from http://www .sciencedirect.com/science/article/pii/S2352914817301697 doi: https://doi.org/10.1016/j.imu.2018.02.003 Rivest, R. L., Shamir, A., & Adleman, L. (1978, February). A method for ob- taining digital signatures and public-key cryptosystems. Commun. ACM, 21(2), 120 126. Retrieved from https://doi.org/10.1145/359340.359342 doi: 10.1145/359340.359342 Roman, L. F., Gondim, P. R., & Lloret, J. (2019). Pairing-based authentica- tion protocol for v2g networks in smart grid. Ad Hoc Networks, 90, 101745. Retrieved from http://www.sciencedirect.com/science/article/pii/ S1570870518305997 (Recent advances on security and privacy in Intelligent Transportation Systems) doi: https://doi.org/10.1016/j.adhoc.2018.08.015 Roy, S., Chatterjee, S., Das, A. K., Chattopadhyay, S., Kumari, S., & Jo, M. (2018, Aug). Chaotic map-based anonymous user authentication scheme with PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 226 Bibliography user biometrics and fuzzy extractor for crowdsourcing internet of things. IEEE Internet of Things Journal, 5(4), 2884-2895. doi: 10.1109/JIOT.2017.2714179 Shin, S., & Kwon, T. (2020). A privacy-preserving authentication, authoriza- tion, and key agreement scheme for wireless sensor networks in 5g-integrated internet of things. IEEE Access, 8, 67555-67571. doi: 10.1109/ACCESS.2020 .2985719 Shuai, M., Xiong, L., Wang, C., & Yu, N. (2020). A secure authentication scheme with forward secrecy for industrial internet of things using rabin cryptosys- tem. Computer Communications, 160, 215 - 227. Retrieved from http://www .sciencedirect.com/science/article/pii/S0140366420300736 doi: https://doi.org/10.1016/j.comcom.2020.06.012 Shuai, M., Yu, N., Wang, H., & Xiong, L. (2019). Anonymous authentication scheme for smart home environment with provable security. Computers and Security, 86, 132 - 146. doi: https://doi.org/10.1016/j.cose.2019.06.002 Stallings, W. (2010). Cryptography and network security: Principles and practice (5th ed.). Upper Saddle River, NJ, USA: Prentice Hall Press. Sudhakar, T., Natarajan, V., Gopinath, M., & Saranyadevi, J. (2020, May 26). An enhanced authentication protocol for multi-server environment using password and smart card. Wireless Personal Communications. Retrieved from https:// doi.org/10.1007/s11277-020-07462-4 doi: 10.1007/s11277-020-07462 -4 PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 227 Bibliography Turkanovi c, M., Brumen, B., & H olbl, M. (2014). A novel user authentication and key agreement scheme for heterogeneous ad hoc wireless sensor networks, based on the internet of things notion. Ad Hoc Networks, 20, 96 112. Vahedi, E., Bayat, M., Pakravan, M. R., & Aref, M. R. (2017). A secure ecc- based privacy preserving data aggregation scheme for smart grids. Computer Networks, 129, 28 36. Wang, D., & Wang, P. (2018). Two birds with one stone: Two-factor authentica- tion with security beyond conventional bound. IEEE Transactions on Depend- able and Secure Computing, 15(4), 708-722. Wazid, M., Das, A. K., Kumar, N., Vasilakos, A. V., & Rodrigues, J. J. P. C. (2019, April). Design and analysis of secure lightweight remote user authentication and key agreement scheme in internet of drones deployment. IEEE Internet of Things Journal, 6(2), 3572-3584. doi: 10.1109/JIOT.2018.2888821 Wazid, M., Das, A. K., Odelu, V., Kumar, N., Conti, M., & Jo, M. (2018, Feb). Design of secure user authenticated key management protocol for generic iot networks. IEEE Internet of Things Journal, 5(1), 269-282. doi: 10.1109/JIOT .2017.2780232 Wazid, M., Das, A. K., Odelu, V., Kumar, N., & Susilo, W. (2017). Secure remote user authenticated key establishment protocol for smart home environ- ment. IEEE Transactions on Dependable and Secure Computing. Wu, F., Li, X., Xu, L., Vijayakumar, P., & Kumar, N. (2020). A novel three-factor authentication protocol for wireless sensor networks with iot notion. IEEE Sys- tems Journal, 1-10. PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 228 Bibliography Wu, F., Xu, L., Kumari, S., Li, X., Shen, J., Choo, K.-K. R., ... Das, A. K. (2017). An ef cient authentication and key agreement scheme for multi-gateway wire- less sensor networks in iot deployment. Journal of Network and Computer Applications, 89, 72 - 85. Retrieved from http://www.sciencedirect.com/ science/article/pii/S1084804516303150 (Emerging Services for Inter- net of Things (IoT)) doi: https://doi.org/10.1016/j.jnca.2016.12.008 Xu, L. D., He, W., & Li, S. (2014, Nov). Internet of things in industries: A survey. IEEE Transactions on Industrial Informatics, 10(4), 2233-2243. doi: 10.1109/TII.2014.2300753 Xu, X., Zhu, P., Wen, Q., Jin, Z., Zhang, H., & He, L. (2013, Nov 21). A secure and ef cient authentication and key agreement scheme based on ecc for tele- care medicine information systems. Journal of Medical Systems, 38(1), 9994. Retrieved from https://doi.org/10.1007/s10916-013-9994-8 doi: 10 .1007/s10916-013-9994-8 Zhang, L., & Zhu, S. (2015, Mar 03). Robust ecc-based authenticated key agreement scheme with privacy protection for telecare medicine information systems. Journal of Medical Systems, 39(5), 49. Retrieved from https:// doi.org/10.1007/s10916-015-0233-3 doi: 10.1007/s10916-015-0233-3 Zhou, Y., Liu, T., Tang, F., Wang, F., & Tinashe, M. (2019). A privacy-preserving authentication and key agreement scheme with deniability for iot. Electronics, 8(4). Retrieved from https://www.mdpi.com/2079-9292/8/4/450 doi: 10.3390/electronics8040450 PDEU Investigating Approaches for Improving Security in Remote User Authentication Schemes for IoT Paradigm 229