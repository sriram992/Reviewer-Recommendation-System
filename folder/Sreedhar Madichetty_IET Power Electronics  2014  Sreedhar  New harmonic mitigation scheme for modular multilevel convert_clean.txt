Published in IET Power Electronics Received on 20th January 2014 Revised on 22nd May 2014 Accepted on 5th July 2014 doi: 10.1049/iet-pel.2014.0028 ISSN 1755-4535 New harmonic mitigation scheme for modular multilevel converter an experimental approach Madichetty Sreedhar1,3, Abhijit Dasgupta2, Sambeet Mishra2 1Department Electrical Engineering, KIIT University, Bhubaneswar 751024, India 2School of Electrical Engineering, KIIT University, Bhubaneswar 751024, India 3Department of EEE, GMR Institute of Technology, Rajam, A.P., India E-mail: sreedhar.803@gmail.com Abstract: The multilevel converter has been brought into limelight in this study; however, particular attention has been provided to the form and function of modular multilevel converter (MMC) with new controller to mitigate the circulating currents and harmonics present in the system. Till date, research in this eld is very limited with circulating currents and harmonics as the major problem. The stability analysis of proposed controller has been derived and analysed with its experimental results. The system is examined before and after application of controller and results is analysed. This article effectively addresses the problem with prototype of 1 KVA implementation and attempts to make a detailed analysis with their functions in comprehensive manner with HVDC application under different conditions. Also, the applicability of zero voltage switching at turn on, zero current transition at turn off has been veri ed experimentally. Computer simulations and experiment on a 50 Hz power supply show that the new controller is effective and easy to implement for modular multilevel inverters. 1 Introduction Many investigations in the eld of modular multilevel converters (MMCs) have led to successful operation in high-voltage DC (HVDC) systems. In recent times, in the power transmission era, very-long distances HVDC transmission lines-based current source converters (CSC) and voltage-source converters (VSC) offered more economic and cost-effective power transmission. However, recently HVDC transmission systems based on VSC s have received increasing attention owing to many opportunities like the grid access of weak AC networks, independent control of active and reactive power, supply of passive networks and black start capability, high dynamic performance and small space requirements. In particular, the novel power converter topology for MMC has been intensively researched and developed, valuated by many features like high modularity, simple scalability, low expense of lters, robust control, simple in design and redundancy. This converter is composed by identical power cells connected in series, each one build up with standard components, enabling the connection to high-voltage poles. Although the MMC and derived topologies offer several advantages, they also introduce a more complex design of the power circuit and control goals, which have been the main reasons for the recent and ongoing research. Furthermore, medium-voltage converters are an interesting area for the application of MMCs. The important features of the multilevel converters are as follows: Voltage sharing of the devices is handled automatically by the topology. The waveform shape will lead to sinusoidal waveform because of which the total harmonic distortion (THD) is reduced and the harmonics as well. The operating voltage of the converters can be increased, instead of connecting the devices in series or in parallel, which makes the system more complex. The ever increasing demand of industry for stability, adjustability and accuracy of control of power electronic equipment at very-high voltages led to the development of relatively less THD-based modern power electronic static converters. Although solid state power electronic switches, such as the insulated-gate bipolar transistor (IGBTs) have brought noti ed variance in control techniques, but the main disadvantage is that they produce multiple frequency components called as harmonics. Harmonic voltages can cause an unacceptable disturbance on the supply network and adversely affect the operation of other connected electrical equipment. Hence, there is requirement to reduce the harmonic content to an acceptable level. One should design a converter with proper controllers by keeping THD within limits. Harmonic currents can never be totally eliminated from an electrical system. They can, however, be very signi cantly reduced by using a harmonic controllers. All power electronic converters produces complex waveforms, that can be resolved into a series of sinusoidal waves of various frequencies, hence any complex waveform is the sum of a number of odd or even harmonics, that can be eliminated by designing the proper controller by tuning to the distorted frequencies.A new transformer less four-leg topology is suggested for shunt compensation [1]. In accelerated model of MMCs in PSCAD/EMTDC [2] and www.ietdl.org 3090 & The Institution of Engineering and Technology 2014 IET Power Electron., 2014, Vol. 7, Iss. 12, pp. 3090 3100 doi: 10.1049/iet-pel.2014.0028 17554543, 2014, 12, Downloaded from https://ietresearch.onlinelibrary.wiley.com/doi/10.1049/iet-pel.2014.0028, Wiley Online Library on [19/02/2023]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License in high-power MMCs, with silicon carbide (SiC) JFETs [3], the possibility of building a MMC using SiC switches has been studied. In [4], the MMC is based on the cascaded connection of identical sub modules (SMs) enabling additional redundancies. In [5], the con guration of the MMC topology with redundant SMs is proposed and the effects of active redundancies are demonstrated. In [6], it is mentioned that the MMC has become an increasingly important topology in medium- and high-voltage applications. In [7], the various con gurations of a multilevel modular capacitor-clamped converter (MMCCC) are presented, and it also reveals many useful and new formations of the original MMCCC for transferring power in either an isolated or no isolated manner. In [8], it proposes a novel topology of a multilevel modular capacitor-clamped DC DC converter. In [9], it provides the idea of voltage balancing of the capacitors of different SMs comprising the converter. In [10], it proposes a modulation strategy for the MMC which provides the voltage balancing of the capacitors of different SMs comprising the converter. In [11] it states that HVDC transmission systems are becoming increasingly popular when compared with conventional AC transmission. HVDC VSCs can offer advantages over traditional HVDC CSC topologies, and as such, it is expected that HVDC VSCs will be further exploited with the growth of HVDC transmission. In [12], the modular multilevel cascade converter (MMCC) family based on cascade connection of multiple bidirectional chopper cells or single-phase full-bridge cells are discussed. In [13], a discussion on new AC/AC modular multilevel topology for connecting two three-phase systems is provided. The operating principle is explained, and characteristic waveforms are given. In [14], it is clearly mentioned that an onshore horizontal axis wind turbine, generator and converter are usually in the nacelle on the top of the tower, while the grid step-up transformer is placed at the bottom. Also, a new AC/AC MMC [15] (M2LC) family is expected to be introduced. The new concept stands out because of its modularity and superior control characteristics. Multilevel voltage-source converter topologies are widely used today in high-power applications such as medium-voltage drives [16]. On the other hand, studies on matrix converters (MCs) have been mainly limited to the low power range. A MMCC based on double-star bridge-cells is expected to be one of the next-generation medium-voltage pulse-width modulation converters intended for grid connections [17, 18]. In [19 21], it proposes different harmonic mitigation techniques for MMC s. In MCs, M2LC, MMCC and MMCCC, the mitigation of harmonics by using controllers is a quite complex but mitigation of harmonics in MMC is under different conditions can be easily achieved. This paper is organised in six sections. In Section 1, it introduces about the MMC and its literature survey. In Section 2, it shall be discussed about the proposed circuit and its operation. In Section 3, the controller design and its stability analysis. In Section 4, it shall discuss about the switching schemes and its implementation. In Section 5, the application of proposed technique to HVDC is discussed. In Section 6, it shall discuss about the simulation and experimental results and in the last section, the conclusion has been provided. Fig. 1 Basic circuit topology a Three phase ve level MMC b Expanded MMC for a R Phase leg www.ietdl.org IET Power Electron., 2014, Vol. 7, Iss. 12, pp. 3090 3100 doi: 10.1049/iet-pel.2014.0028 3091 & The Institution of Engineering and Technology 2014 17554543, 2014, 12, Downloaded from https://ietresearch.onlinelibrary.wiley.com/doi/10.1049/iet-pel.2014.0028, Wiley Online Library on [19/02/2023]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License 2 Proposed circuit and its operation The basic circuit topology is shown in Fig. 1a. It is a three phase ve level MMC having four SMs in upper limb and four SMs in lower limb. Each SM basic circuit is shown in dotted lines of Fig. 1a and expanded circuit shown in Fig. 1b. This circuit mainly consists of an inductor having self-inductance L1 and L2. Each module consists of main switch S1 and auxiliary switch Sx1 with their anti-parallel diodes D1 and D2, respectively. Main switch and auxiliary switch consists of a capacitor connected in parallel as Cu1. It has been considered the ve level MMC for validation. The basic switching operations have been shown in Table 1 for some operating states. The top four switches in R phase limb is considered as S1, S2, S3, S4 and the bottom four switches considered as S5, S6, S7, S8 of a single leg. Whereas the auxiliary switches are in anti-operation of main switches provided with delay, which will be explained in subsequent sections. In Table 1, it shows the switching states of a MMC. Here, switch ON condition is indicated by 1 and 0 indicates the OFF condition of a switch. It mainly consists one state of V/2 output voltage, 16 states of V/4 output voltage and 16 states of 0 voltage condition. In Table 2, it shows the basic operation of some redundancies switch state condition of upper limb of a phase. In Table 3, it shows the capacitor charging status of an upper limb of a phase. The modi ed module has been presented in Fig. 3. This circuit mainly consist of a transformer having self-inductance L1 and L2 with an assumption of the coef cient of coupling M = 1. It has main switch S1 and auxiliary switch S2 with their anti-parallel diodes D1 and D2, respectively. Main switch and auxiliary switch consists of a capacitor connected in parallel as Cu1 and Cu2 to provide soft switching operations. Whereas the auxiliary switches are in anti-operation of main switches provided with delay, which will be explained in subsequent sections. Owing to the uneven voltage distribution in the legs of a phase, circulating currents will ow through the system. It consists of current harmonics which deteriorates the system performance. Here, an attempt is made to derive the current harmonics present in circulating currents and its necessary controller to suppress the same. The instantaneous voltage across the capacitors are denoted as Vc1, Vc2, Vc3, Vc4 VcN Also, the voltage distribution across the capacitors is considered as unequal. The current owing through the R phase top limb, bottom limb, circulating current and R phase currents are represented by itr , ilr , icir and ir , respectively. In order to nd out voltage for the R phase, Kirchhoff s voltage law (KVL) is applied to Fig. 1b. Then the voltage across the R phase top limb, Vtr and resistance, Rtop, for bottom limb, Vlr and resistance, Rlow, circulating currents, icir , with supply voltage, Vdc , Vntr represents the voltage of limb n , and N represents the number of modules. Initially, it assumes that the voltage across all SM capacitors are equal and shown in (1) Vc1 = Vc2 = Vc3 = Vc4 = VcN (1) Under any switching conditions, the average voltage across the upper arm switches are shown in (2) VCu N = VDc + DVcu N (2) The total capacitor voltage of the capacitor is shown in (3) and the differential capacitor voltage is shown in the (4) VCu = Vc1 + Vc2 + Vc3 + VcN (3) DVCu = DVc1 + DVc2 + DVc3 + DVcN (4) VCL N = VDc + DVCL N (5) VCL = Vc(N+1) + Vc(N+2) + Vc2N (6) DVCL = DVc(N+1) + DVc(N+2) + DVc2N (7) The circulating currents in the arm inductors consists of both DC and AC components. These AC components are called as the harmonics, since those are rotating with the higher Table 1 Basic switching operation of a five level MMC State S1 S2 S3 S4 S5 S6 S7 S8 S1 S2 S3 S4 S5 S6 S7 S8 State +Vdc/2 1 1 1 1 0 0 0 0 0 0 0 0 1 1 1 1 +Vdc/2 +Vdc/4 1 1 1 0 1 0 0 0 0 0 0 1 0 1 1 1 + Vdc/4 1 1 1 0 0 1 0 0 0 0 0 1 1 1 0 1 1 1 1 0 0 0 0 1 0 0 0 1 1 1 1 0 0 1 1 1 1 0 0 0 1 0 0 0 0 1 1 1 0 1 1 0 0 1 1 0 0 1 0 1 0 1 1 0 0 0 1 1 0 0 0 1 1 0 1 0 1 0 0 1 1 0 1 1 0 0 0 0 1 1 1 0 1 0 0 0 1 1 1 1 0 0 1 0 0 1 1 0 1 0 1 0 0 1 Table 2 Basic switching operation of a redundance switching state in mmc State Current Switching Capacitor Capacitor 1010 ir > 0 S1 D2 S4 D3 Cs2 Cs4 1010 ir < 0 S2 D1 S3 D4 Cs4 Cs2 0110 ir > 0 S2 D1 S4 D3 Cs1 Cs4 0110 ir < 0 S2 D1 S4 D3 Cs4 Cs1 0101 ir > 0 S2 D1 S3 D4 Cs1 Cs3 0101 ir < 0 S1 D2 S4 D3 Cs3 Cs1 1001 ir > 0 S1 D2 S3 D4 Cs1 Cs3 1001 ir < 0 S2 D1 S4 D3 Cs3 Cs2 www.ietdl.org 3092 & The Institution of Engineering and Technology 2014 IET Power Electron., 2014, Vol. 7, Iss. 12, pp. 3090 3100 doi: 10.1049/iet-pel.2014.0028 17554543, 2014, 12, Downloaded from https://ietresearch.onlinelibrary.wiley.com/doi/10.1049/iet-pel.2014.0028, Wiley Online Library on [19/02/2023]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License frequencies in the system icir = idc 3 + 1 n=1 iacn   (8) icir = idc 3 + iac1 + iac2 + iac3 + iacn (9) In order to derive the circulating voltage and current, we need the output voltage of a single phase from the three phases VR = Vdc.m. sin (vot) 2 (10) IR = Io. sin (vot w) (11) m is the modulation index of a signal. Yet again, the actual voltages are shown below Vacu = N. Vdc 2 (1 m. sin (vot))(Vac + DVcu) (12) Vacl = N. Vdc 2 (1 + m. sin vot   (Vac + DVcl) (13) Therefore the total voltage is Vac = Vau + VaL (14) = Vdc 2 (1 m. sin (vot)) DVcu + Vac   + Vdc 2 (1 + m. sin vot  (Vac + DVcl)) (15) Vau + VaL = Vdc + DVcu + DVcl 2 + m. sin vot.(DVau DVcl) 2 (16) In order to derive the disturbance voltage for the upper and lower cell capacitors of a leg, that is, Vcv and VCL Vc1 = 1 C1  i1(t).dt (17) Vcu = 1 Cv  iu(t).Nu.dt (18) At this instance iu = 1 n=0 iun (19) iL = 1 n=0 iLn (20) Nu = 1 m. cos vt 2 (21) NL = 1 + m. cos vt 2 (22) Vcu = 1 Cu   1 n=0 iun. 1 m. cos vt 2 (23) VcL = 1 CL   1 n=0 iLn. 1 m. cos vt 2 (24) CU = C1 + C2 . . . .Cn (25) CL = Cn+1 + Cn+2 . . . .C2n (26) by considering the currents of the limb iau = idc + ia1 + 1 n=2 iacn (27) iau The current present in the phase a upper arm, idc DC component of the current, iac Fundamental component of the current, iac.n Harmonic component of current iaL = idc ia1 + 1 n=2 iac.n (28) iac = iacm. cos (nvt + wn) (29) [ The total current ia = iau + iaL (30) ia = idc + ia1 + 1 n=2 iac.n   + idc ia1 + 1 n=2 iac.n   (31) By considering voltage for Nth module in terms of capacitance ia = Io. sin (vt w) (32) = idc + ia1 + 1 n=2 iac.n   + idc ia1 + 1 n=2 iac.n   (33) DVCU = 1 2C .N.  (1 m. sin vot  . ia 2 + idc 3 +  1 n=1 iacn  .dt (34) DVCL = 1 2C .N.  (1 + m.sin vot  . ia 2 + idc 3 +  1 n=1 iacn  .dt (35) [ The total R phase voltage is shown in (36) Va = VaU + VaL (36) Table 3 Basic capacitor switching operation of a redundance switching state in mmc S1 S2 Vout Current Power Capacitor on off 0 iout > 0 S1 undefined on off 0 iout < 0 D1 undefined off on Vdc iout > 0 D2 charge off on Vdc iout < 0 S2 discharge www.ietdl.org IET Power Electron., 2014, Vol. 7, Iss. 12, pp. 3090 3100 doi: 10.1049/iet-pel.2014.0028 3093 & The Institution of Engineering and Technology 2014 17554543, 2014, 12, Downloaded from https://ietresearch.onlinelibrary.wiley.com/doi/10.1049/iet-pel.2014.0028, Wiley Online Library on [19/02/2023]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License By substituting (34) and (35) in (37); we shall have (see (37), (38) and (39) at the bottom of the next page) From above (40) it concludes that, the system consists of both DC and AC components. Most important issue here is the steady state of a system with controller, if applied. To maintain its fundamental and eliminate the DC and AC components, a controller is needed to be implemented in the system. The controller should be designed so as to be fully suf ce the (41) and (42)  (1 m sin vot) idc 3 + (1 m sin vot). 1 n=1 iacn = 0 (40) =. idc 3 + 1 n=1 iacn = 0 (41) From the (41) and (42), it is found that, load voltage depends upon the current iV, difference between upper and lower capacitors; icir depends only on the DC-link voltage, the sum of the arm voltages. 3 Optimal controller used to compensate the circulating currents Taking into account the (39), (40) and (41), the designed controller should eliminate both the lower order even harmonics and higher even harmonics, since all odd harmonics are absent and evident. Even though the higher-order harmonics are less in number, as the order of converter increases the effect on system can be noted. Practically the system may be designed for 400 levels or higher. To pro ciently eliminate the harmonics from the system a repetitive controller is then added to the system. A repetitive control system is a type of servomechanism for a periodic reference input. In other words, the repetitive control system follows a periodic reference input without steady-state error, even if a periodic disturbance or uncertainty exists in the plant. The optimum values of proportional and integral controller are obtained with the use of the integral square error (ISE) technique and controller shown in Fig. 2a. Balancing a system needed to have the net energy transfer to be zero. c Bandwidth of the controllerGrc Gain of the resonant controller, o Resonant frequency of the controller, Kp is the proportional gain and Ki is the integral gain of the controller. 3.1 Derivation of proposed controller The transfer function of controller shown in Fig. 2 can be written as (see (42)) The difference between the command signal and actual signal is error of the controller. The error is speci ed in (44) (see (43) at the bottom of next page) 3.2 Stability analysis To de ne the stability, the eigen values should be in the left-hand side (LHS) side of the locus. Hence, the designed controller should obey the following conditions. Fig. 2 Repetitive Controller used for MMC = Vdc + DVCU + DVCL 2 + m sin vot  .DVCU m sin vot  .DVCL 2 (37) = Vdc + 1 2C .N.   1 m. sin vot  . iaU 2 + idc 3 + 1 n=1 iacn .dt + 1 2C .N.   1 + m. sin vot  . iaL 2 + idc 3 + 1 n=1 iacn .dt (38) = m sin vot  .(1/2C).N.  (1 m. sin vot  . (iaU/2) + (idc/3) + 1 n=1 iacn  .dt 2 m sin sin (vot).(1/2C).N.  (1 + m. sin vot   . (iaL/2) + (idc/3) + 1 n=1 iacn.   dt 2 (39) Vout = Kp + (Ki/s)   + (vc.s.Grc)/(s2 + 2.vc.s + v2 0)   + ((s/vc) + 1)/(s. (s/v0) + 1  )    . 1/(Rr + s.Lr)   1 + Kp + (Ki/s)   + (vc.s.Grc)/(s2 + 2.vc.s + v2 0)   + ((s/vc) + 1)/(s. (s/v0) + 1  )    . 1/(Rr + s.Lr)     Vout(cmd) 1/(Rr + s.Lr)   .Vdisturbance 1 + Kp + (Ki/s)   + (vc.s.Grc)/(s2 + 2.vc.s + v2 0)   + ((s/vc) + 1)/ s. (s/v0) + 1         . 1/(Rr + s.Lr)     (42) www.ietdl.org 3094 & The Institution of Engineering and Technology 2014 IET Power Electron., 2014, Vol. 7, Iss. 12, pp. 3090 3100 doi: 10.1049/iet-pel.2014.0028 17554543, 2014, 12, Downloaded from https://ietresearch.onlinelibrary.wiley.com/doi/10.1049/iet-pel.2014.0028, Wiley Online Library on [19/02/2023]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License 1. The poles and zeros of polynomial should be within the LHS of the locus. 2. The zeros of polynomial, which is shown in (44) should be in LHS side. From [17], the stability condition has been designed as follows. The characteristic polynomial equation for which the system should be in stable condition as shown in (45) (see (44)) The pole and zero plot for the characteristic equation is shown in Fig. 3c, in which all poles and zero s are lying in LHS side, so it can concludes that the proposed controller is completely stable. The stability of controller has been checked by further providing different inputs such as impulse. By providing the impulse input, which is assumed as sudden change in load for practical condition; the response is shown in Fig. 3b, in which it has been checked with lower and higher order. From this, it is evident that controller reaches steady state for impulse conditions. Hence, it can conclude that the proposed controller is stable for worst conditions as well. The proposed controller stability further analysed with different conditions by plotting the magnitude and phase response as shown in Fig. 3a. Primarily, the system is analysed with proportional controller without optimum gain and then with optimum gain. System with optimum gain shows better response compared without optimum gain. But, it s consisting of steady state error. In order to reduce Fig. 3 Stability analysis a Repetitive Controller used for MMC showing magnitude and phase responses b Repetitive Controller used for MMC showing impulse responses. (X-axis-samples and Y-axis-amplitude) c Repetitive Controller used for MMC showing pole/zero responses. (X-axis-real part and Y-axis-imaginary part) Vout cmd ( ) Vout = Vout(cmd) + 1/(Rr + s.Lr)  .Vdisturbance 1 + Kp + (Ki/s)   + (vc.s.Grc)/(s2 + 2.vc.s + v2 0)   + ((s/vc) + 1)/ s. (s/v0) + 1        . 1/(Rr + s.Lr)     (43) T(s) = 1 + Kp + Ki s . 1 Rr + s.Lr (vc.s.Grc)/(s2 + 2.vc.s + v2 0)   + ((s/vc) + 1)/ s. (s/v0) + 1       1 + Kp + (Ki/s)   1/(Rr + s.Lr)   1 Rr + s.Lr (44) www.ietdl.org IET Power Electron., 2014, Vol. 7, Iss. 12, pp. 3090 3100 doi: 10.1049/iet-pel.2014.0028 3095 & The Institution of Engineering and Technology 2014 17554543, 2014, 12, Downloaded from https://ietresearch.onlinelibrary.wiley.com/doi/10.1049/iet-pel.2014.0028, Wiley Online Library on [19/02/2023]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License the system steady-state error, it has been implemented an inner integral controller by which it ensures the steady-state error. However, comparatively, system with optimum gain is giving better results. However, the proportional and integral controllers has not been effective for all frequencies and may system became unstable, hence to maintain stability it introduced an inner second order resonant controller which ensures the system stability as shown in Fig. 3a at all frequencies. The optimum values for the controller was obtained by the ISE technique with circulating currents as an objective function as shown in (42). 4 ZVCTS-based switching scheme in MMC by using proposed scheme A new switching losses mitigated SM scheme is proposed for MMC is shown in Fig. 4. The active snubber circuit, proposed, is discussed in the aspects of design and validation for a ve level MMC. Furthermore, it provides a zero voltage transition (ZVT) at turn-on and zero current transition (ZCT) at turn-off for switch S1 . Again zero current switching at turn ON for a auxiliary switch S2 and ZCT at turn-off will be achieved. 4.1 Assumptions (i) If IS2(current passing through the switch S2) increases, resonance will occur in between L1 Cu1 L2. If S2 conducts, then, resonance will occur in between L2 Cu2 L1 and will achieve ZCS. (ii) A resonance will occur in between Cu1-L1-L2-Cu2 then the condition of ZVS will be achieved. (iii) If S2 is in conducting state, it leads to a conduction of a resonant current between L1-L2-Cu1, Where ZVT kept turned on for S1. 4.2 ZVT turn ON and ZCT turn OFF for S1 1. First, turn ON the Switch S2 , then the capacitor Cu1 discharges its energy because of which the capacitor Cu2 Fig. 4 Modi ed SM used in MMC under ZVCTS conditions Fig. 5 ZVT and ZCT a ZVT turn on and ZCT turn off condition for switch S1 b ZCS turn ON and ZCT turn OFF condition for S2 Table 4 Design of inductor and capacitor under ZVCTS condition Design of capacitor Design of inductor Cu1 and Cu2 should be selected based on the value of L1 and L2 taking in to account the resonance condition. the value of L2 can be selected in such a way that (Vout/LS2).trS2 Imaxin the value of LS1 can be selected in such a way that LS1 = 2*L2 www.ietdl.org 3096 & The Institution of Engineering and Technology 2014 IET Power Electron., 2014, Vol. 7, Iss. 12, pp. 3090 3100 doi: 10.1049/iet-pel.2014.0028 17554543, 2014, 12, Downloaded from https://ietresearch.onlinelibrary.wiley.com/doi/10.1049/iet-pel.2014.0028, Wiley Online Library on [19/02/2023]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License and L2 will get charged. Owing to coupling effect, the primary winding will also get transferred and instantly energy will concentrate on L1-Cu1-L2 which leads to response. This is the ideal time to switch on S1 . This signal can be applied as along as the Cu1 completely discharges. Thus emerges the ZVT. 2. Although the switch S1 conducts the current, the signal is applied to the switch S2 for creating a resonance current higher than that of an input current. At this time, current is always zero. Therefore S1 can be cancelled and ZCT can be possible for the same time, as shown in Fig. 5a. 4.3 ZCS turn ON and ZCT turn OFF for S2 1. When the switch S1 gets suddenly switched OFF, the resonance conduction will take place. Resulting in the application of ZCS. 2. Although turning OFF, S2 current should reach to zero with a resonance. Hence, ZCT can be provided here and shown in Fig. 5b. The values of capacitor and inductor have been selected as per Table 4. Fig. 6 HVDC line with the power capacity of 2000 MVA, 530 KV, 50 Hz a HVDC Block diagram b System veri cation by applying different faults at different time c System veri cation by different faults for change in modulation index www.ietdl.org IET Power Electron., 2014, Vol. 7, Iss. 12, pp. 3090 3100 doi: 10.1049/iet-pel.2014.0028 3097 & The Institution of Engineering and Technology 2014 17554543, 2014, 12, Downloaded from https://ietresearch.onlinelibrary.wiley.com/doi/10.1049/iet-pel.2014.0028, Wiley Online Library on [19/02/2023]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License Table 6 Parameters used for five level MMC simulation and experiment MMC Level Five DC Voltage Vdc = 200 V Dc circulating current reference Icref = 0 arm inductors L1 = L2 = L = 3 mH switching frequency Sf = 100 Hz capacitor value C = 16 F/400 V bandwidth of the controller c = 2000 load parameters Lr = 10 mH/Rr = 30 gain of resonant controller Grc = 1250 resonant frequency of controller 0 = 2000 Table 5 Optimum gain for proportional and integral controller Five level MMC Optimum integral controller gain of Ki* Optimum proportional controller gain Kp* 1% step load for m = 1 1.4 3.6 10% step load 2.4 1.8 Fig. 7 Experimental setup a Experimental setup for ve level MMC b Circulating current control for upper and lower arms c Response of a proposed controller for bounded input d Output voltage FFT analysis of MMC before application of controller e FFT analysis in time domain after application of controller f Output voltage and its FFT analysis in frequency domain after application of controller www.ietdl.org 3098 & The Institution of Engineering and Technology 2014 IET Power Electron., 2014, Vol. 7, Iss. 12, pp. 3090 3100 doi: 10.1049/iet-pel.2014.0028 17554543, 2014, 12, Downloaded from https://ietresearch.onlinelibrary.wiley.com/doi/10.1049/iet-pel.2014.0028, Wiley Online Library on [19/02/2023]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License 5 Application of proposed scheme The proposed scheme is developed and applied to HVDC transmission system with consideration of fault conditions. For this case, a HVDC line having parameters as 100 Km length, HVDC line with the power capacity of 2000 MVA, 530 KV, 50 Hz is considered as shown in Fig. 6a. The system is investigated for different conditions as explained below: The HVDC system is connected to grid with experimental veri cation of MMC. A virtual fault condition is created at three different conditions as LLL, LLG and LG faults and investigation results are as follows. The AC voltage step 10% is applied at t = 0.2 s during 0.14 s. The above results clari es that the active and reactive power deviation from the pre-disturbance is less than 0.09 and 0.2 pu, respectively. The recovery time is less than 0.3 s and the steady state is reached before next perturbation initiation. The LLL fault is applied at t = 1.5 s during 0.9 s. Consequently results in the active and reactive power deviation from the reference. During the three-phase fault, the transmitted DC power is almost halted and the DC voltage tends to increase (1.2 pu) since the DC side capacitance is being excessively charged. The proposed controller in the active power control at AC attempts to limit the DC voltage within a xed range. The system recovers well after the fault, within 0.5 s damped oscillations are negligible in the reactive power. The systems with different conditions are shown in Figs. 6b and c which are self-explanatory. At different loading condition s, the output, capacitor voltages and inductor currents are shown in Fig. 6c, respectively, and it is evident that, system is running ideally without any signi cant losses. 6 Simulation and experimental results In order to test the proposed method for mitigating the circulating currents of the MMC, computer simulation is carried out rst and then veri ed experimentally as well. The system has been tested with the parameters listed in Tables 5 and 6. The experimental setup has been shown in Fig. 7a. It has been developed a model, with proposed controller which is suitable for wide range of load with different modulation index. Firstly, System has been investigated before and after application of controller. Before application of controller, the system consist of even and odd harmonics with THD of 34.2% as shown in Fig. 7d. Although after application of controller, THD has been reduced to 1.2% which is far better than the speci ed in standard s by maintaining all even and odd harmonics are completely absent as shown in Fig. 7e. From this, it is evident that system with controller is giving better harmonic mitigation for wide range of frequencies. The output voltage and its FFT (Fast Fourier Transform) analysis in time domain and frequency domain have shown in Figs. 7e and f, respectively. From Fig. 7d it shows that all lower order harmonics and even harmonics are present by maintaining its fundamental harmonic component. Since, it is one of the important factors to access the controller performance. In order to test the stability of controller experimentally, it has been given a sudden step load of 10% of actual load and limits of controller observed are in bounded region as shown in Fig. 7c. Further, the upper and lower arm currents are stabilised perfectly as shown in Fig. 7b and hence circulating currents are absent in the system because of which losses are reduced. The root mean square (RMS) values of phase to neutral current are 31.4 A with controller and 29.2A without controller. From those values it is clear that, output current is also distorted because of circulating currents. Please note that, each division is taken as 5 ms. From the Figs. 8a and b, it is clear that, ZVCTS operation is veri ed. Owing to which, the losses in the system is drastically decreased and ef ciency has been increased by 14% compared with system without controller. The system is exposed to sudden change in the load of 10% from its actual value at t = 0.032 s, because of which a sudden dip in the capacitor voltage happens at t = 0.033 s. Suddenly, controller sensed the module voltage and send it s signal to the distorted module and make it s uniform within 0.02 s. Then the controller reaches its steady state in 0.007 s. At time t = 20 ns, the load on the system is suddenly increased by 1%, Then controller receives the signal and reciprocates appropriate signal to module, nally settled at t = 2 ns. Then at time t = 60 ns, The load on the system is suddenly increased by 10%, then the controller responded quickly and settled with in time t = 10 ns. After which, the Fig. 8 ZVCTS operation a ZCS turn ON and ZCT turn OFF condition for S2 b ZVT turn on and ZCT turn off condition for switch S1 www.ietdl.org IET Power Electron., 2014, Vol. 7, Iss. 12, pp. 3090 3100 doi: 10.1049/iet-pel.2014.0028 3099 & The Institution of Engineering and Technology 2014 17554543, 2014, 12, Downloaded from https://ietresearch.onlinelibrary.wiley.com/doi/10.1049/iet-pel.2014.0028, Wiley Online Library on [19/02/2023]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License load on the system is then increased suddenly by 30% and it is settled in t = 12 ns. From which it is concluded that, as load increases, the controller takes the little time to settle down. All the cases have been shown in Fig. 7c. As modulation index changes, accordingly controller response has been observed. From the above analysis, it concludes that, controller can be used for various loads and various modulation indexes. From Fig. 7b, it is clear that upper and lower limb current currents are equal and opposite to each other. The circulating currents are completely eliminated, there by the losses in the system has been decreased drastically and ef ciency has been increased. The above obtained results are compared with [4], and shown better than those proposed technique. 7 Conclusion This paper proposed a closed-loop control method for mitigating circulating currents with ZVT and ZCT obtained by a new snubber circuit applied to the MMC. In this article, a new controller scheme has been proposed to mitigate the lower and higher-order harmonics of the system. The stability analysis of proposed controller has been derived and analysed with its experimental results. This scheme shows its effectiveness by theoretical calculations, veri ed by simulation and experimental results. This article effectively addresses the problem with prototype of 1 KVA implementation and attempts to make a detailed analysis with their functions in comprehensive manner with HVDC application under different conditions. This method is simple in design and can substantially eliminate the RMS value of the circulating current compared with the existing methods in literature, while the voltages of the SM capacitors are kept well balanced. This method is very helpful for reducing power losses of the MMC in real HVDC applications and also veri ed by experimental results. The proposed system can be applied to wide range of loads with various modulation indexes. The steady-state analysis and harmonics can substantially reduce by the proposed method. Both simulation and experimental results have shown the validity and effectiveness of the proposed method. 8 References 1 Mohammadi, H.P., Bina, M.T.: A transformerless medium-voltage STATCOM topology based on extended modular multilevel converters , IEEE Trans. Power Electron., 2011, 26, (5), pp. 1534 1545 2 Xu, J., Zhao, C., Liu, W., Guo, C.: Accelerated model of modular multilevel converters in PSCAD/EMTDC , IEEE Trans. Power Deliv., 2013, 28, (1), pp. 129 136 3 Peftitsis, D., Tolstoy, G., Antonopoulos, A.: High-power modular multilevel converters with SiC JFETs , IEEE Trans. Power Electron., 2012, 27, (1), pp. 28 36 4 Konstantinou, G., Pou, J., Ceballos, S., Agelidis, V.G.: Active redundant submodule con guration in modular multilevel converters , IEEE Trans. Power Deliv., 2013, 28, (4), pp. 2333 2341 5 Ferreira, J.A.: The multilevel modular DC converter , IEEE Trans. Power Electron., 2013, 28, (10), pp. 4460 4465 6 Khan, F.H., Tolbert, L.M.: Hybrid electric vehicle power management solutions based on isolated and nonisolated con gurations of multilevel modular capacitor-clamped converter , IEEE Trans. Ind. Electron., 2009, 56, (8), pp. 3079 3095 7 Khan, F.H., Tolbert, L.M.: A multilevel modular capacitor-clamped DC DC converter , IEEE Trans. Ind. Appl., 2007, 43, (6), pp. 1628 1638 8 Solas, E., Abad, G., Barrena, J.A.: Modular multilevel converter with different submodule concepts Part II: experimental validation and comparison for HVDC application , IEEE Trans. Ind. Electron., 2013, 60, (10), pp. 4536 4545 9 Barrena, J.A., Aurtenetxea: Modular multilevel converter with different submodule concepts part I: capacitor voltage balancing method , IEEE Trans. Ind. Electron., 2013, 60, (10), pp. 4525 4535 10 Feldman, R., Tomasini, M.: A hybrid modular multilevel voltage source converter for HVDC power transmission , IEEE Trans. Ind. Appl., 2013, 49, (4), pp. 1577 1588 11 Akagi, H.: Classi cation, terminology, and application of the modular multilevel cascade converter (MMCC) , IEEE Trans. Power Electron., 2011, 26, (11), pp. 3119 3130 12 Baruschka, L., Mertens, A.: A new three-phase AC/AC modular multilevel converter with six branches in hexagonal con guration , IEEE Trans. Ind. Appl., 2013, 49, (3), pp. 1400 1410 13 Ng, C.H., Parker, M.A.: A multilevel modular converter for a large, light weight wind turbine generator , IEEE Trans. Power Electron., 2008, 23, (3), pp. 1062 1074 14 Glinka, M., Marquardt, R.: A new AC/AC multilevel converter family , IEEE Trans. Ind. Electron., 2005, 52, (3), pp. 662 669 15 Zhang, Y., Tang, Y.: Superconducting magnet based VSC suitable for interface of renewable power sources , IEEE Trans. Appl. Supercond., 2010, 20, (3), pp. 880 883 16 Wang, J., Wu, B.: Multimodular matrix converters with sinusoidal input and output waveforms , IEEE Trans. Ind. Electron., 2012, 59, (1), pp. 17 26 17 Hagiwara, M., Akagi, H.: Experimental veri cation of a modular multilevel cascade converter based on double-star bridge-cells (MMCI-DSBC) , IEEE Trans. Ind. Appl., 50, (1), pp. 509 519 18 Alishah, R.S., Nazarpour, D.: New hybrid structure for multilevel inverter with fewer number of components for high-voltage levels , IET Power Electron., 2014, 7, (1), pp. 96 104 19 Konstantinou, G., Ciobotaru, M., Agelidis, V.: Selective harmonic elimination pulse-width modulation of modular multilevel converters , IET Power Electron., 2013, 6, (1), pp. 96 107 20 Zhang, Y., Adam, G.P., Lim, T.C., Finney, S.J., Williams, B.W.: Analysis of modular multilevel converter capacitor voltage balancing based on phase voltage redundant states , IET Power Electron., 2012, 5, (6), pp. 726 738 21 Moeini, A., Iman-Eini, H.: Selective harmonic mitigation-pulse-width modulation technique with variable DC-link voltages in single and three-phase cascaded H-bridge inverters , IET Power Electron., 2014, 7, (4), pp. 924 932 www.ietdl.org 3100 & The Institution of Engineering and Technology 2014 IET Power Electron., 2014, Vol. 7, Iss. 12, pp. 3090 3100 doi: 10.1049/iet-pel.2014.0028 17554543, 2014, 12, Downloaded from https://ietresearch.onlinelibrary.wiley.com/doi/10.1049/iet-pel.2014.0028, Wiley Online Library on [19/02/2023]. See the Terms and Conditions (https://onlinelibrary.wiley.com/terms-and-conditions) on Wiley Online Library for rules of use; OA articles are governed by the applicable Creative Commons License