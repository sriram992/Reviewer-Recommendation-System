Granular computing, rough entropy and object extraction Sankar K. Pal a,1, B. Uma Shankar a,*, Pabitra Mitra b a Machine Intelligence Unit, Indian Statistical Institute, Calcutta 700 108, India b Department of Computer Science and Engineering, Indian Institute of Technology, Kanpur 208 016, India Received 4 August 2004 Available online 28 July 2005 Communicated by W. Pedrycz Abstract The problem of image object extraction in the framework of rough sets and granular computing is addressed. A mea- sure called rough entropy of image is de ned based on the concept of image granules. Its maximization results in minimization of roughness in both object and background regions; thereby determining the threshold of partitioning. Methods of selecting the appropriate granule size and e cient computation of rough entropy are described.  2005 Elsevier B.V. All rights reserved. Keywords: Rough sets; Entropy; Image segmentation; Set approximation; Granules 1. Introduction It has been argued, both from philosophical and theoretical points of views, that information granulation is essential to human problem solving, and hence has very signi cant impact on the design and implementation of intelligent system. Zadeh (1997) identi ed three basic concepts that underlie the process of human cognition, namely, granula- tion, organization, and causation. Granulation involves decomposition of whole into parts, orga- nization involves integration of parts into whole, and causation involves association of causes and e ects . A granule is a clump of objects (points), in the universe of discourse, drawn together by indistinguishability, similarity, proximity, or func- tionality. Granulation leads to information com- pression/summarization. In situations involving incomplete, uncertain, or vague information, it may be di cult to di erentiate di erent elements 0167-8655/$ - see front matter  2005 Elsevier B.V. All rights reserved. doi:10.1016/j.patrec.2005.05.007 * Corresponding author. Tel.: +91 33 25753107; fax: +91 33 25783357. E-mail addresses: sankar@isical.ac.in (S.K. Pal), uma@ isical.ac.in (B. Uma Shankar), pmitra@iitk.ac.in (P. Mitra). 1 Currently with the US Naval Research Laboratory, Wash- ington, DC, USA. Pattern Recognition Letters 26 (2005) 2509 2517 www.elsevier.com/locate/patrec and instead it is convenient to consider granules, i.e., clump or group of indiscernible elements, for performing operations. Granular computing (GrC) may be regarded as a uni ed framework for theories, methodologies and techniques that make use of such granules in the process of prob- lem solving. Recently, rough set theory (Pawlak, 1991) has become a popular mathematical framework for granular computing. The focus of rough set theory is on the ambiguity caused by limited discernibility of objects in the domain of discourse. Its key con- cepts are those of object indiscernibility and set approximation. The primary use of rough set theory has so far mainly been in generating logical rules for classi cation and prediction (Skowron and Rauszer, 1992) using information granules; thereby making it a prospective tool for pattern recognition, image processing, feature selection, data mining and knowledge discovery process from large data sets. Use of rough set rules based on reducts has signi cant role for dimensionality reduction/feature selection by discarding redun- dant features; thereby having potential application for mining large data sets (Komorouski et al., 1999). As far as rough set theoretic image process- ing is concerned, there is hardly any investigation reported so far. However, in related areas like pat- tern analysis/clustering mention may be made of the studies of Wojcik (1987), and Pal and Mitra (2002). While rough sets are used in (Wojcik, 1987) for describing image features for analysis, they are used in a part in (Pal and Mitra, 2002) for initializing EM algorithm in conjunction with minimal spanning tree (MST) for clustering with application to multi spectral images. In the present article we demonstrate an appli- cation of rough sets and granular computing for object extraction (Gonzalez and Woods, 2002) from gray scale image. In gray scale images bound- aries between object regions are often ill-de ned. This uncertainty can be handled by describing the di erent objects as rough sets with upper (outer) and lower (inner) approximations. The set approximation capability of rough sets is exploited in the present investigation to formulate an entropy measure, called rough entropy, quantifying the uncertainty in an object-background image. This has been done by de ning an image as a collection of pixels and the equivalence relation induced par- tition as pixels lying within each non-overlapping window over the image. With this de nition the roughness of various transforms (or partitions) of the image can be computed using image granules, i.e., windows, of di erent sizes. Maximization of the said rough entropy measure minimizes the uncertainty arising from vagueness of the boundary region of the object. Therefore, for a given granule size, the threshold for object-background classi cation can be ob- tained through its maximization with respect to di erent image partitions. A guideline for selecting the appropriate granule size from gray level distri- bution is given, as well as a way of computing the rough entropy e ciently only in one pass (or scan) of the image. E ectiveness of the method is dem- onstrated on di erent kinds of images. 2. Rough entropy measure of an image 2.1. Rough set Let A hU; Ai be an information system, and let B  A and X  U. We can approximate the set X using only the information contained in B by constructing the lower and upper approxima- tions of X. If X  U, the sets {x 2 U:[x]B  X} and {x 2 U:[x]B \ X 5 ;}, where [x]B denotes the equivalence class of the object x 2 U relative to IB (the equivalence relation), are called the B- lower and B-upper approximations of X in U. They are denoted by BX and BX, respectively. The ob- jects in BX can be certainly classi ed as members of X on the basis of knowledge in B, while objects in BX can only be classi ed as possible members of X on the basis of B. These are illustrated in Fig. 1 where the sets of dark-gray granules represent lower approximation, while those of both dark- gray and light-gray granules together denote upper approximation. Therefore, a rough set is nothing but a crisp set with rough representation. The roughness of a set X with respect to B can be characterized numerically (Pawlak, 1991) as Ra 1  jBXj jBXj. This means if roughness of the set X is 0 then X is crisp with respect to B, and if 2510 S.K. Pal et al. / Pattern Recognition Letters 26 (2005) 2509 2517 Ra > 0 then X is rough (i.e., X is vague with respect to B). For details one may refer to Pawlak (1991), Skowron and Rauszer (1992) and Komorouski et al. (1999). 2.2. Image as a rough set In gray scale images boundaries between object regions are often ill de ned because of grayness and/or spatial ambiguities (Pal, 2001). This uncer- tainty can be handled by describing the di erent objects as rough sets with upper (or outer) and lower (or inner) approximations. Here the con- cepts of upper and lower approximation can be viewed, respectively, as outer and inner approxi- mations of an image region in terms of granules. Let the universe U be an image consisting of a collection of pixels. Then if we partition U into a collection of non-overlapping windows (of size m n, say), each window can be considered as a granule G. In other words, the induced equivalence classes Im n have m n pixels in each non-over- lapping window. Given this granulation, object re- gions in the image can be approximated by rough sets. Let us consider an object-background separa- tion (a two class) problem of an M N, L level image. Let prop(B) and prop(O) represent two properties (say, gray level intervals 0,1,. . .,T and T + 1,T + 2,. . .,L  1) that characterize back- ground and object regions, respectively. Given this framework, object and background can be viewed as two sets with their rough representation as follows: The inner approximation of the object (OT): OT [ i GijP j > T; 8j 1; . . . ; mn; and ( P j is a pixel belonging to Gi ) . Outer approximation of the object (OT): OT [ i Gi; 9j; j 1; . . . ; mn s.t. P j > T; ( where P j is a pixel in Gi ) . Inner approximation of the background (BT): BT [ i GijP j 6 T; 8j 1; . . . ; mn; and ( P j is a pixel belonging to Gi ) . Outer approximation of the background (BT): BT [ i Gi; 9j; j 1; . . . ; mn s.t. P j 6 T ; ( where P j is a pixel in Gi ) . Therefore, the rough set representation of the image (i.e., object OT and background BT) for a given Im n depends on the value of T. Let the roughness of object OT and background BT be de ned as ROT 1  jOTj jOTj jOTj  jOTj jOTj ; RBT 1  jBTj jBTj jBTj  jBTj jBTj ; 1 where jOTj and jOTj are the cardinality of the sets OT and OT, and jBTj and jBTj are the cardinality of the sets BT and BT, respectively. 2.3. Rough entropy measure Rough entropy (RE) of an image can be de ned as RET  e 2 ROT loge ROT RBT loge RBT . 2 Fig. 1. Rough representation of a set with upper and lower approximations. S.K. Pal et al. / Pattern Recognition Letters 26 (2005) 2509 2517 2511 Its plot for various values of ROT and RBT is shown in Fig. 2. (1) The value of RET lies between 0 and 1. (2) RET has a maximum value of unity when ROT RBT 1=e, and minimum value of zero when ROT ; RBT 2 {0,1}. (3a) Since the boundary pixels are common for both object and background, we have OT  OT BT  BT QT, say. Therefore, ROT RBT ; iff jOTj jBTj. Under this condition, the distribution of RET on the diagonal (joining (0,0) and (1,1)) is shown in Fig. 3, where RET attains a maximum value of unity at ROT RBT 1=e. (3b) When jOTj < jBTj, then ROT > RBT and jOTj > jBTj, then ROT < RBT . In either case, RET will decrease from its maximum value of unity and will reach a value of zero at (0,0), (0,1), (1,0) and (1,1) in the (ROT ; RBT ) plane (Fig. 2). 3. Object extraction minimizing roughness Let us describe a method of object enhance- ment/extraction based on the principle of minimiz- ing the roughness of both object and background regions, i.e., maximizing RET. As explained in Sec- tion 2.2, one can compute for every T the RET of the image, representing the background and object regions (0,. . .,T) and (T + 1,. . .,L  1), respec- tively, and select the one for which RET is maxi- mum. In other words, select T  arg max T RET; as the optimum threshold to provide the object- background segmentation. Note that maximizing the rough entropy to get the required threshold basically implies minimizing both the object rough- ness and background roughness. 3.1. Choice of granule size As can be seen, the determination of T* by maximization of rough entropy or minimization of roughness depends on the granule size. A choice of granule size can be made from gray level distri- bution of the image by selecting a value approxi- mately equal to the minimum of half the width of base regions corresponding to all the peaks in the histogram. This will allow the algorithm to take into account the local information (details) of all the regions, as indicated by di erent peaks in the histogram, and facilitate the detection of the smallest region. Any granule larger (or smaller) than this may result in losing some desirable re- gions (or detection of spurious undesirable re- gions) by the decrease (or increase) in the value Fig. 2. Plot of rough entropy for various values of roughness of the object and background. 0 0.2 0.4 0.6 0.8 1 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 ROT = RBT Entropy RET 1/e Fig. 3. Plot of rough entropy for the values (0,0) to (1,1) on the diagonal of Fig. 2 (i.e., when ROT RBT ). 2512 S.K. Pal et al. / Pattern Recognition Letters 26 (2005) 2509 2517 of T*, assuming that the regions of interest corre- spond to lower side of the histogram. The details of the selection procedure are shown in Section 4 with histograms of di erent images. 3.2. Algorithm for threshold selection Following is the algorithm for e cient imple- mentation of the aforesaid methodology for select- ing T*. Let max_gray and min_gray be the maximum and minimum gray level values of the image, respectively. Let granulei represent a window of m n pixels. Let total number of granules be total_no_granule. Initialize: Four integer arrays namely object_ lower, object_upper, background_lower, back- ground_upper each of size (max gray  min gray 1) to zero. Step 1: for i = 1 to total_no_granule max_granulei = maximum gray value of pixels in granulei min_granulei = minimum gray value of pixels in granulei (a) for max_granulei 6 j 6 max_gray object_lower(j) = object_lower(j) + 1 (b) for min_granulei 6 j 6 max_gray object_ upper(j) = object_upper(j) + 1 (c) for min_gray 6 j 6 min_granulei background_lower(j) = background_ lower(j) + 1 (d) for min_gray 6 j 6 max_granulei background_upper(j) = background_ upper(j) + 1 Step 2: for l = min_gray to max_gray object_roughness(l) = 1  [object_lower(l)/ object_upper(l)] background_roughness(l) = 1  [background_lower(l)/ background_upper(l)] Rough entropy l  e 2  object roughness l loge(object_roughness(l)) + background_roughness(l) loge(background_roughness(l))] Step 3: Threshold optimal arg max l [rough_entropy(l)]. Remark. Given the max_gray and min_gray val- ues, the computation of rough entropy (and hence the algorithm) requires only a single scan of pixels in the image, since max_granulei and min_granulei are computed exactly once for each i. Therefore the computational complexity of the algorithm is same as that of histogram computation. 4. Experimental results The e ectiveness of the methodology for object extraction based on rough entropy (Eq. (2)) is demonstrated on three di erent types of images. These are: (i) a text image (TEXT), (ii) a blocks image (BLOCKS), and (iii) a remote sensing image (CALCUTTA). The details of the images are as follows: The TEXT image (Fig. 7(a)) is of 1003 2249 pixels and scanned from a news letter of IAPR. The BLOCKS image (Fig. 8(a)) is taken with a CCD camera when the blocks of di erent shapes are placed on table and imaged. The size of the image is 512 512 pixels. The CALCUTTA image is an IRS-1A image, which was taken using the scanner LISS-II (Linear Imaging Self Scanner) in the range of wavelength 0.77 0.86 lm and it has a spatial resolution of 36.25 m 36.25 m. The image is covering an area around the city of Cal- cutta (Fig. 9(a)). The image is of size 512 512. Due to poor illumination, the actual object classes 0 50 100 150 200 250 0 0.01 0.02 0.03 0.04 0.05 0.06 0.07 Gray level Relative Frequency Fig. 4. Histogram of the TEXT image, minimum estimated base width is 30 between gray levels 105 and 135. S.K. Pal et al. / Pattern Recognition Letters 26 (2005) 2509 2517 2513 present in the input image are not visible clearly; therefore an enhanced version of the input image highlighting the di erent object regions are shown in Fig. 9(a) for convenience. At rst we discuss about the selection of the granule size (window size) for the computation of rough entropy on these images. The histograms (Figs. 7 9) of all these images are bimodal. For the TEXT image (Fig. 4) the base width of each region is approximately 30 levels. Therefore, as mentioned in Section 3, we take the granule size as 15 15 (half of the smaller base width). Similarly for the BLOCKS image (Fig. 5) the widths of the regions at the base are 100 and 68 approximately. Therefore, a granule for this image can be of size 34 34. For the CALCUTTA image 0 50 100 150 200 250 0 0.002 0.004 0.006 0.008 0.01 0.012 0.014 0.016 0.018 0.02 Gray level Relative Frequency Fig. 5. Histogram of the BLOCKS image, minimum estimated base width is 68 between gray levels 150 and 218. 0 10 20 30 40 50 60 70 80 0 0.01 0.02 0.03 0.04 0.05 0.06 0.07 0.08 Gray level Relative Frequency Fig. 6. Histogram of the CALCUTTA image, minimum estimated base width is 8 between 16 and 24 gray level. Fig. 7. Thresholds by maximizing rough entropy using granule of di erent sizes on TEXT image: (a) original, (b) threshold = 169, granule size = 15 15, (c) threshold = 171, granule size = 10 10, (d) threshold = 168, granule size = 19 19. 2514 S.K. Pal et al. / Pattern Recognition Letters 26 (2005) 2509 2517 (Fig. 6) the widths being 8 and 30, 4 4 is a choice of the granule size. Experiments were conducted with these granu- lar sizes, as well as with other values, to demon- strate the e ectiveness of the aforesaid selection criterion. The results are as follows. The image TEXT is seen to be clearly seg- mented into text and back ground portions as shown in Fig. 7(b), with threshold value 169 which is determined with granule size of 15 15. The other two results which are obtained with window sizes 10 10 and 19 19 are shown in Fig. 7(c) and (d) corresponding to thresholds 171 and 168. As explained in Section 3.1, increase in granule size is seen to reduce the value of T*, and vice versa. Since the histogram has a wide smooth at valley between two major peak regions, the resulting threshold image does not have signi cant visual change even for a large variation of granule size from 10 10 to 19 19. For the image BLOCKS, the algorithm is able to partition the blocks as object from background, with a threshold at 99 obtained with granule size of 34 34 (Fig. 8(b)). Increase (or decrease) in granule size, as expected, decreases (or increases) the value of T* (e.g., 86 for Fig. 8(c) and 104 for Fig. 8(d) corresponding to granules of 36 36 and 29 29). Since the object regions (blocks) here correspond to upper part of the histogram, the de- crease in the T* value from 99 to 86 resulted in the detection of more spurious regions (dots). On the other hand, increase in T* value from 99 to 104 al- most on the at valley could not make signi cant change in the output image. Unlike the above two images, the image CAL- CUTTA has many more object regions. However, Fig. 8. Thresholds by maximizing rough entropy using granule of di erent sizes on BLOCKS image: (a) original, (b) threshold = 99, granule size = 34 34, (c) threshold = 86, granule size = 36 36, (d) threshold = 104, granule size = 29 29. S.K. Pal et al. / Pattern Recognition Letters 26 (2005) 2509 2517 2515 considering it as a two class (object and back- ground) problem, di erent segmented results are shown. The output shown in Fig. 9(b) corresponds to granule size of 4 4 which produced a threshold of 30. The other two outputs, Fig. 9(c) and (d), are due to threshold 33 with granule size 2 2 and threshold 26 with granule size 6 6, respectively. Like the previous two images, the T* value in- creases/decreases with decrease/increase in granule size. Here we can see that while all the three output images are able to segment the water bodies (rep- resented by the lower peak region in the histo- gram) from the rest of the objects, increase in T* value to 33 introduces more spurious (undesirable) regions (Fig. 9(d)), whereas decrease in T* value to 26 fails to detect some useful regions (e.g., airport runways, roads, canals) as object (Fig. 9(c)). This justi es the selection of 30 as the more appropriate threshold, and hence the choice of granule size 4 4. 5. Conclusions Rough entropy of an image is de ned using the concept of image granules. Based on this measure, Fig. 9. Thresholds by maximizing rough entropy using granule of di erent sizes on CALCUTTA image: (a) original, (b) threshold = 30, granule size = 4 4, (c) threshold = 26, granule size = 6 6, (d) threshold = 33, granule size = 2 2. 2516 S.K. Pal et al. / Pattern Recognition Letters 26 (2005) 2509 2517 a method of extracting object regions from an im- age is described by minimizing both object and background roughness. Here granules carry local information and re ect the inherent spatial rela- tion of the image by treating pixels of a window as indiscernible or homogeneous. Maximization of homogeneity in both object and background re- gions during their partitioning is achieved through maximization of rough entropy; thereby providing optimum results for object-background classi ca- tion. The guideline described for the choice of granule size from gray level distribution is seen to be appropriate. Extension of the algorithm to multi-class segmentation problem may constitute a part of future investigation. It may be mentioned here that there exist some de nitions of rough entropy useful for other appli- cations. For example, the one de ned by Beaubouef et al. (1999) is applicable to relational database and the one of Du ntsch and Gediga (1998) for optimal granulation and feature selection. Reports are also available on image entropy measures and object extraction where image entropy is de ned based on both histogram (Pun, 1981) and co-occurrence matrix (Pal and Pal, 1989) making use of the global and local information of image. Use of logarithmic and exponential gain functions in this regard is explained in (Pal and Pal, 1991). Acknowledgement A part of the work was completed while Prof. Pal held a Visiting Scientist position in the US Naval Research Lab, Washington, DC, USA under ONRIFO Grant No. N00014-04-1-4061. Mr. Uma Shankar acknowledges the project Advanced techniques for remote sensing image processing under the India-Trento Program for Advanced Research (ITPAR). References Beaubouef, T., Petry, F.E., Arora, G., 1999. Information measure for rough and fuzzy sets and application to uncertainty in relational database. In: Pal, S.K., Skowron, A. (Eds.), Rough Fuzzy Hybridization: A New Trend in Decision-making. Springer, Singapore, pp. 200 214. Du ntsch, I., Gediga, G., 1998. Uncertainty measures of rough set prediction. Artif. Intell. 106, 109 137. Gonzalez, R.C., Woods, R.E., 2002. Digital Image Processing, second ed. Pearson Education Inc., Singapore. Komorouski, J., Pawlak, Z., Polkowski, L., Skowron, A., 1999. Rough sets: A tutorial. In: Pal, S.K., Skowron, A. (Eds.), Rough Fuzzy Hybridization: A New Trend in Decision- Making. Springer, Singapore, pp. 3 98. Pal, S.K., 2001. Fuzzy image processing and recognition: Uncertainties handling and applications. Internat. J. Image Graphics 1 (2), 169 195. Pal, N.R., Pal, S.K., 1989. Entropic thresholding. Signal Process. 16, 97 108. Pal, N.R., Pal, S.K., 1991. Entropy: A new de nition and its applications. IEEE Trans. Systems Man Cybernet. SMC-21, 1260 1270. Pal, S.K., Mitra, P., 2002. Multispectral image segmentation using rough set initialized EM algorithm. IEEE Trans. Geosci. Remote Sensing 40, 2495 2501. Pawlak, Z., 1991. Rough Sets, Theoretical Aspects of Reason- ing about Data. Kluwer Academic, Dordrecht. Pun, T., 1981. Entropic thresholding: A new approach. Comput. Graphics Image Process. 16, 210 239. Skowron, A., Rauszer, C., 1992. The discernibility matrices and functions in information systems. In: Slowin ski, R. (Ed.), Intelligent Decision Support, Handbook of Applications and Advances of the Rough Sets Theory. Kluwer Academic, Dordrecht, pp. 331 362. Wojcik, Z., 1987. Rough approximation of shapes in pattern recognition. Comput. Vision Graphics Image Process. 40, 228 249. Zadeh, L.A., 1997. Towards a theory of fuzzy information granulation and its centrality in human reasoning and fuzzy logic. Fuzzy Sets Systems 19, 111 127. S.K. Pal et al. / Pattern Recognition Letters 26 (2005) 2509 2517 2517