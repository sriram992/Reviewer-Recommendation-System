Conference Title AUTHOR 1 Incorporating Deep Learning Techniques for Predicting the Prices and Identifying Most Influential Cryptocurrencies Ruchi Mittala, M.P.S Bhatiaa aDivision of Computer Engineering, Netaji Subhas Institute of Technology, New Delhi, India Abstract: In the modern era, researchers are predicting prices of various kinds of cryptocurrency to understand their trend in the sector of finance. In this paper, we focus on price prediction of cryptocurrencies based on a period, i.e., for the year 2013 t0 2018. From our research, we have identified the highest prices for bitcoin for historical dates and trained Long Short-Term Memory Networks to learn and predict the highest rate for a future period. Thus, trend analysis of cryptocurrency prices has been done, and neural networks have been leveraged to determine from time series data and predict future values. 1. Introduction Cryptocurrencies have soared to the peak of popularity since the year 2008, with an aggregate value greater than IBM s market capital. The underlying technology, Blockchain has a significant impact on industries in the finance sector. Investors looking forward to attaining long-term benefits in this technology are teaming up with technology enablers in the field of finance and other utilities. The role of digital currency is slowly growing and replacing the use of traditional cash and checkbooks. Cryptocurrencies consist of digitally coded scripts that are replications of currencies that we are using today. A digital ledger, blockchain, tracks transactions are made using cryptocurrencies. Bitcoin is one of the most popular digital currencies. Started in 2009, it gained attention as it served as a peer version of cash and no intermediate financial systems were required for transactions anymore (Nakamoto, S. 2008). Many methods have been proposed to forecast future Bitcoin prices for profitable trades. However, classical time series prediction methods make poor predictions and lack a probabilistic approach. Digital currencies use encryption systems so that the creation and transfer of these can be tracked from the perspective of the economy. It is essential to examine the financial factors, which will determine its price, which would subsequently help in understanding the scope and consequences of this currency in a country s economy. In the light of these challenges, this paper proposed scalable algorithms to predict the increase and decrease in Bitcoin prices throughout five years. Bitcoin market prices have been associated with deep machine learning networks to predict the dynamically increasing and decreasing trend of the currency. This can help investors to understand market trends before they invest. This approach maintains a high accuracy (>90 percent) and low Root Mean Squared Error. Section 2 explains the background of this research. Section 3 describes our proposed approach, and in section 4, we discuss the results. 2. Related Work To see cryptocurrencies as future currencies or transaction medium holds a greater impact. This is due to strong and powerful blockchain mechanism and security. All the cryptourreincies works on blockchain and holds greater security because there exist direct transactions between two parties. Figure 1 briefly shows the working of cryptocurrency and blockchain. Yermack, D., 2015, present their study by comparing the bitcoin cryptocurrency with traditional currencies. According to their analysis, it is commodity money without gold, fiat money without the state, and credit money without debt, and claimed that even though bitcoin is no gold, state or debt backing, it is a mistake to settle for counterfeit money (Herrera-Joancomart , J., 2014). On the other side, a few authors argued that bitcoin could not meet the classical properties of money since it lacks intrinsic value, requires long verification process of the transactions and is highly volatile (Catania, L., Grassi, S., & Ravazzolo, F., 2018). Fig. 1 Basic working of cryptocurrency To estimate bitcoin s (Mittal, R., Arora, S., & Bhatia, M. P. S., 2018) price drivers, there are two main driving factors: methods that include financial variables and sentiment analysis. The others make use of at least a proxy to attract investors. In the first method, the authors studied how emotions in the Twitter influence digital currency market and argued that those sentiments have a moderate correlation with Bitcoin closing price and volume. Further causality analysis found that there is no statistical significance for Twitter signals as a predictor, in contrast, this social media an emotional reflection of Bitcoin s price movements (Reid, F., & Harrigan, M., 2013). Similarly, the authors collected Google Trends data and anecdotal evidence regarding Bitcoin users to investigate the HTTPS://WWW.SSRN.COM/LINK/IJISMS-PIP.HTML ELSEVIER-SSRN (ISSN: 1556-5068) 188 Proceedings of 4TH International Conference on Computers & Management (ICCM) 2018 Electronic copy available at: https://ssrn.com/abstract=3364971 Conference Title AUTHOR 2 determinants of interest in Bitcoin. According to this paper, machine learning has been taken up as the driving factor to determine the price of Bitcoin. 3. Methodology for Price Predicition Using Deep Learning Unlike regression, the prediction of prices using Long Short Tem memory Networks is based on sequence dependence or time series. LSTM is a powerful kind of recurrent neural network, which is used to train large architectures. The proposed architecture helps to: Predict the highest price of cryptocurrency based on the previous date. This is done for the years 2013-2018. Develop LSTM network and make predictions using LSTM that maintain their state over many sequences. Use LSTM to predict prices using regression and window based framing for prediction. The proposed model is as shown below: Fig. 2. Proposed architecture Extended Short-Term Memory networks or LSTMs are particular kinds of Recurrent Neural Networks, which are used to work on long-term dependencies. They remember information for an extended period to work on stored data. LSTMs have the repeating chain like modules like Recurrent Neural Networks, but these have four interacting layers as shown below: Fig. 3. LSTM structure Forget gate layer: In this layer, LSTM decides which information to keep and which to forget. ! = ( !. !!! , ! + ! (1) It looks at output of previous layer !!! ! and outputs a number 0 or 1. If result is 0, result is discarded or else it is kept. A sigmoid layer or input gate layer decides which values are to be updated. This is followed by a layer of tanh, which creates a vector of candidates !. ! = ( !. !!! , ! + ! (2) ! = ( !. !!! , ! + ! (3) To update the old cell state Ct-1 with values of new state Ct, the old state is multiplied by ft . Thus old information is dropped and new information is retained. ! = ! !!! + ! ! (4) Finally, output is based on our present cell state and a sigmoid layer is applied to decide which part of the output is to be kept. ! = ( !. !!! , ! + ! (5) ! = ! tanh( !) (6) 4. Cryptocurrency Price Prediction Approach 4.1 Price Prediction The CryptocoinHistoricPrice dataset has been used for our experiments. This dataset has around 1400 types of cryptocurrencies. During data preprocessing, Date, Type, and Highest Price have been extracted from the following list of features, provided in the dataset. In this paper, 1500 records have been used to predict the price of Bitcoin from historical prices. A brief description of the dataset has been shown in Table 1. Table.1. Dataset description Parameter Description Date Date to which data is picked Open Open price of the day High High price of the day Low Low price of the day Close Closing price of the day Volume Total Volume of the currency Market Cap Market capital of the currency Type Type of the coin Delta Delta of the currency In this paper, LSTM is trained using Keras library of Python, and time series prediction problem is solved. For a given date and type of cryptocurrency, the task is to predict the price for a particular currency on a future date. The dataset has been analyzed for the past five years, i.e., HTTPS://WWW.SSRN.COM/LINK/IJISMS-PIP.HTML ELSEVIER-SSRN (ISSN: 1556-5068) 189 Proceedings of 4TH International Conference on Computers & Management (ICCM) 2018 Electronic copy available at: https://ssrn.com/abstract=3364971 Conference Title AUTHOR 3 from the year 2013-2018. A sample from the dataset after preprocessing has been shown as below: Table.2. Preprocessed data Date Type Highest 12/31/2017 BTC 14377.4 1/30/2017 BTC 923.05 1/31/2017 BTC 972.02 2/1/2017 BTC 989.11 The trend over the last three months of 2017 has been visualized for Bitcoin in the following graph. We can observe an upward trend in the dataset over time. This trend is from October 2017 to January 2018. Fig. 4. Trend of historical dataset (BTC) LSTM is a particular case of RNN, which is trained using back propagation, which helps to overcome the vanishing gradient problem. Thus it uses memory blocks connected via layers, to solve challenging sequence problems. Each block operates over an input sequence and applies sigmoid activation to make changes in state and add additional information. The following steps are followed: We convert the dataset into a two-column format, one column with price on a particular date followed by price on the next date. Data is normalized to a range of 0-1, as LSTM is sensitive to scaling of data, especially due to the use of sigmoid and tanh functions. Integer values are converted to floating point numbers. 67% of the ordered dataset is divided into training set and the remaining 33 % is split into testing test. The number of previous time steps to be considered for looking back is decided by a variable x. In this paper, we work on two values of x i.e. 1 and 3. The input array is provided to LSTM in the form of a structure: [sample. time steps, features]. The following features have been used: Table.3. LSTM Network Features Values Values X (Looking back) 1 3 LSTM blocks (hidden layers) 4 4 Input layer 1 1 Number of epochs 200 200 When the value of x is 1, it looks back at only time step to predict the price for the next slot. However, if x is 3, it looks back at time t-2 as well as t-1, i.e., a window of timeframe is used by the LSTM network. It is observed that there is the more significant error in the prediction of the result when a look back period 3 is used. This is because parameters need to be tuned in order to use a window of time. Finally, predictions can be generated for both training and testing model. Root Mean Squared Error has been used to find the difference between predicted values and values observed. = ! ! ( ! ! ^)! ! !!! (7) The table 4 shows the results for predicting the root mean squares values. Table.4. Predicted Root Mean Square Values Look back Calculated RMSE in prediction x =1 32.84 x = 3 76.28 In the figure below, it is observed the value of Root Mean Square Error is higher when we look back at greater number of values. As look back refers to the number of previous time steps, which are used as input variables to predict the value obtained at the next timestamp, our dataset gives minimum error when look back is 1. Based on this approach, the predicted prices for chosen dates are tabulated in Table 6. Thus, the approach is efficient to predict prices based on prior time values and prices. Fig. 6. RMSE vs. look back values in LSTM network Table.5. Predicted prices for some dates Date Predicted Price Original Price 8/8/2017 3448 3484.85 HTTPS://WWW.SSRN.COM/LINK/IJISMS-PIP.HTML ELSEVIER-SSRN (ISSN: 1556-5068) 190 Proceedings of 4TH International Conference on Computers & Management (ICCM) 2018 Electronic copy available at: https://ssrn.com/abstract=3364971 Conference Title AUTHOR 4 11/28/2017 10244.18 10125.7 8/19/2017 4375.17 4243.26 In all cases, accuracy with which price is predicted is more than 90 percent. 4.2 Comparisons with other Approach We have compared the results of our proposed approach with results obtained using linear regression, for prediction of highest price in cryptocurrencies. Multivariate linear regression has been used to predict the highest and lowest prices of cryptocurrency. In this model, multiple independent variables contribute to a dependent feature with the help of multiple coefficients (Aparicio, T., & Villanua, I., 2003). h (x) = 0 + 1x1 + 2x2 .. nxn These prices are predicted based on the prices seen in the past three years i.e. 2017,2016 and 2015. The predicted prices and actual prices of currencies have been tabulated as follows: Table.4. Results of linear regression Starting price Predicted-High Price 15123.7 16109.1906 16476.2 17790.0436 6777.77 7556.4003 It is observed that accuracy achieved using linear regression is 70-80 percent. Whereas using our proposed approach involving LSTM networks, we can obtain a high accuracy of 90 percent in the prediction of prices. 4.2 Most Influential Crypto currencies One of the main concerns about predicting cryptocurrency is directly or indirectly raises a point to find which cryptocurrencies are the most influential or rate of which cryptocurrency may go high in the future. Here, we are predicting the most important currencies to which investment could be beneficial or not. In figure 7, figure 8, figure 9, figure 10 and figure 11 we are plotting the rise or fall in prices over time concerning our predicted price. For example, in fure7 we show how the price of bitcoin falls over time. Similarly, in figure 9, we show how the price of CVH goes high. With this any user or investor may decide, in which cyptocurrency he/she may invest. Fig. 7. BTC price prediction Fig. 8. EOS price prediction Fig. 9. CVH price prediction HTTPS://WWW.SSRN.COM/LINK/IJISMS-PIP.HTML ELSEVIER-SSRN (ISSN: 1556-5068) 191 Proceedings of 4TH International Conference on Computers & Management (ICCM) 2018 Electronic copy available at: https://ssrn.com/abstract=3364971 Conference Title AUTHOR 5 Fig. 10. LTC price prediction Fig. 11. XRC price prediction The average values of different cryptocurrencies have been calculated after scaling of price values (between 0 and 1). It is observed that after training the model using LSTM and considering price values at the previous time step, the average value of predicted Bitcoin prices is the highest. The average predicted value of prices is more in case of Bitcoin, as compared to other currencies like CVH,XRP, and LTC etc. For these currencies, average predicted price drops down after training with the help of LSTM model. Table.7. Average of various cryptocurrencies Currency Average (after scaling) Average (After prediction) BTC 0.105596 0.1083201 XRP 0.0391002 0.0387248 LTC 0.058093 0.05756036 EOS 0.111908 0.1091949 CVH 0.100448 0.098818 Thus, this approach can help us to understand the graph and trend of various cryptocurrencies, along with the idea of investing in the right domain. 5. Conclusion In this paper, we have used LSTM for time series prediction using Keras deep learning library. The network is trained to predict the price of a particular cryptocurrency, based on the price on the previous date. Thus, LSTM is used for regression and is also used for window formulation of the time series problem. It is observed that the algorithm performs better on the dataset when we look back at one time step, rather than framing a window. The Root Mean Squared Error is lesser in the former case, and good accuracy is achieved. As a part of future work, we would fine-tune the windowing parameters to attain better results on our dataset, using the LSTM network. REFERENCES Nakamoto, S. (2008). Bitcoin: A peer-to-peer electronic cash system. Herrera-Joancomart , J. (2014). Research and challenges on bitcoin anonymity. In Data Privacy Management, Autonomous Spontaneous Security, and Security Assurance (pp. 3-16). Springer, Cham. Reid, F., & Harrigan, M. (2013). An analysis of anonymity in the bitcoin system. In Security and privacy in social networks (pp. 197-223). Springer, New York, NY. Yermack, D. (2015). Is Bitcoin a real currency? An economic appraisal. In Handbook of digital currency (pp. 31-43). Catania, L., Grassi, S., & Ravazzolo, F. (2018). Forecasting Cryptocurrencies Financial Time Series. Mittal, R., Arora, S., & Bhatia, M. P. S. (2018), AUTOMATED CRYPTOCURRENCIES PRICES PREDICTION USING MACHINE LEARNING . ICTACT Aparicio, T., & Villanua, I. (2003). Multivariate Linear Regression Model. In Computer-Aided Introduction to Econometrics (pp. 45-120). Springer, Berlin, Heidelberg. HTTPS://WWW.SSRN.COM/LINK/IJISMS-PIP.HTML ELSEVIER-SSRN (ISSN: 1556-5068) 192 Proceedings of 4TH International Conference on Computers & Management (ICCM) 2018 Electronic copy available at: https://ssrn.com/abstract=3364971