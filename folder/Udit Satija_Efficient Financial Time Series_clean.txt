See discussions, stats, and author profiles for this publication at: https://www.researchgate.net/publication/289531157 Ef cient Financial Time Series Forecasting Model using DWT Decomposition Conference Paper July 2015 DOI: 10.13140/RG.2.1.2889.0640 CITATIONS 2 READS 766 3 authors: Some of the authors of this publication are also working on these related projects: IT Growth Driver Analysis using Bayesian Belief Network (BBN) View project Business Risk and Impact Assessment through Machine Learning View project Ina Khandelwal The LNM Institute of Information Technology 6 PUBLICATIONS 199 CITATIONS SEE PROFILE Udit Satija Indian Institute of Technology Patna 49 PUBLICATIONS 1,084 CITATIONS SEE PROFILE Ratnadip Adhikari Fractal Analytics, Bengaluru, India 21 PUBLICATIONS 1,062 CITATIONS SEE PROFILE All content following this page was uploaded by Udit Satija on 08 January 2016. The user has requested enhancement of the downloaded file. Ef cient Financial Time Series Forecasting Model using DWT Decomposition Ina Khandelwal , Udit Satija , Ratnadip Adhikari Computer Science and Engineering The LNM Institute of Information Technology, Jaipur, India Email: {ina, adhikari.ratan}@lnmiit.ac.in School of Electrical Sciences Indian Institute of Techonology Bhubaneswar, India Email: us11@iitbbs.ac.in Abstract This paper proposes an ef cient time series fore- casting model for exchange rates. Previous literature reveals that Functional Link Arti cial Neural Network (FLANN) is very effective in nancial time series forecasting involving less computational load and fast forecasting capability. Autoregressive Integrated Moving Average (ARIMA) models are well known for their remarkable forecasting accuracy. In this literature, we have used Discrete Wavelet Transform (DWT) to decompose the in-sample training data into linear (detailed) and nonlinear (approximate) components, then applied ARIMA and FLANN model to forecast the respective components. The proposed method amalgamate the unique strengths of ARIMA, FLANN and DWT to improve the forecasting accuracy of a nancial time series data. Simulation results show superiority of the proposed method. I. INTRODUCTION Time series forecasting is a very dynamic research topic in various domains of science and engineering [1]. Time series forecasting has numerous applications in diverse eld includ- ing nancial forecasting, weather forecasting, stock market prediction etc. The main aim of analyzing the time series is to formulate a mathematical model that can be used to forecast desired number of future observations. Several inherent issues of a time series make future forecasting dif cult. The accuracy of the future forecasts solely depends on the tted model. Forecasting a nancial data is a challenging and complex problem due to its high volatile nature [2]. In the literature, many statistical and soft computing tools have been applied on nancial time series. Many soft com- puting techniques such as Arti cial Neural Network (ANN), Genetic algorithm [3], Fuzzy logic [4] etc. have been ap- plied on nancial time series. These Models have more time complexity. Autoregressive Integrated Moving Average (ARIMA) model developed by Box and Jenkins [5], which is an effective model in time series forecasting. However, it relies upon the correlation analysis which makes it unsuitable for nonlinear patterns [6]. Functional Link Arti cial Neural Network (FLANN) has been used in the literature for fore- casting exchange rates and stock markets [2], [7]. In [8], FLANN has been applied for seasonal time series forecasting. FLANN involves less computational complexity and easily implementable because of the absence of hidden layers. It does not involve setting up the parameters like number of hidden layers and hidden nodes. The major issue with nancial time series is how to improve the forecasting accuracy by using a model which involves less computation. Wavelet transform has been applied in different problems of engineering, signal processing and statistics [9]. From the previous literature, it is evident that wavelet transform improves the forecasting accuracies [10], [11]. S & P index is decomposed using wavelet to forecast the future observations [10]. Haar wavelet decomposition is used in stock price time series for removing noise in order to achieve more precise forecasts [12]. Input data is partitioned into different regions using haar wavelet together with clustering algorithm [13]. In Choi et al. [14], sales time series is forecasted using hybrid SARIMA and wavelet transform. Wavelet transform is used in Conejo et al. [15] to decompose electricity time series in order to increase accuracy after applying ARIMA on decomposed part. Wavelets have also been used for improving ANN forecasting accuracy [16], [17]. In this study, we investigate a method to forecast nan- cial time series effectively with low computational cost. The method adequately model the linear and nonlinear correlation structures of a time series through ARIMA and FLANN respectively, after a prior decomposition of original time se- ries through Discrete Wavelet Transform (DWT). This hybrid method compiles the modeling strengths of ARIMA, FLANN and DWT. The investigated method is compared with FLANN in terms of ve popular error measures. The rest of the paper is organized as follows. Section II describes the traditional time series models. Section III presents the hybrid approach. The discussion on various simulation results has been made in Section IV. Finally, Section V concludes the paper. II. TIME SERIES MODELS A. ARIMA Model ARIMA models are the most popular statistical models for time series forecasting [5]. In this model, the future values of a time series are generated from a linear function of the past observations and white noise terms. An ARIMA (p,d,q) model can be mathematically expressed as follows: yt = 0 + 1yt 1 + 2yt 2 + . . . + pyt p+ t 1 t 1 2 t 2 . . . q t q (1) Copyright c IEEE2015 Fig. 1. FLANN Model where yt and t are the actual value and white noise at time t respectively. p and q are the model order, whereas i and j are the model parameters. d represents degree of ordinary dif- ferencing required to make the series stationary. Box-Jenkins model building methodology [6] is used to estimate the values of p, d and q. ARIMA models are not very effective for modeling a general real-world time series due to the linearity restriction. B. FLANN Model FLANN is a model proposed by Pao [18] in 1989 . Single layer neural network can be used in place of Multi-layer neural network to overcome the computational complexities [19]. Due to the linear nature of single layer network, it may fail to represent the nonlinear problems. Therefore, in this model the input vector is functionally expanded to overcome the issue of linearity [20]. Feature Extraction: Financial time series data are not used directly as a input. Features are extracted from the data and used as a input in the FLANN Model in order to achieve better forecasting accuracies [2]. First, the data is normalized using the maximum value present in the data to ensure that the data lie between 0 to 1. In this paper, we have taken number of inputs as three. a) First input is taken as the 12th month value. In order to extract the features of previous data we have started the input value from 12th month. b) Second input is taken as the mean of the values from 1st to 12th month. c) Third input is taken as the variance of the values from 1st to 12th month. These features are calculated separately for the time series of rupee, yen and pound. Fig. 1 shows the FLANN model [2], [8]. As shown in Fig. 1, data from the dataset are given as input. In this study, we have taken number of inputs as three and number of expansions equal to ve. Let, M be the number of months for which total data is available. M1 be the number of months for training and M2 be the number of months for testing. Suppose, Xm be the normalized data where m = 1, 2, 3, ..., M. Here, inputs are X = [X(1), X(2), X(3)]. Then, each input is functionally expanded. We have used trigonometric expansion which can be represented as: y = [y1(k), y2(k), ..., yI(k)] (2) Here, k = 1, 2, 3 and I = 5. The expansion of each input can be written as: yi(k) = [Xi(k), sin(2n 1) Xi(k), cos(2n 1) Xi(k)]T (3) where n = 1, 2 and i = 1, 2, 3, 4, 5. Random weights are initialized from 0 to 1. Then, the expanded 15 values are multiplied to weights and summed up to produce the output of the linear part of the model. This output is then passed through a nonlinear function (a sigmoid function) to produce the estimated output. This estimated output is compared with the corresponding desired output and the resultant error for the available pattern is used to evaluate the change in mth weight in each experiment is given by [2]: wm(j) = 1 N N X n=1 2 y(j)e(j) (4) Here, N are the patterns to be applied and j is the iteration number. Then, the weight update equation is given by: wm(j + 1) = wm(j) + wm(j) (5) 0 100 200 300 400 500 0 10 20 30 40 50 60 70 No. of months USD to IR Fig. 2. USD to IR data III. DWT BASED ARIMA-FLANN HYBRID METHOD Wavelet transform is used to decompose the historical price data into mutual orthogonal set of wavelets or basis functions. These functions are small waves located in different times, the wavelet transform can provide information about both the time and frequency domains. In this study, DWT is used to obtain a prior decomposition of a time series into low and high frequency components [14]. During decomposition, a given signal is decomposed into several other signals with different levels of resolution. It is possible to recover the original time domain signal without losing any information. Wavelets transform has reverse process which is called the inverse wavelet transform or signal reconstruction [11], [14]. 0 100 200 300 400 500 1 1.2 1.4 1.6 1.8 2 2.2 2.4 2.6 2.8 No. of months USD to BP Fig. 3. USD to BP data 0 100 200 300 400 500 50 100 150 200 250 300 350 400 No. of months USD to YEN Fig. 4. USD to YEN data In the decomposition phase, the series is decomposed into high (detailed) pass lter which picks up the higher frequency component of the series and low (approximate) pass lter which picks up the lower frequency component of the series. The reconstruction is just a reversed process of decomposition. ARIMA is tted to the reconstructed detailed part and then forecasts are generated for the linear component. Then, the FLANN is tted to the corresponding residuals together with the approximate part which results in generating the forecasts for nonlinear component. Finally, the combined nal forecasts are obtained through adding the two linear and nonlinear component-wise forecasts [21]. Flow chart for the method is shown in Fig. 5 IV. EXPERIMENTAL SETUP A. Data Collection The hybrid method is tested on 3 datasets. All these datasets are taken from www.forecasts.org. All the datasets are shown in Figs. 2-4. In addition, description of the three datasets is given in Table I. Fig. 5. Flow chart of DWT based ARIMA-FLANN method TABLE I. DESCRIPTION OF THE THREE FINANCIAL TIME SERIES DATASETS Time series Description 1US Dollar to Indian Rupee 01-Jan-1973 to 01-Oct-2014 Total size- 502 , Train size- 468 , Test size- 34 1US Dollar to British Pound 01-Jan-1971 to 01-Oct-2014 Total size- 526 , Train size- 492 , Test size- 34 1US Dollar to Japanese Yen 01-Jan-1971 to 01-Oct-2014 Total size- 526 , Train size- 492 , Test size- 34 B. Training and Testing Process In this literature, Mean Square Error (MSE) is considered as the cost function for training process. During training, the weights having the minimum MSE value for their forecast are stored for testing the network. In this study, we have tested our performance using other four functions i.e., Mean Absolute Error (MAE), Mean Absolute Percentage Error (MAPE), Root Mean Squared Error (RMSE) and Sum of Squared Error (SSE). Actual output and estimated output are compared to evaluate the optimal values for different performance measures. The main objective is to minimize the MSE value for the testing pattern. MSE is calculated as: MSE = 1 N N X t=1 e2 t (6) MAE is calculated as: MAE = 1 N N X t=1 | et | (7) MAPE is calculated as: MAPE = 1 N N X t=1 | et yt | 100 (8) RMSE is calculated as: RMSE = v u u t 1 N N X t=1 e2 t (9) SSE is calculated as: SSE = N X t=1 e2 t (10) V. RESULTS AND DISCUSSIONS In this study, FLANN model is compared with the DWT based hybrid ARIMA-FLANN method using the forecasting accuracy measures, i.e., MSE, MAE, MAPE, RMSE and SSE. Table II gives the forecasting results of USD to IR conversion. For hybrid method, ARIMA (6,0,0) is taken along with FLANN. Results of USD to BP conversion is shown in Table III, ARIMA of order (4,0,0) along with FLANN has been used. Table IV gives the predicted results for USD to YEN conversion, hybrid method consists of ARIMA (0,1,0) and FLANN. In all the three nancial time series data it can be clearly seen from the results that our proposed DWT hybrid ARIMA- FLANN model outperforms the FLANN model. All the results of actual and forecasted data are shown in Figs. 6-8. TABLE II. RESULTS FOR USD TO IR Forecasting Model FLANN Proposed MSE 0.019755 0.009742 MAE 0.135577 0.093802 MAPE 14.94333 10.30467 RMSE 0.140553 0.098702 SSE 0.671673 0.331234 TABLE III. RESULTS FOR USD TO BP Forecasting Model FLANN Proposed MSE 0.048984 0.013717 MAE 0.217202 0.115962 MAPE 35.65701 19.03467 RMSE 0.221324 0.117121 SSE 1.66546 0.466387 TABLE IV. RESULTS FOR USD TO YEN Forecasting Model FLANN Proposed MSE 0.092436 0.004229 MAE 0.303506 0.053384 MAPE 118.8734 20.02986 RMSE 0.304032 0.065032 SSE 3.142808 0.143793 VI. CONCLUSION In this paper, a DWT based hybrid ARIMA-FLANN based model is introduced for nancial time series forecasting. The most challenging task is to determine the exact nature of a real-world time series. ARIMA assumes linear data generation function, whereas FLANN is suitable for nonlinear nancial 0 5 10 15 20 25 30 0.75 0.8 0.85 0.9 0.95 1 No. of months Normalized USD to IR Actual Predicted Fig. 6. Testing USD to IR data and its forecast 0 5 10 15 20 25 30 0.54 0.56 0.58 0.6 0.62 0.64 0.66 0.68 No. of months Normalized USD to BP Actual Predicted Fig. 7. Testing USD to BP data and its forecast 0 5 10 15 20 25 30 0.18 0.2 0.22 0.24 0.26 0.28 0.3 0.32 No. of months Normalized USD to YEN Actual Predicted Fig. 8. Testing USD to YEN data and its forecast time series. The DWT based hybrid method provides prior decomposition of time series data into low and high frequency components. So, that ARIMA is tted on the high frequency linear part and FLANN is tted on the low frequency nonlinear part. The nal combined forecasts obtained for proposed hybrid method outperforms FLANN model. REFERENCES [1] J. G. De Gooijer, R. J. Hyndman, 25 years of time series forecasting, Int. J. Forecasting, vol. 22, no. 3, pp. 443-473, 2006. [2] R. Majhi, G. Panda and G. Sahoo, Development and performance evaluation of FLANN based model for forecasting of stock markets, Expert Syst. Applicat., 2009. [3] S. Bhattacharya and K. Mehta , Staged learning of trading rules using genetic algorithm, Conf. Inform. Sys. Tech., pp. 62-66, 1998. [4] Y. Ju, C. Kim and J. C. Shim, Genetic-based fuzzy models; interest rates Forecasting problem, Computer and Industrial Eng., vol. 33, pp. 561-564, 1997. [5] G. E. Box, G. M. Jenkins and G. C. Reinsel, Time series analysis: forecasting and control, John Wiley and Sons, 2013. [6] G.P. Zhang, Time series forecasting using hybrid ARIMA and neural network model, Neurocomputing, vol. 50, pp. 159-175, 2001. [7] B. Majhi, M. Rout, R. Majhi, G. Panda and P. J. Fleming, New robust forecasting models for exchange rates prediction, Expert Syst. Applicat., vol. 39, no. 16, pp. 12658-12670, 2012. [8] I. Khandelwal, U. Satija, R. Adhikari, Forecasting seasonal time series with functional link arti cial neural network, IEEE Int. Conf. Signal Process. & Integrated Networks, (SPIN), 2015. [9] P. Chaovalit, A. Gangopadhyay, G. Karabatis and Z. Chen, Discrete wavelet transform based time series analysis and mining, ACM Com- puting Surveys, vol. 43, no. 2, pp. 0360-0300, 2011. [10] Z. R. Struzik, Wavelet methods in nancial time-series processing, Physica A: Statistical Mechanics and its Applications, vol. 296, no. 1, pp. 307-319, 2001. [11] M. T. I. S. Al Wadia and M. Tahir Ismail, Selecting Wavelet Trans- forms Model in Forecasting Financial Time Series Data Based on ARIMA Model, Applied Mathematical Sci., vol. 5, no. 7, pp. 315-326, 2011. [12] T. J. Hsieh, H. F. Hsiao and W. C. Yeh, Forecasting stock markets using wavelet transforms and recurrent neural networks: An integrated system based on arti cial bee colony algorithm, Applied Soft Computing, vol. 11, no.2, pp. 2510-2525, 2011. [13] R. L. Milidiu, R. J. Machado and R. P. Rentera, Time-series forecast- ing through wavelets transformation and a mixture of expert models, Neurocomputing, vol. 28, no. 1, pp. 145-156, 1999. [14] T. M. Choi, Y. Yu and K. F. Au, A hybrid SARIMA wavelet transform method for sales forecasting, Decision Support Systems, vol. 51, no. 1, pp. 130-140, 2011. [15] A. J. Conejo, M. A. Plazas, R. Espinola and A. B. Molina, Day-ahead electricity price forecasting using the wavelet transform and ARIMA models, IEEE Trans. Power Sys., vol. 20, no. 2, pp. 1035-1042, 2005. [16] P. C. Deka, L. Haque and A. G. Banhatti, Discrete wavelet-Ann approach in time series ow forecasting-a case study of Brahmaputra river, Int. J. Earth Sci. Eng., vol. 5, no. 4, pp. 673-685, 2012. [17] A. Aussem, and F. Murtagh, Combining neural network forecasts on wavelet-transformed time series, Connection Sci., vol. 9, no. 1, pp. 113- 122, 1997. [18] Y. H. Pao, S. M. Phillips and D. J. Sobajic, Neural net computing and intelligent control systems, Int. J. Control, vol. 56, no. 2, pp. 263-289, 1992. [19] R. Agrawal, T. Imielinski and A. Swami, Database mining: A per- formance perspective, IEEE Trans. Knowledge Data Eng., no. 5, pp. 914-925, 1993. [20] B. B. Misra and S. Dehuri, Functional Link Arti cial Neural Network for Classi cation Task in Data Mining, J. Comput. Sci., vol. 12, no. 3, pp. 948-955, 2007. [21] I. Khandelwal, R. Adhikari, G. Verma, Time Series Forecasting using Hybrid ARIMA and ANN Models based on DWT Decomposition, Procedia Comp. Sci., vol. 48, pp. 173-179, 2015. View publication stats