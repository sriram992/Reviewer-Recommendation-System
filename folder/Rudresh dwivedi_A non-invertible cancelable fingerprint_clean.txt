Date of publication xxxx 00, 0000, date of current version xxxx 00, 0000. Digital Object Identi er 10.1109/ACCESS.2017.DOI A non-invertible cancelable ngerprint template generation based on ridge feature transformation RUDRESH DWIVEDI1, SOMNATH DEY2, (Member, IEEE) 1Discipline of Computer Science & Engineering, Indian Institute of Technology Indore, Indore, India (e-mail: phd1301201006@iiti.ac.in) 2Discipline of Computer Science & Engineering, Indian Institute of Technology Indore, Indore, India (e-mail: somnathd@iiti.ac.in)) Corresponding author: Rudresh Dwivedi (e-mail: phd1301201006@ iiti.ac.in). The authors are thankful to SERB (ECR/2017/000027), Department of science & Technology, Govt. of India for providing nancial support to carry out this research work. ABSTRACT In a biometric veri cation system, leakage of biometric data leads to permanent identity loss since original biometric data is inherently linked to a user. Further, various types of attacks on a biometric system may reveal the original template and utility in other applications. To address these security and privacy concerns cancelable biometric has been introduced. Cancelable biometric constructs a protected template from the original biometric template using transformation functions and performs the comparison between templates in the transformed domain. Recent approaches towards cancelable ngerprint generation either rely on aligning minutiae points with respect to singular points (core/delta) or utilize the absolute coordinate positions of minutiae points. In this paper, we propose a novel non- invertible ridge feature transformation method to protect the original ngerprint template information. The proposed method partitions the ngerprint region into a number of sectors with reference to each minutia point employing a ridge-based co-ordinate system. The nearest neighbor minutiae in each sector are identi ed, and ridge-based features are computed. Further, a cancelable template is generated by applying the Cantor pairing function followed by random projection. We have evaluated our method with FVC2002, FVC2004 and FVC2006 databases. It is evident from the experimental results that the proposed method outperforms existing methods in the literature. Moreover, the security analysis demonstrates that the proposed method ful lls the necessary requirements of non-invertibility, revocability, and diversity with a minor performance degradation caused due to cancelable transformation. INDEX TERMS biometric, cancelable biometrics, ngerprint, minutiae, alignment-free, feature extrac- tion, privacy, security I. INTRODUCTION T HE compromise of stored biometric template causes permanent identity theft of a user as biometric data is irreplaceable and irrevocable. There are various types of attacks and privacy concerns linked with sharing of biometric information across multiple applications [1], [2]. Jain et al. [3] identi ed four levels of attacks in a biometric system. At the rst level, the attacker presents a falsi ed biometric input to the sensor, and the sensor may not be able to differentiate between genuine and fake biometric inputs. Second, the attacker intercepts the communication link between the different modules to enter into the system. At the third level, the attacker intercepts the executable program of a module to get the desired output. Such attacks are called Trojan-Horse attacks. Last, the attacker replaces/ derives a spoof of the stored template which causes the security breach. Therefore, biometric template protection is necessary to address such security challenges. To provide biometric template protection against the afore-mentioned attacks, an idea of cancelable biometrics has been presented. The cancelable biometric scheme applies a transformation to derive a protected template which is used for veri cation instead of the original template of a user. The transformation relies on a non-invertible function such that it is hard to VOLUME 4, 2016 1 arXiv:1805.10853v1 [cs.CV] 28 May 2018 R. Dwivedi et al.: A non-invertible cancelable ngerprint template generation based on ridge feature transformation retrieve the original template even if the attacker knows the transformed template and transformation function. In a compromise situation, a new protected template can be derived by altering the parameter values of the transforma- tion function. The transformation should ful ll the following requirements described by Breebaart et al. [4]: 1) Non-invertibility: It should be computationally hard to construct the original template from the transformed template. This prevents the recovery of the original biometric information by an imposter. 2) Diversity: Identical cancelable template should not be used in different applications to avoid cross-matching of the stored template. 3) Revocability: The transformation should be able to derive numerous protected templates from the same biometric input and there should be immediate revo- cation in case of compromise. 4) Performance: The transformation should not exhibit signi cant performance degradation. Bolle et al. [5] introduced four types of transformations for cancelable ngerprint template generation which utilize the core and delta points (singular points) of an input n- gerprint. The biohashing based approaches proposed in [6], [7] combine a user-speci c key onto the original biometric features to derive a protected template. BioHashing and its variants [6], [7], are proved to be impractical if the unique seed is compromised. Ahmad et al. [8] proposed a ngerprint template protection scheme that uses relative minutiae information in the polar coordinate system as described in [9]. The proposed scheme underperforms on the FVC2002 DB3 database where low-quality ngerprint images exist. The performances of the techniques presented in [9] [12] get degraded if the user-speci c key or token is compromised. Further, the limitation of the methods proposed in [5], [13], [14] lies with the accurate detection of the singular point (core or reference point). However, it is not possible to identify the singular points from ngerprint images of all users. Moreover, accurate detection of core point from an arch type or a poor quality ngerprint image is a challenging task. Farooq et al. [15] derived a binary representation of the different features computed from all possible triplets which require a large number of computations. Cappelli et al. [16] introduced a state-of-the-art Minutiae Cylinder Code (MCC) based ngerprint representation which outperforms the most of the existing methods. However, the original MCC ap- proach does not provide any protection mechanism for minutiae information. Later, Ferrara et al. [17] proposed the protected MCC (P-MCC) approach to secure the minutiae information. Further investigations reveal the irrevocability issue of P-MCC technique. In order to provide revocability, Ferrara et al. [18] proposed a two-factor protected Minutiae Cylinder Code (2P-MCC) scheme which performs curtailed permutation onto cylinders in P-MCC using a secret key. Few approaches [14], [19] in literature utilize xed-radius transformation. These approaches may cause performance degradation if the minutiae points are at the edge of the radius. Owing to noise or local distortion these minutiae could be considered inside the radius for the rst sample and outside the radius for the second sample for the same ngerprint. Further, Ahmad et al. [8] and Sutcu et al. [19] applied a transformation considering a threshold onto the number of minutiae point to derive the protected template. Certain methods [11], [12] directly use the position and di- rection information of minutiae points to derive a protected ngerprint template. However, selection of invariant features from the minutiae points results in signi cant performance improvement over the original minutiae information. Earlier, we have proposed a coprime mapping based transformation to protect the original ridge features. In the prior work [20], a very less number of brute-force attempts are required yielding the approach invertible. Moreover, the method is susceptible to the Attack-via-record-multiplicity (ARM) attack. Also, the performance degrades in case of FVC2004 where the users are allowed to exaggerate deformations at the time of acquisition. In this work, we have proposed random projection based transformation to mitigate the limitations of our prior work. In summary, to address the limitations of the existing ap- proaches depicted above, we propose a novel cancelable n- gerprint template generation method based on ridge feature transformation. Ridge-based features are computed for the nearest neighbor structure drawn for each reference minutiae point. Next, the Cantor pairing function is applied to encode the ridge features, and the logarithm function is used to uniformly distribute the paired features. Finally, the random projection is utilized to derive a non-invertible protected template. In a nutshell, we highlight the contributions of our work: 1) We have proposed a novel cancelable ngerprint template design methodology where transformation is applied over ridge features to cope with rotation, trans- lation and scale deformations in the input ngerprint image. 2) The proposed transformation does not lean upon prior alignment with the singular point which is hard to discover in the poor quality or missing singular point ngerprint images. 3) The ridge feature transformation is applied around each minutia to derive a feature matrix instead of xed-radius transformation to overcome the boundary problems. 4) The Cantor pairing function followed by random pro- jection is utilized to generate non-invertible cancelable ngerprint template. 5) The proposed scheme is analyzed with respect to the necessary criteria of cancelable template generation i.e. non-invertibility, revocability and diversity. Fur- ther, the method is also analyzed against different types of attacks such as Attack via Record Multiplic- 2 VOLUME 4, 2016 R. Dwivedi et al.: A non-invertible cancelable ngerprint template generation based on ridge feature transformation ity (ARM), pre-image attack, cross-matching attack, distinguishing attack and annealing attack. The secu- rity analysis demonstrates that the proposed approach ful lls the desired criteria and is robust enough to sustain such attacks. 6) The performance of the proposed method is evaluated with two different protocols (FVC and 1VS1) for all datasets (i.e. DB1, DB2, DB3 and DB4) of FVC2002, FVC2004 and FVC2006 databases. The experimental results demonstrate that our approach outperforms existing approaches. The rest of the paper is organized as follows. In Section II, we brie y summarize the existing methods related to the generation of cancelable ngerprint template. Section III describes the procedural steps of the proposed method. Section IV demonstrates experimental results as well as compares the proposed method with the existing cancelable template generation approaches. Section V provides the security analysis of our method. Conclusions and direction of future research are presented in Section VI. II. RELATED WORK In recent years, several methods have been introduced to generate the cancelable template in the literature. Ratha et al. [21] rst introduced the notion of cancelable biometric with three different types of transformations (Cartesian, polar and functional) to provide privacy and security to the original biometric information. The cartesian transformation method maps the ngerprint minutiae into cells of xed size. The minutiae positions in the cells are permuted to derive the cancelable template. In polar transformation method, the minutiae positions are mapped onto a polar coordinate space. Further, the coordinate space is divided into sectors, and sector positions are shuf ed based on a key to generate the cancelable template. Functional transfor- mation method alters the minutiae positions and orientation based on a parametric Gaussian function. Quan et al. [1] proved that the functional transformation could be cracked if the parameters and transformed template are revealed. The rest two transformations cater with high Equal Error Rate (EER). Moreover, all these methods require core-point for alignment before the transformation, and the determination of core-point is not always feasible. Boult et al. [22] proposed secure biotokens for nger- print template protection. The method constructs a minutiae pair table which contains distance, relative orientation, and orientation of the line connecting two minutiae points. The features are then divided into quotient and modulus part. The quotient part is encrypted using RSA algorithm and modulus part is concatenated with the encrypted quotient to form a cluster. In veri cation stage, minutiae pair tables of the query and stored templates are traversed to construct clusters and to compute the comparison scores. Lee et al. [23] proposed an alignment-free protected ngerprint template generation scheme using minutia orientation. They applied two different changing functions (i.e., positions and respec- tive orientations) which are used to secure the minutiae information. The stored template can thus be regenerated and revoked by altering the input parameters of the changing functions in the situation of compromise. In BioHashing based approaches [6], [7], the protected template is derived after discretizing the inner product of the biometric features with the projection matrix. Yang et al. [24] proposed a non-linear dynamic random projection scheme to increase the computational complexity against the inversion attack. Instead of conventional random projection utilized by Bio- Hashing, the projection matrix is dynamically constructed based on an index vector which is constructed from the quantization of the biometric feature vector. Lee et al. [12] presented a method to derive cancelable ngerprint template based on 3-D array mapping. In this work, a minutia from the minutiae set is assigned as the reference, and remaining minutiae are aligned with respect to the reference minutiae. Then, the aligned minutiae points are mapped into a 3-D array, based on the positions (x-y co-ordinate) and orienta- tions of the minutiae points. The cells in the 3-D array are marked as 1, which include minutiae points. The array is sequentially traversed to derive a bit-string. The derived bit- string is exploited to random permutation utilizing a user- speci c PIN and minutiae type. Wang et al. [25] proposed a template protection mechanism where many-to-one mapping is applied onto the pair-minutiae based bit-string evaluated using the method proposed by Lee et al. [12]. Then, the user-speci c PIN is applied to the complex vector derived by discrete Fourier transform on bit-string. Wang et al. [10] proposed another method for cancelable ngerprint template design using circular convolution. The procedure adopted till bit-string generation is identical to it s earlier method [25]. Then, a random sequence is derived by utilizing a user- speci c PIN. Bit-string and random sequence are exploited to discrete Fourier transform and product of both DFT s are computed. The cancelable template is stored by applying inverse-DFT and removing the rst (p 1) points from the output. Das et al. [13] constructed a graph structure based on the minimum possible distance from core/delta point to remaining minutiae points. Correspondence search algorithms [13] are used for veri cation of query template. Liu et al. [14] proposed a template protection scheme which derives a protected xed-length template viz., random local region descriptor (RLRD). In this scheme, a random reference point is selected initially. Next, Tico s sampling structure [14] is utilized to generate uniformly distributed sampling point structure around the random reference. The order of the sampling points is decided through a random seed. Finally, a protected template is derived as the angular width between the reference and sampling points. Further, gray-code encoding of sine and cosine of angular width is performed to generate a bit-string. Wong et al. [26] proposed a multi-line code (MLC) for minutiae-based ngerprint template protection which is an extension of Wong et al. [11] work. In this method, the minutia set is divided into angular partitions with respect to a straight line drawn at VOLUME 4, 2016 3 R. Dwivedi et al.: A non-invertible cancelable ngerprint template generation based on ridge feature transformation the reference minutiae. Next, few sample points with equal distance to each other are taken with uniform distribution on the straight line. Circles are constructed on each of the sample points, and minutiae points falling in each lower region (semi-circle) are counted. A binary string is derived considering 1 if the count is greater than 0, and 0 otherwise. The result is stored as the cancelable template. In their extended work [26], the mean distance from minutiae to the line is computed in each semicircle along the lines. The quantization is performed over the mean distances. The binary string is derived and permuted with a user-speci c PIN to generate the cancelable template. Ahmad et al. [8] proposed a cancelable ngerprint template design scheme using many-to-one sector mapping for relative minutiae information in the polar coordinate system as described in [9]. Farooq et al. [15] proposed a triangular transformation which derives a binary representation of minutiae features. The method utilizes the minutiae triplet features: length of each side, the angle subtended between each side, each minutiae orientation in the triplet and the height of triplet. These features are quantized into 24 bits to derive a 224- bit binary representation. Sutcu et al. [19] introduced a geometric design which represents minutiae information into a xed length string. The method computes mean of minutiae x and y coordinate as centroid. Next, a circle is con- structed centered at centroid and divided into an arc of equal angular width. Then, a straight line is drawn in between each minutiae pair and intersection with the circumference is marked. The number of intersection mark is collected sequentially for each arc to derive the transformed template. Wang et al. [27] proposed a scheme which utilizes DFT for pair-minutiae bit string. Further, the complex sequence is fed to Finite-Impulse-Response (FIR) with a user-speci c key to derive the protected template. The method performs optimally yet weak against attack via record multiplicity (ARM). In their future work, Wang et al. [28] proposed a partial Hadamard based transformation the to protect original pair minutiae bit-string. Cappelli et al. [16] introduced a state-of-the-art Minutiae Cylinder Code (MCC) algorithm which frames a 3-D cylin- drical structure around minutiae neighborhood considering each minutia as a reference. Each cylinder of height 2 and radius r is tessellated into a number of cells. Each cell stores the minutiae position and orientation in the neighborhood of each minutia taken as a reference at a time. A cylinder which contains less valid information is discarded. Two cylinders are veri able if direction difference between two minutiae is less than a certain value. MCC is a xed radius local minutiae construct which provides notable recognition performance. However, high computation cost of cell con- struction for each cylinder is the drawback associated with this method. Ferrara et al. [17] then proved that few genuine minutiae points (approximately 25.4%) could be correctly revealed by calculating likelihood between two cylinders. Later, a novel representation namely Protected-MCC (P- MCC) is proposed where a non-invertible transform has been applied onto MCC template incorporating binary-KL projection which provides a greater level of security and privacy. III. PROPOSED METHODOLOGY This section describes our proposed method to derive the protected ngerprint template. The overall design ow for the proposed method is displayed in Fig. 1. The proposed method consists of three major tasks which are displayed in rectangles in the block diagram. First, the input ngerprint image is preprocessed to extract the minutiae points by utilizing the thinned ngerprint image. Next, we form a nearest neighbor structure around each minutiae point using the ridge-based co-ordinate system and compute the ridge features from the thinned image and minutiae information. Thereafter, we apply Cantor pairing function to encode the ridge features uniquely. Finally, the random projection is applied onto the paired output to derive the protected template. In the veri cation phase, the same mechanism is followed to generate the protected query template from the query ngerprint and comparison is performed between the protected enrolled and protected query templates in the transformed (cancelable) domain. A. PRE-PROCESSING AND MINUTIAE EXTRACTION Fingerprint images may have different levels of contrast throughout the image. Pre-processing is performed to en- hance the quality of input ngerprint image subsequently reducing the noise. In literature, different methods have been proposed to reduce noise and detect minutiae points from input ngerprint image. In this work, the pre-processing and extraction of minutiae points are performed by following the method presented in [29]. The extracted minutiae points are denoted as follows: Vup = {mi}n i=1 mi = (xi, yi, i) (1) where, Vup represents the set of untransformed (raw) minu- tia points detected from the input ngerprint and n is the total number of minutiae points in Vup. The ith minutiae point is denoted by mi where (xi, yi) and i are the coordinate positions and orientation, respectively. Also, a thinned ngerprint image is obtained during preprocessing step which is further used for the invariant features extrac- tion. B. NEAREST NEIGHBOR STRUCTURE CONSTRUCTION We use minutiae information to create the nearest neighbor structure on the thinned ngerprint image. First, one of the minutiae point from Vup is selected as a reference minutia. Next, the nearest neighbor structure is formed in the vicinity of reference minutiae point considering the ridge-based co- ordinate system as depicted in Fig. 2(a). In the ridge- based co-ordinate system, reference axis coincides with the 4 VOLUME 4, 2016 R. Dwivedi et al.: A non-invertible cancelable ngerprint template generation based on ridge feature transformation Pre-processing and minutiae extraction Feature extraction Nearest-neighbor structure construction Ridge feature computation Cancelable template generation Cantor pairing function Random projection Comparison Match / Non-match Stored template Protected template Enrollment Verification Protected query template Database FIGURE 1: Block diagram of the proposed method orientation of the selected reference minutiae. Further, we divide the ngerprint region into s sectors of equal angular width around the reference minutia in an anti-clockwise direction. In each sector, the nearest neighbor minutiae point is identi ed by selecting the minimum distance from the reference minutiae point. This procedure is followed for all minutiae points in Vup. It may be noted that if there is no minutia located in any of the sectors, we assign the nearest neighbor to be 0 in that sector. Further, we do not take into account the sectors with no minutiae point at the time of comparison. We consider eight sectors (s = 8) in our method as shown in Fig. 2(a). In Fig. 2(a), m2 is the nearest neighbor of reference minutiae m1 in sector 3. C. RIDGE FEATURE COMPUTATION The accuracy of the ngerprint-based veri cation system could be affected by translation, rotation and scale defor- mations produced while acquisition. Hence, it is necessary to compute invariant features from the input ngerprint image. In this work, we consider ridge count and average ridge orientation between the nearest neighbor minutiae and the reference minutiae in each sector as invariant features. To compute these features, the reference minutiae and the nearest neighbor minutiae points are identi ed rst. Then, we compute the number of ridges along the straight line between these two minutiae in the thinned image and denote the ridge count in jth sector as rcj. Figure 2(a) shows a descriptive example where ridge count between nearest neighbor minutiae (m2) and the reference minutiae (m1) is 2. To compute ridge orientation, a tangent is drawn at the intersection point of the line and ridge. Next, we measure the angle subtended by the tangent and straight lines between two minutiae points for each ridge crossing the straight line. For example, the orientation ( k1 1 ) of the rst ridge in the rst sector as shown in Fig. 2(b) is evaluated as: k1 1 = r1 1 1 where 1, denotes the slope of the line connecting nearest neighbor minutiae to the reference minutiae in the rst sector. r1 1 is the angle subtended by the tangent line from the rst ridge crossing and the reference axis. In a similar manner, we calculate the orientation k2 1 of the second ridge in the rst sector and compute the mean ridge orientation for the rst sector. The mean ridge orientation for the jth sector, denoted as roj is calculated using Eq. (2). roj = round ( r1 j j)+( r2 j j)+........+  rNRj j j  NRj (2) where, NRj represents the total number of ridges between the reference and nearest minutiae in the jth sector. Simi- larly, we nd ridge count and mean ridge orientation for all minutiae and store it as D rcij, roij s j=1 En i=1, where s is the number of sectors and n is the total number of minutiae. D. CANTOR PAIRING FUNCTION The Cantor pairing function [30], [31] is utilized to uniquely encode two natural numbers into a single natural number. Let N = 0, 1, 2, 3,.... be the set of positive integers and N N be the set of all ordered pairs of non-negative integers, a bijection from N N to N is called the Cantor pairing function which is de ned as in Eq. (3). VOLUME 4, 2016 5 R. Dwivedi et al.: A non-invertible cancelable ngerprint template generation based on ridge feature transformation Sector 1 Sector 2 Sector 3 Sector 4 Sector 5 Sector 6 Sector 7 Sector 8 m2 m1 (a) Nearest neighbor structure onto ridge-based coordi- nate system 1 1 k 2 1 k 1 1 r 2 1 r 1 m1 m2 (b) Ridge-based feature computation FIGURE 2: Ridge feature extraction Consider a function: : N N N such that: (k1, k2) := 1 2(k1 + k2)(k1 + k2 + 1) + k2 (k1, k2) N2 (3) We apply this function to encode ridge features. For each minutiae point, we compute the paired output of ridge features (rc and ro) for each sector and stored in a 2D matrix as de ned in Eq. (4). CP (i, j) = 1 2 (rcij + roij) (rcij + roij + 1) + roij i [1, n] and j [1, s] (4) where, rci,j and roi,j represent the ridge features (i.e. ridge count and mean ridge orientation) between the nearest minutiae in the jth sector corresponding to ith reference minutiae. CP (i, j) is paired output of ridge features of the jth sector with respect to the ith reference minutiae. Next, we apply pointwise logarithm operation onto the paired outputs to obtain uniform distribution. Log function is de ned in Eq. (5) and the base (b) of log function is chosen empirically (for details see Section III(C)). For instance, if an input ngerprint image comprising n minutiae points is divided into s sectors, the matrix CP would result into n s entries. After applying the log function, we obtain the log template (LT) of size n s. LT (i, j) = logb (CP (i, j)) (5) E. RANDOM PROJECTION In order to derive non-invertible and revocable cancelable template, we perform random projection onto log template (LT). A random projection matrix (RP) of size s t is derived using a random seed, where t < s. Moreover, each of the entries of RP is computed from a Gaussian indepen- dent and identical distribution (i.i.d.) with unit variance and mean is equal to zero. Now, each row of log template (LT) is projected onto random projection matrix (RP) to derive the cancelable template (CT) of size n t as shown in Eq. (6). CT = LT. RP (6) where, rank(RP)=r. In linear algebra, a theorem of linear systems [32] claims a unique solution when ranks of the coef cient matrix as well as the augmented matrix are same. Further, if rank becomes lower than the unknowns present, the linear system leads to in nite solutions as con rmed in the following proposition. Hence, RP is one of those in nite solutions of Eq. (6). Proposition 1: A linear non-homogeneous system of equations such as CT = LT. RP including s unknowns and n equations contain an in nite number of solutions. Proof: Initially, we claim that CT = LT. RP is solvable. It is evident from Eq. (6) that CT is a linear combination of columns of RP, which states that CT lies in the column space of RP. Hence, rank(RP)=rank([RP CT]). Due to same rank of coef cient matrix and augmented matrix, a solution exists for CT = LT. RP. Next, since rank(RP)= r < t, there are in nitely many possible solutions to Eq. (6). The proposition illustrates that CT is concealed among in nitely many possible solutions which become infeasible to an attacker even if he/she unveils CT and RP. The attacker would not be able to achieve true biometric template as evaluation of pseudo-inverse results obsolete as shown in the following example: Example: Suppose, we have one row of log template and random projection matrix as follows: 6 VOLUME 4, 2016 R. Dwivedi et al.: A non-invertible cancelable ngerprint template generation based on ridge feature transformation LT =  2.5 1.3 3 4.51  and RP = 1.52 2.72 4.28 3.2 3 1.3 0.69 2.1 0.76 1.36 2.14 1.6 Hence, rank(RP)=2 and CT = LT RP =  1.328 1.591 0.664 is corresponding protected template. Let p i LT represents the pseudo-inverse LT. p i LT is computed as: p i LT = RP CT=[-0.3579 0.0993 0.0240 0.1927], where, RP denotes pseudo-inverse of RP. Concurrently, we evaluate another solution manually, p i LT =[0 0 0.3396 0.8692]. Hence, it is veri ed that p i LT RP = CT and p i LT RP = CT. This random projection based transformation guarantees the privacy and security of the proposed method. An im- poster has no clue about LT even if the protected template gets compromised. Further, if we consider the worst case of stolen CT and RP, it would be very hard to retrieve LT from in nitely many possible solutions. We illustrate this with a mathematical proof [33]: Proposition 2: An underdetermined system of linear equations either contains an in nite number of solutions or become inconsistent. Proof: Consider this linear and underdetermined system, CT = LT. RP (see Eq. (6)). We assume that CT = LT RP has in nitely many solutions. Let P be the n s matrix, P = 1 0 0 0 0 1 0 0 0 0 1 0 n s We de ne RP := P. RP. Further we evaluate, LT = min x P. RP CT 2 2 subject to the constraint LT. RP CT 2 2 = 0. For evaluation of LT, the ( LT T LT + P T P) 1 must exist for all > 0, this is non-trivial. Hence, LT achieved may look similar as LT, but it would not be identical. The user s original information cannot be compromised even if an adversary obtains the stored ngerprint template because of the randomness present in the RP. The steps for cancelable template generation are summarized in Al- gorithm 1. F. COMPARISON The comparison between enrolled and query templates is performed in the protected domain to maintain secrecy. We compute local and global similarity to evaluate overall comparison score. We use Dice coef cient to measure the Algorithm 1 Cancelable template generation Input: Log template (LTn s), random projection matrix (RPs t) // Select a seed, to generate random projection matrix RPs t where t < s Output: Cancelable template (CTn t) 1: for i = 1 to n do 2: for j = 1 to t do 3: Initialize sum=0; 4: for k = 1 to s do 5: sum sum + LT(i, k) RP(k, j) 6: end for 7: CT(i, j) sum 8: end for 9: end for 10: return CTn t local similarity between the enrolled and query templates as utilized in [26]. Finally, the likelihood of the enrolled and query template being the two ngerprint of the same subject is measured to compute global similarity score. 1) Local similarity score Let us consider, the enrolled and query protected templates are denoted by CTn t and QTm t respectively where m and n represents the number of minutiae in the query and enrolled templates, respectively. To evaluate the local similarity score, each row of the CT is cross-matched with all rows in QT by computing the inner product of CT(i, :) and QT(j, :) where i 1, 2, , n and j 1, 2, , m. We obtain a similarity matrix sim(i, j) Rn m after applying the Eq. (7). sim (i, j) = 2CT(i, :) QT(j, :) CT(i, :) 2 + QT(j, :) 2 (7) where i [1, n] and j [1, m]. The ith row of CT and the jth row of QT are con- sidered to be veri able if and only if sim(i, j) = max ([sim(i, 1), sim(i, 2), ....., sim(i, n)]) and sim(i, j) = max ([sim(1, j), sim(2, j), ....., sim(m, j)]) are valid simultane- ously. Therefore, each of the entries in similarity matrix is re-evaluated to eliminate double comparison in the following manner: Let, CT = [ CT (1), . . . , CT (i), . . . CT (n)] (8a) where, CT (i) = max(sim(i, 1), . . . , sim(i, m) and QT = [ QT (1), . . . , QT (i), . . . , QT (m)] (8b) where, QT (j) = max(sim(1, j), . . . , sim(n, j) be the maximum scores acquired for all minutiae in CT and QT, respectively. Next, we construct a binary mask A VOLUME 4, 2016 7 R. Dwivedi et al.: A non-invertible cancelable ngerprint template generation based on ridge feature transformation {0, 1}n m, which records the positions of the coinciding maxima; A(i, j) = ( CT (i) == QT (j)) (9) where ( ) returns 1 when the nested condition is true and 0, otherwise. Hence, the ltered similarity matrix is represented by: S = sim A (10) where, represents element-wise multiplication. 2) Global similarity score To perform overall comparison score between CT and QT, the likelihood of CT and QT being two instances of the same ngerprint is measured. From the similarity matrix ( S) obtained in Eq. (11), we calculate the comparison score (S) with the following equation: S = Pn i=1 Pm j=1 \ S(i, j) min(m, n) (11) Algorithm 2 describes the overall comparison procedure. Algorithm 2 Comparison Input: Cancelable template (CTn t), Query template (QTm t) Output: Comparison score (match_score) Initialize : sim(n, m) 0, S(n, m) 0 1: for i = 1 to n do 2: RM1 CT[i] 3: for j = 1 to m do 4: RM2 QT[j] 5: // Evaluate similarity score as described in Eq. (7) 6: sim[i, j] = InnerProduct(RM1, RM2) 7: end for 8: end for 9: CT [ CT (1), . . . , CT (i), . . . CT (n)] where, CT (i) = max(sim(i, 1), . . . , sim(i, m) 10: QT [ QT (1), . . . , QT (i), . . . , QT (m)] where, QT (j) = max(sim(1, j), . . . , sim(n, j) 11: for i = 1 to n do 12: for j = 1 to m do 13: S[i, j] ( CT [i] = QT [j]) // Re-evaluate similarity score to avoid double comparison as described in Eq. (9) 14: end for 15: end for 16: sim sim S 17: match_score(S) = sum(sim(:)) min(m,n) // Evaluate Eq. (11) IV. EXPERIMENTAL RESULTS AND ANALYSIS In this section, we present the details of experimental design and results to illustrate the performance of the proposed method. We also analyze the effect of the different param- eters as well as comparison with the existing approaches. A. DATABASE SELECTION We have conducted our experiment on publicly available ngerprint databases FVC2002, FVC2004, and FVC2006 and each database contain four sets namely, DB1, DB2, DB3, and DB4 since most of the authors of biometrics research community utilize FVC databases [34]. Each set of the rst two databases comprise of 100 subjects with 8 images per subject. Each set of the FVC2006 database includes 140 subjects with 12 images per subject. B. EXPERIMENTAL DESIGN In accordance with the ISO standard [35], we use the following four metrics to evaluate the performance of our method: 1) FMR: The probability of getting a positive comparison decision for an imposter 2) FNMR: The probability of getting a negative compar- ison decision for a genuine user 3) GMR: Can be calculated as 1-FNMR 4) EER: The error rate where FMR and FNMR hold equality The computation of these performance metrics involves the evaluation of genuine and imposter scores. Genuine score refers to the comparison of a ngerprint impression of a sub- ject with the other impressions of the same subject, whereas imposter score is derived by comparing a ngerprint im- pression of each subject against the ngerprint impressions of all other subjects. Also, we have used standard FVC protocol and 1VS1 protocol to compute the performance of our method. In the 1VS1 protocol, the rst ngerprint image of each subject is compared with the second ngerprint image of the same subject to compute the FNMR. To measure the FMR, the rst image of each subject is compared with the rst image of other subjects. This results to measure 100 genuine and 100C2 =4950 imposter scores for each set of the FVC2002 and FVC2004 databases. For each set of FVC2006 database, 140 genuine and 140C2=9730 imposter scores are computed. In the FVC protocol, each ngerprint image of a subject is compared with the remaining ngerprint images of the same subject to compute the FNMR and to evaluate the FMR, the rst ngerprint image of each subject is compared with the rst ngerprint image of the different subjects. This results in providing 8C2 100=2800 genuine and 100C2=4950 imposter scores computation for each set of FVC2002 and FVC2004 databases. For each set of FVC2006, 12C2 140=9240 genuine and 140C2=9730 imposter scores are computed. C. VALIDATION OF PARAMETERS The proposed method utilizes two parameters to derive the protected ngerprint template. These parameters are: number of sectors (s) in the nearest neighbor structure [see section III(B)] and log-base value (b) [see section III(D)]. In 8 VOLUME 4, 2016 R. Dwivedi et al.: A non-invertible cancelable ngerprint template generation based on ridge feature transformation TABLE 1: Number of sectors in nearest neighbor structure Angular width Number of sectors (s) EER (in %) FVC2002 DB1 FVC2004 DB3 FVC2006 DB1 15 24 5.03 7.89 11.32 30 12 3.91 6.75 8.03 45 8 1.75 3.97 5.14 60 6 2.17 4.64 6.38 90 4 3.81 5.44 7.19 this section, we highlight the impact of these parameters on the performance of our approach. We have validated these parameters with respect to dataset DB1 of FVC2002, DB3 of FVC2004 and DB1 of FVC2006 using FVC protocol since they have good quality images. 1) Number of sectors (s): After conducting pre- processing steps, we divide input ngerprint image into s number of sectors with an equal angular width in the ridge-based co-ordinate system. To validate the parameter s, we have performed exhaustive testing considering the different angular widths with 15 interval. We have considered s = 24, 12,...and 4 corresponding to angular width 15 , 30 , ...and 90 , respectively. To carry out this experiment, we have considered log-base value (b) as 1.2. The performance is measured with respect to EER and results are re- ported in Table 1. It has been observed that the method gives the best result for s =8 on dataset DB1 of FVC2002, DB3 of FVC2004 and DB1 of FVC2006. The small value of s degrades the performance of the method as the transformation becomes sensitive to noise. We also observe that EER increases for large values of s as there are more sectors with 0 minutiae points. Hence, we have considered s = 8 for all other experimental evaluations. 2) Log-base value (b): We apply the log function onto the paired output derived using Cantor pairing function to obtain the uniform features distribution. We have conducted a number of experiments by considering the different values of b = 1.1, 1.2, 1.3,..., 2 and measured the performance in terms of EER for dataset DB1 of FVC2002, DB3 of FVC2004 and DB1 of FVC2006 as reported in Table 2. The experimental evaluation illustrates that the method performs the best on b = 1.2. We observe that small value of b ampli es the distribution of paired output reducing EER. Also, EER gets increases as the discrimination between features of the different subjects gets reduced for high values of b. Therefore, we consider b=1.2 to evaluate the performance of our method. D. PERFORMANCE EVALUATION To measure the performance of our method, we have conducted two sets of experiments. We evaluate the per- formance under the same key and different key scenario in the rst and second set of experiments, respectively. TABLE 2: EER for different values of b Log-base (b) EER (in %) FVC2002 DB1 FVC2004 DB3 FVC2006 DB1 1.1 2.13 4.03 6.84 1.2 1.75 3.97 5.14 1.3 2.43 4.87 7.04 1.4 4.07 5.13 8.93 1.5 5.51 6.83 9.94 1.6 6.91 8.03 11.53 1.7 8.12 10.23 13.18 1.8 10.03 11.89 14.91 1.9 11.36 13.97 16.12 2 12.89 14.64 17.9 Each experiment is conducted 10 times, and the average performance of 10 trials is reported in the paper. 1) Same key scenario This scenario represents the situation in practice when an imposter unveils the random projection matrix (RP). We have evaluated this scenario by assigning the same RP to each user present in the database. The ROC curves for FVC2002, FVC2004, and FVC2006 databases with FVC and 1VS1 protocols are shown in Fig. 3, Fig. 4 and Fig. 5, respectively. FVC2002: For FVC2002 database, we achieve an EER of 1.75, 0.98, 4.02, and 3.74 for DB1, DB2, DB3, and DB4 datasets, respectively using FVC protocol. For 1VS1 proto- col, we obtain an EER of 0, 0.13, 3.39, and 3.02 for DB1, DB2, DB3, and DB4, respectively. Out of all FVC2002 datasets, the method exhibit low EER on DB1 and DB2 for both protocols due to the presence of more number of good quality images as compared to other datasets of FVC2002. Further, 1st and 2nd images of a subject in FVC2002 DB2 are acquired in the same session and have less variation and distortion than the other six images. However, images in DB3 and DB4 dataset of FVC2002 contain relatively poor quality images with less number of minutiae points as compared to dataset DB1 and DB2. As a result, we achieve high EER for DB3 and DB4 datasets under both protocols. FVC2004: For FVC2004 database, we achieve an EER of 4.38, 6.59, 3.97, and 3.16 for DB1, DB2, DB3, and DB4 datasets, respectively using FVC protocol. In the 1VS1 protocol, we obtain an EER of 4.02, 5.77, 3.88, and 3.04 for DB1, DB2, DB3, and DB4, respectively. The method performs better on DB4, out of all FVC2004 datasets in both protocols. However, the method gives a high value of EER on DB2 for both protocols as the rst two images of the DB2 dataset are heavily distorted. Moreover, the small overlap area corresponding to the images of stored and query templates is another reason for less accuracy on FVC2004 DB2. For example, if we consider the images of stored and query template, as 96_1.tif and 96_2.tif, the genuine veri cation attempt fails. This is because 96_1.tif contains the region below the core point, whereas 96_2.tif contains region above the core point. The absence of overlapping VOLUME 4, 2016 9 R. Dwivedi et al.: A non-invertible cancelable ngerprint template generation based on ridge feature transformation 10 3 10 2 10 1 10 0 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 False Match Rate (FMR) Genuine Match Rate (GMR) FVC protocol 10 3 10 2 10 1 10 0 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 False Match Rate (FMR) Genuine Match Rate (GMR) FVC2002DB1 [EER: 0] FVC2002DB2 [EER: 0.13] FVC2002DB3 [EER: 3.39] FVC2002DB4 [EER: 3.02] FVC2002DB1 [EER: 1.75] FVC2002DB2 [EER: 0.98] FVC2002DB3 [EER: 4.02] FVC2002DB4 [EER: 3.74] 1VS1 protocol FIGURE 3: ROC curves for FVC2002 datasets under FVC and 1VS1 protocol area causes very few or zero corresponding minutiae from the stored and query templates. Since the proposed system relies on minutiae neighborhood, the lack of corresponding minutiae pair from the stored and query template pair causes comparison trial to fail. We achieve high EER for all four datasets of the FVC2004 database since all the users were requested to put deliberate perturbations at the time of acquisition [34]. FVC2006: For FVC2006 dataset, we achieve an EER of 5.14, 0.14, 1.63, and 0.49 for DB1, DB2, DB3, and DB4, respectively using FVC protocol. For 1VS1 protocol, we obtain an EER of 3.8, 0.09, 2.02, and 1.03 for DB1, DB2, DB3, and DB4, respectively. All of the four datasets are selected among the heterogeneous populations (i.e., manual workers and elderly people) allowing most dif cult nger- prints according to quality index with explicit distortions such as large amounts of rotation and displacement, wet/dry impressions, etc. The dataset DB1 contains small sized poor quality images with missing minutiae. Therefore, the method produces high EER on the DB1 dataset. The method performs optimally on the DB2 dataset for both protocols due to the presence of relatively good quality images. Dataset DB3 and DB4 consist of more number of poor quality images in comparison to dataset DB2. Therefore, it is observed that the performance of the method degrades for DB3 and DB4 of the FVC2006 dataset. Further, we also observe that the proposed method per- forms better with 1VS1 protocol compared to standard FVC protocol. The reason lies in the number of genuine veri cation attempts. In case of 1VS1 protocol, the rst two images of the same user are utilized, whereas all eight images from each user are utilized in the genuine veri cation for the standard FVC protocol. However, we achieve high EER for 1VS1 protocol as compared to FVC protocol for the DB3 and DB4 datasets of the FVC2006 database since the rst two images are noisy and involve non-overlapping regions. 2) Different key scenario In the second set of experiment, we assign the different projection matrices to the different users by altering the seed value and test our method for both the protocols. For FVC2002 dataset, our method performs ideal for all datasets (EER = 0) with both protocols. Moreover, we achieve an EER of 0 for DB1 and DB2 datasets of FVC2004. Datasets DB3 and DB4 consist of more number of poor quality images with very few or missing minutiae in comparison to datasets DB1 and DB2. For DB3 and DB4 dataset, the method gives EERs of 0.08 and 0.03, respectively. For FVC2006 dataset, we achieve an EER close to 0 for DB1, DB2, DB3, and DB4 using FVC and 1VS1 protocols. Therefore, it is evident that the performance of the method in the different key scenario is almost ideal for all datasets. E. COMPARISON OF WITH AND WITHOUT TRANSFORMATION To perform a fair comparison, the veri cation performance of the proposed cancelable biometric system is analyzed with respect to the baseline biometric system (i.e., original ridge features). Further, a comparison process relying on the original minutiae should be taken into account, since the employed ridge-based representation is already part of the process generating the proposed protected templates. Therefore, we compare the performance of the method under 10 VOLUME 4, 2016 R. Dwivedi et al.: A non-invertible cancelable ngerprint template generation based on ridge feature transformation 10 3 10 2 10 1 10 0 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 False Match Rate (FMR) Genuine Match Rate (GMR) 1VS1 protocol FVC2004DB1 [EER: 4.02] FVC2004DB2 [EER: 5.77] FVC2004DB3 [EER: 3.88] FVC2004DB4 [EER: 3.04] 10 3 10 2 10 1 10 0 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 False Match Rate (FMR) Genuine Match Rate (GMR) FVC protocol FVC2004DB1 [EER: 4.38] FVC2004DB2 [EER: 6.59] FVC2004DB3 [EER: 3.97] FVC2004DB4 [EER: 3.16] FIGURE 4: ROC curves for FVC2004 datasets under FVC and 1VS1 protocol 10 3 10 2 10 1 10 0 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 False Match Rate (FMR) Genuine Match Rate (GMR) 1VS1 protocol FVC2006DB1 [EER: 3.8] FVC2006DB2 [EER: 0.09] FVC2006DB3 [EER: 2.02] FVC2006DB4 [EER: 1.03] 10 3 10 2 10 1 10 0 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 False Match Rate (FMR) Genuine Match Rate (GMR) FVC protocol FVC2006DB1 [EER: 5.14] FVC2006DB2 [EER: 0.14] FVC2006DB3 [EER: 1.63] FVC2006DB4 [EER: 0.49] FIGURE 5: ROC curves for FVC2006 datasets under FVC and 1VS1 protocol three scenarios i.e. original minutiae comparison, original ridge features and protected templates. In this experiment, rst we compute the performance for original minutiae comparison based on adaptive image enhancement method proposed by Bartunek et al. [36]. The approach involves publicly available Bozorth3 minutiae matcher [37] from NIST to evaluate the performance. Next, we compute the performance using original ridge features of the query and stored templates. Further, we apply the proposed approach to derive cancelable template and compare the stored and query templates in the transformed domain. Table 3 reports the EERs obtained from the original minutiae comparison, orig- inal ridge features and the cancelable (protected) ngerprint template for the different datasets. It has been observed that the proposed ridge-based computation outperforms the orig- inal minutiae comparison since Bozorth3 does not perform well for poor quality ngerprint images with fewer minutiae points. Also, Bozorth3 is not robust against the alignment, and scale deformations present between the stored and query templates. Therefore, it is evident that the proposed method VOLUME 4, 2016 11 R. Dwivedi et al.: A non-invertible cancelable ngerprint template generation based on ridge feature transformation outperforms than the Bozorth3 matcher. For FVC protocol, the reported results in Table 3 exhibit that there is a minor degradation of 0.19%, 0.15%, 0.05% and 0.07% in the performance for DB1, DB2, DB3, DB4 of FVC2002, 0.053%, 0.07%, 0.033%, 0.04% for DB1, DB2, DB3, DB4 of FVC2004 and 0.04%, 0.14%, 0.037%, 0.32% for DB1, DB2, DB3, DB4 of FVC2006, respec- tively with reference to original ridge features. For 1VS1 protocol, the reported results in Table 4 indicate that the performance is degraded by 0%, 0.85%, 0.08% and 0.09% for DB1, DB2, DB3, DB4 of FVC2002, 0.05%, 0.11%, 0.04%, 0.05% for DB1, DB2, DB3, DB4 of FVC2004 and 0.048%, 2.0%, 0.09%, 0.17% for DB1, DB2, DB3, DB4 of FVC2006, respectively with reference to original ridge features. Therefore, we can conclude that performance degradation produced by the transformation is very low. F. COMPARISON WITH THE EXISTING CANCELABLE BIOMETRIC APPROACHES The approaches in [8], [22] [25], [27], [28] used FVC 2002 database to evaluate the performance of their method using standard FVC protocol. Further, Wong et al. [11] also evaluated the performance on DB1 of FVC2004. In addition to each dataset of FVC2002, Ferrara et al. [17], [18] evaluated their methods on DB1 of FVC2004 and DB2 of FVC2006. The authors, Yang et al. [24] and Wang et al. [27] evaluated the performance on DB2 of FVC2002 with the 1VS1 protocol. Ferrara et al. [17], [18] also evaluated their methods on DB2 of FVC2006 and each datasets of FVC2002 database for 1VS1 protocol. Therefore, we compare our method with these current state-of-the-art approaches [8], [11], [17], [18], [22] [25], [27], [28] in the literature. Table 5 and 6 summarizes the comparison in terms of EER on different FVC datasets for 1VS1 and FVC protocols, respectively. From Table 5, we observe that the best result reported in existing literature is EER = 0, 0.02, 3.43, 3.37 and 0.03 for FVC2002DB1, FVC2002DB2, FVC2002DB3, FVC2002DB4 and FVC2006DB2, respectively, whereas our approach yields EER of 0, 0.13, 3.39, 3.02 and 0.09 for FVC2002DB1, FVC2002DB2, FVC2002DB3, FVC2002DB4 and FVC2006DB2, respectively. From Table 6, we observe that the best result reported in existing literature is EER = 1, 0.99, 5.24, 4.84, 10.36 and 0.17 for FVC2002DB1, FVC2002DB2, FVC2002DB3, FVC2002DB4, FVC2004DB1 and FVC2006DB2, respectively, whereas our approach gives EER of 1.75, 0.98, 4.02, 3.74, 4.38 and 0.14 for FVC2002DB1, FVC2002DB2, FVC2002DB3, FVC2002DB4, FVC2004DB1 and FVC2006DB2, respectively. However, we can observe that the performance of the proposed method for the DB2 dataset of FVC2002 and FVC2006 is slightly lower than [17] in 1VS1 protocol and the EER of FVC2002DB1 is lower than that of Wang et al. [28], but it is comparable. Therefore, it is evident from the reported results that the performance of our proposed approach performs better over the existing template protection techniques. V. SECURITY ANALYSIS The security of the derived protected template is guaranteed when an adversary has no information about the transfor- mation. If an adversary unveils any information about can- celable transformation, the security of the proposed system is guaranteed by three factors: non-invertibility, revocability, and diversity. In this section, we analyze our method with respect to these three contexts. A. NON-INVERTIBILITY The term, non-invertibility refers that it should be compu- tationally infeasible to derive the original ngerprint tem- plate from the protected template. Note that a randomized projection matrix (RP) is utilized to generate a cancelable template from the log template (LT). To meet the non- invertibility requirement, we have adopted a reference archi- tecture proposed by Breebaart et al. [4]. Figure 6 shows the reference architecture where the protected template (CT), random projection matrix (RP), and the parameters (s, b) can be presumed as pseudo-identity, auxiliary data and supplementary data, respectively. In the reference architecture, the protected template (CT) is derived at the enrollment phase. The biometric sample, ridge features and the parameter (s, b) are destroyed after the successful veri cation of stored protected and query protected templates. Due to privacy preservation, it may have been either issued for a limited period or may require revocation when compromised. Moreover, the biometric characteristics may get affected due to aging effects. Hence, it requires renewal after a validity period regulated through watch list. The protected template CT along with the RP and supplementary data (s, b) are stored in the database. During veri cation, a protected query template (CT ) is generated from the issued RP, biometric sample and the parameters (s, b). Next, the stored protected template (CT) and the query protected template (CT ) are forwarded to a comparator/matching server via the communication interface to verify the identity. In this section, we ana- lyze the criterion of non-invertibility with three different architectural components i.e. database, matching server and communication interface for information exchange. 1) Compromised database In this scenario, an attacker can reveal the database i.e. protected template (CT) and the random projection matrix (RP). On the possession of this information, the attacker would not be able to retrieve the log template (LT) since the size of RP is s t where t < s and the entries of RPs t are independent and identically distributed (i.i.d.) Gaussian random variables. Evaluation of LTn s from CTn t results to nd a solution for underdetermined system because it is hard to nd s unknowns from t linearly independent equations where t < s (see Proposition 1-2 in Section III- E). Further, it has also been proved in Du et al. [38] that 12 VOLUME 4, 2016 R. Dwivedi et al.: A non-invertible cancelable ngerprint template generation based on ridge feature transformation TABLE 3: Baseline comparison for FVC protocol Dataset EER Original minutiae comparison Without cancelable transformation With cancelable transformation DB1 DB2 DB3 DB4 DB1 DB2 DB3 DB4 DB1 DB2 DB3 DB4 FVC2002 2.8 2.3 6.5 3.9 1.47 0.89 3.81 3.49 1.75 0.98 4.02 3.74 FVC2004 9.6 5.9 6.2 6.6 4.14 6.12 3.84 3.03 4.38 6.59 3.97 3.16 FVC2006 5.2 1.39 2.91 1.27 4.93 0.12 1.57 0.37 5.14 0.14 1.63 0.49 TABLE 4: Baseline comparison for 1VS1 protocol Dataset EER Original minutiae comparison Without cancelable transformation With cancelable transformation DB1 DB2 DB3 DB4 DB1 DB2 DB3 DB4 DB1 DB2 DB3 DB4 FVC2002 0.91 1.02 4.3 3.89 0 0.07 3.13 2.77 0 0.13 3.39 3.02 FVC2004 4.65 6.30 4.72 3.95 3.81 5.19 3.69 2.89 4.02 5.77 3.88 3.04 FVC2006 4.87 1.04 2.65 2.83 3.62 0.03 1.83 0.88 3.8 0.09 2.02 1.03 Template creation Template creation Template creation Template creation Parameters (s, b) (Supplementary data) Parameters (s, b) (Supplementary data) Comparator / Matching server CT' CT RP RP RP Enrollment Enrollment Database Database Verification Verification Application Application Feature Extractor Feature Extractor Feature Extractor Feature Extractor CT Parameters (s, b) (Supplementary data) Parameters (s, b) (Supplementary data) Biometric sensor Biometric sensor FIGURE 6: Reference architecture for the creation, storage and veri cation of the protection template TABLE 5: Performance comparison with existing cancelable approaches for 1VS1 protocol (values in percentages) Datasets Methods Yang et al. [24] Ferrara et al. [17] Wang et al. [27] Proposed method FVC 2002 DB1 - 0 3 0 DB2 0.72 0.02 2 0.13 DB3 - 3.43 7 3.39 DB4 - 3.37 - 3.02 FVC 2006 DB2 - 0.03 - 0.09 if the projection matrix follows the condition t s 2 and entries in RP are i.i.d., it is very hard to nd the LT from CT. Moreover, even if the attacker achieves supplementary information (s, b), it would be infeasible to unveil the LT as analyzed in the third scenario i.e. compromised communication interface. 2) Compromised matching server Let us assume that an attacker unveils matching server i.e. stored protected template (CT) and query protected template (CT ). Next, an attacker tries to evaluate LT by correlating the information contained in CT and CT . In this situation, an attacker would not be able to retrieve LT since he does not have any information about the RP. 3) Compromised communication interface In this scenario, an attacker may have control over com- munication interface between the database and matching server. In this situation, the adversary would be able to estimate the stored protected template (CT), query protected template (CT ) and the random projection matrix (RP). On the possession of these information, the attacker may utilize CT and RP, or CT and RP to retrieve the log template (LT). This situation is identical to the rst scenario i.e. compromised database. Further, the attacker may correlate CT and CT to evaluate LT. This situation is same as the second scenario i.e. compromised matching server. Further, we assume that the attacker unveils the approx- imate LT by applying known key distinguishing attack. In this situation, the imposter tries to estimate CP or approximate CP using the value of parameter b. However, it would not be possible to retrieve original ridge features since the inversion involves the computation of a square root VOLUME 4, 2016 13 R. Dwivedi et al.: A non-invertible cancelable ngerprint template generation based on ridge feature transformation TABLE 6: Performance comparison with existing cancelable approaches for FVC protocol (values in percentages) Datasets Methods Ahmad et al. [8] Wang et al. [25] Lee et al. [23] Wong et al. [11] Yang et al. [24] Boult et al. [22] Ferrara et al. [17] Ferrara et al. [18] Wang et al. [27] Wang et al. [28] Proposed method FVC 2002 DB1 9 3.5 3.4 4.69 - 2.1 1.88 3.3 4 1 1.75 DB2 6 4 - 5.03 4.53 1.2 0.99 1.8 3 2 0.98 DB3 27 7.5 - - - - 5.24 7.8 8.5 5.2 4.02 DB4 - - - - - - 4.84 6.6 - - 3.74 FVC 2004 DB1 - - - 10.36 - - - 6.3 - - 4.38 FVC 2006 DB2 - - - - - - 0.17 0.3 - - 0.14 indicates that the author(s) have not reported the results or results are reported for partial dataset, in their work. which gives one to many correspondences as de ned in Eq. 12(a)-(d). w =  8 CP + 1 1 2  (12a) t = w2 + w 2 (12b) ro = CP t (12c) rc = w ro (12d) where, rc, ro and CP represent the ridge count, mean ridge orientation and transformed paired output, respectively. w and t are the intermediate values in the calculation and is the oor function. Hence, it would not be possible to invert CP to attain the original ridge features. Therefore, it can be stated that our method preserves the criterion of non-invertibility. B. REVOCABILITY The term revocability refers to the design of a new pro- tected template if stored template gets leaked. The newly generated template should be adequately dissimilar to the compromised one. In this work, a new protected template can be issued just by altering RP. To ensure the potent revo- cability, the biometric templates that are derived by applying different RPs for the same user in different applications, should not be able to verify each other. Here, the random projection is motivated by the Johnson-Lindenstrauss (JL) lemma described in [39]. The lemma states that: For any 0 < < 1 and an integer k, let t be a positive integer such that t t0 = O ( 2log k). For any set B of k points in s, there exists a map f : s t such that: for all u, v B, (1 ) u v 2 f(u) f(v) 2 (1 + ) u v 2 (13) where, u and v are two randomly derived vectors in the s- dimensional Euclidean space, u, v s. For inner-product based similarity, it states that: u.v u . v = Au.Av Au . Av O( ) This lemma provides a proof that the similarity between any two vectors can be preserved up to a factor of when these vectors are projected onto a random t-dimensional subspace. Such type of mapping can be performed by utilizing a matrix containing orthonormal columns as described in Lemma 5.2 [40]. The lemma states that: Let RP be a matrix of size s t where t < s. Each of the entries of RP are i.i.d. Gaussian random variable with zero mean and variance 1 s, rij s(0, 1 s), i=1, ,s , j=1, , t. Let W = RP T RP and W = RPRP T ; then, E(wi,j) = 1, i = j 0, i = j V ar(wi,j) =  2 s, i = j 1 s, i = j (14) E(w i,j) =  t s, i = j 0, i = j V ar(w i,j) =  2t s2 , i = j t s2 , i = j (15) where, wi,j and w i,j are elements of W and W , respec- tively. The output here con rms that E[RP T RP] = I, where I denotes an identity matrix. The elements of RP T RP are centered around their mean with very small variance. This suggests that vectors with random directions are close to orthogonal (i.e. RP T RP I). Further, it is obvious that if rij s(0, 1 s), then, E[ rj 2] = E[Ps i=1 r2 ij] = 1 and V ar[ rj 2] = V ar[Ps i=1 r2 ij] = 2 s, where rj denotes individual columns of RP. This mathematical proof ensures that columns in RP are saturated around one which signi es that the vectors in RP are nearly orthonormal. For revocable biometric template generation, we evaluate the probability of false match when the biometric data of the same user is exploited with the different random projection matrices, denoted as Pfm. Therefore, the revocability i.e. probability of a protected template being revocable can be de ned as: Pr = 1 Pfm. The higher value of Pr corresponds to better revocability. In general, zero Pfm cannot be obtained if we apply random projection directly onto the biometric data (LT). Further, this probability can be reduced by adding an extra vector d s, di >> th to the LT, LT = LT + d, where th denotes the threshold of veri cation system [41]. In similar manner, the biometric templates with Pr 1 could be derived, if different random projection matrices are exploited on the original template of the same user 14 VOLUME 4, 2016 R. Dwivedi et al.: A non-invertible cancelable ngerprint template generation based on ridge feature transformation nullifying the record multiplicity attack [1]. In this work, we achieve Pr= 0.982 corresponding to a threshold, th=0.65. We also verify this security aspect empirically by gen- erating 100 different protected templates using 100 dif- ferent projection matrices from the same nger. Next, we perform a comparison of these 100 templates with the originally enrolled template to obtain the pseudo-imposter scores. We achieve mean and variance of (0.7519; 0.018), (0.3982; 0.177) and (0.3563; 0.189) for genuine, imposter and pseudo-imposter distributions, respectively. These val- ues indicate that mean and variance for the pseudo-imposter distribution are at a distant to genuine distribution and near towards the imposter distribution. Moreover, we obtain FMR = 0, which depicts that all queries are rejected. This signi es that the derived templates are dissimilar to the enrolled templates for the same nger. Although, the templates are generated from the same nger pattern, they are uncorre- lated to each other. Therefore, the claim of revocability is preserved. C. DIVERSITY The characteristics of diversity state that it should derive numerous templates and these derived templates should not provide positive biometric claim over other applications to avoid cross-matching. In our method, multiple ngerprint templates can be derived by choosing the different projec- tion matrices (RP) with the different seed values ( ). Also, the two parameters illustrated in Section IV(C); the number of sectors (s) and log-base value (b) can be utilized to derive numerous templates. The derived protected templates are suf ciently different from the raw ngerprint template which indicates that a user can enroll itself with different templates in different applications without any cross-matching. Hence, it has been con rmed that the method validates the property of diversity. D. OTHER ATTACKS We also analyze the possibility of different types of attacks namely Attacks via Record Multiplicity, pre-image, cross- matching, distinguishing and annealing attacks to validate the robustness of the proposed work: Attack via Record Multiplicity (ARM): This is a scenario where the attacker employs multiple stolen protected tem- plates with or without associated parameters to generate original template [42]. For our approach, it is infeasible to apply ARM since stored template s dimensionality is uncorrelated to the original template s feature space. Fur- ther, numerical values in protected template contain both positive and negative signs due to random projection based transformation. ARM attacks can be launched where the multiplication output contains either all positive or all neg- ative entries. Therefore, the possibility of ARM attack for the proposed method gets nulli ed. Pre-image attack: In this attack, the attacker can utilize multiple protected instances to derive a pre-image instance. Knowledge of Security can also be challenged using feature order with different projection matrices to create a fake template. Biohashing based methods [6], [7], [43], [44] derive binary string by projecting feature vectors with user- speci c random numbers. In contrast, the bit-string could be easily exploited to disclose original minutiae information. Moreover, the projection matrix in Biohashing is not only a square matrix but also have orthonormal row vectors i.e. Rproj RT proj=I, where RT proj is the pseudo-inverse of Rproj and I is the identity matrix. This makes the Biohashing methods vulnerable to pre-image attack. How- ever, the proposed random projection based transformation is different to the methods involving Biohashing. Here, the random projection is utilized to hide the log template among in nitely many possible solutions. Also, our method does not depend on the order of feature components while generating the original as well as the protected template. Further, any value could not be investigated from the two projected feature vectors in any position due to the different sized enrolled and query template. Hence, pre-image attack could not be utilized to derive the original template in our method. Cross-matching attack: The cross-matching attack refers to the scenario where an adversary is able to compromise the databases stored in different applications. The protected templates each from different applications are analyzed to restore the original template. However, the random projec- tion transformation described in Eq. (6) avoids any possi- bility of cross-matching attack across different applications. The proof for the same has been stated in proposition 1 and 2 of Section III-E. Distinguishing attack: In distinguishing attack [45], an imposter tries to utilize the same protected template cap- tured from the different applications to derive the original template by correlating the information. To prevent this, the different protected templates can be utilized in the different applications. However, the attacker can retrieve the different protected templates (CT) along with the known random projection matrices (RP) from the different applications in the known-key distinguishing attack. In this situation, the attacker would be able to unveil log template (LT). Further, he may estimate the paired output (CP) or approximate CP using the value of b or approximately equal to b. However, it is not possible to derive original ridge features since the Cantor pairing function is irreversible as de ned in Eq. (12a)-(12d) (for details, see Section V-A). Annealing attack: In this attack [2], the protected template is divided into multiple regions, and some regions of a sam- ple template are paired with some regions of the reference template to evaluate similarity score. If the similarity score exceeds the threshold, the vicinity corresponding to sample s region is included in the gummy template. This step is repeated until it outputs a gummy template including all matched vicinities. Our approach is robust against this type of attack due to the following reasons: 1) Our approach evaluates the nearest neighbor minutia for each minutiae point causing the different radii to VOLUME 4, 2016 15 R. Dwivedi et al.: A non-invertible cancelable ngerprint template generation based on ridge feature transformation the different minutiae points. Hence, it is very hard to map the gummy template with the original template which is derived from the multiple regions with the variable radius. 2) Ridge-based features are utilized for the neighboring minutiae in each sector instead of relative distances or the directional difference between minutiae pairs. Here, the measured ridge features are invariant to the inter-ridge distances and locations of minutiae points. VI. CONCLUSION AND FUTURE WORK In this paper, we have proposed pre-alignment free can- celable ngerprint template generation technique. The pro- posed technique does not rely on detection of singular points. We divide the input ngerprint image into a number of sectors of equal angular width considering each minu- tia as a reference and use the nearest neighbor minutiae in each sector to compute transformation invariant ridge count and mean ridge orientation features from each sector. Cantor pairing function is applied to encode these fea- tures uniquely. Further, the pointwise logarithm operation is exploited to yield uniformly distributed features. Finally, a random projection is adopted to derive a non-invertible and revocable cancelable template. Experimental evaluation performed over four datasets of FVC2002, FVC2004, and FVC2006 databases depict that the signi cant performance improvement is achieved as compared to the current state- of-the-art techniques. Moreover, the security analysis of our work con rms that our approach ful lls the desired characteristics of template protection schemes preserving the recognition performance too. However, the proposed ridge- based feature computation for low-quality ngerprint and partial ngerprint images is still a demanding area. In our future work, we would try to address this limitation. The computational complexity of the proposed method is O(n2). Hence, future work along the direction to reduce/improve computational complexity is underway. REFERENCES [1] F. Quan, S. Fei, C. Anni, and Z. Feifei, Cracking cancelable ngerprint template of ratha, in 2008 International Symposium on Computer Science and Computational Technology, vol. 2, Dec 2008, pp. 572 575. [2] A. Pashalidis, Simulated annealing attack on certain ngerprint authen- tication systems, in International Conference of the BIOSIG Special Interest Group (BIOSIG), Sept 2013, pp. 1 11. [3] A. K. jain, K. Nandakumar, and A. Nagar, Biometric template security, EURASIP J. Adv. Signal Processing, pp. 113:1 113:17, jan 2008. [4] J. Breebaart, C. Busch, J. Grave, and E. Kindt, A reference architecture for biometric template protection based on pseudo identities, in BIOSIG, 2008. [5] R. Bolle, J. Connell, and N. Ratha, System and method for distorting a biometric for transactions with enhanced security and privacy, dec 2004, US Patent 6,836,554. [6] A. B. Teoh, Y. W. Kuan, and S. Lee, Cancellable biometrics and annota- tions on biohash, Pattern Recognition, vol. 41(6), pp. 2034 2044, 2008. [7] A. T. B. Jin, D. N. C. Ling, and A. Goh, Biohashing: two factor authentication featuring ngerprint data and tokenised random number, Pattern Recognition, vol. 37, no. 11, pp. 2245 2255, 2004. [8] T. Ahmad, J. Hu, and S. Wang, Pair-polar coordinate-based cancelable ngerprint templates, Pattern Recognition, vol. 44, no. 10-11, pp. 2555 2564, 2011. [9] Z. Jin, T. S. Ong, C. Tee, and A. B. J. Teoh, Generating revocable n- gerprint template using polar grid based 3-tuple quantization technique, in IEEE 54th International Midwest Symposium on Circuits and Systems, Aug 2011, pp. 1 4. [10] S. Wang and J. Hu, Design of alignment-free cancelable ngerprint templates via curtailed circular convolution, Pattern Recognition, vol. 47, no. 3, pp. 1321 1329, 2014. [11] W. jing Wong, M. ling Dennis Wong, and Y. hee Kho, Multi-line code: A low complexity revocable ngerprint template for cancelable biometrics, Journal of Central South University, vol. 20, no. 5, pp. 1292 1297, 2013. [12] C. Lee and J. Kim, Cancelable ngerprint templates using minutiae-based bit-strings, Journal of Network and Computer Applications, vol. 33, no. 3, pp. 236 246, 2010. [13] P. Das, K. Karthik, and B. Chandra Garai, A robust alignment-free ngerprint hashing algorithm based on minimum distance graphs, Pattern Recognition, vol. 45, no. 9, pp. 3373 3388, 2012. [14] E. Liu, H. Zhao, J. Liang, L. Pang, H. Chen, and J. Tian, Random local region descriptor (RLRD): A new method for xed-length feature repre- sentation of ngerprint image and its application to template protection, Future Generation Computer Systems, vol. 28(1), pp. 236 243, 2012. [15] F. Farooq, R. Bolle, T.-Y. Jea, and N. Ratha, Anonymous and revocable ngerprint recognition, in IEEE Conference on Computer Vision and Pattern Recognition, June 2007, pp. 1 7. [16] R. Cappelli, M. Ferrara, and D. Maltoni, Minutia cylinder-code: A new representation and matching technique for ngerprint recognition, IEEE Transactions on Pattern Analysis and Machine Intelligence, vol. 32, no. 12, pp. 2128 2141, 2010. [17] M. Ferrara, D. Maltoni, and R. Cappelli, Noninvertible minutia cylinder- code representation, IEEE Transactions on Information Forensics and Security, vol. 7, no. 6, pp. 1727 1737, Dec 2012. [18] M. Ferrara, D. Maltoni, and R. Cappelli, A two-factor protection scheme for mcc ngerprint templates, in International Conference of the Biomet- rics Special Interest Group (BIOSIG), Sept 2014, pp. 1 8. [19] Y. Sutcu, H. T. Sencar, and N. Memon, A geometric transformation to protect minutiae-based ngerprint templates, in Defense and Security Symposium, 2007, pp. 65 390E 65 390E. [20] R. Dwivedi and S. Dey, Coprime mapping transformation for protected and revocable ngerprint template generation, in Mining Intelligence and Knowledge Exploration. Springer International Publishing, 2017, pp. 111 122. [21] N. K. Ratha, S. Chikkerur, J. H. Connell, and R. M. Bolle, Generating cancelable ngerprint templates, IEEE Transactions on Pattern Analysis and Machine Intelligence, vol. 29, no. 4, pp. 561 572, 2007. [22] T. E. Boult, W. J. Scheirer, and R. Woodworth, Revocable ngerprint biotokens: accuracy and security analysis, in IEEE Int. Conference on Computer Vision and Pattern Recognition, June 2007, pp. 1 8. [23] C. Lee, J.-Y. Choi, K.-A. Toh, and S. Lee, Alignment-free cancelable ngerprint templates based on local minutiae information, IEEE Trans. on Systems, Man, and Cybernetics, vol. 37, pp. 980 992, 2007. [24] B. Yang, D. Hartung, K. Simoens, and C. Busch, Dynamic random projection for biometric template protection, in IEEE International Con- ference on Biometrics: Theory Applications and Systems (BTAS), Sept 2010, pp. 1 7. [25] S. Wang and J. Hu, Alignment-free cancelable ngerprint template de- sign: A densely in nite-to-one mapping approach, Pattern Recognition, vol. 45, no. 12, pp. 4129 4137, 2012. [26] W. J. Wong, A. B. Teoh, M. D. Wong, and Y. H. Kho, Enhanced multi- line code for minutiae-based ngerprint template protection, Pattern Recognition Letters, vol. 34, no. 11, pp. 1221 1229, 2013. [27] S. Wang and J. Hu, A blind system identi cation approach to cancelable ngerprint templates, Pattern Recognition, vol. 54, pp. 14 22, 2016. [28] S. Wang, G. Deng, and J. Hu, A partial hadamard transform approach to the design of cancelable ngerprint templates containing binary biometric representations, Pattern Recognition, vol. 61, pp. 447 458, 2017. [29] J. Abraham, J. Gao, and P. Kwan, Fingerprint matching using a hybrid shape and orientation descriptor. INTECH Open Access Pub., 2011. [30] M. Lisi, Some remarks on the cantor pairing function, Le Matematiche, vol. 62, no. 1, pp. 55 65, 2007. [31] G. Cantor, Contributions to the Founding of the Theory of Trans n Anite Numbers. New York: Dover, 1955. [32] E. Kreyszig, Advanced engineering mathematics. John Wiley & Sons, 2010. [33] W.-H. Steeb and Y. Hardy, Problems and solutions in introductory and advanced matrix calculus. World Scienti c Publishing Company, 2016. 16 VOLUME 4, 2016 R. Dwivedi et al.: A non-invertible cancelable ngerprint template generation based on ridge feature transformation [34] Fingerprint Veri cation Competition, https://biolab.csr.unibo.it/ FVCOnGoing/UI/Form/Home.aspxp. [35] ISO/IEC 2382-37:2012 information technology vocabulary part 37: biometrics 2012, 2012. [Online]. Available: https://www.iso.org/ standard/55194.html [36] J. S. Bartunek, M. Nilsson, B. Sallberg, and I. Claesson, Adaptive ngerprint image enhancement with emphasis on preprocessing of data, IEEE transactions on image processing, vol. 22, no. 2, pp. 644 656, 2013. [37] C. I. Watson, M. D. Garris, E. Tabassi, C. L. Wilson, R. M. McCabe, and S. Janet, User s guide to nist ngerprint image software 2 (n s2), National Institute of Standards and Technology, 2004. [38] W. Du, Y. S. Han, and S. Chen, Privacy-preserving multivariate statistical analysis: Linear regression and classi cation, in Proceedings of the SIAM Int. Conference on Data Mining, 2004, pp. 222 233. [39] W. B. Johnson, J. Lindenstrauss, and G. Schechtman, Extensions of lipschitz maps into banach spaces, Israel Journal of Mathematics, vol. 54, no. 2, pp. 129 138, 1986. [40] K. Liu, H. Kargupta, and J. Ryan, Random projection-based multiplica- tive data perturbation for privacy preserving distributed data mining, IEEE Transactions on knowledge and Data Engineering, vol. 18, no. 1, pp. 92 106, 2006. [41] Y. Wang and K. N. Plataniotis, An analysis of random projection for changeable and privacy-preserving biometric veri cation, IEEE Trans- actions on Systems, Man, and Cybernetics, Part B (Cybernetics), vol. 40, no. 5, pp. 1280 1293, Oct 2010. [42] W. J. Scheirer and T. E. Boult, Cracking fuzzy vaults and biometric encryption, in 2007 Biometrics Symposium, Sept 2007, pp. 1 6. [43] G. I. Davida, Y. Frankel, and B. Matt, On enabling secure applications through off-line biometric identi cation, in IEEE Symposium on Security and Privacy, May 1998, pp. 148 157. [44] T. Connie, A. Teoh, M. Goh, and D. Ngo, Palmhashing: a novel approach for cancelable biometrics, Information Processing Letters, vol. 93, no. 1, pp. 1 5, 2005. [45] W. Yang, J. Hu, and S. Wang, A delaunay quadrangle-based ngerprint authentication system with template protection using topology code for local registration and security enhancement, IEEE Transactions on Infor- mation Forensics and Security, vol. 9, no. 7, pp. 1179 1192, July 2014. VOLUME 4, 2016 17