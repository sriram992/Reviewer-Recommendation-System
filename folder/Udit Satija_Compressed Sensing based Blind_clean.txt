Compressed Sensing based Blind Spectrum Sensing in Cognitive Radio Udit Satija School of Electrical Sciences Indian Institute of Technology Bhubaneswar, Orissa, India. E-mail: us11@iitbbs.ac.in Parthapratim De Department of Electrical Engineering Shaqra University Al-Dawadmi, KSA. E-mail: pd4267@yahoo.com Abstract Cognitive Radios exploit the unutilized spectrum by transmitting opportunistically without disturbing the primary user (PU) or licensed user. So, the sensing should be fast enough that the secondary user (SU) can vacate the spectrum when the PU becomes active. Cyclostationary methods perform better than energy detection methods in low SNR scenarios but they require large number of symbols. The objective of this paper to reduce the number of measurements in blind spectrum sensing (using QR decomposition and backward linear prediction) by employing multiple receive antennas. By using compressed sensing at the receiver front end helps to reduce the complexity of the A/D converter. Furthermore, in this paper, simulation results show that our method achieves a good probability of detection in very low SNR even at 50% measurements which is comparable to probability of detection at full measurements. I. INTRODUCTION Cognitive radio is regarded as a substantial solution to spectrum scarcity issue by enabling the secondary user to dy- namically/adaptively access the frequency channels [1]. Spec- trum sensing improves utilization of spectrum by identi cation of medium access control protocol [1]. Compressed sensing (CS) has led to a tremendous surge in cognitive radio and other applications due to high demand for fast, ef cient and in-expensive signal processing algorithms, applications and devices. In such situations, CS provides a promising solution [2], [3]. Compressed sensing enables sampling below the Nyquist rate without or with small reduction in reconstruction quality by exploiting the sparsity of signals in some transform domain and the incoherency of these measurements with the original domain. In essence, CS eliminates the need to acquire and store large number of samples by measuring minimum samples in some transform or basis that contain maximum information and hence saves space. Compressive sensing has seen major applications in diverse elds, ranging from signal processing, image processing, biomedical signal processing and many other applications. In compressed sensing, real world signals like sound, image, video etc., can be acquired using lesser linear measurements and throwing away some information due to inherent sparsity [4], [5]. In cognitive radio, wireless signals are typically sparse in frequency domain. In [6], compressed wideband sensing is used for cooperative spectrum sensing. In [7], [8] blind spec- trum detector is proposed based on compressed sensing using cyclic autocorrelation. To the best of our knowledge, there are few attempts towards the blind spectrum sensing using compressed sensing in very low SNR. This paper addresses a novel blind spectrum sensing method similar to [2], [9], [10], [11], [12], but requiring fewer measurements, by employing the concept of compressed sensing (sub-Nyquist sampling) [13], [14], [3]. Spectrum sensing in cognitive radio is a quite challenging task below the SNR wall (SNR value, below which detection is not possible) [9], [15]. Cyclostationary detectors [9], [11] perform well in low SNR or extremely noisy scenario rather widely used energy detector suffers with noise uncertainty problem. A major pitfall of the cyclostationary detector is that it requires large number of symbols and hence computational complex. Generally, cyclo-stationary methods need information about the primary signal such as modulation type, carrier frequency etc. to operate. In this paper, we propose a novel algorithm to sense the primary signals at very low SNR, by using much less symbols. Though, the novel algorithm is blind in nature so does not require any such information about the primary signal or the multipath channel, shadowing between the primary and secondary users. II. SIGNAL MODEL Let, a vector s RN be the transmitted signal, which is very sparse in frequency domain. Here, a refers frequency domain representation of a time domain signal a. The N length received signal at ith receive antenna, is given by ri(k) = hi(k) s(k) + ni(k) (1) where i = 1, 2...........M, where M is the total number of receive antennas; k = 1, 2, , N is the frequency index. hi is the tapped channel in frequency domain, from the transmitter to the ith receive antenna, and ni is the discrete Fourier transform of white gaussian noise at the ith receive antenna. The received signal at the ith antenna is given as ri = [ ri(0), ri(1), , ri(N 1).]T (2) Finally the received signal over all M receive antennas is given by r =  rT 1 , rT 2 , , rT M T . (3) So, the signal with reduced number of measurements is given by vi = T i ri, i = 1, 2, , M, (4) where, vi, ri are the Fourier transform of reduced dimension signal vi Rd and received signal ri RN which can be written as vi = Fdvi (5) ri = FNri where FN and Fd are the N N and d d DFT matrix respectively and vi, ri are the time domain reduced dimension signal and time domain received signal respectively at ith antenna. For compressed sensing, the sampling process can be expressed (in discrete-time domain) at the ith receive antenna from (4) and (5) as vi = T i ri, i = 1, 2, , M, (6) where, i = F 1 d iFN is the another measurement matrix of size N d. Generally, it is desired that d << N. Equation (4) is a linear inverse problem with sparseness constraint, which may be solved by a Basis Pursuit method [14], which converts the problem into a convex optimization problem ri = arg min ri ri 1, s.t. T i ri = vi. (7) [16] considers a case when signal itself contains noise prior to measurements (noisy signal before measurement) contrary to the case when noise is added at the time of measurement (in the noiseless sparse signal) and proved by a bound that this difference can lead to severe impact on SNR. This is worth to note that till now, compressed sensing has been explored in the noiseless case relevant to cognitive radio. In this paper, we have taken the sparse signal is subjected to the random noise prior to the measurement as it is relevant that in cognitive radio, channel adds noise to the transmitted signal. However, when the PU signal is received at the reciever, it has been corrupted by zero mean additive white Gaussian noise (at very low SNRs like 13 dB) with variance 2 0I. Then, the equation in (4) becomes (for M receive antennas) vi = i ri = i( hi s + n), i = 1, 2, . . . , M, (8) After adding measurement noise zi (zero mean white noise with variance 2 i I), it can be written as vi = i( hi s + n) + zi, i = 1, 2, . . . , M, (9) Now, since the AWGN noise is non-sparse in the frequency domain so it convers the whole frequency spectrum, there- fore received signal becomes non-sparse. Recovery of noise corrupted sparse signals have been investigated in [17], [18], [19]. [17], [18] showed that the reconstruction of the noise- corrupted PU signal from reduced number of measurements depends only on the noise, and not on the PU signal. In the spectrum sensing problem investigated in this paper, reconstruction of noisy signal (from few measurements) is not the main goal. The spectrum sensing method algorithm in [9], as well in [10], is based on the fact that the signal components (on the different receive antennas) are correlated, while the noise components, on the different receive antennas, are un- correlated (see equation (26) in Section III for details). From the reduced number of measurements, the reconstructed noise signals (on the different receive antennas) by the VROMP (see details in next subsection) and the various recovery algorithms, are still uncorrelated [20]. Due to the cross correlation of the reconstructed signal, noise components will implicitly cancelled out (due to uncorrelatedness of noise components) that enables detection of PU signal. As, we can see in Figure 1 and Figure 2 that reconstruction is very poor at -10 dB SNR but due to uncorrelatedness of noise components added in the channel and high correlation between signal components due to multiple receive antenna the reconstructed signal can be employed for detection using blind spectrum sensing as in [9]. Whitening lter is used to whiten the noise as in [16], [20]. So, the equivalent noise variance will depend on the variance of measurement noise 2 i I and variance of AWGN ( 2 0I) multiplied by a factor of N/d [16], [20]. So, for solving (7), vector regularized Orthogonal Matching Pursuit algorithm [14], [17], [18] (extended for vector case) described in the following subsection. A. Vector Regularized Orthogonal Matching Pursuit (VROMP) The scalar Orthogonal Matching Pursuit in [14], [17], [18] is extended to the vector case for M receive antennas. Referring to (7), let m be the sparsity level, i.e., number of zero elements in ri. In the vector regularized OMP algorithm, let it is initialized that the residual x0,i = vi, index set 0 to zero and the matrix 0 as an empty matrix at iteration t = 0. First, the index set t,i is determined by t,i = maxj=1,2, ,d| < xt 1, j > | (10) where, j is the jth column of t,i. t,i denotes the corre- lation of column of j with xt 1. Let, Jt be the set of m largest values of t,i. Then, among all subsets Jt Jt with maximal energy t,i| Jt 2 in the regularization step. Then t,i = t 1,i [ { Jt}, t,i = h t 1,i | t,i i (11) Since, d is chosen such that d m (in [14], d can be m2), T t,i is always assumed to be of full column rank and thus the linear system of equations vt,i = T t,iyt,i (12) is solved (in the least squares sense) by yt,i = [ t,i T t,i] 1 t,ivt,i. (13) The new approximation to the data and the new residual are calculated as at,i = t,iyt,i (14) and xt,i = vi at,i. (15) The iteration is stopped at t = m, where, m is again the spar- sity level of the signal. The reconstructed signal ri has non- zero entries at indices in m,i; the estimate of ri (i.e., at the ith receive antenna, at index l ), is equal to the lth component of ym,i. Thus, ri, i = 1, 2, , M is obtained for each receive antenna, where ri =  ri(0) ri(1) ri(N 1)  . At each of the M receive antennas, the signal ri (in time domain) is reconstructed for i = 1, 2, , M by taking an 0 1000 2000 3000 4000 5000 0 0.2 0.4 0.6 0.8 Frequency Points (a) Amplitude Sparse signal in single frequency band Reconstructed signal using VROMP 0 1000 2000 3000 4000 5000 0 0.5 1 1.5 Frequency Points (b) Amplitude Sparse signal in single frequency band Reconstructed signal using VROMP Fig. 1. Reconstruction using OMP in xed channel using one antenna for one primary user (a)At 10 dB (b)At -10 dB 0 1000 2000 3000 4000 5000 0 0.2 0.4 0.6 0.8 Frequency Points (a) Amplitude Sparse signal in two frequency bands Reconstructed signal using VROMP 0 1000 2000 3000 4000 5000 0 0.5 1 1.5 Frequency Points (b) Amplitude Sparse signal in two frequency bands Reconstructed signal using VROMP Fig. 2. Reconstruction using OMP in xed channel using one antenna for two primary users (a)At 10 dB (b)At -10 dB inverse DFT of ri. Then, the blind spectrum sensing method of [9] is applied, which does not suffer from noise uncertainty problem encountered by energy detectors at very low SNR but on the other hand, it require large number of symbols. In this paper, we propose a novel method to overcome the require- ment of large number of symbols (measurements) required in [9]. Few measurements are used for reconstructing the large number of symbols and then blind detection algorithm of [9] is used, which nds correlations between signal components (and uncorrelatedness of noise components) using multiple antennas at the receiver. Let, yi be the estimate of ri. Let, a vector y after stacking the signal on the M receive antennas at symbol interval n, we de ne y(n) = [y1(n), y2(n), yM(n)]T . (16) Stacking P successive symbols on top of each other, we get yP (n) =  yT (n), yT (n 1), , yT (n P + 1) T . (17) Similar to [9], yP (n) = HP s(n) + nP (n) (18) where HP and nP (n) are the channel matrix and the stacked noise vector as in [9]. Assuming that HP is of full column rank and de ning the data matrix (over S symbols), Y(n) = [yP (n), yP (n 1), , yP (n S + 1)] , (19) and de ning the prediction error vector as in [9] e(n) = [ PP 1 IM] yP (n) (20) where, PP 1 is the backward linear prediction lter of length (P 1)M). After partitioning received data matrix can be written as Y(n) =  Y(n) B(n)  (21) where Y(n) is the top (P 1)M S block-matrix, at the top of Y(n), while B(n) is the bottom block-row (of size M S) of Y(n). Also the rank-revealing QR decomposition of Y(n) is given by (as in [9]), Y H(n) = Q  R1 R2 0S r,r 0S r,(P 1)M r  (22) and r = P + Lh 1, where Lh is the multipath channel delay spread (in symbols), r is also the rank of Y (n). See the detailed description in [9] by the author. Then backward prediction parameters are determined in least square sense in both signal and noise together and noise only case by [9]. Then, two signal statistics can be computed by rank-revealing QR decomposition of YH(n) as S1 = B(n)[Q]1:r, (23) and S2 = [ PP 1 IM] Y(n)[Q]1:r. (24) where, S1, S2 are the two signal statistics. After calculating Frobenius norm of S1 and S2 presence of primary signal is decided by comparing with a threshold as follows: = Signal Present, if S1 F S2 F , Signal Absent, otherwise (25) where, is the threshold which depends on probability of false alarm. Here, in this paper threshold is chosen such that the probability of false alarm is 0.15. Signal statistic S1 will have a large value when primary signal is transmitting because the received signal at a secondary user, B(n)(at time (n N +1)) will have a non zero projection in signal space of Y(n) ([Q]1:r). On the other side, signal statistic S2 will have a small value (theoretically zero), even if primary signal transmitting. If primary signal is absent then both signal statistics S1 and S2 will theoretically be close to zero [9]. III. ANALYSIS OF THE NOVEL ALGORITHM To explain the ability of the novel algorithm to sense primary signals, even at SNR of 15 dB (when noise power is much higher than the signal power), it is seen that the signal components (in the received signal and noise), on the multiple receive antennas, are correlated, as the same transmitted signal s(n) travels through different multipath channels to be received on the multiple receive antennas. However, the (very large) noise components (of the received signals, on the multiple receive antennas) can be assumed to be uncorrelated [9], [10]. To explain the superior performance of the proposed (cyclo-stationary based) spectrum sensing algorithm, a single- tap multipath channel (in time domain) i.e. Lh = 1 and (number of receive antennas M = 2) is considered. Then the reconstructed signal (at the receive antennas, in time domain), even at very low SNR (like 13 dB), for the nth symbol, (where r is the estimate and obtained by the inverse DFT of equation (1))  r0(n) r1(n)  =  h0(0) h1(0)  s(n) +  n0(n) n1(n)  =  d0(n) d1(n)  +  n0(n) n1(n)  (26) When the noise power is much higher than the signal power (like 13 dB), the second term in the above equation is much larger than the rst term. However even then, the correlation between the noise components n0(n) and n1(n) is very low. But the correlation between the signal compo- nents d0(n) and d1(n) is high, because of the presence of the common term s(n) in both d0(n) and d1(n). This is E[ d0(n) d 1(n)] = h0(0)h 1(0) 2 s. (E[] is the expected value) Similar logic is provided by the author in [9] and in [10]. Moreover, unlike [9], we utilize the fact that very few PUs are active in their bands (at the same time/location) to allow the rich theory of compressed sensing theory [14] (i.e. superior reconstruction of sparse signals from limited number of measurements) to be combined with the modi ed multi- antennas based blind spectrum sensing algorithms to obtain a practical solution to the challenging problem of blindly detecting PU signals at even SNR of 15 dB, with even as little as 50% of the measurements in [9]. IV. SIMULATION RESULTS For all simulations SNR is de ned as, i.e., SNR = E(| y(n)|2) E(| w(n)|2) (27) where y(n) is the received signal vector in time domain for multiple antennas. The signal is received through different channel taps. w(n) is the white gaussian noise in time domain, at varying SNRs. This is worth to note that a sparse noisy signal is receiving before the measurement so after adding measurement noise, noise variance will change and hence SNR will change accordingly by the ratio as mentioned in [16]. Five thousand data symbols having 0.5% non-zero samples (in frequency domain, i.e., sparsity level m) were used. 100 computer experiments for all simulations were performed to average out the results. The number of iterations used in 15 10 5 0 5 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 SNR(dB) Probability of Detection Pd(VROMP(80% Measurements)) Pd(VROMP(50% Measurements)) Blind Sensing [9] Energy Detector Pfa Fig. 3. Comparison of probability of detection for the proposed and other algorithms in single tap channel having channel coef cient h0=[0.8,0.3,0.55,0.15] (for the four receive antennas) . 15 10 5 0 5 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 SNR(dB) Probability of Detection Pd(VROMP(80% Measurements)) Pd(VROMP(50% Measurements)) Blind Sensing [9] Energy Detector Pfa Fig. 4. Comparison of probability of detection for the proposed and other algorithms in ve taps random channel for one primary user . VROMP is 30. P = 15 and M = 4 receive antennas are employed. Figure 1 shows the sparse signal (in frequency domain) and its reconstruction (from 80% measurements) for two bands (can be thought of primary user present in band or one primary user (one and its conjugate band due to symmetry)) using one receive antenna, rst at a SNR of 10 dB, when the reconstruction is very good and then at a SNR of 10 dB, when (as expected), the reconstruction (to a sparse signal) is completely non-sparse and is very different from the original sparse signal. Figure 2 shows the sparse signal (in frequency domain) and its reconstruction (from 80% measurements) for four bands (can be thought of two primary users) using one receive antenna, rst at a SNR of 10 dB, when the reconstruc- tion is very good and then at a SNR of 10 dB, when (as expected), the reconstruction (to a sparse signal) is completely non-sparse and is very different from the original sparse signal. Figure 3 shows, that from the reconstructed (signal + noise) at the multiple receive antennas and by employing the proposed blind sensing algorithm (which implicitly utilizes the cross- correlation between the signal components on the multiple receive antennas), detection of primary signals, even at very low SNR, is possible. Figure 3 shows comparative plots of 15 10 5 0 5 0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1 SNR(dB) Probability of Detection Pd(VROMP(80% Measurements)) Pd(VROMP(50% Measurements)) Blind Sensing [9] Energy Detector Pfa Fig. 5. Comparison of probability of detection for the proposed and other algorithms in ve taps random channel for two primary user . probability of detection for 80% and 50% measurements using VROMP, Blind Sensing [9] (which uses full measurements) and for energy detector and probability of false alarm with the SNR ranging from 15 dB to 5 dB in xed channel. The channel is a single-tap channel with channel coef cient vector h0=[0.8,0.3,0.55,0.15] (for the four receive antennas). From the results, it is evident that by using our proposed method even with 50% measurements, probability of detection is pretty close to that of [9], even if reconstruction is very poor, whereas energy detector fails at very low SNR. In Figure 4, the comparison is made in ve taps random channel for two bands as shown in Figure 1. This shows that our proposed method works well in ve taps random channel also at 50% measurements and comparable to [9], which uses full measurements. Figure 5 shows the comparison of probability of detection in four bands as shown in gure 2 and shows that its performance is close to probability of detection at full measurements. The results allow spectrum sensing over a wide band, by using a limited number of measurements (of the received signal-sub-Nyquist sampling), and thus satisfying the timing requirements for rapid sensing. This paper is also a feasibility study of detecting primary signals from limited number of measurements at very low SNR (like 13 dB) (a very important criterion in cognitive radio systems like IEEE 802.22), which distinguishes it from [13], which considers only the noiseless case. V. CONCLUSION In this paper, a limited number of measurements are used for the detection the presence of primary user by exploiting the sparse-ness of radio spectrum at any given time/location. First, complete received signal is reconstructed from a limited number of measurements of the received signal (over the wide spectrum) using VROMP by employing at different multiple antennas. Then, blind spectrum sensing is accom- plished by employing a combination of linear prediction and rank-revealing QR decomposition, of the reconstructed received signal matrix. The novel method s performance at 50% measurements is quite close to [9], which requires very large numbers of measurements (symbols), similar to other cyclo-stationary based spectrum methods in extremely low SNR conditions. The proposed method is also blind so does not require any information about the primary signal power, multipath channel distortions (between primary and secondary users) and band(s) occupied by the primary users. REFERENCES [1] S. Hu, Y. D. Yao, and Z. Yang, MAC protocol identi cation using support vector machines for cognitive radio networks. IEEE Wireless Commun., vol. 21, no. 1, pp. 52-60, 2014. [2] A. Ghasemi, and E. S. Sousa, Spectrum sensing in cognitive radio networks: requirements, challenges and design trade-offs, IEEE Commun. Mag., vol. 46, pp. 32-39, 2008. [3] D. L. Donoho, : Compressed sensing , IEEE Trans. Inf. Theory, vol. 52, pp. 1289-1306, 2006. [4] E. J. Candes, J. K. Romberg and T. Tao, Stable signal recovery from incomplete and inaccurate measurements, Commun. Pure Appl. Math., vol. 59, no. 8, pp. 1207-1223, 2006. [5] M. F. Duarte and Y. C. Eldar, Structured compressed sensing: From theory to applications, IEEE Trans. Signal Process., vol. 59, no. 9, pp. 4053-4085, 2011. [6] Z. Tian, Compressed wideband sensing in cooperative cognitive radio networks, In Global Telecommun. Conf. GLOBECOM IEEE, pp. 1-5, November 2008. [7] Z. Khalaf, A. Nafkha, and J. Palicot, Blind spectrum detector for cognitive radio using compressed sensing. In Global Telecommun. Conf. (GLOBECOM 2011), IEEE, pp. 1-5, December 2011. [8] Z. Khalaf, A. Nafkha and J. Palicot, Blind spectrum detector for cognitive radio using compressed sensing and symmetry property of the second order cyclic autocorrelation, In Cognitive Radio Oriented Wireless Net. and Commun. (CROWNCOM), 7th Int. ICST Conf. IEEE, pp. 291- 296, June 2012. [9] P. De, and Y. C. Liang, Blind spectrum sensing algorithms for cognitive radio networks, IEEE Trans. Veh. Technol., vol. 58, pp. 2834-2842, Sep. 2008. [10] M. S. Oude Alink, A. B. Kokkeler, E. A. Klumperink, G . J. Smit, B. Nauta, Lowering the SNR wall for energy detection using cross- correlation, IEEE Trans. Veh. Technol., vol. 60, no. 8, pp. 3748-3757, Oct. 2011,. [11] A. Sahai and D. Cabric, Cyclostationary feature detection, DySPAN Part II, 2005. [12] P. De, New methods for blind sensing of bandlimited signals in cogni- tive radio, IEEE Vehicular Technology Conference, Dublin, Ireland, Apr. 2007. [13] Z. Tian, and G. B. Giannakis, Compressed sensing for wideband cog- nitive radios , IEEE Int. Conf. Acoust., Speech, Signal Process.(ICASSP), vol. 4, pp. IV-1357, 2007. [14] J. A. Tropp, and A. C. Gilbert : Signal recovery from random measure- ments via orthogonal matching pursuit , IEEE Trans. Inf. Theory, vol. 53, pp. 4655-4666, 2007. [15] R. Tandra and A. Sahai, SNR walls for signal detection, IEEE J. Sel. Topics Signal Process., vol. 2, no.1, pp. 4-17, Feb 2008. [16] E.-Castro and Y.C. Eldar, Noise folding in compressed sensing, IEEE Signal Process. Lett., vol. 18,no. 8, pp. 478-481, Aug. 2011. [17] D. Needell, R. Vershynin, Signal recovery from in completeand inaccurate measurements cvia regularized orthogonal matching pursuit, IEEE J. Sel. Topics Signal Process., vol. 4,no. 2, pp. 310-316, Apr. 2010. [18] D. Needell and J. A. Tropp, CoSAMP: Iterative signal recovery from incomplete and inaccurate samples, Commun. ACM, pp. 93-100, Dec. 2010. [19] S. Mistry and V. Sharma, New algorithms for wideband spectrum sensing, IEEE Int. Conf. Commun., 2013, pp. 2595-2600. [20] P. De, U. Satija, Sparse Representation for Blind Spectrum Sensing in Cognitive Radio: A Compressed Sensing Approach, IEEE Trans. Veh. Technol., Submitted. View publication stats View publication stats