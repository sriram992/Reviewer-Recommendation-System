Robotics and Autonomous Systems 41 (2002) 257 270 Dynamic modelling, simulation and control of a manipulator with exible links and joints B. Subudhi , A.S. Morris Department of Automatic Control & Systems Engineering, University of Shef eld, Mappin Street, Shef eld S1 3JD, UK Received 15 October 2001; received in revised form 17 July 2002 Communicated by F.C.A. Groen Abstract The paper presents a dynamic modelling technique for a manipulator with multiple exible links and exible joints, based on a combined Euler Lagrange formulation and assumed modes method. The resulting generalised model is validated through computer simulations by considering a simpli ed case study of a two-link exible manipulator with joint elasticity. Controlling such a manipulator is more complex than controlling one with rigid joints because only a single actuation signal can be applied at each joint and this has to control the exure of both the joint itself and the link attached to it. To resolve the control complexities associated with such an under-actuated exible link/ exible joint manipulator, a singularly perturbed model has been formulated and used to design a reduced-order controller. This is shown to stabilise the link and joint vibrations effectively while maintaining good tracking performance. 2002 Elsevier Science B.V. All rights reserved. Keywords: Manipulator; Flexible link; Flexible joint; Singular perturbation 1. Introduction Research on the dynamic modelling and control of exible manipulators has received increased attention since the last 30 years due to their several advan- tages over rigid ones [1]. Unlike rigid manipulators, the dynamics of this class of manipulators incorpo- rate the effects of mechanical exibilities in both the links and joints. Link exibility is a consequence of the lightweight constructional feature in manipulator arms that are designed to operate at high speed with low inertia. Joint exibility arises because of the elas- tic behaviour of the joint transmission elements such as gears and shafts. Thus, exible manipulators un- dergo two types of motion, i.e. rigid and exible mo- Corresponding author. Fax: +44-114-222-5661. E-mail address: a.morris@shef eld.ac.uk (B. Subudhi). tion. Because of the interaction of these motions, the resulting dynamic equations of exible manipulators are highly complex and, in turn, the control task be- comes more challenging compared to that for rigid robots. Therefore, a rst step towards designing an ef cient control strategy for these manipulators must be aimed at developing accurate dynamic models that can characterise the above exibilities along with the rigid dynamics. It has been determined experimentally that joint exibility exists in most manipulators in the drive transmission systems [9], but little work has been re- ported on a comprehensive model that describes both link and joint exibility, particularly for manipulators with more than one link. Coupling effects between a exible link and exible joint have been addressed in [4,11]. Two models for a two-link manipulator with both link and joint exibility have been derived using 0921-8890/02/$ see front matter 2002 Elsevier Science B.V. All rights reserved. PII: S0921-8890(02)00295-6 B. Subudhi is presently with NIT-Rourkela, India bidyadhar@nitrkl.ac.in, bidya2k@yahoo.com This paper is archived in dspace@nitr http://dspace.nitrkl.ac.in/dspace 258 B. Subudhi, A.S. Morris / Robotics and Autonomous Systems 41 (2002) 257 270 the Euler Lagrange AMM, one with a set of decoupled equations and the other with a set of coupled equations [11]. In a similar work, Lin and Gogate [4] derived the dynamics of a manipulator with exible links/ exible joints using the Hamilton s principle. These investiga- tions reported that the elasticity in each joint adds an additional degree of freedom to the manipulator, which in turn causes in a large variation in the dynamic be- haviour. However, this Lin and Gogate model does not give clear insight into the mechanisms of joint de ec- tion and the effects of structural damping. Also, it does not consider the effects of the payload and structural damping of the links. It has been shown that both the link and the joint exibility need to be incorporated in the modelling to achieve good trajectory tracking and quick damping of end tip vibrations [4,9,11], because the exible deformations produced by the joints and the links make it dif cult for the end-effector to track a prescribed trajectory accurately. The modelling of the exible link/ exible joint manipulator described in this paper is different from that of [4,11] in several ways. First, it follows a systematic approach for deriving the dynamic equa- tions for a n-link and n-joint manipulator, which is accomplished by the use of two homogeneous trans- formation matrices describing the rigid and exible motions, respectively. Second, it gives a clear picture of the joint de ection in terms of discrepancies be- tween link and joint angles. Notably, unlike the model derived by Lin and Gogate [4], the dynamic model of the manipulator in this paper considers the payload and the structural damping of the links. The paper is organised as follows. In Section 2, a generalised Euler Lagrange AMM formulation for modelling of a manipulator with exibilities in both links and joints is presented. The development of dynamic equations for two-link exible manipulators with exible joints is then dealt with in Section 3. Subsequently, a two-time-scale singularly perturbed model is proposed in Section 4. Then, based on the two-time-scale separation of the exible link and exible joint manipulator dynamics, a controller is designed for tracking and control of link and joint vibrations in Section 5. Results are presented and discussed in Section 6 which show the dynamic be- haviour of the manipulator with bang bang torque input(s) without any control actions and compare this with the performance achieved by employing the pro- posed controller. The paper is concluded with a brief summary in Section 7. 2. Modelling of a manipulator with multiple exible links and exible joints 2.1. Description of the manipulator system The structure of a multiple exible links and exible joints manipulator consisting of n exible links and n exible revolute joints is shown in Fig. 1. The links are cascaded in serial fashion and are actuated by rotors and hubs with individual motors. An inertial payload of mass MP and inertia IP is connected to the distal link. The proximal link is clamped and connected to the rotor with a hub. 2.2. Flexible link and exible joint assembly The schematic representation for the ith exible joint and exible link assembly is shown in Fig. 2. The exible joint is dynamically simpli ed as a linear torsional spring that works as a connector between the rotor and the exible link. i and i are the ith rotor and link angular positions, respectively. Iri is the in- ertia of the ith rotor and hub, where an input torque, i(t) is applied. Gi is the gear ratio for the ith rotor and ksi is the spring constant of the ith exible joint (FJ)i. 2.3. Assumptions The following assumptions are made for the deve- lopment of a dynamic model of the exible manipu- lator: (I) Each link is assumed to be long and slender. Therefore, transverse shear and the rotary inertia effects are negligible. (II) The motion of each link is assumed to be in the horizontal plane. (III) Links are considered to have constant cross-sec- tional area and uniform material properties, i.e. with constant mass density and Young s modu- lus, etc. (IV) Each link has a very small de ection. (V) Motion of the links can have deformations in the horizontal direction only. B. Subudhi, A.S. Morris / Robotics and Autonomous Systems 41 (2002) 257 270 259 Fig. 1. Multiple exible links and exible joints manipulator. (VI) The kinetic energy of the rotor is mainly due to its rotation only, and the rotor inertia is sym- metric about its axis of rotation. (VII) The backlash in the reduction gear and coulomb friction effects are neglected. 2.4. Kinematics formulation In this section, the exible link kinematics is de- scribed. Instead of just considering two-links [4,11], Fig. 2. Schematic of exible link and exible joint assembly. the kinematics description is given here for a chain of n serially connected exible links. The co-ordinate systems of the link are assigned (Fig. 1) referring to the Denavit Hartenberg (D H) description [1]. X0Y0 is the inertial co-ordinate frame (CF), XiYi the rigid body CF associated with the ith link and Xi Yi is the exible moving CF. Considering revolute joints and motion of the manipulator on a two-dimensional plane, the rigid transformation matrix, Ai, from Xi 1Yi 1 to XiYi is 260 B. Subudhi, A.S. Morris / Robotics and Autonomous Systems 41 (2002) 257 270 written as [1] Ai =  cos i sin i sin i cos i  . (1) On using assumption (IV), the elastic homogenous transformation matrix, Ei, due to the de ection of the link i can be written as [1,10] Ei = 1 vi(xi, t) xi  xi=li vi(xi, t) xi  xi=li 1 , (2) where vi(xi, t) is the bending de ection of the ith link at a spatial point xi (0 xi li) and li is the length of the ith link. The global transformation matrix Ti transforming co-ordinates from X0Y0 to XiYi follows a recursion as below [1,5]: Ti = Ti 1Ei 1Ai = Ti 1Ai, T0 = I. (3) Let iri(xi) = xi vi(xi, t) be the position vector that describes an arbitrary point along the ith de ected link with respect to its local CF (XiYi) and 0ri be the same point referring to X0Y0. The position of the origin of Xi+1Yi+1 with respect to XiYi is given by ipi+1 = iri(li), (4) and 0pi is its absolute position with respect to X0Y0. Using the global transformation matrix, 0ri and 0pi can be written as 0ri = 0pi + Tiiri, 0pi+1 = 0pi + Tiipi+1. (5) 2.5. Dynamic equations of motion To derive the dynamic equations of motion for a multiple exible links and exible joints manipulator, the total energy associated with the manipulator sys- tem needs to be computed using the kinematics for- mulations explained in Section 2.4 (Fig. 1). In their formulation of a model for a two- exible links and joints manipulator, Yang and Donath [11] determined the different components of the energy associated with the rst and second links separately. They assumed small angular rotation of the links in deriving the ki- netic and potential energies due to the motion of the links. Unfortunately, this small angle motion assump- tion is invalid for a practical manipulator. Also, the approach becomes tedious for deriving equations for a manipulator with many links and joints. Therefore, the derivation of the dynamic equations of the multi-link exible manipulator presented in this paper does not assume small angular rotation. Instead of adopting only the rigid transformation matrix and then incor- porating the elastic deformation of the links, the use of rigid and elastic transformation matrices together makes the development in this formulation more sys- tematic and easy. It also means that the total energy expressions of the multiple links and joints manipu- lator can be obtained from the ith link and ith rotor energy expressions directly. The total kinetic energy of the manipulator (T) is given by T = TR + TL + TPL, (6) where TR, TL and TPL are the kinetic energy associated with the rotors, links and the hubs, respectively. Using assumption (VI), the kinetic energy of the ith rotor is given by TRi = 1 2Ji 2 i , (7) where Ji = G2 i Iri, and i is the angular velocity of the rotor about the ith principal axis. Therefore, the total kinetic energy for all the n rotors becomes TR = 1 2 TJ , (8) where = { i} and J = diag(Ji), i = 1, 2, . . ., n. The kinetic energy of a point ri(xi) on the ith link can be written as TLi = 1 2 i li 0 0 rT i (xi)0 ri(xi) dxi, (9) where i is the linear mass density for the ith link and 0 ri(xi) is the velocity vector. The velocity vector can be computed by taking the time derivative of its position (5): 0 ri(xi) = 0 pi + Tiiri(xi) + Tii ri(xi). (10) 0 pi in (10) can be determined using (4) and (5) along with i pi+1 = i ri(li). (11) B. Subudhi, A.S. Morris / Robotics and Autonomous Systems 41 (2002) 257 270 261 The time derivative of the global transformation matrix Ti can be recursively calculated from [1,5] Ti = Ti 1Ai + Ti 1 Ai, Ti = TiEi + Ti Ei. (12) Computation of Ai and Ei for (12) can be achieved as follows [5]: Ai = SAi i and Ei = S vi xi  xi=li , S =  0 1 1 0  . (13) Evaluation of the transpose and derivative of trans- pose terms of the velocity vector in (9) can be easily accomplished by using the following identities [5]: AT i Ai = ET i Ei = STS + I and ET i Ei = (Iv i(li, t) + S) v i(li, t), (14) AT i Ai = S i, (15) where I is the identity matrix of appropriate dimen- sions. After determining the kinetic energy associated with the ith link, the kinetic energy of all the n links can be found as TL = n i=1 1 2 i li 0 rT i (xi) ri(xi) dxi. (16) Referring to Fig. 1 and the kinematics described in Section 2.4, the kinetic energy associated with the pay- load can be written as TPL = 1 2MP pT n+1 pn+1 + 1 2IP( n + v n(ln))2, (17) where n = n j=1 j + n 1 k=1 v k(lk); n being the link number, prime and dot represent the rst derivatives with respect to spatial variable x and time, respectively. pn+1 can be determined using (4) and (5). Next, neglecting the effects of the gravity, the total potential energy of the system can be written as U = US + UJ, (18) where US and UJ are the potential energy resulting from the elastic de ection of the links and joints, re- spectively. The potential energy due to the deforma- tion of the link i can be written as USi = li 0 (EI)i  d2vi(xi) dx2 i  dxi. (19) Therefore, for all the n links, it becomes US = n i 1 2 li 0 (EI)i  d2vi(xi) dx2 i  dxi. (20) Let the de ection of the ith rotor be i i. Then the elastic potential energy for the ith exible joint can be written as UJi = 1 2ksi( i i)2. (21) For n- exible joints, the total elastic potential energy can be written in vector matrix notation as UJ = 1 2Ks( )T( ), (22) where (EI)i is the exural rigidity of the ith link; = { i} , i = 1, 2, . . ., n and the stiffness matrix of the joint (Ks) is written as Ks = diag(ksi). (23) The internal structural damping in each link should also be modelled. Using Rayleigh s dissipation func- tion [6], the dissipation energy for the ith link and jth mode can be written as EDi = 1 2dij q2 ij. (24) Therefore for all the n links, each with nm modes, the total dissipative energy in vector and matrix form can be expressed as ED = 1 2 qTD qT, (25) where the damping matrix, D = diag(dij), i = 1, 2, . . ., n, j = 1, 2, . . ., nm (nm is the number of nite modes (to be explained later)) and dij is the damping coef cient and the modal displacement vector is q = {qij}. Using assumption (I), the dynamics of the link at an arbitrary spatial point xi along the link at an instant of time t can be written using Euler Beam theory [6] as (EI)i 4vi(xi, t) x4 i + i 2vi(xi, t) t2 = 0, (26) where i is the linear mass density of the ith link. Eq. (26) is solved by applying the boundary conditions of the manipulator. Considering a clamped-mass con- guration of the manipulator, the boundary conditions can be written as [5,10] vi(xi, t)|xi=0 = 0, (27) 262 B. Subudhi, A.S. Morris / Robotics and Autonomous Systems 41 (2002) 257 270 v i(xi, t)|xi=0 = 0, (28) (EI)i 2vi(xi, t) x2 i  xi=li = IEi d2 dt2  vi(xi, t) xi  xi=li  MDEi d2 dt2  vi(xi, t) xi  xi=li  , (29) (EI)i 3vi(xi, t) x3 i  xi=li = MEi d2 dt2 (vi(xi, t)|xi=li) + MDEi d2 dt2 (vi(xi, t)|xi=li), (30) where MEi, IEi are the effective mass and moment of inertias at the end of the ith link and MDEi is the con- tributions of masses of distal links. These are de ned below: MEi = MLi mi , IEi = ILi mili , MDEi = MDi mil2 i . (31) A nite dimensional solution of (21) can be obtained by means of AMM [6]. Using this method, vi(xi, t) can be expressed as a superposition of mode-shapes and time dependent modal displacements: vi(x, t) = nm j=1 ij(xi)qij(t), (32) where ij(xi) and qij(t), respectively, are the jth mode shape function and jth modal displacement for the ith link. Substituting for vi(x, t) from (32) in (26) gives (EI)i i ij(xi) d4 ij(x) dx4 i = 1 qij(t) d2qij(t) dt2 = 2 ij. (33) where the constant is 2 ij. Separating (33) into spatial and temporal parts yields d2((EI)i(d2 ij/dx2 i )) dx2 i 2 ij i ij = 0, (34) d2qij(t) dt2 + 2 ijqij(t) = 0. (35) The solution of (35) is qij(t) = exp( ijt), (36) and the solution of (34) is of the form ij(xi) = Nij[cos( ijxi) cosh( ijxi) + ij sinh( ijxi) cosh( ijxi)], (37) where ij is given as [10] ij = sin ij sinh ij+MEi ij(cos ij cosh ij) MDEi 2 ij(sin ij + sinh ij) cos ij + cosh ij MEi ij(sin ij sinh ij) MDEi 2 ij(cos ij cosh ij) , (38) and ij is the solution of the following equation [10]: 1 + cosh ijli cos ijli MEi ij(sinh ijli cosh ijli sin ijli) IEi 3 ij(sinh ijli + cosh ijli sin ijli) + MEiIEi 4 ij(1 cosh ijli sin ijli) + M2 DEi 4 ij(1 cosh ijli sin ijli) 2M2 DEi 4 ij sinh ijli = 0. (39) Nij are the constants that normalise the mode shape functions such that Nij = li 0 [ ij(xi)]2 dxi = mi, (40) where mi is the mass of the link i. Subsequently, the natural frequency for the jth mode and ith link, ij, is determined from the following expression: 4 ij = 2 ij i (EI)i . (41) Next, to obtain a closed-form dynamic model of the manipulator, the energy expressions (6) (25) are used to formulate the Lagrangian L = T U. Using the Euler Lagrange equation t  L Qi  L Qi + ED Qi = Fi (42) B. Subudhi, A.S. Morris / Robotics and Autonomous Systems 41 (2002) 257 270 263 with the ith generalised co-ordinate of the system, Qi, and the corresponding generalised forces, Fi, a set of 4n + 2nm differential equations are obtained. In (42), Qi, and Fi are de ned as follows: Q = {Qi}; Q = { , , q}T; F = {Fi} , i = 1, 2, . . ., 4n + 2nm; F = { , 0, 0}T; = { i}, i = 1, 2, . . ., 4n + 2nm. After mathematical simpli cation, these 4n + 2nm dynamic equations can be written in compact form as J Ks( ) = , (43) M( , q) q + f 1( , ) f 2( , ) + g1( , , q, q) g2( , , q, q) + 0 D q + Ks( ) Kwq = 0 0 , (44) where M is the mass matrix, J the modi ed rotor iner- tia matrix with its elements (Ji), f 1( ) and f 2( ) the vectors containing terms due to coriolis and centrifu- gal forces, and g1( ) and g2( ) are the vectors con- taining terms due to the interactions of the link angles and their rates with the modal displacements and their rates. The components of the above vectors are deter- mined by using the Christoffel symbols as [5] cfg( ) = n+md j=1 n+md k=1  Mij Qfg k 1 2 Mjk Qfg i  Qfg j Qfg k , (45) where cfg( ) = f 1( ) f 2( ) + g1( ) g2( ) , and Qfg = {Qfg i }, i = 1, 2, . . ., n + md (md being the total number of link- exure modes). The stiffness matrix due to the distributed exibility of the links is given by Kw = diag(k11, k12, . . ., k1nm, k21, k22, . . ., k2nm), kij = 2 ijmi. (46) 3. Dynamic model of a manipulator with two exible links and joints Using the generalised modelling scheme described in Section 2, equations of motion of a manipulator with two exible links and exible joints are derived here. Consider two units of the n-link and n-joint ma- nipulator (Fig. 1) with the rst one clamped and a pay- load connected to the tip of the second link. With a view to obtaining a simpli ed model with reasonable accuracy, two modes per link are considered. To derive the kinetic, potential and the dissipative energies associated with the manipulator, the proce- dure adopted in Section 2 is followed. All these energy expressions can be obtained using (6) (25) by substi- tuting for links (i = 1, 2), for two joints (i = 1, 2) and for two modes (j = 1, 2). The solution of the partial differential equation de- scribing the exible motion of the manipulator can be obtained following the general procedures given in (21) (35). In this case, the effective masses at the end of the individual links are set as ME1 = m2 + MP, IE1 = Ib2 + J2 + IP + MPl2, MDE1 = (m2lc2 + MPl2 cos 2), (47) ME2 = MP, IE2 = IP + MPl2, MD2 = 0. (48) It can be seen from (47) that determination of exact mode shapes would require on-line computation of MDE1 as a function of 2. However, previous work [5,10] has shown that little error is incurred if the mode shapes are approximated by those corresponding to the undeformed link con guration where 2 = 0. Hence, in order to minimise computation time, this approximation was made in this work. Here, the generalised co-ordinate vector consists of rotor positions ( 1, 2), link positions ( 1, 2) and modal displacements (q11, q12, q21, q22). The gen- eralised force vector is F = { 1, 2, 0, 0, . . ., 0}T, where 1 and 2 are the torques applied by rotor-1 and rotor-2, respectively. Therefore, the following Euler Lagrange s equations result, with i = 1 and 2 and j = 1 and 2: d dt  L i  L i = i, (49) d dt  L i  L i = 0, (50) d dt  L q1j  L q1j + ED q1j = 0, (51) 264 B. Subudhi, A.S. Morris / Robotics and Autonomous Systems 41 (2002) 257 270 d dt  L q2j  L q2j + ED q2j = 0. (52) The nal dynamic equations of motion of the manipu- lator after algebraic simpli cations can be put in con- cise form as J2 2 Ks2 2( ) = , (53) M6 6( , q) q + f 1( , ) f 2( , ) 6 1 + g1( , , q, q) g2( , , q, q) 6 1 + 0 D4 4 q + Ks2 2( ) Kw2 2 q = 0 0 . (54) It may be noted here that, if the joints are assumed to be very stiff, i.e. ksi , then = and therefore Eqs. (53) and (54) reduce to M6 6( , q) q + f 1( , )2 1 f 2( , )4 1 6 1 + g1( , , q, q)2 1 g2( , , q, q)4 1 6 1 + 0 D4 4 q + 0 Kw4 4 q = 0 . (55) Eq. (55) represents the dynamic model of a two-link exible manipulator with rigid joints. 4. Two-time-scale singular perturbation model Control of exible link manipulators is dif cult be- cause they are under-actuated systems in which all modes of exure in each link have to be controlled by adjusting a single actuating torque. This dif culty is accentuated in the case where both the links and joints are exible since the actuating torque for each link then has to control the exure of both the link and its corresponding joint. A successful solution to this con- trol problem in such under-actuated systems has been accomplished previously by using the singular pertur- bation technique [3]. This essentially uses a perturba- tion parameter to divide the complex dynamic systems into simpler subsystems at different time scales, and it has been successfully applied for controlling manipu- lators with either exible links or exible joints (but not exure in both) [2,8]. This previous work is ex- tended in this paper to obtain a singularly perturbed model for a manipulator where there is exibility in both links and joints simultaneously. The procedure to formulate a two-time-scale singu- lar perturbation model is as follows. Substituting = in (53) and (54), gives J + Ks = , (56) M( , q) q + f 1( , ) f 2( , ) + g1( , , q, q) g2( , , q, q) + 0 D q + Ks Kwq = 0 0 . (57) As the inertia matrix M( ) is positive de nite, its in- verse, H( ) can be partitioned. Hence, and q can be determined as follows: = H11( )f 1( ) H11( )g1( ) H12( )g2( ) H12( )f 2( ) + H11( )Ks H12( )Kwq H12( )D q, (58) q = H21( )f 1( ) H21( )g1( ) H22( )f 2( ) H22( )g2( ) H22( )Kwq + H21( )Ks H22( )D q. (59) Subtracting J from both the sides of (53), = = J 1Ks + J 1 . (60) Now, de ne a common scale factor kc, which is the minimum of all the stiffness constants, i.e. kc = min(k11, k12, k21, k22, ks1, ks2). With this common scale factor, Ks and Kw can be scaled by kc such that, Ks = (1/kc)Ks and Kw = (1/kc)Kw. De ning q = kcq, = kc , = (1/kc) and substituting, q = q and = into (58) (60) gives = H11( , q)f 1( , ) H11( , q)g1( , ) H12( , q)g2( , , q, q) H12( , q)f 2( , ) + H11( , q)Ks H12( , q)Kwq H12( , q)D q, (61) B. Subudhi, A.S. Morris / Robotics and Autonomous Systems 41 (2002) 257 270 265 q = H21( , q)f 1( , ) H21( , q)g1( , ) H21( , q)g2( , , q, q) H22( , q)f 2( , ) + H21( , q)Ks H22( , q)Kwq H22( , q)D q, (62) = J 1 Ks + J 1 . (63) To derive the boundary layer correction, is set to zero in (61) (63) and on solving for q and yields = K 1 s ( J ), (64) q = K 1 w H 1 22 [ H21( , 0)f1( ) H22( , 0)f 2( , ) H21( , 0)( J )], (65) where overbar denotes the value of a variable at = 0. Applying the two-time-scale perturbation technique [3,8], the slow and fast subsystems can be obtained as follows: Slow subsystem: = (M11 + J) 1{ f 1( , ) + }. (66) Fast subsystem at a fast time scale, tf = t/ with = : xf = Afxf + Bf f, (67) Fig. 3. Composite control scheme. where Af = 0 0 I H22 Kw H21 Ks 0 0 J 1 Ks 0 , Bf =  0 J 1 Ks  , xf = [ 1 q 1 a 2 q 2 a ]T, n1 q = q q, n2 q = q, n1 a= , n2 a= , 0 and I matrices are of appropriate dimensions. 5. Design of composite control scheme Fig. 3 gives the structure for the composite con- troller based on the two-time-scale model of the ma- nipulator with two exible links and two exible joints given in (53) and (54). Following the composite con- trol strategy, the net torque, can be determined as [3] = + f, (68) where is the slow control and f is the fast control. The controller for the slow subsystem can be designed according to the computed torque control technique, which can be written as = (M11 + J){ d(t) + Kps( d(t) (t)) + Kvs( d(t) (t))}, (69) 266 B. Subudhi, A.S. Morris / Robotics and Autonomous Systems 41 (2002) 257 270 where Kps and Kvs are the diagonal position and ve- locity gain matrices of the controller and d(t) are the desired trajectories of the two links. As the fast subsystem (67) is completely controllable, a fast state feedback control can be devised to force its states xf to zero. This is given by f = Kpfxf + Kvf dxf dtf , (70) where the feedback gains Kpf and Kvf are obtained through optimising the cost function using an LQR approach [7]. 6. Implementation, results and discussions The dynamic equations (53) and (54) characteris- ing the behaviour of the two-link exible manipulator with exible joints derived in Section 3 are veri ed in this section by undertaking a computer simulation us- ing the fourth-order Runge Kutta integration method at a sampling rate of 1 ms. The physical parameters of the manipulator were taken from [5] and are given in Table 1. Both the links and rotors are considered to have the same dimensions. The manipulator was Fig. 4. Responses of the manipulator: (a) torque input; (b) link-1 angular positions; (c) link-2 angular positions; (d) link-1 rst mode trajectories. Table 1 Parameters of the manipulator Parameter Symbol Value Mass density 0.2 kg m 1 Flexural rigidity EI 1.0 N m2 Length l 0.5 m Rotor and hub inertia Ir 0.02 kg m2 Gear ratio G 1 Stiffness constant ks 100 N m/rad Payload mass MP 0.1 kg Payload inertia IP 0.005 kg m2 excited with symmetric bang bang torque inputs ap- plied at the rotors, each of 0.2 N m amplitude and 0.5 s width (see Fig. 4(a)). The responses of the manipu- lator (without control) are presented in Figs. 4 6 and show the difference between the exible link/ exible joint model and a exible link/rigid joint model. It is observed from Fig. 4(b) and (c) that, due to the joint elasticity, the links exhibit more oscillatory behaviour than they would do if the joints were rigid. The am- plitudes of the rst and second modes of vibrations for both the links (Figs. 4(d), 5(a), 5(b) and 5(c)) and the tip de ections of the links (Figs. 5(d) and 6(a)) are greater with exible joints. Also the oscillations B. Subudhi, A.S. Morris / Robotics and Autonomous Systems 41 (2002) 257 270 267 Fig. 5. Responses of the manipulator: (a) link-1 second mode of vibration; (b) link-2 rst mode of vibration; (c) link-2 second mode of vibration; (d) link-1 tip de ection. Fig. 6. (a) Tip and (b) joint de ection trajectories of the manipulator. 268 B. Subudhi, A.S. Morris / Robotics and Autonomous Systems 41 (2002) 257 270 in modal vibrations and tip de ections with exible joints do not decay with time, unlike the modes of vibration and the tip de ection responses with rigid joints. The elasticity in the joints excites greater rst and second mode vibration in both links, leading to signi cant tip de ections of the links both in ampli- tude and frequency (Figs. 5(d) and 6(a)). Fig. 6(b) shows that both the link angular positions have devia- tions from their respective rotor positions. Thus, it is clear that joint exibility signi cantly affects the link vibrations. This necessitates a suitable controller to damp out the link and joint vibrations simultaneously to achieve good tracking performance. The tracking performance of the singular perturba- tion based composite controller applied to a manip- ulator with two exible links and two exible joints was veri ed with the desired trajectories de ned as d(t) = 0(t) +  6t5 t5 d 15t4 t4 d + 10t3 t3 d  ( f 0), (71) where d(t) = { d1(t), d2(t)}T, 0 = {0, 0}T are the initial positions of the links, f = { /2, /6}T the Fig. 7. Controller performance: (a) tracking desired trajectories; (b) damping joint de ections; (c) link-1 rst modal vibration; (d) link-2 second mode trajectory. nal positions, and td is the time taken to reach the nal position which is taken as 2 s. The gains for the slow and fast control components of the composite singular perturbation control were set as Kps = diag(5.0, 5.0), Kvs = diag(2.0, 2.0), Kpf =  4.0 2.5 1.3 1.8 28.3 58.26 0.0 1.0 1.0 0.0 5.6 8.6  , Kvf =  8.0 37.2 1.5 28.8 126.0 58.03 4.0 0.0 5.0 3.0 8.6 14.7  . The controller performances are shown in Figs. 7 and 8. It can be seen from Fig. 7(a) that good track- ing performance is achieved through the application of the proposed controller. Figs. 7(c), 7(d), 8(a) and 8(b) show that rst and second mode of vi- bration of both the links are well damped. The tip and joint de ections are also suppressed effectively while tracking the desired trajectories (see Figs. 7(b) and 8(c)). The control signals generated for rotor-1 and rotor-2 using the composite controller are shown in Fig. 8(d). B. Subudhi, A.S. Morris / Robotics and Autonomous Systems 41 (2002) 257 270 269 Fig. 8. Controller performance: (a) link-1 second mode trajectory; (b) link-2 second mode trajectory; (c) tip de ections control; (d) control torque signals generated. 7. Conclusions A generalised modelling framework has been de- scribed to obtain the closed-form dynamic equations of motion for a multi-link manipulator considering exibility in the links and the joints by using the Euler Lagrange principle and assumed modes dis- cretisation technique. Unlike the models derived in [11], the model presented in this paper for a multi-link manipulator with both link and joint exibility is a generalised one. This is very useful for the study of manipulators with multiple links and joints that are all exible. As compared to the model formulation in [4], the proposed model is more complete in the sense that it considers the effects of payload and structural damping of the links. The general model formulation can be exploited to obtain the closed-form dynamic models for practical exible manipulators with any number of links. The model equations have been veri ed using bang bang torque inputs in a two-link manipulator, and the model responses have been discussed. The two-time-scale separation of the com- plex dynamics of the exible link and exible joint manipulator makes the control design simpler. With application of the proposed controller to a exible link and exible joint manipulator, good tracking is performed and both link and joint vibrations are suppressed effectively. References [1] W.J. Book, Recursive Lagrangian dynamics of exible mani- pulator arms, International Journal of Robotics Research 3 (3) (1984) 87 101. [2] K. Khorasani, Adaptive control of exible joint-robots, IEEE Transactions on Robotics and Automation 8 (2) (1992) 251 267. [3] P.V. Kokotovic, H.K. Khalil, J. O Reilly, Singular perturbation methods in control: analysis and design, in: SIAM Classics in Applied Mathematics, vol. 25, Society of Industrial and Applied Mathematics, Philadelphia, PA, USA, 1999. [4] Y.J. Lin, S.D. Gogate, Modelling and motion simulation of an n-link exible robot with elastic joints, in: Proceedings of the International Symposium on Robotics and Manufacturing, Santa Barbara, CA, 1989, pp. 39 43. [5] A. De Luca, B. Siciliano, Closed-form dynamic model of planar multi-link lightweight robots, IEEE Transactions on Systems, Man, and Cybernetics 21 (4) (1991) 826 839. [6] L. Meirovitch, Analytical Methods in Vibration, Macmillan, New York, 1967. [7] K. Ogata, Modern Control Engineering, Prentice-Hall International, Upper Saddle River, NJ, 1997. 270 B. Subudhi, A.S. Morris / Robotics and Autonomous Systems 41 (2002) 257 270 [8] B. Siciliano, W.J. Book, A singular perturbation approach to control of lightweight exible manipulators, International Journal of Robotics Research 7 (4) (1988) 79 90. [9] L.M. Sweet, M.C. Good, Re-de nition of the robot motion control problem: effects of plant dynamics, drive systems, constraints and user requirement, in: Proceedings of the 23rd IEEE Conference on Decision and Control, Las Vegas, NV, 1984, pp. 724 731. [10] R. Theodore, A. Ghosal, Comparison of the assumed modes and nite element models for exible multi-link manipulators, International Journal of Robotics Research 14 (2) (1995) 91 111. [11] G.B. Yang, M. Donath, Dynamic model of a two-link robot manipulator with both structural and joint exibility, in: Proceedings of the ASME 1988 Winter Annual Meeting, Chicago, IL, 1988, pp. 37 44. Bidyadhar Subudhi received a BSc (Engg.) degree from the Regional Engi- neering College, Rourkela, India in 1988 and a Master of Technology degree from the Indian Institute of Technology, Delhi, India in 1993. Subsequently, he was awarded a PhD degree from the Univer- sity of Shef eld in 2002. Currently he is an Assistant Professor in the Department of Electrical Engineering in the Indira Gandhi Institute of Technology, Sarang, India. His research in- terests include robotics, fuzzy logic, neural networks and control systems. He is an author of 10 journal papers and 15 conference papers. He is a member of the Institution of Engineers (India) and IEEE (USA). Alan S. Morris was born and educated in England and graduated with a BEng degree in Electrical and Electronic En- gineering from Shef eld University in 1969. Following 5 years employment with British Steel as a research and develop- ment engineer in control system applica- tions, he returned to Shef eld University to carry out research in electric arc fur- nace control, for which he was awarded the PhD degree in 1978. Since that time, he has been employed as a lecturer, and more recently senior lecturer, at Shef eld. His main research interests lie in robotics, and he is now the author of over 120 refereed research papers. Professionally, he is a Fellow of both the Institution of Electrical Engineers and the Institute of Measurement and Control.