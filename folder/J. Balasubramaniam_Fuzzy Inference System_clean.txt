Fuzzy Inference System based Contrast Enhancement Balasubramaniam Jayaram,1 Kakarla V.V.D.L. Narayana,2 V. Vetrivel2 1Department of Mathematics, Indian Institute of Technology Hyderabad, Yeddumailaram - 502 205, INDIA 2Department of Mathematics, Indian Institute of Technology Madras, Chennai - 600 036, INDIA Abstract In this work, we propose a fuzzy inference system based contrast enhancement of gray level images. We propose a new method of generating the fuzzy if-then rules speci c to a given image based on the local information available to be used by a fuzzy inference system. To this end, we only generate a partial histogram and not a complete histogram thus saving on computational costs. We also give a compartive study of our approach and some clas- sical and existing fuzzy techniques, and show that the enhanced images from the proposed algorithm are comparable. Keywords: Image Enhancement, Contrast Stretch- ing, Fuzzy Inference Systems, Fuzzy Partition, His- togram Equalisation, Histogram Matching, Gray level transformations. 1. Image enhancement Enhancement is a fundamental task in digital image processing and analysis. Image enhancement seeks to improve the visual representation of an image to enhance its interpretability by either a human or a machine. Image enhancement encompasses a variety of operations such as noise removal, deblur- ring, gray-level dynamic range modi cation. Con- trast enhancement is among them and is often part of image processing systems in the pre-processing and/or post-processing stage. The principal objective of enhancement is to pro- cess an image so that the result is more suitable than the original image for a speci c application. The word speci c is more important, because a method that is quite useful for enhancing X-ray images may not necessarily be the best approach for enhancing natural sceneries. When an image is processed for visual interpretation, the viewer becomes the ulti- mate judge of how well a method works. 1.1. Spatial Domain Methods The term spatial domain refers to the set of all pix- els composing an image. Spatial domain methods are procedures that operate directly on these pix- els. If f(x, y) denotes the input image and g(x, y) the processed image, the di erent spatial domain procedures can be seen as an operator T on f such that g(x, y) = T[f(x , y )] , (x , y ) N(x, y) , (1) where N(x, y) is some neigbhourhood of the point(x, y). Usually, a neighborhood about a point (x, y) is taken to be the square or rectangular subim- age area centered at (x, y). The center of the subim- age is moved from pixel to pixel starting, say, at the top left corner. The operator T now refers to applying some transformation at each location (x , y ) N(x, y) and suitably aggregating to yield the output g, at that location. The process utilizes only the pixels in the area of the image spanned by the neighborhood. 1.2. Contrast Stretching From the above, we see that any continuous function with domain as the grey values of the input image and the range as the grey levels of the output image can be used dependent on the applications / utility. Often the images to be processed su er from low contrasts. Low contrast images can result from poor illumination, lack of dynamic range in the imag- ing sensor, or even wrong setting of a lens aperture during image acquisition. Hence, there is a need for contrast-stretching, i.e., highlighting a speci c range of gray levels in an image. The idea behind contrast stretching is to increase the dynamic range of the gray levels in the image being processed. Ap- plications include enhancing features such as masses of water in satellite imagery and enhancing aws in X-ray images. This is generally achieved in one of the following two ways: (a) To display a high value for all gray levels in the range of interest and a low value for all other gray levels (b) Brighten the desired range of gray levels but preserve the back- ground and gray-level tonalities in the image. In essence, we stretch the contrast present in a given image. 1.3. Histogram Processing Histograms are the basis for numerous spatial do- main processing techniques. Histogram manipula- tion can be used e ectively for image enhancement. Histograms are simple to calculate and also lend themselves to economic hardware implementations, thus making them a popular tool for real-time im- age processing. EUSFLAT-LFA 2011 July 2011 Aix-les-Bains, France 2011. The authors - Published by Atlantis Press 311 The histogram of a digital image with gray lev- els in the range [0, L 1] is a discrete function h(rk) = nk, where rk is the kth gray level and nk is the number of pixels in the image having gray level rk. It is common practice to normalize a his- togram by dividing each of its values by total num- ber of pixels in the image, denoted by n. Thus a normalized histogram is given by p(rk) = nk n , for k = 0, 1, ....., L 1. Loosely speaking, p(rk) gives an estimate of the probability of occurrence of gray level rk. Note that the sum of all components of a normalized histogram is equal to 1. 1.4. Histogram Equalization Histogram equalization is an approach to enhance a given image. The approach is to design a transfor- mation T(.) such that the gray values in the output are uniformly distributed in [0, 1]. Consider a dis- crete formulation and allow pixel values to be in the interval [0, L 1]. We need to design a gray value transformation s = T(r), based on the histogram of the input image, which will enhance the image. The probability of occurrence of gray level rk in an image is approximated by pr(rk) = nk n k = 0, 1, 2, . . . , L 1 , (2) where, as noted in the beginning of this section, n is the total number of pixels in the image, nk is the number of pixels that have gray levels rk, and L is the total number of possible gray levels in the image. The transformed gray levels are obtained as follows: For k = 0, 1, 2, . . . , L 1, sk = T(rk) = k X j=0 pr(rj) = k X j=0 nj n . (3) Thus, a processed image is obtained by mapping each pixel with level rk in the input image into a cor- responding pixel with level sk in the output image via (3). As indicated earlier, a plot of pr(rk) versus rk is called the histogram of the image. The trans- formation given in (3) is called histogram equal- ization or histogram linearization, since this trans- formation has the tendency of spreading the his- togram of the input image so that the levels of the histogram-equalized image will span the full range of the gray scale. In addition the method is also fully "automatic", i.e., given an image, the process of histogram equalization consists simply of imple- menting (3), which is based on information that can be extracted directly from the given image. 1.5. Main Focus of this work In this paper, we propose a fuzzy inference system based contrast enhancement of gray level images. We present a new method of generating the fuzzy if-then rules - speci c to a given image based on the local information available - to be used by a fuzzy inference system. To this end, we only generate a partial histogram and not a complete histogram thus saving on computational costs. We show that the enhanced images from the proposed algorithm are either comparable, or in some cases, even better than those obtained from histogram equalization. 2. Fuzzy Rule Based Inference System Fuzzy Inference Systems (FIS) are one of the best known applications of fuzzy set theory. They can be seen as a mapping between sets of fuzzy sets. Let X, Y be non-empty sets and f : X Y be any continuous function. Let F(X), F(Y ) denote the set of all fuzzy sets de ned on X, Y , respectively, i.e., F(X) = {A|A : X [0, 1]}. Let an input x X be given to the fuzzy inference system. With the help of a fuzzy if-then rule base and fuzzy logic op- erations on [0, 1]2, the inference module determines a corresponding output y Y . Thus, an FIS ap- proximates f by a fuzzy function f : F(X) F(Y ). The inference mechanism in an FIS itself can dif- fer in their strategy of combining rules, choice of fuzzy logic operations, etc., and hence lead to vari- ous established types of FIS, viz., TS-fuzzy systems, Mamdani, Relational FIS, etc. A fuzzy inference system can be completely and uniquely characterised by the following 6-tuple: F = (X, Y, Ai, Bi, R, O), where X, Y are the input and output domains; Ai, Bi are the fuzzy sets partitioning X, Y ; R is a set of n Single-Input Single-Output fuzzy rules of the form (i = 1, . . . , n): Ri: If x is Ai then y is Bi; O is the set of fuzzy logic operations used in the inference. In the sequel, we describe only the Mamdani FIS in detail which is employed in this work. Let us be given n rules of the form If X is Ai then Y is Bi ", where Ai F(X), Bi F(Y ) for i = 1, . . . , n. Let x X be the given input. The ap- propriate output y Y is determined in the Mam- dani FIS by the following procedure: Step 1 Calculate the degree of belongingness si = Ai(x) [0, 1]. Step 2 Obtain the modi ed output fuzzy set: B i(y) = si Bi(y), for all y Y . Step 3 Obtain the overall modi ed output fuzzy set: B (y) = B 1(y) B 2(y) . . . B n(y), for all y Y . Step 4 Defuzzify the overall modi ed output fuzzy set: y = P y Y B (y) y B (y) . The above Mamdani FIS can be characterised by FM = (X, Y, Ai, Bi, R, O), where O = { = TM = min, = TP = product, = SM = max}. 312 3. Fuzzy Techniques for Image Enhancement Let I denote an image with M N pixels each with varying intensities in some subset of the range [0, L 1] be given. Though, in the literature many works have appeared employing fuzzy techniques covering all aspects of image enhancement, viz., noise removal, sharpness enhancement, etc. (see for instance, [4, 17, 18]), we restrict ourselves only to those works dealing with contrast stretching or grey-level transformations. The rst such work was done by Pal and King [14] wherein they propose a Contrast Intensi cation (CI) Operator, which was further generalised by De and Chatterji [5]. Unlike the approach taken in the present work, they consider the whole image I as a single fuzzy set G : X [0, 1], where X is the set of all M N pixels xmn and G(xmn) [0, 1] gives the brightness of the corresponding pixel. Now they apply the CI operator, which is a function TCI : [0, 1] [0, 1] on G(xmn) and by taking the inverse of this composition the enhanced image is obtained. Other fuzzy techniques used predominantly for contrast adaptation are (see [25] for more details): Minimization of fuzziness [5, 14, 15, 16, 25]; Equalisation using fuzzy expected value: appli- cation of the most typical gray level [7, 19]; Hyperbolization: nonlinear modi cation of membership values [6, 21]; -enhancement: optimization of fuzziness us- ing involutive membership functions [24]; Enhancement using fuzzy relations [1]. We refer the readers to the following excellent monographs and surveys for more on fuzzy tech- niques for image processing: [16, 21, 25, 26]. 3.1. Fuzzy Rule Based Inference System for Contrast Enhancement Recall that a fuzzy inference system is completely and uniquely characterised by the following F = (X, Y, Ai, Bi, R, , ) and that a fuzzy inference sys- tem can be thought of as a function approximator or a mapping from X Y . It is clear now, that by taking X [0, L 1] ; Y = [0, L 1] one can approximate the contrast stretch- ing transformation T : X Y suitably by a fuzzy inference system F = (X [0, L 1], [0, L 1], Ai, Bi, R, O). 3.1.1. Tizhoosh s Approach Fuzzy Rule-based approach is another technique employed and is the one taken in the current work. This approach has turned out to be both powerful and universal for many tasks in image processing. In Tizhoosh et al., [23] a simple inference system is proposed to increase the contrast of medical image data. Based on the full histogram of the image I they partition the input domain X = [0, L 1] into 3 fuzzy sets, viz., dark, gray and bright. On the output domain they use 3 singleton fuzzy sets and obtain the input to output mapping as a weighted average of the membership values and these single- tons. 3.1.2. Proposed Approach To the best of the authors knowledge, Tizhoosh s work is the only one to have taken this approach. Also, as mentioned in Tizhoosh et al., [23], their work was primarily intended to show the potential of fuzzy rule-based approach for image enhancement and was not further explored in a detailed manner. In this work, we intended to do this. Towards this end, we consider here only fuzzy sets whose membership functions are triangular and em- ploy the Mamdani fuzzy system. Thus, to approx- imate T F we need to determine a fuzzy rule base or equivalently a fuzzy partition for the in- put and output domains. In this work, we propose a method of automatically generating an appropri- ate fuzzy rule base utilising the local image-speci c information available, which when incorporated in to a Mamdani fuzzy inference system captures the above mapping. 4. A Novel FIS for Contrast Enhancement Firstly, we de ne the following terms which will be necessary to understand the proposed algorithm. Partial Histogram: In this work, for arriving at the fuzzy partition of the domains, instead of using the classical histogram we only use the partial histogram of the image, i.e., the his- togram obtained by taking the pixel values only from some random paths in the pixel matrix. Typically, we have used 4 paths: 2 along the diagonals, 1 horizontal and 1 vertical. We nd that the partial histogram still retains enough information about the distribution of pixel in- tensities for us to exploit it in the proposed algorithm. Dynamic Minimum Dm : Minimum value among all pixel intensities in the partial his- togram. Concentrated Minimum Cm : Minimum value among all pixel intensities in the concentrated range of the partial histogram. Concentrated Maximum CM : Maximum value among all pixel intensities in the concen- trated range of the partial histogram. Dynamic Maximum DM : Maximum value among all pixel intensities in the partial his- togram. 313 Please refer to Fig. 1(a) for a graphical explana- tion of the above parameters. (a) Partial Histogram (b) Pictorial representation Figure 1: (a) Partial Histogram with the Dynamic and Concentrated Minima & Maxima; (b) Pictorial representation of step-3 of the proposed algorithm (see Section 4.1) Note that since the pixel intensities vary only between [Dm, DM] this interval becomes the de facto input domain X. Let us de- note by FCS the Mamdani fuzzy inference sys- tem characterized by FCS = ([Dm, DM], [0, L 1], Ai, Bi, R, {min, product, max}). The following algorithm speci es how to determine the fuzzy par- titions Ai, Bi. 4.1. The Proposed Algorithm Step 1 From the image I plot the partial his- togram by choosing a few random paths and hence determine the 4 parameters: Dm, Cm, CM, DM. Step 2 Partition the sub-domains [Dm, Cm], [Cm+ 1, CM], [CM +1, DM] of the input domain X = [0, L 1] into nl, nc, nr number of fuzzy sets, respectively. Thus there are n = nl + nc + nr input fuzzy sets Ai, i = 1, 2, . . . , n. Note that each of the Ai s is a triangular fuzzy set and hence requires only the 3 parameters, viz., left, center and right points, to be speci ed. This is done as follows: a) We choose nl equispaced points, say of step size hl, in the sub-domain [Dm, Cm] and for the triangular fuzzy set Ai, i = 1, . . . , nl, the three parameters are speci- ed as (xl, xc, xr) = (Dm+(i 1).hl, Dm+ i.hl, Dm + (i + 1).hl). b) Similarly, we choose nc, nr equispaced points with step sizes hc, hr on the other 2 sub-domains and assign them similarly as above, viz., the triangular fuzzy sets Ai, i = nl + 1, . . . , nl + nc, the three parameters are speci ed as (xl, xc, xr) = (Cm+(i nl 1).hc, Cm+(i nl).hc, Dm+ (i nl + 1).hc), while the triangular fuzzy sets Ai, i = nl + nc + 1, . . . , n, the three parameters are speci ed as (xl, xc, xr) = (CM + (i nl nc 1).hr, Cm + (i nl nc).hr, Dm + (i nl nc + 1).hr). Step 3 Similarly, partition the output domain (Y = [0, L 1]) into a total of n fuzzy sets Bi. This fuzzy partition is not done arbitrarily, but in such a way that the following holds: (i) Dm X is mapped to 0 Y . (ii) DM X is mapped to 255 Y . (iii) Pixels in the range of (Dm, Cm], i.e., x (Dm, Cm] X are mapped to the (0, Cm Dm] Y . (iv) Pixels in the range of (Cm, CM), i.e., x (Cm, CM) X are mapped to the range (Cm Dm, 255 DM CM) Y . (v) Pixels in the range of [CM, DM), i.e., x [CM, DM) X are mapped to the range [255 DM CM, 255) Y . Since we use a Mamdani inference system, the above can be achieved by creating the out- put fuzzy set Bi, where i = 1, 2, . . . , n , as done above, i.e., we choose nl, nc, nr equispaced points, say of step size nl, nc, nr, in the sub- domains [0, Cm Dm], [Cm Dm, 256 DM CM], [256 DM CM, 256] and specify the 3 parameters (xl, xc, xr) as above. Note that the concentrated domain (Cm, CM) is mapped to a larger subset of [0, L 1], viz., [Cm Dm, 256 DM CM] and hence, even though the number of equispaced points remains the same, viz., nc, the step size kc = nc. Step 4 Form the fuzzy if-then rule base consisting of n rules by relating the i-th input fuzzy set Ai to the i-th output fuzzy set Bi, where i = 1, 2, . . . , n. Step 5 Employ the fuzzy system FCS on the input sub-domain X = [Dm, DM] to get the contrast stretching transformation T. 4.2. Comparison of the Proposed Approach with Histogram Equalization and Tizhoosh s Approach We applied the above algorithm employing a Mam- dani fuzzy system with Triangular fuzzy sets for both the input and output fuzzy sets. The gray- level images were so chosen to cover a broad cate- gory of images, viz., outdoor -Boat image, indoor 314 (a) Original image (b) Histogram equalized image (c) Fuzzy inferred image (d) Transformation Function (e) Tizhoosh Approach Figure 2: Results for the Design Pattern image - Magazine cover and Design Pattern images and medical - X-ray image. In Figures. 2 5, we present the original image and also the enhanced images using histogram equalization, Tizhoosh s approach and the proposed approach in this work. We also give the nal gray-scale transformation functions obtained. It can be observed that we obtain con- sistently good enhanced images from the proposed method. 4.3. Advantages of the Proposed Method Since we only require and compute the partial his- togram instead of the complete histogram to determine the fuzzy partitioning of the input domain, the proposed method computation- ally compares favourably with that proposed in Tizhoosh et al., [23]. The input and output fuzzy partitioning is done in a transparent and systematic way. Instead of using a priori transformations like Log, Inverse log transformations which usually do not ex- ploit the image speci c information available, the proposed method does exploit the image speci c information available. Further, since fuzzy inference systems are known universal ap- proximators (see Tikk et al. [20]) it is clear that by suitably partitioning the input and out- put domains with fuzzy sets one can obtain any of the classical a priori transformations to ar- bitrary accuracy. Note that even when the dynamic range of the given image is only a subset of [0, L 1], the dynamic range of the enhanced image is whole of [0, L 1] in the proposed method while that of histogram equalisation is at best [Dm, L 1], and hence the proposed method is more likely to give better contrast to the resulting image. Note that histogram equalization is optimised to exploit the human visual range and hence is not always suitable if the contrast stretching stage is only a pre-processor for a subsequent ma- chine processing stage. In contrast, the fuzzy system based gray level transformations can be tailor-made by tuning the fuzzy partitions of the domains. Finally, though we have considered only contrast stretching through piecewise-linear transforma- 315 (a) Original image (b) Histogram equalized image (c) Fuzzy inferred image (d) Transformation Function (e) Tizhoosh Approach Figure 3: Results for Magazine Cover image tions, the above system can be easily tuned, for instance by employing fuzzy sets of other shapes, to simulate any gray-level transforma- tion function. 4.4. Some concerns of the Proposed Method Despite the many advantages listed above, some concerns do remain and have been listed below. The current method is optimised for low-contrast images, i.e., those with unimodal histograms. Though this algorithm can be easily extended for images with multi-modal histograms by having multiple concentrated minima & max- ima and running the current algorithm on these many sub-domains, this method is plagued with the same concerns as that of local his- togram method with non-overlapping neigh- bourhoods, viz., imbalance in overall contrast even though di erent parts of the image are well contrasted. The advantage of obtaining the required infor- mation from the partial histogram can be lost if the given image is not uniformly varying in contrast. In which case, one may have to re- sort to more number of random paths and in the extreme case requiring the whole histogram to decide on the partition. 5. Conclusions In this work, we have proposed a fuzzy inference sys- tem based contrast enhancement of gray level im- ages. The proposed method of generating the fuzzy if-then rules, which is speci c to a given image based on the local information available, is obtained from the partial histogram and not a complete histogram thus saving on computational costs. We show that the enhanced images from the proposed algorithm are either comparable, or in some cases, even better than those obtained from histogram equalization. A straightforward extension of this work is to au- tomate the determination of fuzzy partitions that perform the di erent a priori transformations thus showing the versatility of the proposed framework. We would also would like to address the above listed concerns and work on porting the above framework to colour images. 316 (a) Original image (b) Histogram equalized image (c) Fuzzy inferred image (d) Transformation Function (e) Tizhoosh Approach Figure 4: Results for the X-ray image-Note the enhancement attained for the subimages in the last row of (c) (a) Original image (b) Histogram equalized image (c) Fuzzy inferred image (d) Transformation Function (e) Tizhoosh Approach Figure 5: Results for the Boat image 317 References [1] Bhutani K.R., Battou A. An application of fuzzy relations to image enhancement. Pattern Recognition Letters, 16: 901 909, 1995. [2] Chen B.-T, Chen Y.-S, Hsu W.-H. Automatic histogram speci cation based on fuzzy set op- erations for image enhancement. IEEE Signal Processing Letters, 2(2): 37 40, 1995. [3] Chen B.-T, Chen Y.-S, Hsu W.-H. Image Pro- cessing and understanding based on fuzzy in- ference approach. In Proc. FUZZ-IEEE 94, Vol I: 254-259, Orlando, FL, USA, June, 1994. [4] Choi Y.S., Krishnapuram R. A robust ap- proach to image enhancement based on fuzzy logic. IEEE Trans. on Image Processing, 6(6): 808 825, 1997. [5] De T.K., Chatterji B.N. An approach to a gen- eralised technique for image contrast enhance- ment using the concept of fuzzy set. Fuzzy Sets and Systems 25(2):145 158, 1988. [6] Frei W. Image enhancement by histogram hy- perbolization. In CGIP 6(3): 397 406, 1977. [7] M. Friedman, M. Schneider, A. Kandel. The use of weighted fuzzy expected value (WFEV) in fuzzy expert systems. Fuzzy Sets and Sys- tems 31(1):37 45, 1989. [8] Gonzalez R.C., Woods R. E. Digital Image Pro- cessing, 3rd Ed. Prentice Hall Inc., 2008. [9] Gottwald S. (2001) A treatise on many-valued logics. Research Studies Press, Baldock, Hert- fordshire. [10] E. E. Kerre and M. Nachtegael (Ed.) (2000) Fuzzy Techniques in Image Processing. Physica-Verlag, Heidelberg. [11] Klement E.P., Mesiar R., Pap E. (2000) Trian- gular norms. Kluwer, Dordrecht. [12] Klir G.J., Yuan Bo (1995) Fuzzy sets and fuzzy logic. Theory and applications. Prentice Hall, New Jersey. [13] Menger K. (1942) Statistical metrics. Proc. Nat. Acad. Sci. USA. 28:535-537. [14] Pal S.K., King R.A. Image enhancement us- ing smoothing with fuzzy sets. IEEE Trans. on Syst. Man and Cybern., 11(7): 494 501, 1981. [15] Pal S.K., Rosenfeld A. Image enhancement and thresholding by optimization of fuzzy compact- ness. Pattern Recognition Letters, 7: 77 86, 1988. [16] Pal S.K., Dutta Majumdar D. Fuzzy Math- ematical Approach to Pattern Recognition. John Wiley and Sons, New York, 1986. [17] Russo F., Ramponi G. A fuzzy lter for im- ages corrupted by impulse noise. IEEE Signal Processing Letters, 3(6): 168 170, 1996. [18] Russo F. FIRE operators for image processing. Fuzzy Sets and Systems 103:265 275, 1999. [19] M. Schneider, M. Craig On the use of fuzzy sets in histogram equalization. Fuzzy Sets Syst. 45(3):271-278, 1992. [20] Tikk D., K czy L.T., Gedeon T.D. A survey on universal approximation and its limits in soft computing techniques. Int. Jl. of Approx. Reas. 33(2):185 202, 2003. [21] Tizhoosh, H.R. Fuzzy Image Processing (in German). Springer, 1997. [22] Tizhoosh, H.R., Krell G., Michaelis B. Lo- cally Adaptive Fuzzy Image Enhancement. In B. Reusch (Ed.), Computational Intelli- gence, Theory and Applications, Proc. Of 5th Fuzzy Days 97, 272 276, Dortmund, Germany, Springer, 1997. [23] Tizhoosh, H.R., Krell, G., Michaelis, B. On Fuzzy Image Enhancement of Megavoltage Im- ages in Radiation Therapy. In FUZZ-IEEE 97, 1399 1404, Spain, 1997. [24] Tizhoosh, H.R., Krell, G., Michaelis, B. Lambda-Enhancement: Contrast adaptation based on Optimization of Image Fuzziness. In FUZZ-IEEE 98, 1548 1553, Alaska, USA, 1998. [25] Tizhoosh, H.R. Fuzzy Image Enhancement: An Overview. In Kerre, E., Nachtegael, M. (Eds.): Fuzzy Techniques in Image Processing, Springer, Studies in Fuzziness and Soft Com- puting, pp. 137-171, 2000. [26] Tizhoosh, H.R., Hauschecker, H. Fuzzy Im- age Processing: An Overview. In J hne, B., Hauschecker, H. (Eds.), Computer vision and applications: A Guide for Students and Prac- titioners, Academic Press, Boston, 2000, pp. 541-576, 318